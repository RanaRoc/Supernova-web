import{A as Ct,B as qD,C as GD,D as $n,E as Ni,F as kh,G as fc,H as zD,I as WD,J as Q,K as bn,L as Pt,M as r_,N as KD,O as pc,P as J,Q as Ht,R as Fh,S as i_,T as Hn,U as Oi,V as li,W as na,X as QD,Y as Tn,Z as dt,_ as s_,a as N,b as Le,c as V2,d as j2,e as t_,f as I,g as FD,h as xh,i as LD,j as VD,k as R,l as ea,m as Rh,n as jD,o as UD,p as Ft,q as ta,r as Mh,s as n_,t as BD,u as Ar,v as $D,w as Ph,x as Nh,y as HD,z as Oh}from"./chunk-OOKUI3SV.js";var R2=V2((Ah,kD)=>{"use strict";(function(t,e){typeof Ah=="object"&&typeof kD=="object"?kD.exports=e():typeof define=="function"&&define.amd?define([],e):typeof Ah=="object"?Ah.embed=e():t.embed=e()})(Ah,function(){return function(){"use strict";var t={8027:function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.DEFAULT_DOMAIN=r.POPUP_SIZE=r.SLIDER_WIDTH=r.SLIDER_POSITION=r.LIVE_EMBED_ATTRIBUTE=r.SIDETAB_ATTRIBUTE=r.WIDGET_ATTRIBUTE=r.SLIDER_ATTRIBUTE=r.POPUP_ATTRIBUTE=r.POPOVER_ATTRIBUTE=void 0,r.POPOVER_ATTRIBUTE="data-tf-popover",r.POPUP_ATTRIBUTE="data-tf-popup",r.SLIDER_ATTRIBUTE="data-tf-slider",r.WIDGET_ATTRIBUTE="data-tf-widget",r.SIDETAB_ATTRIBUTE="data-tf-sidetab",r.LIVE_EMBED_ATTRIBUTE="data-tf-live",r.SLIDER_POSITION="right",r.SLIDER_WIDTH=800,r.POPUP_SIZE=100,r.DEFAULT_DOMAIN="form.typeform.com"},7528:function(n,r,i){var s=this&&this.__assign||function(){return s=Object.assign||function(h){for(var f,p=1,m=arguments.length;p<m;p++)for(var g in f=arguments[p])Object.prototype.hasOwnProperty.call(f,g)&&(h[g]=f[g]);return h},s.apply(this,arguments)},o=this&&this.__rest||function(h,f){var p={};for(var m in h)Object.prototype.hasOwnProperty.call(h,m)&&f.indexOf(m)<0&&(p[m]=h[m]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function"){var g=0;for(m=Object.getOwnPropertySymbols(h);g<m.length;g++)f.indexOf(m[g])<0&&Object.prototype.propertyIsEnumerable.call(h,m[g])&&(p[m[g]]=h[m[g]])}return p};Object.defineProperty(r,"__esModule",{value:!0}),r.createPopover=void 0;var a=i(6797),u=i(1320),c=function(h,f){var p=h.parentNode;p&&(p.removeChild(h),p.appendChild(f))},l=function(h,f){h===void 0&&(h="span"),f===void 0&&(f="tf-v1-popover-button-icon");var p=document.createElement(h);return p.className="".concat(f," tf-v1-close-icon"),p.innerHTML="&times;",p.dataset.testid=f,p},d={buttonColor:"#3a7685"};r.createPopover=function(h,f){f===void 0&&(f={});var p,m,g,_=s(s({},d),f),y=_.domain,v=o(_,["domain"]),S=(0,a.createIframe)("popover",{formId:h,domain:y,options:v}),F=S.iframe,x=S.embedId,M=S.refresh,P=S.focus,K=function(Te,Ne){var tt=document.createElement("div");return tt.className="tf-v1-popover",tt.dataset.testid="tf-v1-popover",(0,a.setElementSize)(tt,{width:Te,height:Ne})}(v.width,v.height),he=function(){var Te=document.createElement("div");return Te.className="tf-v1-popover-wrapper",Te.dataset.testid="tf-v1-popover-wrapper",Te}(),Pe=function(Te,Ne){var tt=(0,a.getTextColor)(Ne),gt=document.createElement("div");gt.className="tf-v1-popover-button-icon";var In=`<svg class="default" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M21 0H0V9L10.5743 24V16.5H21C22.6567 16.5 24 15.1567 24 13.5V3C24 1.34325 22.6567 0 21 0ZM7.5
    9.75C6.672 9.75 6 9.07875 6 8.25C6 7.42125 6.672 6.75 7.5 6.75C8.328 6.75 9 7.42125 9 8.25C9 9.07875 8.328 9.75
    7.5 9.75ZM12.75 9.75C11.922 9.75 11.25 9.07875 11.25 8.25C11.25 7.42125 11.922 6.75 12.75 6.75C13.578 6.75 14.25
    7.42125 14.25 8.25C14.25 9.07875 13.578 9.75 12.75 9.75ZM18 9.75C17.172 9.75 16.5 9.07875 16.5 8.25C16.5 7.42125
    17.172 6.75 18 6.75C18.828 6.75 19.5 7.42125 19.5 8.25C19.5 9.07875 18.828 9.75 18 9.75Z" fill="`.concat(tt,`"></path>
  </svg>`),hc=Te?.startsWith("http");return gt.innerHTML=hc?"<img alt='popover trigger icon button' src='".concat(Te,"'/>"):Te??In,gt.dataset.testid="default-icon",gt}(v.customIcon,v.buttonColor||d.buttonColor),Ce=function(){var Te=document.createElement("div");Te.className="tf-v1-spinner";var Ne=document.createElement("div");return Ne.className="tf-v1-popover-button-icon",Ne.dataset.testid="spinner-icon",Ne.append(Te),Ne}(),fe=l(),ce=l("button","tf-v1-popover-close"),le=function(Te,Ne){Ne===void 0&&(Ne={});var tt=(0,a.getTextColor)(Te),gt=document.createElement("button");return gt.className="tf-v1-popover-button",gt.dataset.testid="tf-v1-popover-button",gt.style.backgroundColor=Te,gt.style.color=tt,(0,a.addAttributesToElement)(gt,Ne),gt}(v.buttonColor||d.buttonColor,v.buttonProps);(v.container||document.body).append(K),he.append(F),K.append(le),K.append(ce),le.append(Pe);var Ae=function(){m&&m.parentNode&&(m.classList.add("closing"),setTimeout(function(){(0,a.unmountElement)(m)},250))};v.tooltip&&v.tooltip.length>0&&(m=function(Te,Ne){var tt=document.createElement("span");tt.className="tf-v1-popover-tooltip-close",tt.dataset.testid="tf-v1-popover-tooltip-close",tt.innerHTML="&times;",tt.onclick=Ne;var gt=document.createElement("div");gt.className="tf-v1-popover-tooltip-text",gt.innerHTML=Te;var In=document.createElement("div");return In.className="tf-v1-popover-tooltip",In.dataset.testid="tf-v1-popover-tooltip",In.appendChild(gt),In.appendChild(tt),In}(v.tooltip,Ae),K.append(m)),v.notificationDays&&(v.enableSandbox||(0,u.canBuildNotificationDot)(h))&&(g=(0,u.buildNotificationDot)(),le.append(g)),F.onload=function(){K.classList.add("open"),he.style.opacity="1",ce.style.opacity="1",c(Ce,fe),(0,a.addCustomKeyboardListener)(qe)};var Z=function(){(0,a.isOpen)(he)||(Ae(),g&&(g.classList.add("closing"),v.notificationDays&&!v.enableSandbox&&(0,u.saveNotificationDotHideUntilTime)(h,v.notificationDays),setTimeout(function(){(0,a.unmountElement)(g)},250)),setTimeout(function(){(0,a.isInPage)(he)?(he.style.opacity="0",ce.style.opacity="0",he.style.display="flex",setTimeout(function(){K.classList.add("open"),he.style.opacity="1",ce.style.opacity="1"}),c(Pe,fe)):(K.append(he),c(Pe,Ce),he.style.opacity="0",ce.style.opacity="0")}))},qe=function(){var Te;(0,a.isOpen)(K)&&((0,a.handlePreventReopenOnClose)(v,h),(Te=f.onClose)===null||Te===void 0||Te.call(f),setTimeout(function(){v.keepSession?he.style.display="none":(0,a.unmountElement)(he),K.classList.remove("open"),c(fe,Pe)},250))};(0,a.setAutoClose)(x,v.autoClose,qe);var lt=function(){(0,a.isOpen)(he)?qe():Z()};return le.onclick=(0,a.invokeWithoutDefault)(lt),ce.onclick=(0,a.invokeWithoutDefault)(qe),v.open&&!(0,a.isOpen)(he)&&(p=(0,a.handleCustomOpen)(Z,v,h)),{open:Z,close:qe,toggle:lt,refresh:M,focus:P,unmount:function(){(0,a.unmountElement)(K),v.open&&p?.remove&&p.remove()}}}},1797:function(n,r,i){var s=this&&this.__createBinding||(Object.create?function(a,u,c,l){l===void 0&&(l=c);var d=Object.getOwnPropertyDescriptor(u,c);d&&!("get"in d?!u.__esModule:d.writable||d.configurable)||(d={enumerable:!0,get:function(){return u[c]}}),Object.defineProperty(a,l,d)}:function(a,u,c,l){l===void 0&&(l=c),a[l]=u[c]}),o=this&&this.__exportStar||function(a,u){for(var c in a)c==="default"||Object.prototype.hasOwnProperty.call(u,c)||s(u,a,c)};Object.defineProperty(r,"__esModule",{value:!0}),o(i(7528),r),o(i(6100),r)},1320:function(n,r){var i=this&&this.__assign||function(){return i=Object.assign||function(u){for(var c,l=1,d=arguments.length;l<d;l++)for(var h in c=arguments[l])Object.prototype.hasOwnProperty.call(c,h)&&(u[h]=c[h]);return u},i.apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0}),r.buildNotificationDot=r.canBuildNotificationDot=r.saveNotificationDotHideUntilTime=void 0;var s="tfNotificationData",o=function(){var u=localStorage.getItem(s);return u?JSON.parse(u):{}},a=function(u){u&&localStorage.setItem(s,JSON.stringify(u))};r.saveNotificationDotHideUntilTime=function(u,c){var l,d=new Date;d.setDate(d.getDate()+c),a(i(i({},o()),((l={})[u]={hideUntilTime:d.getTime()},l)))},r.canBuildNotificationDot=function(u){var c=function(l){var d;return((d=o()[l])===null||d===void 0?void 0:d.hideUntilTime)||0}(u);return new Date().getTime()>c&&(c&&function(l){var d=o();delete d[l],a(d)}(u),!0)},r.buildNotificationDot=function(){var u=document.createElement("span");return u.className="tf-v1-popover-unread-dot",u.dataset.testid="tf-v1-popover-unread-dot",u}},6100:function(n,r){Object.defineProperty(r,"__esModule",{value:!0})},9630:function(n,r,i){var s=this&&this.__rest||function(c,l){var d={};for(var h in c)Object.prototype.hasOwnProperty.call(c,h)&&l.indexOf(h)<0&&(d[h]=c[h]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function"){var f=0;for(h=Object.getOwnPropertySymbols(c);f<h.length;f++)l.indexOf(h[f])<0&&Object.prototype.propertyIsEnumerable.call(c,h[f])&&(d[h[f]]=c[h[f]])}return d};Object.defineProperty(r,"__esModule",{value:!0}),r.createPopup=void 0;var o=i(6797),a=i(8027),u=i(6797);r.createPopup=function(c,l){if(l===void 0&&(l={}),!(0,o.hasDom)())return{open:function(){},close:function(){},toggle:function(){},refresh:function(){},focus:function(){},unmount:function(){}};var d,h=l.width,f=l.height,p=l.size,m=p===void 0?a.POPUP_SIZE:p,g=l.onClose,_=l.domain,y=s(l,["width","height","size","onClose","domain"]),v=(0,o.createIframe)("popup",{formId:c,domain:_,options:y}),S=v.iframe,F=v.embedId,x=v.refresh,M=v.focus,P=document.body.style.overflow,K=function(){var Ae=document.createElement("div");return Ae.className="tf-v1-popup",Ae.dataset.testid="tf-v1-popup",Ae.style.opacity="0",Ae}(),he=function(){var Ae=document.createElement("div");return Ae.className="tf-v1-spinner",Ae}(),Pe=function(Ae,Z,qe){var lt=document.createElement("div");return lt.className="tf-v1-iframe-wrapper",lt.style.opacity="0",(0,o.isDefined)(Ae)&&(0,o.isDefined)(Z)?(0,o.setElementSize)(lt,{width:Ae,height:Z}):(lt.style.width="calc(".concat(qe,"% - 80px)"),lt.style.height="calc(".concat(qe,"% - 80px)"),lt)}(h,f,m);Pe.append(S),K.append(he),K.append(Pe);var Ce=y.container||document.body;S.onload=function(){Pe.style.opacity="1",setTimeout(function(){he.style.display="none"},250),(0,o.addCustomKeyboardListener)(ce)};var fe=function(){(0,u.isOpen)(K)||((0,u.isInPage)(K)?K.style.display="flex":(he.style.display="block",Ce.append(K)),document.body.style.overflow="hidden",setTimeout(function(){K.style.opacity="1"}))},ce=function(){(0,u.isOpen)(K)&&((0,o.handlePreventReopenOnClose)(y,c),g?.(),K.style.opacity="0",document.body.style.overflow=P,setTimeout(function(){y.keepSession?K.style.display="none":le()},250))};Pe.append(function(Ae){var Z=document.createElement("button");return Z.className="tf-v1-close tf-v1-close-icon",Z.innerHTML="&times;",Z.ariaLabel="Close",Z.onclick=(0,o.invokeWithoutDefault)(Ae),Z}(ce)),(0,o.setAutoClose)(F,y.autoClose,ce),y.open&&!(0,u.isOpen)(K)&&(d=(0,o.handleCustomOpen)(fe,y,c));var le=function(){(0,o.unmountElement)(K),y.open&&d?.remove&&d.remove()};return{open:fe,close:ce,toggle:function(){(0,u.isOpen)(K)?ce():fe()},refresh:x,focus:M,unmount:le}}},5970:function(n,r,i){var s=this&&this.__createBinding||(Object.create?function(a,u,c,l){l===void 0&&(l=c);var d=Object.getOwnPropertyDescriptor(u,c);d&&!("get"in d?!u.__esModule:d.writable||d.configurable)||(d={enumerable:!0,get:function(){return u[c]}}),Object.defineProperty(a,l,d)}:function(a,u,c,l){l===void 0&&(l=c),a[l]=u[c]}),o=this&&this.__exportStar||function(a,u){for(var c in a)c==="default"||Object.prototype.hasOwnProperty.call(u,c)||s(u,a,c)};Object.defineProperty(r,"__esModule",{value:!0}),o(i(9630),r),o(i(7394),r)},7394:function(n,r){Object.defineProperty(r,"__esModule",{value:!0})},382:function(n,r,i){var s=this&&this.__assign||function(){return s=Object.assign||function(d){for(var h,f=1,p=arguments.length;f<p;f++)for(var m in h=arguments[f])Object.prototype.hasOwnProperty.call(h,m)&&(d[m]=h[m]);return d},s.apply(this,arguments)},o=this&&this.__rest||function(d,h){var f={};for(var p in d)Object.prototype.hasOwnProperty.call(d,p)&&h.indexOf(p)<0&&(f[p]=d[p]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function"){var m=0;for(p=Object.getOwnPropertySymbols(d);m<p.length;m++)h.indexOf(p[m])<0&&Object.prototype.propertyIsEnumerable.call(d,p[m])&&(f[p[m]]=d[p[m]])}return f};Object.defineProperty(r,"__esModule",{value:!0}),r.createSidetab=void 0;var a=i(6797),u={buttonColor:"#3a7685",buttonText:"Launch me"},c=function(d,h){d===void 0&&(d="div"),h===void 0&&(h="tf-v1-sidetab-button-icon");var f=document.createElement(d);return f.className="".concat(h," tf-v1-close-icon"),f.innerHTML="&times;",f.dataset.testid=h,f},l=function(d,h){var f=d.parentNode;f&&(f.removeChild(d),f.appendChild(h))};r.createSidetab=function(d,h){h===void 0&&(h={});var f,p=s(s({},u),h),m=p.domain,g=o(p,["domain"]),_=(0,a.createIframe)("side-tab",{formId:d,domain:m,options:g}),y=_.iframe,v=_.embedId,S=_.refresh,F=_.focus,x=function(Z,qe,lt,Te){var Ne=document.createElement("div");return Ne.className="tf-v1-sidetab",Ne.dataset.testid="tf-v1-sidetab",(0,a.setElementSize)(Ne,{width:Z,height:qe}),lt!==void 0?(Ne.style.top="calc(".concat((0,a.getValueWithUnits)(lt)," + ").concat((0,a.getValueWithUnits)(qe||580)," / 2)"),Ne.style.bottom="auto"):Te!==void 0&&(Ne.style.top="auto",Ne.style.bottom="calc(".concat((0,a.getValueWithUnits)(Te)," - ").concat((0,a.getValueWithUnits)(qe||580)," / 2)")),Ne}(g.width,g.height,g.top,g.bottom),M=function(){var Z=document.createElement("div");return Z.className="tf-v1-sidetab-wrapper",Z.dataset.testid="tf-v1-sidetab-wrapper",Z}(),P=function(){var Z=document.createElement("div");Z.className="tf-v1-spinner";var qe=document.createElement("div");return qe.className="tf-v1-sidetab-button-icon",qe.dataset.testid="spinner-icon",qe.append(Z),qe}(),K=function(Z){var qe=Z.backgroundColor,lt=Z.textColor,Te=Z.width,Ne=Z.height,tt=Z.align,gt=tt===void 0?"center":tt,In=Z.buttonProps,hc=In===void 0?{}:In,Cn=document.createElement("button");return Cn.className="tf-v1-sidetab-button",Cn.style.backgroundColor=qe,Cn.style.color=lt||(0,a.getTextColor)(qe),(0,a.addAttributesToElement)(Cn,hc),(0,a.setElementSize)(Cn,{width:Te,height:Ne}),Ne&&(Cn.style.left="-".concat((0,a.getValueWithUnits)(Ne))),gt==="top"?(Cn.style.transform="rotate(-90deg) translateX(-100%)",Cn.style.top="0"):gt==="bottom"&&(Cn.style.transform="rotate(-90deg) translateX(0)",Cn.style.top="auto",Cn.style.bottom="-".concat((0,a.getValueWithUnits)(Ne||48))),Cn}({backgroundColor:g.buttonColor||u.buttonColor,textColor:g.buttonTextColor,width:g.buttonHeight,height:g.buttonWidth,align:g.buttonAlign,buttonProps:g.buttonProps}),he=function(Z,qe){var lt=document.createElement("span");return lt.className="tf-v1-sidetab-button-text",lt.innerHTML=Z,qe&&(lt.style.fontSize=(0,a.getValueWithUnits)(qe)),lt}(g.buttonText||u.buttonText,g.buttonTextSize),Pe=function(Z,qe,lt,Te){var Ne=lt||(0,a.getTextColor)(qe),tt=document.createElement("div");tt.className="tf-v1-sidetab-button-icon",Te&&(tt.style.width=(0,a.getValueWithUnits)(Te),tt.style.height=(0,a.getValueWithUnits)(Te));var gt=`<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M21 0H0V9L10.5743 24V16.5H21C22.6567 16.5 24 15.1567 24 13.5V3C24 1.34325 22.6567 0 21 0ZM7.5 9.75C6.672 9.75 6 9.07875 6 8.25C6 7.42125 6.672 6.75 7.5 6.75C8.328 6.75 9 7.42125 9 8.25C9 9.07875 8.328 9.75 7.5 9.75ZM12.75 9.75C11.922 9.75 11.25 9.07875 11.25 8.25C11.25 7.42125 11.922 6.75 12.75 6.75C13.578 6.75 14.25 7.42125 14.25 8.25C14.25 9.07875 13.578 9.75 12.75 9.75ZM18 9.75C17.172 9.75 16.5 9.07875 16.5 8.25C16.5 7.42125 17.172 6.75 18 6.75C18.828 6.75 19.5 7.42125 19.5 8.25C19.5 9.07875 18.828 9.75 18 9.75Z" fill="`.concat(Ne,`"></path>
  </svg>`),In=Z?.startsWith("http");return tt.innerHTML=In?"<img alt='popover trigger icon button' src='".concat(Z,"'/>"):Z??gt,tt.dataset.testid="default-icon",tt}(g.customIcon,g.buttonColor||u.buttonColor,g.buttonTextColor,g.buttonTextSize),Ce=c(),fe=c("button","tf-v1-sidetab-close");(g.container||document.body).append(x),M.append(y),x.append(K),x.append(fe),K.append(Pe),K.append(he),setTimeout(function(){x.classList.add("ready")},250),y.onload=function(){x.classList.add("open"),l(P,Ce),(0,a.addCustomKeyboardListener)(le)};var ce=function(){(0,a.isOpen)(M)||((0,a.isInPage)(M)?(M.style.display="flex",x.classList.add("open"),l(Pe,Ce)):(x.append(M),l(Pe,P)))},le=function(){var Z;(0,a.isOpen)(M)&&((0,a.handlePreventReopenOnClose)(g,d),(Z=g.onClose)===null||Z===void 0||Z.call(g),x.classList.remove("open"),setTimeout(function(){g.keepSession?M.style.display="none":(0,a.unmountElement)(M),l(Ce,Pe)},250))};(0,a.setAutoClose)(v,g.autoClose,le);var Ae=function(){(0,a.isOpen)(M)?le():ce()};return K.onclick=(0,a.invokeWithoutDefault)(Ae),fe.onclick=(0,a.invokeWithoutDefault)(le),g.open&&!(0,a.isOpen)(M)&&(f=(0,a.handleCustomOpen)(ce,g,d)),{open:ce,close:le,toggle:Ae,refresh:S,focus:F,unmount:function(){(0,a.unmountElement)(x),g.open&&f?.remove&&f.remove()}}}},1434:function(n,r,i){var s=this&&this.__createBinding||(Object.create?function(a,u,c,l){l===void 0&&(l=c);var d=Object.getOwnPropertyDescriptor(u,c);d&&!("get"in d?!u.__esModule:d.writable||d.configurable)||(d={enumerable:!0,get:function(){return u[c]}}),Object.defineProperty(a,l,d)}:function(a,u,c,l){l===void 0&&(l=c),a[l]=u[c]}),o=this&&this.__exportStar||function(a,u){for(var c in a)c==="default"||Object.prototype.hasOwnProperty.call(u,c)||s(u,a,c)};Object.defineProperty(r,"__esModule",{value:!0}),o(i(382),r),o(i(7668),r)},7668:function(n,r){Object.defineProperty(r,"__esModule",{value:!0})},2603:function(n,r,i){var s=this&&this.__rest||function(u,c){var l={};for(var d in u)Object.prototype.hasOwnProperty.call(u,d)&&c.indexOf(d)<0&&(l[d]=u[d]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function"){var h=0;for(d=Object.getOwnPropertySymbols(u);h<d.length;h++)c.indexOf(d[h])<0&&Object.prototype.propertyIsEnumerable.call(u,d[h])&&(l[d[h]]=u[d[h]])}return l};Object.defineProperty(r,"__esModule",{value:!0}),r.createSlider=void 0;var o=i(6797),a=i(8027);r.createSlider=function(u,c){if(c===void 0&&(c={}),!(0,o.hasDom)())return{open:function(){},close:function(){},toggle:function(){},refresh:function(){},focus:function(){},unmount:function(){}};var l,d=c.position,h=d===void 0?a.SLIDER_POSITION:d,f=c.width,p=f===void 0?a.SLIDER_WIDTH:f,m=c.onClose,g=c.domain,_=s(c,["position","width","onClose","domain"]),y=(0,o.createIframe)("slider",{formId:u,domain:g,options:_}),v=y.iframe,S=y.embedId,F=y.refresh,x=y.focus,M=document.body.style.overflow,P=function(le){var Ae=document.createElement("div");return Ae.className="tf-v1-slider ".concat(le),Ae.dataset.testid="tf-v1-slider",Ae.style.opacity="0",Ae}(h),K=function(){var le=document.createElement("div");return le.className="tf-v1-spinner",le}(),he=function(le,Ae){var Z=document.createElement("div");return Z.className="tf-v1-iframe-wrapper",Z.style[le]="-100%",(0,o.setElementSize)(Z,{width:Ae})}(h,p);he.append(v),P.append(K),P.append(he);var Pe=_.container||document.body;v.onload=function(){he.style[h]="0",setTimeout(function(){K.style.display="none"},500),(0,o.addCustomKeyboardListener)(fe)};var Ce=function(){(0,o.isOpen)(P)||((0,o.isInPage)(P)?(P.style.display="flex",setTimeout(function(){he.style[h]="0"})):(Pe.append(P),K.style.display="block"),document.body.style.overflow="hidden",setTimeout(function(){P.style.opacity="1"}))},fe=function(){(0,o.isOpen)(P)&&((0,o.handlePreventReopenOnClose)(_,u),m?.(),P.style.opacity="0",he.style[h]="-100%",document.body.style.overflow=M,setTimeout(function(){_.keepSession?P.style.display="none":ce()},500))};(0,o.setAutoClose)(S,_.autoClose,fe),he.append(function(le){var Ae=document.createElement("button");return Ae.className="tf-v1-close tf-v1-close-icon",Ae.innerHTML="&times;",Ae.ariaLabel="Close",Ae.onclick=(0,o.invokeWithoutDefault)(le),Ae}(fe)),_.open&&!(0,o.isOpen)(P)&&(l=(0,o.handleCustomOpen)(Ce,_,u));var ce=function(){(0,o.unmountElement)(P),_.open&&l?.remove&&l.remove()};return{open:Ce,close:fe,toggle:function(){(0,o.isOpen)(P)?fe():Ce()},refresh:F,focus:x,unmount:ce}}},4071:function(n,r,i){var s=this&&this.__createBinding||(Object.create?function(a,u,c,l){l===void 0&&(l=c);var d=Object.getOwnPropertyDescriptor(u,c);d&&!("get"in d?!u.__esModule:d.writable||d.configurable)||(d={enumerable:!0,get:function(){return u[c]}}),Object.defineProperty(a,l,d)}:function(a,u,c,l){l===void 0&&(l=c),a[l]=u[c]}),o=this&&this.__exportStar||function(a,u){for(var c in a)c==="default"||Object.prototype.hasOwnProperty.call(u,c)||s(u,a,c)};Object.defineProperty(r,"__esModule",{value:!0}),o(i(2603),r),o(i(3162),r)},3162:function(n,r){Object.defineProperty(r,"__esModule",{value:!0})},718:function(n,r,i){var s=this&&this.__rest||function(d,h){var f={};for(var p in d)Object.prototype.hasOwnProperty.call(d,p)&&h.indexOf(p)<0&&(f[p]=d[p]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function"){var m=0;for(p=Object.getOwnPropertySymbols(d);m<p.length;m++)h.indexOf(p[m])<0&&Object.prototype.propertyIsEnumerable.call(d,p[m])&&(f[p[m]]=d[p[m]])}return f},o=this&&this.__read||function(d,h){var f=typeof Symbol=="function"&&d[Symbol.iterator];if(!f)return d;var p,m,g=f.call(d),_=[];try{for(;(h===void 0||h-- >0)&&!(p=g.next()).done;)_.push(p.value)}catch(y){m={error:y}}finally{try{p&&!p.done&&(f=g.return)&&f.call(g)}finally{if(m)throw m.error}}return _};Object.defineProperty(r,"__esModule",{value:!0}),r.createWidget=void 0;var a=i(6797),u=i(8554),c=i(2313),l=i(1126);r.createWidget=function(d,h){if(!(0,a.hasDom)())return{refresh:function(){},focus:function(){},unmount:function(){}};var f=h.domain,p=s(h,["domain"]);p.inlineOnMobile=h.inlineOnMobile||h.fullScreen,p.inlineOnMobile||!p.forceTouch&&!(0,a.isFullscreen)()||(p.displayAsFullScreenModal=!0,p.forceTouch=!0);var m=(0,a.createIframe)("widget",{formId:d,domain:f,options:p}),g=m.embedId,_=m.iframe,y=m.refresh,v=m.focus,S=(0,c.buildWidget)(_,p.width,p.height);if(p.fullScreen&&(0,l.overrideFullScreenStyles)(h.container,_),p.autoResize){var F=o(typeof p.autoResize=="string"?p.autoResize.split(",").map(function(ce){return parseInt(ce)}):[],2),x=F[0],M=F[1];window.addEventListener("message",(0,u.getFormHeightChangedHandler)(g,function(ce){var le=Math.max(ce.height,x||0);M&&(le=Math.min(le,M)),h.container.style.height="".concat(le,"px")}))}p.autoFocus&&window.addEventListener("message",(0,u.getFormReadyHandler)(g,function(){setTimeout(function(){v()},1e3)}));var P,K=function(){return h.container.append(S)};if(h.container.innerHTML="",h.lazy?(0,a.lazyInitialize)(h.container,K):K(),p.displayAsFullScreenModal){var he="",Pe=h.container,Ce=Pe.style.height;window.addEventListener("message",(0,u.getWelcomeScreenHiddenHandler)(g,function(){Pe.classList.add("tf-v1-widget-fullscreen"),h.opacity!==void 0&&(Pe.style.backgroundColor=he)})),window.addEventListener("message",(0,u.getFormThemeHandler)(g,function(ce){var le;he=(0,a.changeColorOpacity)((le=ce?.theme)===null||le===void 0?void 0:le.backgroundColor)}));var fe=((P=document.createElement("button")).className="tf-v1-widget-close tf-v1-close-icon",P.innerHTML="&times;",P.ariaLabel="Close",P);fe.onclick=(0,a.invokeWithoutDefault)(function(){var ce;if(Pe.style.height=Ce,(ce=h.onClose)===null||ce===void 0||ce.call(h),Pe.classList.remove("tf-v1-widget-fullscreen"),Pe.style.backgroundColor="",h.keepSession){var le=document.createElement("div");le.className="tf-v1-widget-iframe-overlay",le.onclick=function(){Pe.classList.add("tf-v1-widget-fullscreen"),(0,a.unmountElement)(le)},S.append(le)}else h.container.innerHTML="",K(),Pe.append(fe)}),Pe.append(fe)}return{refresh:y,focus:v,unmount:function(){(0,a.unmountElement)(S)}}}},1419:function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.buildWidget=void 0;var s=i(6797);r.buildWidget=function(o,a,u){var c=document.createElement("div");return c.className="tf-v1-widget",c.dataset.testid="tf-v1-widget",c.append(o),(0,s.setElementSize)(c,{width:a,height:u})}},2313:function(n,r,i){var s=this&&this.__createBinding||(Object.create?function(a,u,c,l){l===void 0&&(l=c);var d=Object.getOwnPropertyDescriptor(u,c);d&&!("get"in d?!u.__esModule:d.writable||d.configurable)||(d={enumerable:!0,get:function(){return u[c]}}),Object.defineProperty(a,l,d)}:function(a,u,c,l){l===void 0&&(l=c),a[l]=u[c]}),o=this&&this.__exportStar||function(a,u){for(var c in a)c==="default"||Object.prototype.hasOwnProperty.call(u,c)||s(u,a,c)};Object.defineProperty(r,"__esModule",{value:!0}),o(i(1419),r)},1126:function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.overrideFullScreenStyles=void 0,r.overrideFullScreenStyles=function(i,s){Object.assign(i.style,{zIndex:"10001",position:"absolute",top:"0",left:"0",width:"100%",height:"100%"}),s.style.borderRadius="0",Object.assign(document.body.style,{overflow:"hidden"})}},9321:function(n,r,i){var s=this&&this.__createBinding||(Object.create?function(a,u,c,l){l===void 0&&(l=c);var d=Object.getOwnPropertyDescriptor(u,c);d&&!("get"in d?!u.__esModule:d.writable||d.configurable)||(d={enumerable:!0,get:function(){return u[c]}}),Object.defineProperty(a,l,d)}:function(a,u,c,l){l===void 0&&(l=c),a[l]=u[c]}),o=this&&this.__exportStar||function(a,u){for(var c in a)c==="default"||Object.prototype.hasOwnProperty.call(u,c)||s(u,a,c)};Object.defineProperty(r,"__esModule",{value:!0}),o(i(718),r),o(i(4058),r)},4058:function(n,r){Object.defineProperty(r,"__esModule",{value:!0})},1920:function(n,r,i){var s=this&&this.__createBinding||(Object.create?function(a,u,c,l){l===void 0&&(l=c);var d=Object.getOwnPropertyDescriptor(u,c);d&&!("get"in d?!u.__esModule:d.writable||d.configurable)||(d={enumerable:!0,get:function(){return u[c]}}),Object.defineProperty(a,l,d)}:function(a,u,c,l){l===void 0&&(l=c),a[l]=u[c]}),o=this&&this.__exportStar||function(a,u){for(var c in a)c==="default"||Object.prototype.hasOwnProperty.call(u,c)||s(u,a,c)};Object.defineProperty(r,"__esModule",{value:!0}),o(i(1797),r),o(i(5970),r),o(i(4071),r),o(i(9321),r),o(i(1434),r)},5084:function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.addAttributesToElement=void 0;var s=i(7377);r.addAttributesToElement=function(o,a){a===void 0&&(a={}),Object.keys(a).forEach(function(u){o.setAttribute((0,s.camelCaseToKebabCase)(u),a[u])})}},3626:function(n,r,i){var s=this&&this.__assign||function(){return s=Object.assign||function(f){for(var p,m=1,g=arguments.length;m<g;m++)for(var _ in p=arguments[m])Object.prototype.hasOwnProperty.call(p,_)&&(f[_]=p[_]);return f},s.apply(this,arguments)},o=this&&this.__read||function(f,p){var m=typeof Symbol=="function"&&f[Symbol.iterator];if(!m)return f;var g,_,y=m.call(f),v=[];try{for(;(p===void 0||p-- >0)&&!(g=y.next()).done;)v.push(g.value)}catch(S){_={error:S}}finally{try{g&&!g.done&&(m=y.return)&&m.call(y)}finally{if(_)throw _.error}}return v};Object.defineProperty(r,"__esModule",{value:!0}),r.buildIframeSrc=void 0;var a=i(8027),u=i(4527),c=i(2346),l=i(2698),d=i(863),h={widget:"embed-widget",popup:"popup-blank",slider:"popup-drawer",popover:"popup-popover","side-tab":"popup-side-panel"};r.buildIframeSrc=function(f){var p=f.domain,m=f.formId,g=f.type,_=f.embedId,y=f.options,v=function(x,M,P){var K=P.transitiveSearchParams,he=P.source,Pe=P.medium,Ce=P.mediumVersion,fe=P.hideFooter,ce=P.hideHeaders,le=P.opacity,Ae=P.disableTracking,Z=P.enableSandbox,qe=P.shareGaInstance,lt=P.forceTouch,Te=P.displayAsFullScreenModal,Ne=P.tracking,tt=P.redirectTarget,gt=P.autoResize,In=P.disableScroll,hc=P.onEndingButtonClick,Cn=P.noHeading,F2=P.noScrollbars,L2=(0,l.getTransitiveSearchParams)(K);return s(s(s({},{"typeform-embed-id":M,"typeform-embed":h[x],"typeform-source":he,"typeform-medium":Pe,"typeform-medium-version":Ce,"embed-hide-footer":fe?"true":void 0,"embed-hide-headers":ce?"true":void 0,"embed-opacity":le,"disable-tracking":Ae||Z?"true":void 0,"__dangerous-disable-submissions":Z?"true":void 0,"share-ga-instance":qe?"true":void 0,"force-touch":lt?"true":void 0,"add-placeholder-ws":x==="widget"&&Te?"true":void 0,"typeform-embed-redirect-target":tt,"typeform-embed-handles-redirect":1,"typeform-embed-auto-resize":gt?"true":void 0,"typeform-embed-disable-scroll":In?"true":void 0,"typeform-embed-handle-ending-button-click":hc?"true":void 0,"typeform-embed-no-heading":Cn?"true":void 0,"typeform-embed-no-scrollbars":F2?"true":void 0}),L2),Ne)}(g,_,function(x){return x.noHeading||(x.noHeading=document.querySelectorAll("h1").length>0),s(s({},{source:(M=window?.location)===null||M===void 0?void 0:M.hostname.replace(/^www\./,""),medium:"embed-sdk",mediumVersion:"next"}),(0,u.removeUndefinedKeys)(x));var M}(y)),S=function(x,M){return M===void 0&&(M=a.DEFAULT_DOMAIN),x.startsWith("http://")||x.startsWith("https://")?new URL(x):new URL("https://".concat(M,"/to/").concat(x))}(m,p);if(Object.entries(v).filter(function(x){var M=o(x,2)[1];return(0,c.isDefined)(M)}).forEach(function(x){var M=o(x,2),P=M[0],K=M[1];S.searchParams.set(P,K)}),y.hubspot){var F=(0,d.getHubspotHiddenFields)();y.hidden=s(s({},y.hidden),F)}return S.hash=function(x,M){var P=new URLSearchParams;M.hidden&&Object.entries(M.hidden).filter(function(Ce){var fe=o(Ce,2)[1];return(0,c.isDefined)(fe)&&fe!==""}).forEach(function(Ce){var fe=o(Ce,2),ce=fe[0],le=fe[1];typeof M.transitiveSearchParams=="boolean"&&x.searchParams.delete(ce),P.set(ce,le)});var K=function(Ce){if(!Ce)return null;var fe=Object.keys(Ce).at(0),ce=fe&&Ce[fe]||void 0;return fe===void 0||ce===void 0?null:{key:"answers-".concat(fe),value:ce}}(M.preselect);if(K){var he=K.key,Pe=K.value;P.set(he,Pe)}return P.toString()}(S,y),S.href}},2391:function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.changeColorOpacity=void 0,r.changeColorOpacity=function(i,s){return i===void 0&&(i=""),s===void 0&&(s=255),i.startsWith("rgba(")?i?.replace(/, [\d.]+\)$/,", ".concat(s,")")):i}},8972:function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.handleCustomOpen=r.handlePreventReopenOnClose=void 0;var i={remove:function(){}};r.handlePreventReopenOnClose=function(a,u){a.preventReopenOnClose&&o(u)},r.handleCustomOpen=function(a,u,c){var l=u.open,d=u.openValue,h=u.preventReopenOnClose,f=function(p,m,g,_){return function(){var y,v;if(!(_&&s(m)||g==="all"&&(v=document.querySelector(".tf-v1-popup, .tf-v1-slider, .tf-v1-popover-wrapper, .tf-v1-sidetab-wrapper"),v?.offsetHeight||v?.offsetWidth||((y=v?.getClientRects())===null||y===void 0?void 0:y.length))||g==="same"&&function(S){var F=document.querySelectorAll(".tf-v1-popup, .tf-v1-slider, .tf-v1-popover-wrapper, .tf-v1-sidetab-wrapper");return Array.from(F).some(function(x){var M,P=(M=x.querySelector("iframe"))===null||M===void 0?void 0:M.src;return P?.includes("typeform.com/to/".concat(S))||P?.startsWith(S)})}(m)))return p()}}(a,c,u.respectOpenModals,h);switch(l){case"load":return f(),i;case"exit":return d?function(p,m){var g=0,_=function(y){y.clientY<p&&y.clientY<g?(document.removeEventListener("mousemove",_,!0),m()):g=y.clientY};return document.addEventListener("mousemove",_,!0),{remove:function(){return document.removeEventListener("mousemove",_,!0)}}}(d,f):i;case"time":return setTimeout(function(){f()},d),i;case"scroll":return d?function(p,m){function g(){var _=window.pageYOffset||document.documentElement.scrollTop,y=document.documentElement.clientTop||0,v=document.documentElement.scrollHeight,S=_-y,F=S/v*100,x=S+window.innerHeight>=v;(F>=p||x)&&(m(),document.removeEventListener("scroll",g))}return document.addEventListener("scroll",g),{remove:function(){return document.removeEventListener("scroll",g)}}}(d,f):i;default:return i}};var s=function(a){return document.cookie.includes("tf-".concat(a,"-closed=true"))},o=function(a){document.cookie="tf-".concat(a,"-closed=true;Path=/")}},1553:function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.createIframe=void 0;var s=i(3626),o=i(6797),a=i(8866),u=i(8554),c=i(2256),l=i(7144),d=i(5511);r.createIframe=function(h,f){var p=f.formId,m=f.domain,g=f.options,_=(0,a.generateEmbedId)(),y=g.iframeProps,v=y===void 0?{}:y,S=g.onReady,F=g.onStarted,x=g.onQuestionChanged,M=g.onHeightChanged,P=g.onSubmit,K=g.onEndingButtonClick,he=g.shareGaInstance,Pe=(0,s.buildIframeSrc)({formId:p,domain:m,embedId:_,type:h,options:g}),Ce=document.createElement("iframe");return Ce.src=Pe,Ce.dataset.testid="iframe",Ce.style.border="0px",Ce.allow="microphone; camera",(0,o.addAttributesToElement)(Ce,v),Ce.addEventListener("load",c.triggerIframeRedraw,{once:!0}),window.addEventListener("message",(0,u.getFormReadyHandler)(_,S)),window.addEventListener("message",(0,u.getFormStartedHandler)(_,F)),window.addEventListener("message",(0,u.getFormQuestionChangedHandler)(_,x)),window.addEventListener("message",(0,u.getFormHeightChangedHandler)(_,M)),window.addEventListener("message",(0,u.getFormSubmitHandler)(_,P)),window.addEventListener("message",(0,u.getFormThemeHandler)(_,function(fe){var ce;if(fe?.theme){var le=document.querySelector(".tf-v1-close-icon");le&&(le.style.color=(ce=fe.theme)===null||ce===void 0?void 0:ce.color)}})),window.addEventListener("message",(0,u.getThankYouScreenButtonClickHandler)(_,K)),window.addEventListener("message",(0,u.getRedirectHandler)(_,Ce)),h!=="widget"&&window.addEventListener("message",l.dispatchCustomKeyEventFromIframe),he&&window.addEventListener("message",(0,u.getFormReadyHandler)(_,function(){(0,o.setupGaInstance)(Ce,_,he)})),{iframe:Ce,embedId:_,refresh:function(){return(0,d.refreshIframe)(Ce)},focus:function(){var fe;(fe=Ce.contentWindow)===null||fe===void 0||fe.postMessage("embed-focus","*")}}}},8866:function(n,r){var i=this&&this.__read||function(s,o){var a=typeof Symbol=="function"&&s[Symbol.iterator];if(!a)return s;var u,c,l=a.call(s),d=[];try{for(;(o===void 0||o-- >0)&&!(u=l.next()).done;)d.push(u.value)}catch(h){c={error:h}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(c)throw c.error}}return d};Object.defineProperty(r,"__esModule",{value:!0}),r.generateEmbedId=void 0,r.generateEmbedId=function(){var s=Math.random();return i(String(s).split("."),2)[1]}},8554:function(n,r,i){var s=this&&this.__rest||function(c,l){var d={};for(var h in c)Object.prototype.hasOwnProperty.call(c,h)&&l.indexOf(h)<0&&(d[h]=c[h]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function"){var f=0;for(h=Object.getOwnPropertySymbols(c);f<h.length;f++)l.indexOf(h[f])<0&&Object.prototype.propertyIsEnumerable.call(c,h[f])&&(d[h[f]]=c[h[f]])}return d};Object.defineProperty(r,"__esModule",{value:!0}),r.getRedirectHandler=r.getThankYouScreenButtonClickHandler=r.getFormThemeHandler=r.getWelcomeScreenHiddenHandler=r.getFormSubmitHandler=r.getFormHeightChangedHandler=r.getFormQuestionChangedHandler=r.getFormStartedHandler=r.getFormReadyHandler=void 0;var o=i(8743);r.getFormReadyHandler=function(c,l){return u("form-ready",c,l)},r.getFormStartedHandler=function(c,l){return u("form-started",c,l)},r.getFormQuestionChangedHandler=function(c,l){return u("form-screen-changed",c,l)},r.getFormHeightChangedHandler=function(c,l){return u("form-height-changed",c,l)},r.getFormSubmitHandler=function(c,l){return u("form-submit",c,l)},r.getWelcomeScreenHiddenHandler=function(c,l){return u("welcome-screen-hidden",c,l)},r.getFormThemeHandler=function(c,l){return u("form-theme",c,l)},r.getThankYouScreenButtonClickHandler=function(c,l){return u("thank-you-screen-button-click",c,l)},r.getRedirectHandler=function(c,l){return u(["redirect-after-submit","thank-you-screen-redirect"],c,(0,o.handleFormRedirect)(l))};var a=function(c,l){return Array.isArray(c)?c.includes(l):c===l};function u(c,l,d){return function(h){var f=h.data,p=f.type,m=f.embedId,g=s(f,["type","embedId"]);a(c,p)&&m===l&&d?.(g)}}},8743:function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.handleFormRedirect=void 0,r.handleFormRedirect=function(i){return function(s){var o,a,u=s.url,c=s.target;if(u)switch(c===void 0?"_parent":c){case"_self":i.src=(o=i.src,(a=u).includes("#")&&a.startsWith("".concat(o,"#"))?a.includes("?")?a.replace("#","&tf-embed-ts=".concat(Date.now(),"#")):a.replace("#","?tf-embed-ts=".concat(Date.now(),"#")):a);break;case"_blank":window.open(u,"_blank");break;case"_top":var l=document.createElement("a");l.href=u,l.target="_top",document.body.appendChild(l),l.click(),document.body.removeChild(l);break;default:window.location.href=u}else console.error("Redirect failed, no URL provided")}}},339:function(n,r,i){var s=this&&this.__createBinding||(Object.create?function(a,u,c,l){l===void 0&&(l=c);var d=Object.getOwnPropertyDescriptor(u,c);d&&!("get"in d?!u.__esModule:d.writable||d.configurable)||(d={enumerable:!0,get:function(){return u[c]}}),Object.defineProperty(a,l,d)}:function(a,u,c,l){l===void 0&&(l=c),a[l]=u[c]}),o=this&&this.__exportStar||function(a,u){for(var c in a)c==="default"||Object.prototype.hasOwnProperty.call(u,c)||s(u,a,c)};Object.defineProperty(r,"__esModule",{value:!0}),o(i(1553),r),o(i(7144),r)},5511:function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.refreshIframe=void 0,r.refreshIframe=function(i){if(i){var s=i.src;if(s.includes("&refresh")){var o=s.split("&refresh#");i.src=o.join("#")}else(o=s.split("#"))[0]="".concat(o[0],"&refresh"),i.src=o.join("#")}}},7144:function(n,r){var i=this&&this.__awaiter||function(u,c,l,d){return new(l||(l=Promise))(function(h,f){function p(_){try{g(d.next(_))}catch(y){f(y)}}function m(_){try{g(d.throw(_))}catch(y){f(y)}}function g(_){var y;_.done?h(_.value):(y=_.value,y instanceof l?y:new l(function(v){v(y)})).then(p,m)}g((d=d.apply(u,c||[])).next())})},s=this&&this.__generator||function(u,c){var l,d,h,f,p={label:0,sent:function(){if(1&h[0])throw h[1];return h[1]},trys:[],ops:[]};return f={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function m(g){return function(_){return function(y){if(l)throw new TypeError("Generator is already executing.");for(;f&&(f=0,y[0]&&(p=0)),p;)try{if(l=1,d&&(h=2&y[0]?d.return:y[0]?d.throw||((h=d.return)&&h.call(d),0):d.next)&&!(h=h.call(d,y[1])).done)return h;switch(d=0,h&&(y=[2&y[0],h.value]),y[0]){case 0:case 1:h=y;break;case 4:return p.label++,{value:y[1],done:!1};case 5:p.label++,d=y[1],y=[0];continue;case 7:y=p.ops.pop(),p.trys.pop();continue;default:if(!((h=(h=p.trys).length>0&&h[h.length-1])||y[0]!==6&&y[0]!==2)){p=0;continue}if(y[0]===3&&(!h||y[1]>h[0]&&y[1]<h[3])){p.label=y[1];break}if(y[0]===6&&p.label<h[1]){p.label=h[1],h=y;break}if(h&&p.label<h[2]){p.label=h[2],p.ops.push(y);break}h[2]&&p.ops.pop(),p.trys.pop();continue}y=c.call(u,p)}catch(v){y=[6,v],d=0}finally{l=h=0}if(5&y[0])throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}([g,_])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.dispatchCustomKeyEventFromIframe=r.removeCustomKeyboardListener=r.addCustomKeyboardListener=void 0;var o="Escape",a=function(u,c){return i(void 0,void 0,void 0,function(){return s(this,function(l){return u.code===o&&typeof c=="function"&&(c(),(0,r.removeCustomKeyboardListener)()),[2]})})};r.addCustomKeyboardListener=function(u){return window.document.addEventListener("keydown",function(c){return a(c,u)})},r.removeCustomKeyboardListener=function(){return window.document.removeEventListener("keydown",a)},r.dispatchCustomKeyEventFromIframe=function(u){u.data.type==="form-close"&&window.document.dispatchEvent(new KeyboardEvent("keydown",{code:o}))}},2256:function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.triggerIframeRedraw=void 0,r.triggerIframeRedraw=function(){this.style.transform="translateZ(0)"}},8939:function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.getTextColor=void 0;var s=i(2938);r.getTextColor=function(o){if(!o)return"#FFFFFF";var a=o.startsWith("#")?(0,s.hexRgb)(o):function(d){var h={red:0,green:0,blue:0},f=d.match(/\d+/g);return f&&(h.red=parseInt(f[0],10),h.green=parseInt(f[0],10),h.blue=parseInt(f[0],10)),h}(o),u=a.red,c=a.green,l=a.blue;return Math.round((299*u+587*c+114*l)/1e3)>150?"#000000":"#FFFFFF"}},2698:function(n,r){var i=this&&this.__assign||function(){return i=Object.assign||function(s){for(var o,a=1,u=arguments.length;a<u;a++)for(var c in o=arguments[a])Object.prototype.hasOwnProperty.call(o,c)&&(s[c]=o[c]);return s},i.apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0}),r.getTransitiveSearchParams=void 0,r.getTransitiveSearchParams=function(s){var o=new URL(window.location.href);return typeof s=="boolean"&&s?Object.fromEntries(o.searchParams.entries()):Array.isArray(s)&&s.length>0?s.reduce(function(a,u){var c,l=o.searchParams.get(u);return l?i(i({},a),((c={})[u]=l,c)):a},{}):{}}},8252:function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.hasDom=void 0,r.hasDom=function(){return typeof document<"u"&&typeof window<"u"}},2938:function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.hexRgb=void 0;var i="a-f\\d",s="#?[".concat(i,"]{3}[").concat(i,"]?"),o="#?[".concat(i,"]{6}([").concat(i,"]{2})?"),a=new RegExp("[^#".concat(i,"]"),"gi"),u=new RegExp("^".concat(s,"$|^").concat(o,"$"),"i");r.hexRgb=function(c){if(typeof c!="string"||a.test(c)||!u.test(c))throw new TypeError("Expected a valid hex string");(c=c.replace(/^#/,"")).length===8&&(c=c.slice(0,6)),c.length===4&&(c=c.slice(0,3)),c.length===3&&(c=c[0]+c[0]+c[1]+c[1]+c[2]+c[2]);var l=Number.parseInt(c,16);return{red:l>>16,green:l>>8&255,blue:255&l}}},863:function(n,r,i){var s=this&&this.__awaiter||function(u,c,l,d){return new(l||(l=Promise))(function(h,f){function p(_){try{g(d.next(_))}catch(y){f(y)}}function m(_){try{g(d.throw(_))}catch(y){f(y)}}function g(_){var y;_.done?h(_.value):(y=_.value,y instanceof l?y:new l(function(v){v(y)})).then(p,m)}g((d=d.apply(u,c||[])).next())})},o=this&&this.__generator||function(u,c){var l,d,h,f,p={label:0,sent:function(){if(1&h[0])throw h[1];return h[1]},trys:[],ops:[]};return f={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function m(g){return function(_){return function(y){if(l)throw new TypeError("Generator is already executing.");for(;f&&(f=0,y[0]&&(p=0)),p;)try{if(l=1,d&&(h=2&y[0]?d.return:y[0]?d.throw||((h=d.return)&&h.call(d),0):d.next)&&!(h=h.call(d,y[1])).done)return h;switch(d=0,h&&(y=[2&y[0],h.value]),y[0]){case 0:case 1:h=y;break;case 4:return p.label++,{value:y[1],done:!1};case 5:p.label++,d=y[1],y=[0];continue;case 7:y=p.ops.pop(),p.trys.pop();continue;default:if(!((h=(h=p.trys).length>0&&h[h.length-1])||y[0]!==6&&y[0]!==2)){p=0;continue}if(y[0]===3&&(!h||y[1]>h[0]&&y[1]<h[3])){p.label=y[1];break}if(y[0]===6&&p.label<h[1]){p.label=h[1],h=y;break}if(h&&p.label<h[2]){p.label=h[2],p.ops.push(y);break}h[2]&&p.ops.pop(),p.trys.pop();continue}y=c.call(u,p)}catch(v){y=[6,v],d=0}finally{l=h=0}if(5&y[0])throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}([g,_])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.waitForHubspotCookie=r.getHubspotHiddenFields=r.getHubspotCookieValue=void 0;var a=i(4623);r.getHubspotCookieValue=function(){var u=document.cookie.match(new RegExp("(^| )".concat("hubspotutk","=([^;]+)")));return u&&u[2]||void 0},r.getHubspotHiddenFields=function(){return{hubspot_page_name:document.title,hubspot_page_url:window.location.href,hubspot_utk:(0,r.getHubspotCookieValue)()}},r.waitForHubspotCookie=function(){return s(void 0,void 0,void 0,function(){var u,c;return o(this,function(l){switch(l.label){case 0:u=10,c=0,l.label=1;case 1:return!(0,r.getHubspotCookieValue)()&&c<u?[4,(0,a.sleep)(250)]:[3,4];case 2:l.sent(),l.label=3;case 3:return c++,[3,1];case 4:return[2]}})})}},9071:function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.includeCss=void 0,r.includeCss=function(i){var s=function(a){return"".concat("https://embed.typeform.com/next/css/").concat(a)}(i);if(!document.querySelector('link[href="'.concat(s,'"]'))){var o=document.createElement("link");o.rel="stylesheet",o.href=s,document.head.append(o)}}},6797:function(n,r,i){var s=this&&this.__createBinding||(Object.create?function(a,u,c,l){l===void 0&&(l=c);var d=Object.getOwnPropertyDescriptor(u,c);d&&!("get"in d?!u.__esModule:d.writable||d.configurable)||(d={enumerable:!0,get:function(){return u[c]}}),Object.defineProperty(a,l,d)}:function(a,u,c,l){l===void 0&&(l=c),a[l]=u[c]}),o=this&&this.__exportStar||function(a,u){for(var c in a)c==="default"||Object.prototype.hasOwnProperty.call(u,c)||s(u,a,c)};Object.defineProperty(r,"__esModule",{value:!0}),o(i(3626),r),o(i(339),r),o(i(8252),r),o(i(9071),r),o(i(2346),r),o(i(7377),r),o(i(6563),r),o(i(4527),r),o(i(9533),r),o(i(1451),r),o(i(8972),r),o(i(4748),r),o(i(4392),r),o(i(8939),r),o(i(9917),r),o(i(1987),r),o(i(2391),r),o(i(863),r),o(i(6890),r),o(i(5084),r)},6890:function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.invokeWithoutDefault=void 0,r.invokeWithoutDefault=function(i){return function(s){s?.preventDefault(),i()}}},2346:function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isDefined=void 0,r.isDefined=function(i){return i!=null}},1987:function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isVisible=r.isInPage=r.isOpen=void 0,r.isOpen=function(i){return(0,r.isInPage)(i)&&(0,r.isVisible)(i)},r.isInPage=function(i){return!!i.parentNode},r.isVisible=function(i){return i.style.display!=="none"}},9917:function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.lazyInitialize=void 0,r.lazyInitialize=function(i,s){var o=new IntersectionObserver(function(a){a.forEach(function(u){u.isIntersecting&&(s(),o.unobserve(u.target))})});o.observe(i)}},7377:function(n,r){var i=this&&this.__assign||function(){return i=Object.assign||function(d){for(var h,f=1,p=arguments.length;f<p;f++)for(var m in h=arguments[f])Object.prototype.hasOwnProperty.call(h,m)&&(d[m]=h[m]);return d},i.apply(this,arguments)},s=this&&this.__read||function(d,h){var f=typeof Symbol=="function"&&d[Symbol.iterator];if(!f)return d;var p,m,g=f.call(d),_=[];try{for(;(h===void 0||h-- >0)&&!(p=g.next()).done;)_.push(p.value)}catch(y){m={error:y}}finally{try{p&&!p.done&&(f=g.return)&&f.call(g)}finally{if(m)throw m.error}}return _};Object.defineProperty(r,"__esModule",{value:!0}),r.loadOptionsFromAttributes=r.transformAttributeValue=r.camelCaseToKebabCase=void 0,r.camelCaseToKebabCase=function(d){return d.split("").map(function(h,f){return h.toUpperCase()===h?"".concat(f!==0?"-":"").concat(h.toLowerCase()):h}).join("")};var o=function(d){return d||void 0},a=function(d){if(d!==null)return d===""||d==="yes"||d==="true"},u=function(d){var h=d?parseInt(d,10):NaN;return isNaN(h)?void 0:h},c="%ESCAPED_COMMA%",l=function(d){if(d)return d.replace(/\s/g,"").replace(/\\,/g,c).split(",").filter(function(h){return!!h}).map(function(h){return h.replace(c,",")})};r.transformAttributeValue=function(d,h){var f,p,m;switch(h){case"string":return o(d);case"boolean":return a(d);case"integer":return u(d);case"function":return function(g){var _=g&&g in window?window[g]:void 0;return typeof _=="function"?_:void 0}(d);case"array":return l(d);case"record":return function(g){if(g)return g.replace(/\\,/g,c).split(",").filter(function(_){return!!_}).map(function(_){return _.replace(c,",")}).reduce(function(_,y){var v,S=y.match(/^([^=]+)=(.*)$/);if(S){var F=s(S,3),x=F[1],M=F[2];return i(i({},_),((v={})[x.trim()]=M,v))}return _},{})}(d);case"integerOrString":return function(g){if(g)return g.match(/^[0-9]+$/)?u(g):o(g)}(d);case"integerOrBoolean":return(f=u(d))!==null&&f!==void 0?f:a(d);case"stringOrBoolean":return(p=o(d))!==null&&p!==void 0?p:a(d);case"arrayOrBoolean":return(m=l(d))!==null&&m!==void 0?m:a(d);default:throw new Error("Invalid attribute transformation ".concat(h))}},r.loadOptionsFromAttributes=function(d,h){return Object.keys(h).reduce(function(f,p){var m;return i(i({},f),((m={})[p]=(0,r.transformAttributeValue)(d.getAttribute("data-tf-".concat((0,r.camelCaseToKebabCase)(p))),h[p]),m))},{})}},6563:function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isFullscreen=r.isMobile=r.isBigScreen=void 0,r.isBigScreen=function(){return window.screen.width>=1024&&window.screen.height>=768},r.isMobile=function(){return/mobile|tablet|android/i.test(navigator.userAgent.toLowerCase())},r.isFullscreen=function(){return(0,r.isMobile)()&&!(0,r.isBigScreen)()}},4527:function(n,r,i){var s=this&&this.__assign||function(){return s=Object.assign||function(u){for(var c,l=1,d=arguments.length;l<d;l++)for(var h in c=arguments[l])Object.prototype.hasOwnProperty.call(c,h)&&(u[h]=c[h]);return u},s.apply(this,arguments)},o=this&&this.__read||function(u,c){var l=typeof Symbol=="function"&&u[Symbol.iterator];if(!l)return u;var d,h,f=l.call(u),p=[];try{for(;(c===void 0||c-- >0)&&!(d=f.next()).done;)p.push(d.value)}catch(m){h={error:m}}finally{try{d&&!d.done&&(l=f.return)&&l.call(f)}finally{if(h)throw h.error}}return p};Object.defineProperty(r,"__esModule",{value:!0}),r.removeUndefinedKeys=void 0;var a=i(2346);r.removeUndefinedKeys=function(u){return Object.entries(u).filter(function(c){var l=o(c,2)[1];return(0,a.isDefined)(l)}).reduce(function(c,l){var d,h=o(l,2),f=h[0],p=h[1];return s(s({},c),((d={})[f]=p,d))},{})}},4748:function(n,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.setAutoClose=r.DEFAULT_AUTO_CLOSE_TIME=void 0;var s=i(8554);r.DEFAULT_AUTO_CLOSE_TIME=500,r.setAutoClose=function(o,a,u){a&&u&&window.addEventListener("message",(0,s.getFormSubmitHandler)(o,function(){return setTimeout(u,(l=typeof(c=a)=="number"?c:0,Math.max(l,r.DEFAULT_AUTO_CLOSE_TIME)));var c,l}))}},9533:function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.setElementSize=r.getValueWithUnits=void 0,r.getValueWithUnits=function(i){return typeof i!="string"||i.match(/^[0-9]+$/)?"".concat(i,"px"):i},r.setElementSize=function(i,s){var o=s.width,a=s.height;return o&&(i.style.width=(0,r.getValueWithUnits)(o)),a&&(i.style.height=(0,r.getValueWithUnits)(a)),i}},4392:function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.setupGaInstance=r.sendGaIdMessage=void 0,r.sendGaIdMessage=function(o,a,u){var c={embedId:o,gaClientId:a};setTimeout(function(){u&&u.contentWindow&&u.contentWindow.postMessage({type:"ga-client-id",data:c},"*")},0)};var i=function(o){console.error(o)},s=function(o){i("Whoops! You enabled the shareGaInstance feature in your typeform embed but ".concat(o,`.

`)+`Make sure to include Google Analytics Javascript code before the Typeform Embed Javascript code in your page and use correct tracker ID.

It is also possible the Google Analytics was blocked by your adblock plugin.`)};r.setupGaInstance=function(o,a,u){var c=typeof u=="string"?u:void 0;if(window.gtag){if(c||(c=function(){if(window.dataLayer){var h=window.dataLayer.find(function(f){return f.length>1&&f[0]==="config"});return h&&h[1]}}()),!c)return void s("the tracking ID could not be retrieved");var l=!1;window.gtag("get",c,"client_id",function(h){l=!0,(0,r.sendGaIdMessage)(a,h,o)}),setTimeout(function(){l||s("the tracker with ID ".concat(c," was not found"))},3e3)}else try{var d=function(h,f){return f?h.find(function(p){return p.get("trackingId")===f}):h[0]}(window.ga.getAll(),c);d?(0,r.sendGaIdMessage)(a,d.get("clientId"),o):s("the tracker with ID ".concat(c," was not found"))}catch(h){s("the Google Analytics object was not found"),i(h)}}},4623:function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.sleep=void 0,r.sleep=function(i){return new Promise(function(s){return setTimeout(s,i)})}},1451:function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.unmountElement=void 0,r.unmountElement=function(i){var s;(s=i.parentNode)===null||s===void 0||s.removeChild(i)}}},e={};return function n(r){var i=e[r];if(i!==void 0)return i.exports;var s=e[r]={exports:{}};return t[r].call(s.exports,s,s.exports,n),s.exports}(1920)}()})});var YD=null;var o_=1;function qt(t){let e=YD;return YD=t,e}var ZD={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function U2(t){if(!(c_(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===o_)){if(!t.producerMustRecompute(t)&&!a_(t)){t.dirty=!1,t.lastCleanEpoch=o_;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=o_}}function XD(t){return t&&(t.nextProducerIndex=0),qt(t)}function JD(t,e){if(qt(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(c_(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)u_(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function a_(t){Lh(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(U2(n),r!==n.version))return!0}return!1}function eS(t){if(Lh(t),c_(t))for(let e=0;e<t.producerNode.length;e++)u_(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function u_(t,e){if(B2(t),Lh(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)u_(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];Lh(i),i.producerIndexOfThis[r]=e}}function c_(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function Lh(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function B2(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function $2(){throw new Error}var H2=$2;function tS(t){H2=t}function te(t){return typeof t=="function"}function ra(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Vh=ra(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function Ls(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var bt=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(te(r))try{r()}catch(s){e=s instanceof Vh?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{nS(s)}catch(o){e=e??[],o instanceof Vh?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Vh(e)}}add(e){var n;if(e&&e!==this)if(this.closed)nS(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&Ls(n,e)}remove(e){let{_finalizers:n}=this;n&&Ls(n,e),e instanceof t&&e._removeParent(this)}};bt.EMPTY=(()=>{let t=new bt;return t.closed=!0,t})();var l_=bt.EMPTY;function jh(t){return t instanceof bt||t&&"closed"in t&&te(t.remove)&&te(t.add)&&te(t.unsubscribe)}function nS(t){te(t)?t():t.unsubscribe()}var ur={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var ia={setTimeout(t,e,...n){let{delegate:r}=ia;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=ia;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Uh(t){ia.setTimeout(()=>{let{onUnhandledError:e}=ur;if(e)e(t);else throw t})}function Vs(){}var rS=(()=>d_("C",void 0,void 0))();function iS(t){return d_("E",void 0,t)}function sS(t){return d_("N",t,void 0)}function d_(t,e,n){return{kind:t,value:e,error:n}}var js=null;function sa(t){if(ur.useDeprecatedSynchronousErrorHandling){let e=!js;if(e&&(js={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=js;if(js=null,n)throw r}}else t()}function oS(t){ur.useDeprecatedSynchronousErrorHandling&&js&&(js.errorThrown=!0,js.error=t)}var Us=class extends bt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,jh(e)&&e.add(this)):this.destination=z2}static create(e,n,r){return new di(e,n,r)}next(e){this.isStopped?f_(sS(e),this):this._next(e)}error(e){this.isStopped?f_(iS(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?f_(rS,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},q2=Function.prototype.bind;function h_(t,e){return q2.call(t,e)}var p_=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){Bh(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){Bh(r)}else Bh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){Bh(n)}}},di=class extends Us{constructor(e,n,r){super();let i;if(te(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&ur.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&h_(e.next,s),error:e.error&&h_(e.error,s),complete:e.complete&&h_(e.complete,s)}):i=e}this.destination=new p_(i)}};function Bh(t){ur.useDeprecatedSynchronousErrorHandling?oS(t):Uh(t)}function G2(t){throw t}function f_(t,e){let{onStoppedNotification:n}=ur;n&&ia.setTimeout(()=>n(t,e))}var z2={closed:!0,next:Vs,error:G2,complete:Vs};var oa=(()=>typeof Symbol=="function"&&Symbol.observable||"@@observable")();function Gt(t){return t}function g_(...t){return m_(t)}function m_(t){return t.length===0?Gt:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var se=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=K2(n)?n:new di(n,r,i);return sa(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=aS(r),new r((i,s)=>{let o=new di({next:a=>{try{n(a)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[oa](){return this}pipe(...n){return m_(n)(this)}toPromise(n){return n=aS(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function aS(t){var e;return(e=t??ur.Promise)!==null&&e!==void 0?e:Promise}function W2(t){return t&&te(t.next)&&te(t.error)&&te(t.complete)}function K2(t){return t&&t instanceof Us||W2(t)&&jh(t)}function y_(t){return te(t?.lift)}function ee(t){return e=>{if(y_(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function X(t,e,n,r,i){return new __(t,e,n,r,i)}var __=class extends Us{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function aa(){return ee((t,e)=>{let n=null;t._refCount++;let r=X(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var ua=class extends se{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,y_(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new bt;let n=this.getSubject();e.add(this.source.subscribe(X(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=bt.EMPTY)}return e}refCount(){return aa()(this)}};var uS=ra(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Tt=(()=>{class t extends se{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new $h(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new uS}next(n){sa(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){sa(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){sa(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?l_:(this.currentObservers=null,s.push(n),new bt(()=>{this.currentObservers=null,Ls(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new se;return n.source=this,n}}return t.create=(e,n)=>new $h(e,n),t})(),$h=class extends Tt{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:l_}};var zt=class extends Tt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var gc={now(){return(gc.delegate||Date).now()},delegate:void 0};var Hh=class extends Tt{constructor(e=1/0,n=1/0,r=gc){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=n.now(),a=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)a=u;a&&r.splice(0,a+1)}}};var qh=class extends bt{constructor(e,n){super()}schedule(e,n=0){return this}};var mc={setInterval(t,e,...n){let{delegate:r}=mc;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=mc;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var ca=class extends qh{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return mc.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&mc.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,Ls(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var la=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};la.now=gc.now;var da=class extends la{constructor(e,n=la.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var hi=new da(ca);var Gh=class extends ca{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var zh=class extends da{};var v_=new zh(Gh);var Dn=new se(t=>t.complete());function cS(t){return t&&te(t.schedule)}function w_(t){return t[t.length-1]}function ha(t){return te(w_(t))?t.pop():void 0}function xr(t){return cS(w_(t))?t.pop():void 0}function lS(t,e){return typeof w_(t)=="number"?t.pop():e}var Wh=t=>t&&typeof t.length=="number"&&typeof t!="function";function Kh(t){return te(t?.then)}function Qh(t){return te(t[oa])}function Yh(t){return Symbol.asyncIterator&&te(t?.[Symbol.asyncIterator])}function Zh(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function Q2(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Xh=Q2();function Jh(t){return te(t?.[Xh])}function ef(t){return LD(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield xh(n.read());if(i)return yield xh(void 0);yield yield xh(r)}}finally{n.releaseLock()}})}function tf(t){return te(t?.getReader)}function Ge(t){if(t instanceof se)return t;if(t!=null){if(Qh(t))return Y2(t);if(Wh(t))return Z2(t);if(Kh(t))return X2(t);if(Yh(t))return dS(t);if(Jh(t))return J2(t);if(tf(t))return ej(t)}throw Zh(t)}function Y2(t){return new se(e=>{let n=t[oa]();if(te(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Z2(t){return new se(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function X2(t){return new se(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,Uh)})}function J2(t){return new se(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function dS(t){return new se(e=>{tj(t,e).catch(n=>e.error(n))})}function ej(t){return dS(ef(t))}function tj(t,e){var n,r,i,s;return FD(this,void 0,void 0,function*(){try{for(n=VD(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function Sn(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function Rn(t,e=0){return ee((n,r)=>{n.subscribe(X(r,i=>Sn(r,t,()=>r.next(i),e),()=>Sn(r,t,()=>r.complete(),e),i=>Sn(r,t,()=>r.error(i),e)))})}function cr(t,e=0){return ee((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function hS(t,e){return Ge(t).pipe(cr(e),Rn(e))}function fS(t,e){return Ge(t).pipe(cr(e),Rn(e))}function pS(t,e){return new se(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function gS(t,e){return new se(n=>{let r;return Sn(n,e,()=>{r=t[Xh](),Sn(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>te(r?.return)&&r.return()})}function nf(t,e){if(!t)throw new Error("Iterable cannot be null");return new se(n=>{Sn(n,e,()=>{let r=t[Symbol.asyncIterator]();Sn(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function mS(t,e){return nf(ef(t),e)}function yS(t,e){if(t!=null){if(Qh(t))return hS(t,e);if(Wh(t))return pS(t,e);if(Kh(t))return fS(t,e);if(Yh(t))return nf(t,e);if(Jh(t))return gS(t,e);if(tf(t))return mS(t,e)}throw Zh(t)}function ve(t,e){return e?yS(t,e):Ge(t)}function q(...t){let e=xr(t);return ve(t,e)}function fa(t,e){let n=te(t)?t:()=>t,r=i=>i.error(n());return new se(e?i=>e.schedule(r,0,i):r)}function E_(t){return!!t&&(t instanceof se||te(t.lift)&&te(t.subscribe))}var fi=ra(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function H(t,e){return ee((n,r)=>{let i=0;n.subscribe(X(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:nj}=Array;function rj(t,e){return nj(e)?t(...e):t(e)}function rf(t){return H(e=>rj(t,e))}var{isArray:ij}=Array,{getPrototypeOf:sj,prototype:oj,keys:aj}=Object;function sf(t){if(t.length===1){let e=t[0];if(ij(e))return{args:e,keys:null};if(uj(e)){let n=aj(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function uj(t){return t&&typeof t=="object"&&sj(t)===oj}function of(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function yc(...t){let e=xr(t),n=ha(t),{args:r,keys:i}=sf(t);if(r.length===0)return ve([],e);let s=new se(cj(r,e,i?o=>of(i,o):Gt));return n?s.pipe(rf(n)):s}function cj(t,e,n=Gt){return r=>{_S(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let u=0;u<i;u++)_S(e,()=>{let c=ve(t[u],e),l=!1;c.subscribe(X(r,d=>{s[u]=d,l||(l=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function _S(t,e,n){t?Sn(n,t,e):e()}function vS(t,e,n,r,i,s,o,a){let u=[],c=0,l=0,d=!1,h=()=>{d&&!u.length&&!c&&e.complete()},f=m=>c<r?p(m):u.push(m),p=m=>{s&&e.next(m),c++;let g=!1;Ge(n(m,l++)).subscribe(X(e,_=>{i?.(_),s?f(_):e.next(_)},()=>{g=!0},void 0,()=>{if(g)try{for(c--;u.length&&c<r;){let _=u.shift();o?Sn(e,o,()=>p(_)):p(_)}h()}catch(_){e.error(_)}}))};return t.subscribe(X(e,f,()=>{d=!0,h()})),()=>{a?.()}}function Dt(t,e,n=1/0){return te(e)?Dt((r,i)=>H((s,o)=>e(r,s,i,o))(Ge(t(r,i))),n):(typeof e=="number"&&(n=e),ee((r,i)=>vS(r,i,t,n)))}function ki(t=1/0){return Dt(Gt,t)}function wS(){return ki(1)}function pa(...t){return wS()(ve(t,xr(t)))}function af(t){return new se(e=>{Ge(t()).subscribe(e)})}function I_(...t){let e=ha(t),{args:n,keys:r}=sf(t),i=new se(s=>{let{length:o}=n;if(!o){s.complete();return}let a=new Array(o),u=o,c=o;for(let l=0;l<o;l++){let d=!1;Ge(n[l]).subscribe(X(s,h=>{d||(d=!0,c--),a[l]=h},()=>u--,void 0,()=>{(!u||!d)&&(c||s.next(r?of(r,a):a),s.complete())}))}});return e?i.pipe(rf(e)):i}function Fi(...t){let e=xr(t),n=lS(t,1/0),r=t;return r.length?r.length===1?Ge(r[0]):ki(n)(ve(r,e)):Dn}function Wt(t,e){return ee((n,r)=>{let i=0;n.subscribe(X(r,s=>t.call(e,s,i++)&&r.next(s)))})}function Li(t){return ee((e,n)=>{let r=null,i=!1,s;r=e.subscribe(X(n,void 0,void 0,o=>{s=Ge(t(o,Li(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function ES(t,e,n,r,i){return(s,o)=>{let a=n,u=e,c=0;s.subscribe(X(o,l=>{let d=c++;u=a?t(u,l,d):(a=!0,l),r&&o.next(u)},i&&(()=>{a&&o.next(u),o.complete()})))}}function Bs(t,e){return te(e)?Dt(t,e,1):Dt(t,1)}function C_(t,e=hi){return ee((n,r)=>{let i=null,s=null,o=null,a=()=>{if(i){i.unsubscribe(),i=null;let c=s;s=null,r.next(c)}};function u(){let c=o+t,l=e.now();if(l<c){i=this.schedule(void 0,c-l),r.add(i);return}a()}n.subscribe(X(r,c=>{s=c,o=e.now(),i||(i=e.schedule(u,t),r.add(i))},()=>{a(),r.complete()},void 0,()=>{s=i=null}))})}function Vi(t){return ee((e,n)=>{let r=!1;e.subscribe(X(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function pi(t){return t<=0?()=>Dn:ee((e,n)=>{let r=0;e.subscribe(X(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function b_(t){return H(()=>t)}function $s(t,e=Gt){return t=t??lj,ee((n,r)=>{let i,s=!0;n.subscribe(X(r,o=>{let a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function lj(t,e){return t===e}function uf(t=dj){return ee((e,n)=>{let r=!1;e.subscribe(X(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function dj(){return new fi}function _c(t){return ee((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function qn(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Wt((i,s)=>t(i,s,r)):Gt,pi(1),n?Vi(e):uf(()=>new fi))}function ga(t){return t<=0?()=>Dn:ee((e,n)=>{let r=[];e.subscribe(X(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function T_(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Wt((i,s)=>t(i,s,r)):Gt,ga(1),n?Vi(e):uf(()=>new fi))}function vc(){return ee((t,e)=>{let n,r=!1;t.subscribe(X(e,i=>{let s=n;n=i,r&&e.next([s,i]),r=!0}))})}function Rr(t,e){return ee(ES(t,e,arguments.length>=2,!0))}function Hs(t={}){let{connector:e=()=>new Tt,resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,u,c=0,l=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=u=void 0,l=d=!1},p=()=>{let m=o;f(),m?.unsubscribe()};return ee((m,g)=>{c++,!d&&!l&&h();let _=u=u??e();g.add(()=>{c--,c===0&&!d&&!l&&(a=D_(p,i))}),_.subscribe(g),!o&&c>0&&(o=new di({next:y=>_.next(y),error:y=>{d=!0,h(),a=D_(f,n,y),_.error(y)},complete:()=>{l=!0,h(),a=D_(f,r),_.complete()}}),Ge(m).subscribe(o))})(s)}}function D_(t,e,...n){if(e===!0){t();return}if(e===!1)return;let r=new di({next:()=>{r.unsubscribe(),t()}});return Ge(e(...n)).subscribe(r)}function cf(t,e,n){let r,i=!1;return t&&typeof t=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t:r=t??1/0,Hs({connector:()=>new Hh(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function S_(t){return ee((e,n)=>{let r=!1,i=0;e.subscribe(X(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}function qs(...t){let e=xr(t);return ee((n,r)=>{(e?pa(t,n,e):pa(t,n)).subscribe(r)})}function Be(t,e){return ee((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(X(r,u=>{i?.unsubscribe();let c=0,l=s++;Ge(t(u,l)).subscribe(i=X(r,d=>r.next(e?e(u,d,l,c++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function lf(t,e){return te(e)?Be(()=>t,e):Be(()=>t)}function A_(t){return ee((e,n)=>{Ge(t).subscribe(X(n,()=>n.complete(),Vs)),!n.closed&&e.subscribe(n)})}function vt(t,e,n){let r=te(t)||e||n?{next:t,error:e,complete:n}:t;return r?ee((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(X(s,u=>{var c;(c=r.next)===null||c===void 0||c.call(r,u),s.next(u)},()=>{var u;a=!1,(u=r.complete)===null||u===void 0||u.call(r),s.complete()},u=>{var c;a=!1,(c=r.error)===null||c===void 0||c.call(r,u),s.error(u)},()=>{var u,c;a&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(c=r.finalize)===null||c===void 0||c.call(r)}))}):Gt}function x_(...t){let e=ha(t);return ee((n,r)=>{let i=t.length,s=new Array(i),o=t.map(()=>!1),a=!1;for(let u=0;u<i;u++)Ge(t[u]).subscribe(X(r,c=>{s[u]=c,!a&&!o[u]&&(o[u]=!0,(a=o.every(Gt))&&(o=null))},Vs));n.subscribe(X(r,u=>{if(a){let c=[u,...s];r.next(e?e(...c):c)}}))})}function ze(t){for(let e in t)if(t[e]===ze)return e;throw Error("Could not find renamed property on target object.")}function df(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function Jt(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(Jt).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function IS(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var hj=ze({__forward_ref__:ze});function Ma(t){return t.__forward_ref__=Ma,t.toString=function(){return Jt(this())},t}function cn(t){return sA(t)?t():t}function sA(t){return typeof t=="function"&&t.hasOwnProperty(hj)&&t.__forward_ref__===Ma}function oA(t){return t&&!!t.\u0275providers}var aA="https://g.co/ng/security#xss",z=class extends Error{constructor(e,n){super(Pv(e,n)),this.code=e}};function Pv(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}var fj=ze({\u0275cmp:ze}),pj=ze({\u0275dir:ze}),gj=ze({\u0275pipe:ze}),mj=ze({\u0275mod:ze}),If=ze({\u0275fac:ze}),wc=ze({__NG_ELEMENT_ID__:ze}),CS=ze({__NG_ENV_ID__:ze});function Hf(t){return typeof t=="string"?t:t==null?"":String(t)}function yj(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():Hf(t)}function _j(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new z(-200,`Circular dependency in DI detected for ${t}${n}`)}function Nv(t,e){let n=e?` in ${e}`:"";throw new z(-201,!1)}function vj(t,e){t==null&&wj(e,t,null,"!=")}function wj(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t}`+(r==null?"":` [Expected=> ${n} ${r} ${e} <=Actual]`))}function B(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Ze(t){return{providers:t.providers||[],imports:t.imports||[]}}function qf(t){return bS(t,cA)||bS(t,lA)}function uA(t){return qf(t)!==null}function bS(t,e){return t.hasOwnProperty(e)?t[e]:null}function Ej(t){let e=t&&(t[cA]||t[lA]);return e||null}function TS(t){return t&&(t.hasOwnProperty(DS)||t.hasOwnProperty(Ij))?t[DS]:null}var cA=ze({\u0275prov:ze}),DS=ze({\u0275inj:ze}),lA=ze({ngInjectableDef:ze}),Ij=ze({ngInjectorDef:ze}),we=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(we||{}),G_;function dA(){return G_}function Gn(t){let e=G_;return G_=t,e}function hA(t,e,n){let r=qf(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&we.Optional)return null;if(e!==void 0)return e;Nv(Jt(t),"Injector")}var ln=globalThis;var j=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=B({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};var Cj={},Ic=Cj,z_="__NG_DI_FLAG__",Cf="ngTempTokenPath",bj="ngTokenPath",Tj=/\n/gm,Dj="\u0275",SS="__source",wa;function Sj(){return wa}function ji(t){let e=wa;return wa=t,e}function Aj(t,e=we.Default){if(wa===void 0)throw new z(-203,!1);return wa===null?hA(t,void 0,e):wa.get(t,e&we.Optional?null:void 0,e)}function C(t,e=we.Default){return(dA()||Aj)(cn(t),e)}function $(t,e=we.Default){return C(t,Gf(e))}function Gf(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function W_(t){let e=[];for(let n=0;n<t.length;n++){let r=cn(t[n]);if(Array.isArray(r)){if(r.length===0)throw new z(900,!1);let i,s=we.Default;for(let o=0;o<r.length;o++){let a=r[o],u=xj(a);typeof u=="number"?u===-1?i=a.token:s|=u:i=a}e.push(C(i,s))}else e.push(C(r))}return e}function fA(t,e){return t[z_]=e,t.prototype[z_]=e,t}function xj(t){return t[z_]}function Rj(t,e,n,r){let i=t[Cf];throw e[SS]&&i.unshift(e[SS]),t.message=Mj(`
`+t.message,i,n,r),t[bj]=i,t[Cf]=null,t}function Mj(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==Dj?t.slice(2):t;let i=Jt(e);if(Array.isArray(e))i=e.map(Jt).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Jt(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(Tj,`
  `)}`}function kc(t){return{toString:t}.toString()}var pA=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(pA||{}),Nr=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(Nr||{}),Ia={},zn=[];function gA(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function K_(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];Pj(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function mA(t){return t===3||t===4||t===6}function Pj(t){return t.charCodeAt(0)===64}function Cc(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?AS(t,n,i,null,e[++r]):AS(t,n,i,null,null))}}return t}function AS(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var yA="ng-template";function Nj(t,e,n){let r=0,i=!0;for(;r<t.length;){let s=t[r++];if(typeof s=="string"&&i){let o=t[r++];if(n&&s==="class"&&gA(o.toLowerCase(),e,0)!==-1)return!0}else if(s===1){for(;r<t.length&&typeof(s=t[r++])=="string";)if(s.toLowerCase()===e)return!0;return!1}else typeof s=="number"&&(i=!1)}return!1}function _A(t){return t.type===4&&t.value!==yA}function Oj(t,e,n){let r=t.type===4&&!n?yA:t.value;return e===r}function kj(t,e,n){let r=4,i=t.attrs||[],s=Vj(i),o=!1;for(let a=0;a<e.length;a++){let u=e[a];if(typeof u=="number"){if(!o&&!lr(r)&&!lr(u))return!1;if(o&&lr(u))continue;o=!1,r=u|r&1;continue}if(!o)if(r&4){if(r=2|r&1,u!==""&&!Oj(t,u,n)||u===""&&e.length===1){if(lr(r))return!1;o=!0}}else{let c=r&8?u:e[++a];if(r&8&&t.attrs!==null){if(!Nj(t.attrs,c,n)){if(lr(r))return!1;o=!0}continue}let l=r&8?"class":u,d=Fj(l,i,_A(t),n);if(d===-1){if(lr(r))return!1;o=!0;continue}if(c!==""){let h;d>s?h="":h=i[d+1].toLowerCase();let f=r&8?h:null;if(f&&gA(f,c,0)!==-1||r&2&&c!==h){if(lr(r))return!1;o=!0}}}}return lr(r)||o}function lr(t){return(t&1)===0}function Fj(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return jj(e,t)}function Lj(t,e,n=!1){for(let r=0;r<e.length;r++)if(kj(t,e[r],n))return!0;return!1}function Vj(t){for(let e=0;e<t.length;e++){let n=t[e];if(mA(n))return e}return t.length}function jj(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function xS(t,e){return t?":not("+e.trim()+")":e}function Uj(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!lr(o)&&(e+=xS(s,i),i=""),r=o,s=s||!lr(r);n++}return i!==""&&(e+=xS(s,i)),e}function Bj(t){return t.map(Uj).join(",")}function $j(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!lr(i))break;i=s}r++}return{attrs:e,classes:n}}function st(t){return kc(()=>{let e=CA(t),n=Le(N({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===pA.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||Nr.Emulated,styles:t.styles||zn,_:null,schemas:t.schemas||null,tView:null,id:""});bA(n);let r=t.dependencies;return n.directiveDefs=MS(r,!1),n.pipeDefs=MS(r,!0),n.id=Gj(n),n})}function Hj(t){return $i(t)||vA(t)}function qj(t){return t!==null}function Xe(t){return kc(()=>({type:t.type,bootstrap:t.bootstrap||zn,declarations:t.declarations||zn,imports:t.imports||zn,exports:t.exports||zn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function RS(t,e){if(t==null)return Ia;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),n[i]=r,e&&(e[i]=s)}return n}function An(t){return kc(()=>{let e=CA(t);return bA(e),e})}function $i(t){return t[fj]||null}function vA(t){return t[pj]||null}function wA(t){return t[gj]||null}function EA(t){let e=$i(t)||vA(t)||wA(t);return e!==null?e.standalone:!1}function IA(t,e){let n=t[mj]||null;if(!n&&e===!0)throw new Error(`Type ${Jt(t)} does not have '\u0275mod' property.`);return n}function CA(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||Ia,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||zn,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:RS(t.inputs,e),outputs:RS(t.outputs),debugInfo:null}}function bA(t){t.features?.forEach(e=>e(t))}function MS(t,e){if(!t)return null;let n=e?wA:Hj;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(qj)}function Gj(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483647+1,"c"+e}var yi=0,me=1,ne=2,Nt=3,dr=4,pr=5,bc=6,Tc=7,en=8,Ca=9,ba=10,Ot=11,Dc=12,PS=13,Pa=14,hr=15,zf=16,ma=17,Sc=18,Wf=19,TA=20,Ui=21,R_=22,zs=23,Wn=25,DA=1;var Ws=7,bf=8,Tf=9,dn=10,Ta=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t[t.HasChildViewsToRefresh=4]="HasChildViewsToRefresh",t}(Ta||{});function Bi(t){return Array.isArray(t)&&typeof t[DA]=="object"}function fr(t){return Array.isArray(t)&&t[DA]===!0}function SA(t){return(t.flags&4)!==0}function Kf(t){return t.componentOffset>-1}function Ov(t){return(t.flags&1)===1}function Hi(t){return!!t.template}function zj(t){return(t[ne]&512)!==0}function Da(t,e){let n=t.hasOwnProperty(If);return n?t[If]:null}var Q_=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function gr(){return AA}function AA(t){return t.type.prototype.ngOnChanges&&(t.setInput=Kj),Wj}gr.ngInherit=!0;function Wj(){let t=RA(this),e=t?.current;if(e){let n=t.previous;if(n===Ia)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function Kj(t,e,n,r){let i=this.declaredInputs[n],s=RA(t)||Qj(t,{previous:Ia,current:null}),o=s.current||(s.current={}),a=s.previous,u=a[i];o[i]=new Q_(u&&u.currentValue,e,a===Ia),t[r]=e}var xA="__ngSimpleChanges__";function RA(t){return t[xA]||null}function Qj(t,e){return t[xA]=e}var NS=null;var Mr=function(t,e,n){NS?.(t,e,n)},Yj="svg",Zj="math";function Or(t){for(;Array.isArray(t);)t=t[yi];return t}function MA(t,e){return Or(e[t])}function Kn(t,e){return Or(e[t.index])}function kv(t,e){return t.data[e]}function Xj(t,e){return t[e]}function Gi(t,e){let n=e[t];return Bi(n)?n:n[yi]}function Fv(t){return(t[ne]&128)===128}function Jj(t){return fr(t[Nt])}function Df(t,e){return e==null?null:t[e]}function PA(t){t[ma]=0}function eU(t){t[ne]&1024||(t[ne]|=1024,Fv(t)&&Qf(t))}function tU(t,e){for(;t>0;)e=e[Pa],t--;return e}function NA(t){return t[ne]&9216||t[zs]?.dirty}function OA(t){NA(t)&&Qf(t)}function Qf(t){let e=t[Nt];for(;e!==null&&!(fr(e)&&e[ne]&Ta.HasChildViewsToRefresh||Bi(e)&&e[ne]&8192);){if(fr(e))e[ne]|=Ta.HasChildViewsToRefresh;else if(e[ne]|=8192,!Fv(e))break;e=e[Nt]}}function kA(t,e){if((t[ne]&256)===256)throw new z(911,!1);t[Ui]===null&&(t[Ui]=[]),t[Ui].push(e)}function nU(t,e){if(t[Ui]===null)return;let n=t[Ui].indexOf(e);n!==-1&&t[Ui].splice(n,1)}var Ie={lFrame:$A(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function rU(){return Ie.lFrame.elementDepthCount}function iU(){Ie.lFrame.elementDepthCount++}function sU(){Ie.lFrame.elementDepthCount--}function FA(){return Ie.bindingsEnabled}function oU(){return Ie.skipHydrationRootTNode!==null}function aU(t){return Ie.skipHydrationRootTNode===t}function uU(){Ie.skipHydrationRootTNode=null}function We(){return Ie.lFrame.lView}function Qn(){return Ie.lFrame.tView}function xe(t){return Ie.lFrame.contextLView=t,t[en]}function Re(t){return Ie.lFrame.contextLView=null,t}function Pn(){let t=LA();for(;t!==null&&t.type===64;)t=t.parent;return t}function LA(){return Ie.lFrame.currentTNode}function cU(){let t=Ie.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function Fc(t,e){let n=Ie.lFrame;n.currentTNode=t,n.isParent=e}function VA(){return Ie.lFrame.isParent}function lU(){Ie.lFrame.isParent=!1}function dU(){return Ie.lFrame.contextLView}function hU(t){return Ie.lFrame.bindingIndex=t}function Lc(){return Ie.lFrame.bindingIndex++}function fU(t){let e=Ie.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function pU(){return Ie.lFrame.inI18n}function gU(t,e){let n=Ie.lFrame;n.bindingIndex=n.bindingRootIndex=t,Y_(e)}function mU(){return Ie.lFrame.currentDirectiveIndex}function Y_(t){Ie.lFrame.currentDirectiveIndex=t}function yU(t){let e=Ie.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function jA(t){Ie.lFrame.currentQueryIndex=t}function _U(t){let e=t[me];return e.type===2?e.declTNode:e.type===1?t[pr]:null}function UA(t,e,n){if(n&we.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&we.Host);)if(i=_U(s),i===null||(s=s[Pa],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=Ie.lFrame=BA();return r.currentTNode=e,r.lView=t,!0}function Lv(t){let e=BA(),n=t[me];Ie.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function BA(){let t=Ie.lFrame,e=t===null?null:t.child;return e===null?$A(t):e}function $A(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function HA(){let t=Ie.lFrame;return Ie.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var qA=HA;function Vv(){let t=HA();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function vU(t){return(Ie.lFrame.contextLView=tU(t,Ie.lFrame.contextLView))[en]}function Js(){return Ie.lFrame.selectedIndex}function Ks(t){Ie.lFrame.selectedIndex=t}function jv(){let t=Ie.lFrame;return kv(t.tView,t.selectedIndex)}function wU(){return Ie.lFrame.currentNamespace}var GA=!0;function Uv(){return GA}function Bv(t){GA=t}function EU(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=AA(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function $v(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:c,ngOnDestroy:l}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),u&&(t.viewHooks??=[]).push(-n,u),c&&((t.viewHooks??=[]).push(n,c),(t.viewCheckHooks??=[]).push(n,c)),l!=null&&(t.destroyHooks??=[]).push(n,l)}}function yf(t,e,n){zA(t,e,3,n)}function _f(t,e,n,r){(t[ne]&3)===n&&zA(t,e,n,r)}function M_(t,e){let n=t[ne];(n&3)===e&&(n&=16383,n+=1,t[ne]=n)}function zA(t,e,n,r){let i=r!==void 0?t[ma]&65535:0,s=r??-1,o=e.length-1,a=0;for(let u=i;u<o;u++)if(typeof e[u+1]=="number"){if(a=e[u],r!=null&&a>=r)break}else e[u]<0&&(t[ma]+=65536),(a<s||s==-1)&&(IU(t,n,e,u),t[ma]=(t[ma]&4294901760)+u+2),u++}function OS(t,e){Mr(4,t,e);let n=qt(null);try{e.call(t)}finally{qt(n),Mr(5,t,e)}}function IU(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[ne]>>14<t[ma]>>16&&(t[ne]&3)===e&&(t[ne]+=16384,OS(a,s)):OS(a,s)}var Ea=-1,Qs=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function CU(t){return t instanceof Qs}function bU(t){return(t.flags&8)!==0}function TU(t){return(t.flags&16)!==0}function WA(t){return t!==Ea}function Sf(t){let e=t&32767;return t&32767}function DU(t){return t>>16}function Af(t,e){let n=DU(t),r=e;for(;n>0;)r=r[Pa],n--;return r}var Z_=!0;function kS(t){let e=Z_;return Z_=t,e}var SU=256,KA=SU-1,QA=5,AU=0,Pr={};function xU(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(wc)&&(r=n[wc]),r==null&&(r=n[wc]=AU++);let i=r&KA,s=1<<i;e.data[t+(i>>QA)]|=s}function xf(t,e){let n=YA(t,e);if(n!==-1)return n;let r=e[me];r.firstCreatePass&&(t.injectorIndex=e.length,P_(r.data,t),P_(e,null),P_(r.blueprint,null));let i=Hv(t,e),s=t.injectorIndex;if(WA(i)){let o=Sf(i),a=Af(i,e),u=a[me].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|u[o+c]}return e[s+8]=i,s}function P_(t,e){t.push(0,0,0,0,0,0,0,0,e)}function YA(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function Hv(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=tx(i),r===null)return Ea;if(n++,i=i[Pa],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return Ea}function X_(t,e,n){xU(t,e,n)}function RU(t,e){if(e==="class")return t.classes;if(e==="style")return t.styles;let n=t.attrs;if(n){let r=n.length,i=0;for(;i<r;){let s=n[i];if(mA(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof n[i]=="string";)i++;else{if(s===e)return n[i+1];i=i+2}}}return null}function ZA(t,e,n){if(n&we.Optional||t!==void 0)return t;Nv(e,"NodeInjector")}function XA(t,e,n,r){if(n&we.Optional&&r===void 0&&(r=null),!(n&(we.Self|we.Host))){let i=t[Ca],s=Gn(void 0);try{return i?i.get(e,r,n&we.Optional):hA(e,r,n&we.Optional)}finally{Gn(s)}}return ZA(r,e,n)}function JA(t,e,n,r=we.Default,i){if(t!==null){if(e[ne]&2048&&!(r&we.Self)){let o=kU(t,e,n,r,Pr);if(o!==Pr)return o}let s=ex(t,e,n,r,Pr);if(s!==Pr)return s}return XA(e,n,r,i)}function ex(t,e,n,r,i){let s=NU(n);if(typeof s=="function"){if(!UA(e,t,r))return r&we.Host?ZA(i,n,r):XA(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&we.Optional))Nv(n);else return o}finally{qA()}}else if(typeof s=="number"){let o=null,a=YA(t,e),u=Ea,c=r&we.Host?e[hr][pr]:null;for((a===-1||r&we.SkipSelf)&&(u=a===-1?Hv(t,e):e[a+8],u===Ea||!LS(r,!1)?a=-1:(o=e[me],a=Sf(u),e=Af(u,e)));a!==-1;){let l=e[me];if(FS(s,a,l.data)){let d=MU(a,e,n,o,r,c);if(d!==Pr)return d}u=e[a+8],u!==Ea&&LS(r,e[me].data[a+8]===c)&&FS(s,a,e)?(o=l,a=Sf(u),e=Af(u,e)):a=-1}}return i}function MU(t,e,n,r,i,s){let o=e[me],a=o.data[t+8],u=r==null?Kf(a)&&Z_:r!=o&&(a.type&3)!==0,c=i&we.Host&&s===a,l=PU(a,o,n,u,c);return l!==null?Sa(e,o,l,a):Pr}function PU(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,u=t.directiveStart,c=t.directiveEnd,l=s>>20,d=r?a:a+l,h=i?a+l:c;for(let f=d;f<h;f++){let p=o[f];if(f<u&&n===p||f>=u&&p.type===n)return f}if(i){let f=o[u];if(f&&Hi(f)&&f.type===n)return u}return null}function Sa(t,e,n,r){let i=t[n],s=e.data;if(CU(i)){let o=i;o.resolving&&_j(yj(s[n]));let a=kS(o.canSeeViewProviders);o.resolving=!0;let u,c=o.injectImpl?Gn(o.injectImpl):null,l=UA(t,r,we.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&EU(n,s[n],e)}finally{c!==null&&Gn(c),kS(a),o.resolving=!1,qA()}}return i}function NU(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(wc)?t[wc]:void 0;return typeof e=="number"?e>=0?e&KA:OU:e}function FS(t,e,n){let r=1<<t;return!!(n[e+(t>>QA)]&r)}function LS(t,e){return!(t&we.Self)&&!(t&we.Host&&e)}var Gs=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return JA(this._tNode,this._lView,e,Gf(r),n)}};function OU(){return new Gs(Pn(),We())}function Vc(t){return kc(()=>{let e=t.prototype.constructor,n=e[If]||J_(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[If]||J_(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function J_(t){return sA(t)?()=>{let e=J_(cn(t));return e&&e()}:Da(t)}function kU(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[ne]&2048&&!(o[ne]&512);){let a=ex(s,o,n,r|we.Self,Pr);if(a!==Pr)return a;let u=s.parent;if(!u){let c=o[TA];if(c){let l=c.get(n,Pr,r);if(l!==Pr)return l}u=tx(o),o=o[Pa]}s=u}return i}function tx(t){let e=t[me],n=e.type;return n===2?e.declTNode:n===1?t[pr]:null}function qv(t){return RU(Pn(),t)}var hf="__parameters__";function FU(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function nx(t,e,n){return kc(()=>{let r=FU(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(u,c,l){let d=u.hasOwnProperty(hf)?u[hf]:Object.defineProperty(u,hf,{value:[]})[hf];for(;d.length<=l;)d.push(null);return(d[l]=d[l]||[]).push(o),u}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}function LU(t){let e=ln.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function VU(t){return typeof t=="function"}function Gv(t,e){t.forEach(n=>Array.isArray(n)?Gv(n,e):e(n))}function rx(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Rf(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function jU(t,e){let n=[];for(let r=0;r<t;r++)n.push(e);return n}function UU(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let s=i-2;t[i]=t[s],i--}t[e]=n,t[e+1]=r}}function BU(t,e,n){let r=jc(t,e);return r>=0?t[r|1]=n:(r=~r,UU(t,r,e,n)),r}function N_(t,e){let n=jc(t,e);if(n>=0)return t[n|1]}function jc(t,e){return $U(t,e,1)}function $U(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}var Uc=fA(nx("Optional"),8);var ix=fA(nx("SkipSelf"),4);function HU(t){let e=[],n=new Map;function r(i){let s=n.get(i);if(!s){let o=t(i);n.set(i,s=o.then(WU))}return s}return Mf.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(c=>{i.template=c}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let c=i.styles.length,l=i.styleUrls;i.styleUrls.forEach((d,h)=>{a.push(""),o.push(r(d).then(f=>{a[c+h]=f,l.splice(l.indexOf(d),1),l.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(c=>{a.push(c),i.styleUrl=void 0}));let u=Promise.all(o).then(()=>KU(s));e.push(u)}),GU(),Promise.all(e).then(()=>{})}var Mf=new Map,qU=new Set;function GU(){let t=Mf;return Mf=new Map,t}function zU(){return Mf.size===0}function WU(t){return typeof t=="string"?t:t.text()}function KU(t){qU.delete(t)}var Bc=new j("ENVIRONMENT_INITIALIZER"),sx=new j("INJECTOR",-1),ox=new j("INJECTOR_DEF_TYPES"),Pf=class{get(e,n=Ic){if(n===Ic){let r=new Error(`NullInjectorError: No provider for ${Jt(e)}!`);throw r.name="NullInjectorError",r}return n}};function QU(...t){return{\u0275providers:ax(!0,t),\u0275fromNgModule:!0}}function ax(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return Gv(e,o=>{let a=o;ev(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&ux(i,s),n}function ux(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];zv(i,s=>{e(s,r)})}}function ev(t,e,n,r){if(t=cn(t),!t)return!1;let i=null,s=TS(t),o=!s&&$i(t);if(!s&&!o){let u=t.ngModule;if(s=TS(u),s)i=u;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let u=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let c of u)ev(c,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let c;try{Gv(s.imports,l=>{ev(l,e,n,r)&&(c||=[],c.push(l))})}finally{}c!==void 0&&ux(c,e)}if(!a){let c=Da(i)||(()=>new i);e({provide:i,useFactory:c,deps:zn},i),e({provide:ox,useValue:i,multi:!0},i),e({provide:Bc,useValue:()=>C(i),multi:!0},i)}let u=s.providers;if(u!=null&&!a){let c=t;zv(u,l=>{e(l,c)})}}else return!1;return i!==t&&t.providers!==void 0}function zv(t,e){for(let n of t)oA(n)&&(n=n.\u0275providers),Array.isArray(n)?zv(n,e):e(n)}var YU=ze({provide:String,useValue:ze});function cx(t){return t!==null&&typeof t=="object"&&YU in t}function ZU(t){return!!(t&&t.useExisting)}function XU(t){return!!(t&&t.useFactory)}function Aa(t){return typeof t=="function"}function JU(t){return!!t.useClass}var Yf=new j("Set Injector scope."),vf={},eB={},O_;function Wv(){return O_===void 0&&(O_=new Pf),O_}var Mn=class{},Ac=class extends Mn{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,nv(e,o=>this.processProvider(o)),this.records.set(sx,ya(void 0,this)),i.has("environment")&&this.records.set(Mn,ya(void 0,this));let s=this.records.get(Yf);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(ox,zn,we.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(let n of this._ngOnDestroyHooks)n.ngOnDestroy();let e=this._onDestroyHooks;this._onDestroyHooks=[];for(let n of e)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=ji(this),r=Gn(void 0),i;try{return e()}finally{ji(n),Gn(r)}}get(e,n=Ic,r=we.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(CS))return e[CS](this);r=Gf(r);let i,s=ji(this),o=Gn(void 0);try{if(!(r&we.SkipSelf)){let u=this.records.get(e);if(u===void 0){let c=sB(e)&&qf(e);c&&this.injectableDefInScope(c)?u=ya(tv(e),vf):u=null,this.records.set(e,u)}if(u!=null)return this.hydrate(e,u)}let a=r&we.Self?Wv():this.parent;return n=r&we.Optional&&n===Ic?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[Cf]=a[Cf]||[]).unshift(Jt(e)),s)throw a;return Rj(a,e,"R3InjectorError",this.source)}else throw a}finally{Gn(o),ji(s)}}resolveInjectorInitializers(){let e=ji(this),n=Gn(void 0),r;try{let i=this.get(Bc,zn,we.Self);for(let s of i)s()}finally{ji(e),Gn(n)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(Jt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new z(205,!1)}processProvider(e){e=cn(e);let n=Aa(e)?e:cn(e&&e.provide),r=nB(e);if(!Aa(e)&&e.multi===!0){let i=this.records.get(n);i||(i=ya(void 0,vf,!0),i.factory=()=>W_(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}else{let i=this.records.get(n)}this.records.set(n,r)}hydrate(e,n){return n.value===vf&&(n.value=eB,n.value=n.factory()),typeof n.value=="object"&&n.value&&iB(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;let n=cn(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function tv(t){let e=qf(t),n=e!==null?e.factory:Da(t);if(n!==null)return n;if(t instanceof j)throw new z(204,!1);if(t instanceof Function)return tB(t);throw new z(204,!1)}function tB(t){let e=t.length;if(e>0){let r=jU(e,"?");throw new z(204,!1)}let n=Ej(t);return n!==null?()=>n.factory(t):()=>new t}function nB(t){if(cx(t))return ya(void 0,t.useValue);{let e=lx(t);return ya(e,vf)}}function lx(t,e,n){let r;if(Aa(t)){let i=cn(t);return Da(i)||tv(i)}else if(cx(t))r=()=>cn(t.useValue);else if(XU(t))r=()=>t.useFactory(...W_(t.deps||[]));else if(ZU(t))r=()=>C(cn(t.useExisting));else{let i=cn(t&&(t.useClass||t.provide));if(rB(t))r=()=>new i(...W_(t.deps));else return Da(i)||tv(i)}return r}function ya(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function rB(t){return!!t.deps}function iB(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function sB(t){return typeof t=="function"||typeof t=="object"&&t instanceof j}function nv(t,e){for(let n of t)Array.isArray(n)?nv(n,e):n&&oA(n)?nv(n.\u0275providers,e):e(n)}function zi(t,e){t instanceof Ac&&t.assertNotDestroyed();let n,r=ji(t),i=Gn(void 0);try{return e()}finally{ji(r),Gn(i)}}function oB(t){if(!dA()&&!Sj())throw new z(-203,!1)}function VS(t,e=null,n=null,r){let i=dx(t,e,n,r);return i.resolveInjectorInitializers(),i}function dx(t,e=null,n=null,r,i=new Set){let s=[n||zn,QU(t)];return r=r||(typeof t=="object"?void 0:Jt(t)),new Ac(s,e||Wv(),r||null,i)}var Yn=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return VS({name:""},i,r,"");{let s=r.name??"";return VS({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=Ic,e.NULL=new Pf,e.\u0275prov=B({token:e,providedIn:"any",factory:()=>C(sx)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})();var rv;function hx(t){rv=t}function aB(){if(rv!==void 0)return rv;if(typeof document<"u")return document;throw new z(210,!1)}var Zf=new j("AppId",{providedIn:"root",factory:()=>uB}),uB="ng",Kv=new j("Platform Initializer"),Kt=new j("Platform ID",{providedIn:"platform",factory:()=>"unknown"});var Qv=new j("CSP nonce",{providedIn:"root",factory:()=>aB().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function fx(t){return t instanceof Function?t():t}function cB(t){return(t??$(Yn)).get(Kt)==="browser"}function px(t){return(t.flags&128)===128}var gi=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(gi||{});var gx=new Map,lB=0;function dB(){return lB++}function hB(t){gx.set(t[Wf],t)}function fB(t){gx.delete(t[Wf])}var jS="__ngContext__";function Ys(t,e){Bi(e)?(t[jS]=e[Wf],hB(e)):t[jS]=e}var pB;function Yv(t,e){return pB(t,e)}function Zv(t){let e=t[Nt];return fr(e)?e[Nt]:e}function mx(t){return _x(t[Dc])}function yx(t){return _x(t[dr])}function _x(t){for(;t!==null&&!fr(t);)t=t[dr];return t}function _a(t,e,n,r,i){if(r!=null){let s,o=!1;fr(r)?s=r:Bi(r)&&(o=!0,r=r[yi]);let a=Or(r);t===0&&n!==null?i==null?Ex(e,n,a):Nf(e,n,a,i||null,!0):t===1&&n!==null?Nf(e,n,a,i||null,!0):t===2?PB(e,a,o):t===3&&e.destroyNode(a),s!=null&&OB(e,t,s,n,i)}}function gB(t,e){return t.createText(e)}function mB(t,e,n){t.setValue(e,n)}function vx(t,e,n){return t.createElement(e,n)}function yB(t,e){let n=e[Ot];$c(t,e,n,2,null,null),e[yi]=null,e[pr]=null}function _B(t,e,n,r,i,s){r[yi]=i,r[pr]=e,$c(t,r,n,1,i,s)}function vB(t,e){$c(t,e,e[Ot],2,null,null)}function wB(t){let e=t[Dc];if(!e)return k_(t[me],t);for(;e;){let n=null;if(Bi(e))n=e[Dc];else{let r=e[dn];r&&(n=r)}if(!n){for(;e&&!e[dr]&&e!==t;)Bi(e)&&k_(e[me],e),e=e[Nt];e===null&&(e=t),Bi(e)&&k_(e[me],e),n=e&&e[dr]}e=n}}function EB(t,e,n,r){let i=dn+r,s=n.length;r>0&&(n[i-1][dr]=e),r<s-dn?(e[dr]=n[i],rx(n,dn+r,e)):(n.push(e),e[dr]=null),e[Nt]=n;let o=e[zf];o!==null&&n!==o&&IB(o,e);let a=e[Sc];a!==null&&a.insertView(t),OA(e),e[ne]|=128}function IB(t,e){let n=t[Tf],i=e[Nt][Nt][hr];e[hr]!==i&&(t[ne]|=Ta.HasTransplantedViews),n===null?t[Tf]=[e]:n.push(e)}function wx(t,e){let n=t[Tf],r=n.indexOf(e),i=e[Nt];n.splice(r,1)}function xc(t,e){if(t.length<=dn)return;let n=dn+e,r=t[n];if(r){let i=r[zf];i!==null&&i!==t&&wx(i,r),e>0&&(t[n-1][dr]=r[dr]);let s=Rf(t,dn+e);yB(r[me],r);let o=s[Sc];o!==null&&o.detachView(s[me]),r[Nt]=null,r[dr]=null,r[ne]&=-129}return r}function Xf(t,e){if(!(e[ne]&256)){let n=e[Ot];n.destroyNode&&$c(t,e,n,3,null,null),wB(e)}}function k_(t,e){if(!(e[ne]&256)){e[ne]&=-129,e[ne]|=256,e[zs]&&eS(e[zs]),bB(t,e),CB(t,e),e[me].type===1&&e[Ot].destroy();let n=e[zf];if(n!==null&&fr(e[Nt])){n!==e[Nt]&&wx(n,e);let r=e[Sc];r!==null&&r.detachView(t)}fB(e)}}function CB(t,e){let n=t.cleanup,r=e[Tc];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[Tc]=null);let i=e[Ui];if(i!==null){e[Ui]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function bB(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof Qs)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],u=s[o+1];Mr(4,a,u);try{u.call(a)}finally{Mr(5,a,u)}}else{Mr(4,i,s);try{s.call(i)}finally{Mr(5,i,s)}}}}}function TB(t,e,n){return DB(t,e.parent,n)}function DB(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[yi];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===Nr.None||s===Nr.Emulated)return null}return Kn(r,n)}}function Nf(t,e,n,r,i){t.insertBefore(e,n,r,i)}function Ex(t,e,n){t.appendChild(e,n)}function US(t,e,n,r,i){r!==null?Nf(t,e,n,r,i):Ex(t,e,n)}function SB(t,e,n,r){t.removeChild(e,n,r)}function Xv(t,e){return t.parentNode(e)}function AB(t,e){return t.nextSibling(e)}function xB(t,e,n){return MB(t,e,n)}function RB(t,e,n){return t.type&40?Kn(t,n):null}var MB=RB,BS;function Jv(t,e,n,r){let i=TB(t,r,e),s=e[Ot],o=r.parent||e[pr],a=xB(o,r,e);if(i!=null)if(Array.isArray(n))for(let u=0;u<n.length;u++)US(s,i,n[u],a,!1);else US(s,i,n,a,!1);BS!==void 0&&BS(s,r,e,n,i)}function wf(t,e){if(e!==null){let n=e.type;if(n&3)return Kn(e,t);if(n&4)return iv(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return wf(t,r);{let i=t[e.index];return fr(i)?iv(-1,i):Or(i)}}else{if(n&32)return Yv(e,t)()||Or(t[e.index]);{let r=Ix(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Zv(t[hr]);return wf(i,r)}else return wf(t,e.next)}}}return null}function Ix(t,e){if(e!==null){let r=t[hr][pr],i=e.projection;return r.projection[i]}return null}function iv(t,e){let n=dn+t+1;if(n<e.length){let r=e[n],i=r[me].firstChild;if(i!==null)return wf(r,i)}return e[Ws]}function PB(t,e,n){let r=Xv(t,e);r&&SB(t,r,e,n)}function ew(t,e,n,r,i,s,o){for(;n!=null;){let a=r[n.index],u=n.type;if(o&&e===0&&(a&&Ys(Or(a),r),n.flags|=2),(n.flags&32)!==32)if(u&8)ew(t,e,n.child,r,i,s,!1),_a(e,t,i,a,s);else if(u&32){let c=Yv(n,r),l;for(;l=c();)_a(e,t,i,l,s);_a(e,t,i,a,s)}else u&16?NB(t,e,r,n,i,s):_a(e,t,i,a,s);n=o?n.projectionNext:n.next}}function $c(t,e,n,r,i,s){ew(n,r,t.firstChild,e,i,s,!1)}function NB(t,e,n,r,i,s){let o=n[hr],u=o[pr].projection[r.projection];if(Array.isArray(u))for(let c=0;c<u.length;c++){let l=u[c];_a(e,t,i,l,s)}else{let c=u,l=o[Nt];px(r)&&(c.flags|=128),ew(t,e,c,l,i,s,!0)}}function OB(t,e,n,r,i){let s=n[Ws],o=Or(n);s!==o&&_a(e,t,r,s,i);for(let a=dn;a<n.length;a++){let u=n[a];$c(u[me],u,t,e,r,s)}}function kB(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=r.indexOf("-")===-1?void 0:gi.DashCase;i==null?t.removeStyle(n,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=gi.Important),t.setStyle(n,r,i,s))}}function FB(t,e,n){t.setAttribute(e,"style",n)}function Cx(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function bx(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&K_(t,e,r),i!==null&&Cx(t,e,i),s!==null&&FB(t,e,s)}var ff;function LB(){if(ff===void 0&&(ff=null,ln.trustedTypes))try{ff=ln.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return ff}function $S(t){return LB()?.createScriptURL(t)||t}var Of=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${aA})`}};function Hc(t){return t instanceof Of?t.changingThisBreaksApplicationSecurity:t}function tw(t,e){let n=VB(t);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${aA})`)}return n===e}function VB(t){return t instanceof Of&&t.getTypeName()||null}var jB=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Tx(t){return t=String(t),t.match(jB)?t:"unsafe:"+t}var Jf=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(Jf||{});function nw(t){let e=Sx();return e?e.sanitize(Jf.URL,t)||"":tw(t,"URL")?Hc(t):Tx(Hf(t))}function UB(t){let e=Sx();if(e)return $S(e.sanitize(Jf.RESOURCE_URL,t)||"");if(tw(t,"ResourceURL"))return $S(Hc(t));throw new z(904,!1)}function BB(t,e){return e==="src"&&(t==="embed"||t==="frame"||t==="iframe"||t==="media"||t==="script")||e==="href"&&(t==="base"||t==="link")?UB:nw}function Dx(t,e,n){return BB(e,n)(t)}function Sx(){let t=We();return t&&t[ba].sanitizer}var $B="h",HB="b";var qB=(t,e,n)=>null;function rw(t,e,n=!1){return qB(t,e,n)}var sv=class{},kf=class{};function GB(t){let e=Error(`No component factory found for ${Jt(t)}.`);return e[zB]=t,e}var zB="ngComponent";var ov=class{resolveComponentFactory(e){throw GB(e)}},ep=(()=>{let e=class e{};e.NULL=new ov;let t=e;return t})();function WB(){return tp(Pn(),We())}function tp(t,e){return new Wi(Kn(t,e))}var Wi=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=WB;let t=e;return t})();var Rc=class{},eo=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>KB();let t=e;return t})();function KB(){let t=We(),e=Pn(),n=Gi(e.index,t);return(Bi(n)?n:t)[Ot]}var QB=(()=>{let e=class e{};e.\u0275prov=B({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),mi=class{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}},iw=new mi("17.0.7"),F_={};function Ff(t,e,n,r,i=!1){for(;n!==null;){let s=e[n.index];s!==null&&r.push(Or(s)),fr(s)&&YB(s,r);let o=n.type;if(o&8)Ff(t,e,n.child,r);else if(o&32){let a=Yv(n,e),u;for(;u=a();)r.push(u)}else if(o&16){let a=Ix(e,n);if(Array.isArray(a))r.push(...a);else{let u=Zv(e[hr]);Ff(u[me],u,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function YB(t,e){for(let n=dn;n<t.length;n++){let r=t[n],i=r[me].firstChild;i!==null&&Ff(r[me],r,i,e)}t[Ws]!==t[yi]&&e.push(t[Ws])}var Ax=[];function ZB(t){return t[zs]??XB(t)}function XB(t){let e=Ax.pop()??Object.create(e$);return e.lView=t,e}function JB(t){t.lView[zs]!==t&&(t.lView=null,Ax.push(t))}var e$=Le(N({},ZD),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{Qf(t.lView)},consumerOnSignalRead(){this.lView[zs]=this}}),t$="ngOriginalError";function L_(t){return t[t$]}var kr=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&L_(e);for(;n&&L_(n);)n=L_(n);return n||null}},xx=new j("",{providedIn:"root",factory:()=>$(kr).handleError.bind(void 0)});var Rx=!1,n$=new j("",{providedIn:"root",factory:()=>Rx});var to={};function oe(t){Mx(Qn(),We(),Js()+t,!1)}function Mx(t,e,n,r){if(!r)if((e[ne]&3)===3){let s=t.preOrderCheckHooks;s!==null&&yf(e,s,n)}else{let s=t.preOrderHooks;s!==null&&_f(e,s,0,n)}Ks(n)}function Y(t,e=we.Default){let n=We();if(n===null)return C(t,e);let r=Pn();return JA(r,n,cn(t),e)}function Px(){let t="invalid";throw new Error(t)}function r$(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)Ks(~i);else{let s=i,o=n[++r],a=n[++r];gU(o,s);let u=e[s];a(2,u)}}}finally{Ks(-1)}}function np(t,e,n,r,i,s,o,a,u,c,l){let d=e.blueprint.slice();return d[yi]=i,d[ne]=r|4|128|8,(c!==null||t&&t[ne]&2048)&&(d[ne]|=2048),PA(d),d[Nt]=d[Pa]=t,d[en]=n,d[ba]=o||t&&t[ba],d[Ot]=a||t&&t[Ot],d[Ca]=u||t&&t[Ca]||null,d[pr]=s,d[Wf]=dB(),d[bc]=l,d[TA]=c,d[hr]=e.type==2?t[hr]:d,d}function rp(t,e,n,r,i){let s=t.data[e];if(s===null)s=i$(t,e,n,r,i),pU()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=cU();s.injectorIndex=o===null?-1:o.injectorIndex}return Fc(s,!0),s}function i$(t,e,n,r,i){let s=LA(),o=VA(),a=o?s:s&&s.parent,u=t.data[e]=c$(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=u),s!==null&&(o?s.child==null&&u.parent!==null&&(s.child=u):s.next===null&&(s.next=u,u.prev=s)),u}function Nx(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function Ox(t,e,n,r,i){let s=Js(),o=r&2;try{Ks(-1),o&&e.length>Wn&&Mx(t,e,Wn,!1),Mr(o?2:0,i),n(r,i)}finally{Ks(s),Mr(o?3:1,i)}}function kx(t,e,n){if(SA(e)){let r=qt(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];a.contentQueries&&a.contentQueries(1,n[o],o)}}finally{qt(r)}}}function Fx(t,e,n){FA()&&(g$(t,e,n,Kn(n,e)),(n.flags&64)===64&&$x(t,e,n))}function Lx(t,e,n=Kn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function Vx(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=sw(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function sw(t,e,n,r,i,s,o,a,u,c,l){let d=Wn+r,h=d+i,f=s$(d,h),p=typeof c=="function"?c():c;return f[me]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:u,consts:p,incompleteFirstPass:!1,ssrId:l}}function s$(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:to);return n}function o$(t,e,n,r){let s=r.get(n$,Rx)||n===Nr.ShadowDom,o=t.selectRootElement(e,s);return a$(o),o}function a$(t){u$(t)}var u$=t=>null;function c$(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return oU()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function HS(t,e,n,r){for(let i in t)if(t.hasOwnProperty(i)){n=n===null?{}:n;let s=t[i];r===null?qS(n,e,i,s):r.hasOwnProperty(i)&&qS(n,e,r[i],s)}return n}function qS(t,e,n,r){t.hasOwnProperty(n)?t[n].push(e,r):t[n]=[e,r]}function l$(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],u=null,c=null;for(let l=r;l<i;l++){let d=s[l],h=n?n.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;u=HS(d.inputs,l,u,f),c=HS(d.outputs,l,c,p);let m=u!==null&&o!==null&&!_A(e)?D$(u,l,o):null;a.push(m)}u!==null&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=c}function d$(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function jx(t,e,n,r,i,s,o,a){let u=Kn(e,n),c=e.inputs,l;!a&&c!=null&&(l=c[r])?(ow(t,n,l,r,i),Kf(e)&&h$(n,e.index)):e.type&3?(r=d$(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(u,r,i)):e.type&12}function h$(t,e){let n=Gi(e,t);n[ne]&16||(n[ne]|=64)}function Ux(t,e,n,r){if(FA()){let i=r===null?null:{"":-1},s=y$(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&Bx(t,e,n,o,i,a),i&&_$(n,r,i)}n.mergedAttrs=Cc(n.mergedAttrs,n.attrs)}function Bx(t,e,n,r,i,s){for(let c=0;c<r.length;c++)X_(xf(n,e),t,r[c].type);w$(n,t.data.length,r.length);for(let c=0;c<r.length;c++){let l=r[c];l.providersResolver&&l.providersResolver(l)}let o=!1,a=!1,u=Nx(t,e,r.length,null);for(let c=0;c<r.length;c++){let l=r[c];n.mergedAttrs=Cc(n.mergedAttrs,l.hostAttrs),E$(t,n,e,u,l),v$(u,l,i),l.contentQueries!==null&&(n.flags|=4),(l.hostBindings!==null||l.hostAttrs!==null||l.hostVars!==0)&&(n.flags|=64);let d=l.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),u++}l$(t,n,s)}function f$(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;p$(o)!=a&&o.push(a),o.push(n,r,s)}}function p$(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function g$(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;Kf(n)&&I$(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||xf(n,e),Ys(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let u=t.data[a],c=Sa(e,t,a,n);if(Ys(c,e),o!==null&&T$(e,a-i,c,u,n,o),Hi(u)){let l=Gi(n.index,e);l[en]=Sa(e,t,a,n)}}}function $x(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=mU();try{Ks(s);for(let a=r;a<i;a++){let u=t.data[a],c=e[a];Y_(a),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&m$(u,c)}}finally{Ks(-1),Y_(o)}}function m$(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function y$(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(Lj(e,o.selectors,!1))if(r||(r=[]),Hi(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let u=a.length;av(t,e,u)}else r.unshift(o),av(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function av(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function _$(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new z(-301,!1);r.push(e[i],s)}}}function v$(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;Hi(e)&&(n[""]=t)}}function w$(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function E$(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=Da(i.type,!0)),o=new Qs(s,Hi(i),Y);t.blueprint[r]=o,n[r]=o,f$(t,e,r,Nx(t,n,i.hostVars,to),i)}function I$(t,e,n){let r=Kn(e,t),i=Vx(n),s=t[ba].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=ip(t,np(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function C$(t,e,n,r,i,s){let o=Kn(t,e);b$(e[Ot],o,s,t.value,n,r,i)}function b$(t,e,n,r,i,s,o){if(s==null)t.removeAttribute(e,i,n);else{let a=o==null?Hf(s):o(s,r||"",i);t.setAttribute(e,i,a,n)}}function T$(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let u=o[a++],c=o[a++],l=o[a++];Hx(r,n,u,c,l)}}function Hx(t,e,n,r,i){let s=qt(null);try{let o=t.inputTransforms;o!==null&&o.hasOwnProperty(r)&&(i=o[r].call(e,i)),t.setInput!==null?t.setInput(e,i,n,r):e[r]=i}finally{qt(s)}}function D$(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){r.push(s,o[a+1],n[i+1]);break}}i+=2}return r}function qx(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function Gx(t,e){let n=t.contentQueries;if(n!==null){let r=qt(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];jA(s),a.contentQueries(2,e[o],o)}}}finally{qt(r)}}}function ip(t,e){return t[Dc]?t[PS][dr]=e:t[Dc]=e,t[PS]=e,e}function uv(t,e,n){jA(0);let r=qt(null);try{e(t,n)}finally{qt(r)}}function S$(t){return t[Tc]||(t[Tc]=[])}function A$(t){return t.cleanup||(t.cleanup=[])}function zx(t,e){let n=t[Ca],r=n?n.get(kr,null):null;r&&r.handleError(e)}function ow(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],u=e[o],c=t.data[o];Hx(c,u,r,a,i)}}function x$(t,e,n){let r=MA(e,t);mB(t[Ot],r,n)}var R$=100;function M$(t,e=!0){let n=t[ba],r=n.rendererFactory,i=n.afterRenderEventManager,s=!1;s||(r.begin?.(),i?.begin());try{P$(t)}catch(o){throw e&&zx(t,o),o}finally{s||(r.end?.(),n.inlineEffectRunner?.flush(),i?.end())}}function P$(t){cv(t,0);let e=0;for(;NA(t);){if(e===R$)throw new z(103,!1);e++,cv(t,1)}}function N$(t,e,n,r){let i=e[ne];if((i&256)===256)return;let s=!1;!s&&e[ba].inlineEffectRunner?.flush(),Lv(e);let o=null,a=null;!s&&O$(t)&&(a=ZB(e),o=XD(a));try{PA(e),hU(t.bindingStartIndex),n!==null&&Ox(t,e,n,2,r);let u=(i&3)===3;if(!s)if(u){let d=t.preOrderCheckHooks;d!==null&&yf(e,d,null)}else{let d=t.preOrderHooks;d!==null&&_f(e,d,0,null),M_(e,0)}if(k$(e),Wx(e,0),t.contentQueries!==null&&Gx(t,e),!s)if(u){let d=t.contentCheckHooks;d!==null&&yf(e,d)}else{let d=t.contentHooks;d!==null&&_f(e,d,1),M_(e,1)}r$(t,e);let c=t.components;c!==null&&Qx(e,c,0);let l=t.viewQuery;if(l!==null&&uv(2,l,r),!s)if(u){let d=t.viewCheckHooks;d!==null&&yf(e,d)}else{let d=t.viewHooks;d!==null&&_f(e,d,2),M_(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[R_]){for(let d of e[R_])d();e[R_]=null}s||(e[ne]&=-73)}catch(u){throw Qf(e),u}finally{a!==null&&(JD(a,o),JB(a)),Vv()}}function O$(t){return t.type!==2}function Wx(t,e){for(let n=mx(t);n!==null;n=yx(n)){n[ne]&=~Ta.HasChildViewsToRefresh;for(let r=dn;r<n.length;r++){let i=n[r];Kx(i,e)}}}function k$(t){for(let e=mx(t);e!==null;e=yx(e)){if(!(e[ne]&Ta.HasTransplantedViews))continue;let n=e[Tf];for(let r=0;r<n.length;r++){let i=n[r],s=i[Nt];eU(i)}}}function F$(t,e,n){let r=Gi(e,t);Kx(r,n)}function Kx(t,e){Fv(t)&&cv(t,e)}function cv(t,e){let r=t[me],i=t[ne],s=t[zs],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&a_(s)),s&&(s.dirty=!1),t[ne]&=-9217,o)N$(r,t,r.template,t[en]);else if(i&8192){Wx(t,1);let a=r.components;a!==null&&Qx(t,a,1)}}function Qx(t,e,n){for(let r=0;r<e.length;r++)F$(t,e[r],n)}function aw(t){for(;t;){t[ne]|=64;let e=Zv(t);if(zj(t)&&!e)return t;t=e}return null}var Zs=class{get rootNodes(){let e=this._lView,n=e[me];return Ff(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[en]}set context(e){this._lView[en]=e}get destroyed(){return(this._lView[ne]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Nt];if(fr(e)){let n=e[bf],r=n?n.indexOf(this):-1;r>-1&&(xc(e,r),Rf(n,r))}this._attachedToViewContainer=!1}Xf(this._lView[me],this._lView)}onDestroy(e){kA(this._lView,e)}markForCheck(){aw(this._cdRefInjectingView||this._lView)}detach(){this._lView[ne]&=-129}reattach(){OA(this._lView),this._lView[ne]|=128}detectChanges(){this._lView[ne]|=1024,M$(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new z(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,vB(this._lView[me],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new z(902,!1);this._appRef=e}},no=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=L$;let t=e;return t})();function L$(t){return V$(Pn(),We(),(t&16)===16)}function V$(t,e,n){if(Kf(t)&&!n){let r=Gi(t.index,e);return new Zs(r,r)}else if(t.type&47){let r=e[hr];return new Zs(r,e)}return null}var Yx=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=j$,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),lv=class extends Yx{constructor(e){super(),this._lView=e}onDestroy(e){return kA(this._lView,e),()=>nU(this._lView,e)}};function j$(){return new lv(We())}var GS=new Set;function qc(t){GS.has(t)||(GS.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}var dv=class extends Tt{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=V_(s),i&&(i=V_(i)),o&&(o=V_(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof bt&&e.add(a),a}};function V_(t){return e=>{setTimeout(t,void 0,e)}}var it=dv;function zS(...t){}function U$(){let t=typeof ln.requestAnimationFrame=="function",e=ln[t?"requestAnimationFrame":"setTimeout"],n=ln[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var ge=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new it(!1),this.onMicrotaskEmpty=new it(!1),this.onStable=new it(!1),this.onError=new it(!1),typeof Zone>"u")throw new z(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=U$().nativeRequestAnimationFrame,H$(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new z(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new z(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,B$,zS,zS);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},B$={};function uw(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function $$(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(ln,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,hv(t),t.isCheckStableRunning=!0,uw(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),hv(t))}function H$(t){let e=()=>{$$(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(q$(a))return n.invokeTask(i,s,o,a);try{return WS(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),KS(t)}},onInvoke:(n,r,i,s,o,a,u)=>{try{return WS(t),n.invoke(i,s,o,a,u)}finally{t.shouldCoalesceRunChangeDetection&&e(),KS(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,hv(t),uw(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function hv(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function WS(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function KS(t){t._nesting--,uw(t)}var fv=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new it,this.onMicrotaskEmpty=new it,this.onStable=new it,this.onError=new it}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}},Zx=new j("",{providedIn:"root",factory:Xx});function Xx(){let t=$(ge),e=!0,n=new se(i=>{e=t.isStable&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks,t.runOutsideAngular(()=>{i.next(e),i.complete()})}),r=new se(i=>{let s;t.runOutsideAngular(()=>{s=t.onStable.subscribe(()=>{ge.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks&&(e=!0,i.next(!0))})})});let o=t.onUnstable.subscribe(()=>{ge.assertInAngularZone(),e&&(e=!1,t.runOutsideAngular(()=>{i.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}});return Fi(n,r.pipe(Hs()))}function q$(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}function G$(t="zone.js",e){return t==="noop"?new fv:t==="zone.js"?new ge(e):t}var va=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(va||{}),z$={destroy(){}};function cw(t,e){!e&&oB(cw);let n=e?.injector??$(Yn);if(!cB(n))return z$;qc("NgAfterNextRender");let r=n.get(Jx),i=r.handler??=new gv,s=e?.phase??va.MixedReadWrite,o=()=>{i.unregister(u),a()},a=n.get(Yx).onDestroy(o),u=new pv(n,s,()=>{o(),t()});return i.register(u),{destroy:o}}var pv=class{constructor(e,n,r){this.phase=n,this.callbackFn=r,this.zone=e.get(ge),this.errorHandler=e.get(kr,null,{optional:!0})}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},gv=class{constructor(){this.executingCallbacks=!1,this.buckets={[va.EarlyRead]:new Set,[va.Write]:new Set,[va.MixedReadWrite]:new Set,[va.Read]:new Set},this.deferredCallbacks=new Set}validateBegin(){if(this.executingCallbacks)throw new z(102,!1)}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let n of e)n.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},Jx=(()=>{let e=class e{constructor(){this.renderDepth=0,this.handler=null,this.internalCallbacks=[]}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){if(this.renderDepth--,this.renderDepth===0){for(let r of this.internalCallbacks)r();this.internalCallbacks.length=0,this.handler?.execute()}}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=B({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function W$(t,e){let n=Gi(e,t),r=n[me];K$(r,n);let i=n[yi];i!==null&&n[bc]===null&&(n[bc]=rw(i,n[Ca])),lw(r,n,n[en])}function K$(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function lw(t,e,n){Lv(e);try{let r=t.viewQuery;r!==null&&uv(1,r,n);let i=t.template;i!==null&&Ox(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&Gx(t,e),t.staticViewQueries&&uv(2,t.viewQuery,n);let s=t.components;s!==null&&Q$(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[ne]&=-5,Vv()}}function Q$(t,e){for(let n=0;n<e.length;n++)W$(t,e[n])}function mv(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=IS(i,a);else if(s==2){let u=a,c=e[++o];r=IS(r,u+": "+c+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var Lf=class extends ep{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=$i(e);return new xa(n,this.ngModule)}};function QS(t){let e=[];for(let n in t)if(t.hasOwnProperty(n)){let r=t[n];e.push({propName:r,templateName:n})}return e}function Y$(t){let e=t.toLowerCase();return e==="svg"?Yj:e==="math"?Zj:null}var yv=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=Gf(r);let i=this.injector.get(e,F_,r);return i!==F_||n===F_?i:this.parentInjector.get(e,n,r)}},xa=class extends kf{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=QS(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return QS(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=Bj(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){i=i||this.ngModule;let s=i instanceof Mn?i:i?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let o=s?new yv(e,s):e,a=o.get(Rc,null);if(a===null)throw new z(407,!1);let u=o.get(QB,null),c=o.get(Jx,null),l={rendererFactory:a,sanitizer:u,inlineEffectRunner:null,afterRenderEventManager:c},d=a.createRenderer(null,this.componentDef),h=this.componentDef.selectors[0][0]||"div",f=r?o$(d,r,this.componentDef.encapsulation,o):vx(d,h,Y$(h)),p=4608,m=this.componentDef.onPush?576:528,g=this.componentDef.signals?p:m,_=null;f!==null&&(_=rw(f,o,!0));let y=sw(0,null,null,1,0,null,null,null,null,null,null),v=np(null,y,null,g,null,null,l,d,o,null,_);Lv(v);let S,F;try{let x=this.componentDef,M,P=null;x.findHostDirectiveDefs?(M=[],P=new Map,x.findHostDirectiveDefs(x,M,P),M.push(x)):M=[x];let K=Z$(v,f),he=X$(K,f,x,M,v,l,d);F=kv(y,Wn),f&&tH(d,x,f,r),n!==void 0&&nH(F,this.ngContentSelectors,n),S=eH(he,x,M,P,v,[rH]),lw(y,v,null)}finally{Vv()}return new _v(this.componentType,S,tp(F,v),v,F)}},_v=class extends sv{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new Zs(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;ow(s[me],s,i,e,n),this.previousInputValues.set(e,n);let o=Gi(this._tNode.index,s);aw(o)}}get injector(){return new Gs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function Z$(t,e){let n=t[me],r=Wn;return t[r]=e,rp(n,r,2,"#host",null)}function X$(t,e,n,r,i,s,o){let a=i[me];J$(r,t,e,o);let u=null;e!==null&&(u=rw(e,i[Ca]));let c=s.rendererFactory.createRenderer(e,n),l=16;n.signals?l=4096:n.onPush&&(l=64);let d=np(i,Vx(n),null,l,i[t.index],t,s,c,null,null,u);return a.firstCreatePass&&av(a,t,r.length-1),ip(i,d),i[t.index]=d}function J$(t,e,n,r){for(let i of t)e.mergedAttrs=Cc(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(mv(e,e.mergedAttrs,!0),n!==null&&bx(r,n,e))}function eH(t,e,n,r,i,s){let o=Pn(),a=i[me],u=Kn(o,i);Bx(a,i,o,n,null,r);for(let l=0;l<n.length;l++){let d=o.directiveStart+l,h=Sa(i,a,d,o);Ys(h,i)}$x(a,i,o),u&&Ys(u,i);let c=Sa(i,a,o.directiveStart+o.componentOffset,o);if(t[en]=i[en]=c,s!==null)for(let l of s)l(c,e);return kx(a,o,t),c}function tH(t,e,n,r){if(r)K_(t,n,["ng-version",iw.full]);else{let{attrs:i,classes:s}=$j(e.selectors[0]);i&&K_(t,n,i),s&&s.length>0&&Cx(t,n,s.join(" "))}}function nH(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function rH(){let t=Pn();$v(We()[me],t)}function iH(t){return Object.getPrototypeOf(t.prototype).constructor}function Ki(t){let e=iH(t.type),n=!0,r=[t];for(;e;){let i;if(Hi(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new z(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let o=t;o.inputs=pf(t.inputs),o.inputTransforms=pf(t.inputTransforms),o.declaredInputs=pf(t.declaredInputs),o.outputs=pf(t.outputs);let a=i.hostBindings;a&&uH(t,a);let u=i.viewQuery,c=i.contentQueries;if(u&&oH(t,u),c&&aH(t,c),df(t.inputs,i.inputs),df(t.declaredInputs,i.declaredInputs),df(t.outputs,i.outputs),i.inputTransforms!==null&&(o.inputTransforms===null&&(o.inputTransforms={}),df(o.inputTransforms,i.inputTransforms)),Hi(i)&&i.data.animation){let l=t.data;l.animation=(l.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(t),a===Ki&&(n=!1)}}e=Object.getPrototypeOf(e)}sH(r)}function sH(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Cc(i.hostAttrs,n=Cc(n,i.hostAttrs))}}function pf(t){return t===Ia?{}:t===zn?[]:t}function oH(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function aH(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,s)=>{e(r,i,s),n(r,i,s)}:t.contentQueries=e}function uH(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}function dw(t){let e=t.inputConfig,n={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[2]&&(n[r]=i[2])}t.inputTransforms=n}function Na(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function sp(t,e,n,r){let i=We(),s=Lc();if(Na(i,s,e)){let o=Qn(),a=jv();C$(a,i,t,e,n,r)}return sp}function eR(t,e,n,r){return Na(t,Lc(),n)?e+Hf(n)+r:to}function gf(t,e){return t<<17|e<<2}function Xs(t){return t>>17&32767}function cH(t){return(t&2)==2}function lH(t,e){return t&131071|e<<17}function vv(t){return t|2}function Ra(t){return(t&131068)>>2}function j_(t,e){return t&-131069|e<<2}function dH(t){return(t&1)===1}function wv(t){return t|1}function hH(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=Xs(o),u=Ra(o);t[r]=n;let c=!1,l;if(Array.isArray(n)){let d=n;l=d[1],(l===null||jc(d,l)>0)&&(c=!0)}else l=n;if(i)if(u!==0){let h=Xs(t[a+1]);t[r+1]=gf(h,a),h!==0&&(t[h+1]=j_(t[h+1],r)),t[a+1]=lH(t[a+1],r)}else t[r+1]=gf(a,0),a!==0&&(t[a+1]=j_(t[a+1],r)),a=r;else t[r+1]=gf(u,0),a===0?a=r:t[u+1]=j_(t[u+1],r),u=r;c&&(t[r+1]=vv(t[r+1])),YS(t,l,r,!0,s),YS(t,l,r,!1,s),fH(e,l,t,r,s),o=gf(a,u),s?e.classBindings=o:e.styleBindings=o}function fH(t,e,n,r,i){let s=i?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&jc(s,e)>=0&&(n[r+1]=wv(n[r+1]))}function YS(t,e,n,r,i){let s=t[n+1],o=e===null,a=r?Xs(s):Ra(s),u=!1;for(;a!==0&&(u===!1||o);){let c=t[a],l=t[a+1];pH(c,e)&&(u=!0,t[a+1]=r?wv(l):vv(l)),a=r?Xs(l):Ra(l)}u&&(t[n+1]=r?vv(s):wv(s))}function pH(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?jc(t,e)>=0:!1}function Ve(t,e,n){let r=We(),i=Lc();if(Na(r,i,e)){let s=Qn(),o=jv();jx(s,o,r,t,e,r[Ot],n,!1)}return Ve}function ZS(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";ow(t,n,s[o],o,r)}function Qi(t,e){return gH(t,e,null,!0),Qi}function gH(t,e,n,r){let i=We(),s=Qn(),o=fU(2);if(s.firstUpdatePass&&yH(s,t,o,r),e!==to&&Na(i,o,e)){let a=s.data[Js()];IH(s,a,i,i[Ot],t,i[o+1]=CH(e,n),r,o)}}function mH(t,e){return e>=t.expandoStartIndex}function yH(t,e,n,r){let i=t.data;if(i[n+1]===null){let s=i[Js()],o=mH(t,n);bH(s,r)&&e===null&&!o&&(e=!1),e=_H(i,s,e,r),hH(i,s,e,n,o,r)}}function _H(t,e,n,r){let i=yU(t),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=U_(null,t,e,n,r),n=Mc(n,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==i)if(n=U_(i,t,e,n,r),s===null){let u=vH(t,e,r);u!==void 0&&Array.isArray(u)&&(u=U_(null,t,e,u[1],r),u=Mc(u,e.attrs,r),wH(t,e,r,u))}else s=EH(t,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),n}function vH(t,e,n){let r=n?e.classBindings:e.styleBindings;if(Ra(r)!==0)return t[Xs(r)]}function wH(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[Xs(i)]=r}function EH(t,e,n){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=t[s].hostAttrs;r=Mc(r,o,n)}return Mc(r,e.attrs,n)}function U_(t,e,n,r,i){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],r=Mc(r,s.hostAttrs,i),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function Mc(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),BU(t,o,n?!0:e[++s]))}return t===void 0?null:t}function IH(t,e,n,r,i,s,o,a){if(!(e.type&3))return;let u=t.data,c=u[a+1],l=dH(c)?XS(u,e,n,i,Ra(c),o):void 0;if(!Vf(l)){Vf(s)||cH(c)&&(s=XS(u,null,n,i,a,o));let d=MA(Js(),n);kB(r,o,d,i,s)}}function XS(t,e,n,r,i,s){let o=e===null,a;for(;i>0;){let u=t[i],c=Array.isArray(u),l=c?u[1]:u,d=l===null,h=n[i+1];h===to&&(h=d?zn:void 0);let f=d?N_(h,r):l===r?h:void 0;if(c&&!Vf(f)&&(f=N_(u,r)),Vf(f)&&(a=f,o))return a;let p=t[i+1];i=o?Xs(p):Ra(p)}if(e!==null){let u=s?e.residualClasses:e.residualStyles;u!=null&&(a=N_(u,r))}return a}function Vf(t){return t!==void 0}function CH(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=Jt(Hc(t)))),t}function bH(t,e){return(t.flags&(e?8:16))!==0}var hne=new RegExp(`^(\\d+)*(${HB}|${$B})*(.*)`);var TH=(t,e)=>null;function Pc(t,e){return TH(t,e)}var Ev=class{destroy(e){}updateValue(e,n){}swap(e,n){let r=Math.min(e,n),i=Math.max(e,n),s=this.detach(i);if(i-r>1){let o=this.detach(r);this.attach(r,s),this.attach(i,o)}else this.attach(r,s)}move(e,n){this.attach(n,this.detach(e))}};function B_(t,e,n,r,i){return t===n&&Object.is(e,r)?1:Object.is(i(t,e),i(n,r))?-1:0}function DH(t,e,n){let r,i,s=0,o=t.length-1;if(Array.isArray(e)){let a=e.length-1;for(;s<=o&&s<=a;){let u=t.at(s),c=e[s],l=B_(s,u,s,c,n);if(l!==0){l<0&&t.updateValue(s,c),s++;continue}let d=t.at(o),h=e[a],f=B_(o,d,a,h,n);if(f!==0){f<0&&t.updateValue(o,h),o--,a--;continue}let p=n(s,u),m=n(o,d),g=n(s,c);if(Object.is(g,m)){let _=n(a,h);Object.is(_,p)?(t.swap(s,o),t.updateValue(o,h),a--,o--):t.move(o,s),t.updateValue(s,c),s++;continue}if(r??=new jf,i??=eA(t,s,o,n),Iv(t,r,s,g))t.updateValue(s,c),s++,o++;else if(i.has(g))r.set(p,t.detach(s)),o--;else{let _=t.create(s,e[s]);t.attach(s,_),s++,o++}}for(;s<=a;)JS(t,r,n,s,e[s]),s++}else if(e!=null){let a=e[Symbol.iterator](),u=a.next();for(;!u.done&&s<=o;){let c=t.at(s),l=u.value,d=B_(s,c,s,l,n);if(d!==0)d<0&&t.updateValue(s,l),s++,u=a.next();else{r??=new jf,i??=eA(t,s,o,n);let h=n(s,l);if(Iv(t,r,s,h))t.updateValue(s,l),s++,o++,u=a.next();else if(!i.has(h))t.attach(s,t.create(s,l)),s++,o++,u=a.next();else{let f=n(s,c);r.set(f,t.detach(s)),o--}}}for(;!u.done;)JS(t,r,n,t.length,u.value),u=a.next()}for(;s<=o;)t.destroy(t.detach(o--));r?.forEach(a=>{t.destroy(a)})}function Iv(t,e,n,r){return e!==void 0&&e.has(r)?(t.attach(n,e.get(r)),e.delete(r),!0):!1}function JS(t,e,n,r,i){if(Iv(t,e,r,n(r,i)))t.updateValue(r,i);else{let s=t.create(r,i);t.attach(r,s)}}function eA(t,e,n,r){let i=new Set;for(let s=e;s<=n;s++)i.add(r(s,t.at(s)));return i}var jf=class{constructor(){this.kvMap=new Map,this._vMap=void 0}has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let n=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(n)?(this.kvMap.set(e,this._vMap.get(n)),this._vMap.delete(n)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,n){if(this.kvMap.has(e)){let r=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let i=this._vMap;for(;i.has(r);)r=i.get(r);i.set(r,n)}else this.kvMap.set(e,n)}forEach(e){for(let[n,r]of this.kvMap)if(e(r,n),this._vMap!==void 0){let i=this._vMap;for(;i.has(r);)r=i.get(r),e(r,n)}}};function op(t,e,n,r){let i=e.tView,o=t[ne]&4096?4096:16,a=np(t,i,n,o,null,e,null,null,null,r?.injector??null,r?.dehydratedView??null),u=t[e.index];a[zf]=u;let c=t[Sc];return c!==null&&(a[Sc]=c.createEmbeddedView(i)),lw(i,a,n),a}function tR(t,e){let n=dn+e;if(n<t.length)return t[n]}function Nc(t,e){return!e||e.firstChild===null||px(t)}function ap(t,e,n,r=!0){let i=e[me];if(EB(i,e,t,n),r){let o=iv(n,t),a=e[Ot],u=Xv(a,t[Ws]);u!==null&&_B(i,t[pr],a,e,u,o)}let s=e[bc];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function nR(t,e){let n=xc(t,e);return n!==void 0&&Xf(n[me],n),n}var Gc=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=SH;let t=e;return t})();function SH(){let t=Pn();return xH(t,We())}var AH=Gc,rR=class extends AH{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return tp(this._hostTNode,this._hostLView)}get injector(){return new Gs(this._hostTNode,this._hostLView)}get parentInjector(){let e=Hv(this._hostTNode,this._hostLView);if(WA(e)){let n=Af(e,this._hostLView),r=Sf(e),i=n[me].data[r+8];return new Gs(i,n)}else return new Gs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=tA(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-dn}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=Pc(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,Nc(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!VU(e),a;if(o)a=n;else{let p=n||{};a=p.index,r=p.injector,i=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let u=o?e:new xa($i(e)),c=r||this.parentInjector;if(!s&&u.ngModule==null){let m=(o?c:this.parentInjector).get(Mn,null);m&&(s=m)}let l=$i(u.componentType??{}),d=Pc(this._lContainer,l?.id??null),h=d?.firstChild??null,f=u.create(c,i,h,s);return this.insertImpl(f.hostView,a,Nc(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(Jj(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let u=i[Nt],c=new rR(u,u[pr],u[Nt]);c.detach(c.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return ap(o,i,s,r),e.attachToViewContainerRef(),rx($_(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=tA(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=xc(this._lContainer,n);r&&(Rf($_(this._lContainer),n),Xf(r[me],r))}detach(e){let n=this._adjustIndex(e,-1),r=xc(this._lContainer,n);return r&&Rf($_(this._lContainer),n)!=null?new Zs(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function tA(t){return t[bf]}function $_(t){return t[bf]||(t[bf]=[])}function xH(t,e){let n,r=e[t.index];return fr(r)?n=r:(n=qx(r,e,null,t),e[t.index]=n,ip(e,n)),MH(n,e,t,r),new rR(n,t,e)}function RH(t,e){let n=t[Ot],r=n.createComment(""),i=Kn(e,t),s=Xv(n,i);return Nf(n,s,r,AB(n,i),!1),r}var MH=OH,PH=(t,e,n)=>!1;function NH(t,e,n){return PH(t,e,n)}function OH(t,e,n,r){if(t[Ws])return;let i;n.type&8?i=Or(r):i=RH(e,n),t[Ws]=i}function kH(t,e,n,r,i,s,o,a,u){let c=e.consts,l=rp(e,t,4,o||null,Df(c,a));Ux(e,n,l,Df(c,u)),$v(e,l);let d=l.tView=sw(2,l,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return e.queries!==null&&(e.queries.template(e,l),d.queries=e.queries.embeddedTView(l)),l}function hn(t,e,n,r,i,s,o,a){let u=We(),c=Qn(),l=t+Wn,d=c.firstCreatePass?kH(l,c,u,e,n,r,i,s,o):c.data[l];Fc(d,!1);let h=FH(c,u,d,t);Uv()&&Jv(c,u,h,d),Ys(h,u);let f=qx(h,u,h,d);return u[l]=f,ip(u,f),NH(f,d,u),Ov(d)&&Fx(c,u,d),o!=null&&Lx(u,d,a),hn}var FH=LH;function LH(t,e,n,r){return Bv(!0),e[Ot].createComment("")}function Yi(t,e,n){qc("NgControlFlow");let r=We(),i=Lc(),s=Dv(r,Wn+t),o=0;if(Na(r,i,e)){let a=qt(null);try{if(nR(s,o),e!==-1){let u=Sv(r[me],Wn+e),c=Pc(s,u.tView.ssrId),l=op(r,u,n,{dehydratedView:c});ap(s,l,o,Nc(u,c))}}finally{qt(a)}}else{let a=tR(s,o);a!==void 0&&(a[en]=n)}}var Cv=class{constructor(e,n,r){this.lContainer=e,this.$implicit=n,this.$index=r}get $count(){return this.lContainer.length-dn}};var bv=class{constructor(e,n,r){this.hasEmptyBlock=e,this.trackByFn=n,this.liveCollection=r}};function up(t,e,n,r,i,s,o,a,u,c,l){qc("NgControlFlow");let d=u!==void 0,h=We(),f=a?o.bind(h[hr][en]):o,p=new bv(d,f);h[Wn+t]=p,hn(t+1,e,n,r,i,s),d&&hn(t+2,u,c,l)}var Tv=class extends Ev{constructor(e,n,r){super(),this.lContainer=e,this.hostLView=n,this.templateTNode=r,this.needsIndexUpdate=!1}get length(){return this.lContainer.length-dn}at(e){return this.getLView(e)[en].$implicit}attach(e,n){let r=n[bc];this.needsIndexUpdate||=e!==this.length,ap(this.lContainer,n,e,Nc(this.templateTNode,r))}detach(e){return this.needsIndexUpdate||=e!==this.length-1,VH(this.lContainer,e)}create(e,n){let r=Pc(this.lContainer,this.templateTNode.tView.ssrId);return op(this.hostLView,this.templateTNode,new Cv(this.lContainer,n,e),{dehydratedView:r})}destroy(e){Xf(e[me],e)}updateValue(e,n){this.getLView(e)[en].$implicit=n}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[en].$index=e}getLView(e){return jH(this.lContainer,e)}};function cp(t){let e=qt(null),n=Js();try{let r=We(),i=r[me],s=r[n];if(s.liveCollection===void 0){let a=n+1,u=Dv(r,a),c=Sv(i,a);s.liveCollection=new Tv(u,r,c)}else s.liveCollection.reset();let o=s.liveCollection;if(DH(o,t,s.trackByFn),o.updateIndexes(),s.hasEmptyBlock){let a=Lc(),u=o.length===0;if(Na(r,a,u)){let c=n+2,l=Dv(r,c);if(u){let d=Sv(i,c),h=Pc(l,d.tView.ssrId),f=op(r,d,void 0,{dehydratedView:h});ap(l,f,0,Nc(d,h))}else nR(l,0)}}}finally{qt(e)}}function Dv(t,e){return t[e]}function VH(t,e){return xc(t,e)}function jH(t,e){return tR(t,e)}function Sv(t,e){return kv(t,e)}function UH(t,e,n,r,i,s){let o=e.consts,a=Df(o,i),u=rp(e,t,2,r,a);return Ux(e,n,u,Df(o,s)),u.attrs!==null&&mv(u,u.attrs,!1),u.mergedAttrs!==null&&mv(u,u.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,u),u}function b(t,e,n,r){let i=We(),s=Qn(),o=Wn+t,a=i[Ot],u=s.firstCreatePass?UH(o,s,i,e,n,r):s.data[o],c=BH(s,i,u,a,e,t);i[o]=c;let l=Ov(u);return Fc(u,!0),bx(a,c,u),(u.flags&32)!==32&&Uv()&&Jv(s,i,c,u),rU()===0&&Ys(c,i),iU(),l&&(Fx(s,i,u),kx(s,u,i)),r!==null&&Lx(i,u),b}function T(){let t=Pn();VA()?lU():(t=t.parent,Fc(t,!1));let e=t;aU(e)&&uU(),sU();let n=Qn();return n.firstCreatePass&&($v(n,t),SA(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&bU(e)&&ZS(n,e,We(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&TU(e)&&ZS(n,e,We(),e.stylesWithoutHost,!1),T}function je(t,e,n,r){return b(t,e,n,r),T(),je}var BH=(t,e,n,r,i,s)=>(Bv(!0),vx(r,i,wU()));function tn(){return We()}var Uf="en-US";var $H=Uf;function HH(t){vj(t,"Expected localeId to be defined"),typeof t=="string"&&($H=t.toLowerCase().replace(/_/g,"-"))}function ro(t){return!!t&&typeof t.then=="function"}function iR(t){return!!t&&typeof t.subscribe=="function"}function re(t,e,n,r){let i=We(),s=Qn(),o=Pn();return GH(s,i,i[Ot],o,t,e,r),re}function qH(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[Tc],u=i[s+2];return a.length>u?a[u]:null}typeof o=="string"&&(s+=2)}return null}function GH(t,e,n,r,i,s,o){let a=Ov(r),c=t.firstCreatePass&&A$(t),l=e[en],d=S$(e),h=!0;if(r.type&3||o){let m=Kn(r,e),g=o?o(m):m,_=d.length,y=o?S=>o(Or(S[r.index])):r.index,v=null;if(!o&&a&&(v=qH(t,e,i,r.index)),v!==null){let S=v.__ngLastListenerFn__||v;S.__ngNextListenerFn__=s,v.__ngLastListenerFn__=s,h=!1}else{s=rA(r,e,l,s,!1);let S=n.listen(g,i,s);d.push(s,S),c&&c.push(i,y,_,_+1)}}else s=rA(r,e,l,s,!1);let f=r.outputs,p;if(h&&f!==null&&(p=f[i])){let m=p.length;if(m)for(let g=0;g<m;g+=2){let _=p[g],y=p[g+1],F=e[_][y].subscribe(s),x=d.length;d.push(s,F),c&&c.push(i,r.index,x,-(x+1))}}}function nA(t,e,n,r){try{return Mr(6,e,n),n(r)!==!1}catch(i){return zx(t,i),!1}finally{Mr(7,e,n)}}function rA(t,e,n,r,i){return function s(o){if(o===Function)return r;let a=t.componentOffset>-1?Gi(t.index,e):e;aw(a);let u=nA(e,n,r,o),c=s.__ngNextListenerFn__;for(;c;)u=nA(e,n,c,o)&&u,c=c.__ngNextListenerFn__;return i&&u===!1&&o.preventDefault(),u}}function Me(t=1){return vU(t)}function lp(t,e,n){return sR(t,"",e,"",n),lp}function sR(t,e,n,r,i){let s=We(),o=eR(s,e,n,r);if(o!==to){let a=Qn(),u=jv();jx(a,u,s,t,o,s[Ot],i,!1)}return sR}function Zi(t){let e=dU();return Xj(e,Wn+t)}function O(t,e=""){let n=We(),r=Qn(),i=t+Wn,s=r.firstCreatePass?rp(r,i,1,e,null):r.data[i],o=zH(r,n,s,e,t);n[i]=o,Uv()&&Jv(r,n,o,s),Fc(s,!1)}var zH=(t,e,n,r,i)=>(Bv(!0),gB(e[Ot],r));function Fr(t){return Oa("",t,""),Fr}function Oa(t,e,n){let r=We(),i=eR(r,t,e,n);return i!==to&&x$(r,Js(),i),Oa}function WH(t,e,n){let r=Qn();if(r.firstCreatePass){let i=Hi(t);Av(n,r.data,r.blueprint,i,!0),Av(e,r.data,r.blueprint,i,!1)}}function Av(t,e,n,r,i){if(t=cn(t),Array.isArray(t))for(let s=0;s<t.length;s++)Av(t[s],e,n,r,i);else{let s=Qn(),o=We(),a=Pn(),u=Aa(t)?t:cn(t.provide),c=lx(t),l=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(Aa(t)||!t.multi){let f=new Qs(c,i,Y),p=q_(u,e,i?l:l+h,d);p===-1?(X_(xf(a,o),s,u),H_(s,t,e.length),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(f),o.push(f)):(n[p]=f,o[p]=f)}else{let f=q_(u,e,l+h,d),p=q_(u,e,l,l+h),m=f>=0&&n[f],g=p>=0&&n[p];if(i&&!g||!i&&!m){X_(xf(a,o),s,u);let _=YH(i?QH:KH,n.length,i,r,c);!i&&g&&(n[p].providerFactory=_),H_(s,t,e.length,0),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(_),o.push(_)}else{let _=oR(n[i?p:f],c,!i&&r);H_(s,t,f>-1?f:p,_)}!i&&r&&g&&n[p].componentProviders++}}}function H_(t,e,n,r){let i=Aa(e),s=JU(e);if(i||s){let u=(s?cn(e.useClass):e).prototype.ngOnDestroy;if(u){let c=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let l=c.indexOf(n);l===-1?c.push(n,[r,u]):c[l+1].push(r,u)}else c.push(n,u)}}}function oR(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function q_(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function KH(t,e,n,r){return xv(this.multi,[])}function QH(t,e,n,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=Sa(n,n[me],this.providerFactory.index,r);s=a.slice(0,o),xv(i,s);for(let u=o;u<a.length;u++)s.push(a[u])}else s=[],xv(i,s);return s}function xv(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function YH(t,e,n,r,i){let s=new Qs(t,n,Y);return s.multi=[],s.index=e,s.componentProviders=0,oR(s,i,r&&!n),s}function dp(t,e=[]){return n=>{n.providersResolver=(r,i)=>WH(r,i?i(t):t,e)}}var qi=class{},Oc=class{};var Bf=class extends qi{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Lf(this);let i=IA(e);this._bootstrapComponents=fx(i.bootstrap),this._r3Injector=dx(e,n,[{provide:qi,useValue:this},{provide:ep,useValue:this.componentFactoryResolver},...r],Jt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},$f=class extends Oc{constructor(e){super(),this.moduleType=e}create(e){return new Bf(this.moduleType,e,[])}};function ZH(t,e,n){return new Bf(t,e,n)}var Rv=class extends qi{constructor(e){super(),this.componentFactoryResolver=new Lf(this),this.instance=null;let n=new Ac([...e.providers,{provide:qi,useValue:this},{provide:ep,useValue:this.componentFactoryResolver}],e.parent||Wv(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function hp(t,e,n=null){return new Rv({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var XH=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=ax(!1,r.type),s=i.length>0?hp([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=B({token:e,providedIn:"environment",factory:()=>new e(C(Mn))});let t=e;return t})();function aR(t){qc("NgStandalone"),t.getStandaloneInjector=e=>e.get(XH).getOrCreateStandaloneInjector(t)}var hw=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=t4;let t=e;return t})(),JH=hw,e4=class extends JH{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=op(this._declarationLView,this._declarationTContainer,e,{injector:n,dehydratedView:r});return new Zs(i)}};function t4(){return n4(Pn(),We())}function n4(t,e){return t.type&4?new e4(e,t,tp(t,e)):null}var mf=null;function r4(t){mf!==null&&(t.defaultEncapsulation!==mf.defaultEncapsulation||t.preserveWhitespaces!==mf.preserveWhitespaces)||(mf=t)}var fp=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),fw=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new zt(!1)}add(){this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Mv=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},pp=(()=>{let e=class e{compileModuleSync(r){return new $f(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=IA(r),o=fx(s.declarations).reduce((a,u)=>{let c=$i(u);return c&&a.push(new xa(c)),a},[]);return new Mv(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),i4=new j("compilerOptions");var pw=new j(""),zc=new j(""),gp=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,gw||(s4(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ge.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb(this._didWork)}this._didWork=!1});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(C(ge),C(mp),C(zc))},e.\u0275prov=B({token:e,factory:e.\u0275fac});let t=e;return t})(),mp=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return gw?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();function s4(t){gw=t}var gw,yp=new j("Application Initializer"),uR=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=$(yp,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(ro(o))r.push(o);else if(iR(o)){let a=new Promise((u,c)=>{o.subscribe({complete:u,error:c})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),mw=new j("appBootstrapListener");function o4(t,e,n){let r=new $f(n);return Promise.resolve(r)}function a4(){tS(()=>{throw new z(600,!1)})}function u4(t){return t.isBoundToModule}function c4(t,e,n){try{let r=n();return ro(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}function cR(t,e){return Array.isArray(e)?e.reduce(cR,t):N(N({},t),e)}var ka=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=$(xx),this.zoneIsStable=$(Zx),this.componentTypes=[],this.components=[],this.isStable=$(fw).hasPendingTasks.pipe(Be(r=>r?q(!1):this.zoneIsStable),$s()),this._injector=$(Mn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof kf;if(!this._injector.get(uR).done){let p="Cannot bootstrap as there are still asynchronous initializers running."+(!s&&EA(r)?"":" Bootstrap components in the `ngDoBootstrap` method of the root module.");throw new z(405,!1)}let a;s?a=r:a=this._injector.get(ep).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let u=u4(a)?void 0:this._injector.get(qi),c=i||a.selector,l=a.create(Yn.NULL,[],c,u),d=l.location.nativeElement,h=l.injector.get(pw,null);return h?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),Ef(this.components,l),h?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new z(101,!1);try{this._runningTick=!0;for(let r of this._views)r.detectChanges()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;Ef(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(mw,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>Ef(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new z(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Ef(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function iA(t){for(let e=t.length-1;e>=0;e--)if(t[e]!==void 0)return t[e]}var l4=(()=>{let e=class e{constructor(){this.zone=$(ge),this.applicationRef=$(ka)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function d4(t){return[{provide:ge,useFactory:t},{provide:Bc,multi:!0,useFactory:()=>{let e=$(l4,{optional:!0});return()=>e.initialize()}},{provide:xx,useFactory:h4},{provide:Zx,useFactory:Xx}]}function h4(){let t=$(ge),e=$(kr);return n=>t.runOutsideAngular(()=>e.handleError(n))}function f4(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}function p4(){return typeof $localize<"u"&&$localize.locale||Uf}var yw=new j("LocaleId",{providedIn:"root",factory:()=>$(yw,we.Optional|we.SkipSelf)||p4()});var lR=new j("PlatformDestroyListeners"),dR=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=G$(i?.ngZone,f4({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=ZH(r.moduleType,this.injector,d4(()=>s)),a=o.injector.get(kr,null);return s.runOutsideAngular(()=>{let u=s.onError.subscribe({next:c=>{a.handleError(c)}});o.onDestroy(()=>{Ef(this._modules,o),u.unsubscribe()})}),c4(a,s,()=>{let u=o.injector.get(uR);return u.runInitializers(),u.donePromise.then(()=>{let c=o.injector.get(yw,Uf);return HH(c||Uf),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=cR({},i);return o4(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(ka);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new z(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new z(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(lR,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(C(Yn))},e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),Ec=null,hR=new j("AllowMultipleToken");function g4(t){if(Ec&&!Ec.get(hR,!1))throw new z(400,!1);a4(),Ec=t;let e=t.get(dR);return _4(t),e}function _w(t,e,n=[]){let r=`Platform: ${e}`,i=new j(r);return(s=[])=>{let o=fR();if(!o||o.injector.get(hR,!1)){let a=[...n,...s,{provide:i,useValue:!0}];t?t(a):g4(m4(a,r))}return y4(i)}}function m4(t=[],e){return Yn.create({name:e,providers:[{provide:Yf,useValue:"platform"},{provide:lR,useValue:new Set([()=>Ec=null])},...t]})}function y4(t){let e=fR();if(!e)throw new z(401,!1);return e}function fR(){return Ec?.get(dR)??null}function _4(t){t.get(Kv,null)?.forEach(n=>n())}function vw(){return!1}var pR=_w(null,"core",[]),gR=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(C(ka))},e.\u0275mod=Xe({type:e}),e.\u0275inj=Ze({});let t=e;return t})();function io(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function mR(t){let e=$i(t);if(!e)return null;let n=new xa(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var ww=null;function Lr(){return ww}function wR(t){ww||(ww=t)}var _p=class{},fn=new j("DocumentToken"),Cw=(()=>{let e=class e{historyGo(r){throw new Error("Not implemented")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:()=>(()=>$(w4))(),providedIn:"platform"});let t=e;return t})(),ER=new j("Location Initialized"),w4=(()=>{let e=class e extends Cw{constructor(){super(),this._doc=$(fn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Lr().getBaseHref(this._doc)}onPopState(r){let i=Lr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=Lr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:()=>(()=>new e)(),providedIn:"platform"});let t=e;return t})();function bw(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function yR(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function _i(t){return t&&t[0]!=="?"?"?"+t:t}var vi=(()=>{let e=class e{historyGo(r){throw new Error("Not implemented")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:()=>(()=>$(Tw))(),providedIn:"root"});let t=e;return t})(),IR=new j("appBaseHref"),Tw=(()=>{let e=class e extends vi{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??$(fn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return bw(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+_i(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+_i(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+_i(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(C(Cw),C(IR,8))},e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),CR=(()=>{let e=class e extends vi{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash;return i==null&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=bw(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+_i(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+_i(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(C(Cw),C(IR,8))},e.\u0275prov=B({token:e,factory:e.\u0275fac});let t=e;return t})(),Fa=(()=>{let e=class e{constructor(r){this._subject=new it,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=C4(yR(_R(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+_i(i))}normalize(r){return e.stripTrailingSlash(I4(this._basePath,_R(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+_i(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+_i(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=_i,e.joinWithSlash=bw,e.stripTrailingSlash=yR,e.\u0275fac=function(i){return new(i||e)(C(vi))},e.\u0275prov=B({token:e,factory:()=>E4(),providedIn:"root"});let t=e;return t})();function E4(){return new Fa(C(vi))}function I4(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function _R(t){return t.replace(/\/index.html$/,"")}function C4(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function bR(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var wp=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new Ew,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){vR("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){vR("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(Y(Gc),Y(hw))},e.\u0275dir=An({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let t=e;return t})(),Ew=class{constructor(){this.$implicit=null,this.ngIf=null}};function vR(t,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${t} must be a TemplateRef, but received '${Jt(e)}'.`)}var TR=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Xe({type:e}),e.\u0275inj=Ze({});let t=e;return t})(),DR="browser",b4="server";function so(t){return t===b4}var SR=(()=>{let e=class e{};e.\u0275prov=B({token:e,providedIn:"root",factory:()=>new Iw(C(fn),window)});let t=e;return t})(),Iw=class{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;let n=T4(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){let n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}};function T4(t,e){let n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var vp=class{};var xw=class extends _p{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Rw=class t extends xw{static makeCurrent(){wR(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=S4();return n==null?null:A4(n)}resetBaseElement(){Wc=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return bR(document.cookie,e)}},Wc=null;function S4(){return Wc=Wc||document.querySelector("base"),Wc?Wc.getAttribute("href"):null}function A4(t){return new URL(t,document.baseURI).pathname}var Mw=class{addToWindow(e){ln.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new z(5103,!1);return s},ln.getAllAngularTestabilities=()=>e.getAllTestabilities(),ln.getAllAngularRootElements=()=>e.getAllRootElements();let n=r=>{let i=ln.getAllAngularTestabilities(),s=i.length,o=!1,a=function(u){o=o||u,s--,s==0&&r(o)};i.forEach(u=>{u.whenStable(a)})};ln.frameworkStabilizers||(ln.frameworkStabilizers=[]),ln.frameworkStabilizers.push(n)}findTestabilityInTree(e,n,r){if(n==null)return null;let i=e.getTestability(n);return i??(r?Lr().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},x4=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:e.\u0275fac});let t=e;return t})(),Pw=new j("EventManagerPlugins"),MR=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new z(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(C(Pw),C(ge))},e.\u0275prov=B({token:e,factory:e.\u0275fac});let t=e;return t})(),Ep=class{constructor(e){this._doc=e}},Sw="ng-app-id",PR=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=so(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${Sw}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(Sw),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(Sw,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(C(fn),C(Zf),C(Qv,8),C(Kt))},e.\u0275prov=B({token:e,factory:e.\u0275fac});let t=e;return t})(),Aw={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Ow=/%COMP%/g,NR="%COMP%",R4=`_nghost-${NR}`,M4=`_ngcontent-${NR}`,P4=!0,N4=new j("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>P4});function O4(t){return M4.replace(Ow,t)}function k4(t){return R4.replace(Ow,t)}function OR(t,e){return e.map(n=>n.replace(Ow,t))}var AR=(()=>{let e=class e{constructor(r,i,s,o,a,u,c,l=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=u,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=so(u),this.defaultRenderer=new Kc(r,a,c,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Nr.ShadowDom&&(i=Le(N({},i),{encapsulation:Nr.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof Ip?s.applyToHost(r):s instanceof Qc&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,u=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case Nr.Emulated:o=new Ip(c,l,i,this.appId,d,a,u,h);break;case Nr.ShadowDom:return new Nw(c,l,r,i,a,u,this.nonce,h);default:o=new Qc(c,l,i,d,a,u,h);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(C(MR),C(PR),C(Zf),C(N4),C(fn),C(Kt),C(ge),C(Qv))},e.\u0275prov=B({token:e,factory:e.\u0275fac});let t=e;return t})(),Kc=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(Aw[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(xR(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(xR(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new z(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=Aw[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=Aw[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(gi.DashCase|gi.Important)?e.style.setProperty(n,r,i&gi.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&gi.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=Lr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function xR(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var Nw=class extends Kc{constructor(e,n,r,i,s,o,a,u){super(e,s,o,u),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=OR(i.id,i.styles);for(let l of c){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=l,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Qc=class extends Kc{constructor(e,n,r,i,s,o,a,u){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=u?OR(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Ip=class extends Qc{constructor(e,n,r,i,s,o,a,u){let c=i+"-"+r.id;super(e,n,r,s,o,a,u,c),this.contentAttr=O4(c),this.hostAttr=k4(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},F4=(()=>{let e=class e extends Ep{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(C(fn))},e.\u0275prov=B({token:e,factory:e.\u0275fac});let t=e;return t})(),RR=["alt","control","meta","shift"],L4={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},V4={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},j4=(()=>{let e=class e extends Ep{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Lr().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",u=i.indexOf("code");if(u>-1&&(i.splice(u,1),a="code."),RR.forEach(l=>{let d=i.indexOf(l);d>-1&&(i.splice(d,1),a+=l+".")}),a+=o,i.length!=0||o.length===0)return null;let c={};return c.domEventName=s,c.fullKey=a,c}static matchEventFullKeyCode(r,i){let s=L4[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),RR.forEach(a=>{if(a!==s){let u=V4[a];u(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(C(fn))},e.\u0275prov=B({token:e,factory:e.\u0275fac});let t=e;return t})();function U4(){Rw.makeCurrent()}function B4(){return new kr}function $4(){return hx(document),document}var H4=[{provide:Kt,useValue:DR},{provide:Kv,useValue:U4,multi:!0},{provide:fn,useFactory:$4,deps:[]}],kR=_w(pR,"browser",H4),q4=new j(""),G4=[{provide:zc,useClass:Mw,deps:[]},{provide:pw,useClass:gp,deps:[ge,mp,zc]},{provide:gp,useClass:gp,deps:[ge,mp,zc]}],z4=[{provide:Yf,useValue:"root"},{provide:kr,useFactory:B4,deps:[]},{provide:Pw,useClass:F4,multi:!0,deps:[fn,ge,Kt]},{provide:Pw,useClass:j4,multi:!0,deps:[fn]},AR,PR,MR,{provide:Rc,useExisting:AR},{provide:vp,useClass:x4,deps:[]},[]],FR=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:Zf,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(C(q4,12))},e.\u0275mod=Xe({type:e}),e.\u0275inj=Ze({providers:[...z4,...G4],imports:[TR,gR]});let t=e;return t})();function W4(){return new kw(C(fn))}var kw=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(C(fn))},e.\u0275prov=B({token:e,factory:function(i){let s=null;return i?s=new i:s=W4(),s},providedIn:"root"});let t=e;return t})();var GR=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(Y(eo),Y(Wi))},e.\u0275dir=An({type:e});let t=e;return t})(),K4=(()=>{let e=class e extends GR{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Vc(e)))(s||e)}})(),e.\u0275dir=An({type:e,features:[Ki]});let t=e;return t})(),zR=new j("NgValueAccessor");var Q4={provide:zR,useExisting:Ma(()=>ja),multi:!0};function Y4(){let t=Lr()?Lr().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var Z4=new j("CompositionEventMode"),ja=(()=>{let e=class e extends GR{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!Y4())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(Y(eo),Y(Wi),Y(Z4,8))},e.\u0275dir=An({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&re("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[dp([Q4]),Ki]});let t=e;return t})();var WR=new j("NgValidators"),KR=new j("NgAsyncValidators");function QR(t){return t!=null}function YR(t){return ro(t)?ve(t):t}function ZR(t){let e={};return t.forEach(n=>{e=n!=null?N(N({},e),n):e}),Object.keys(e).length===0?null:e}function XR(t,e){return e.map(n=>n(t))}function X4(t){return!t.validate}function JR(t){return t.map(e=>X4(e)?e:n=>e.validate(n))}function J4(t){if(!t)return null;let e=t.filter(QR);return e.length==0?null:function(n){return ZR(XR(n,e))}}function Lw(t){return t!=null?J4(JR(t)):null}function eq(t){if(!t)return null;let e=t.filter(QR);return e.length==0?null:function(n){let r=XR(n,e).map(YR);return I_(r).pipe(H(ZR))}}function Vw(t){return t!=null?eq(JR(t)):null}function VR(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function tq(t){return t._rawValidators}function nq(t){return t._rawAsyncValidators}function Fw(t){return t?Array.isArray(t)?t:[t]:[]}function bp(t,e){return Array.isArray(t)?t.includes(e):t===e}function jR(t,e){let n=Fw(e);return Fw(t).forEach(i=>{bp(n,i)||n.push(i)}),n}function UR(t,e){return Fw(e).filter(n=>!bp(t,n))}var Tp=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Lw(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Vw(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},Va=class extends Tp{get formDirective(){return null}get path(){return null}},Jc=class extends Tp{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Dp=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},rq={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Ere=Le(N({},rq),{"[class.ng-submitted]":"isSubmitted"}),xp=(()=>{let e=class e extends Dp{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(Y(Jc,2))},e.\u0275dir=An({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&Qi("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Ki]});let t=e;return t})(),Rp=(()=>{let e=class e extends Dp{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(Y(Va,10))},e.\u0275dir=An({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,s){i&2&&Qi("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[Ki]});let t=e;return t})();var Yc="VALID",Cp="INVALID",La="PENDING",Zc="DISABLED";function eM(t){return(Mp(t)?t.validators:t)||null}function iq(t){return Array.isArray(t)?Lw(t):t||null}function tM(t,e){return(Mp(e)?e.asyncValidators:t)||null}function sq(t){return Array.isArray(t)?Vw(t):t||null}function Mp(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function oq(t,e,n){let r=t.controls;if(!(e?Object.keys(r):r).length)throw new z(1e3,"");if(!r[n])throw new z(1001,"")}function aq(t,e,n){t._forEachChild((r,i)=>{if(n[i]===void 0)throw new z(1002,"")})}var Sp=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Yc}get invalid(){return this.status===Cp}get pending(){return this.status==La}get disabled(){return this.status===Zc}get enabled(){return this.status!==Zc}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(jR(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(jR(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(UR(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(UR(e,this._rawAsyncValidators))}hasValidator(e){return bp(this._rawValidators,e)}hasAsyncValidator(e){return bp(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=La,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Zc,this.errors=null,this._forEachChild(r=>{r.disable(Le(N({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Le(N({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Yc,this._forEachChild(r=>{r.enable(Le(N({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Le(N({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Yc||this.status===La)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Zc:Yc}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=La,this._hasOwnPendingAsyncValidator=!0;let n=YR(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new it,this.statusChanges=new it}_calculateStatus(){return this._allControlsDisabled()?Zc:this.errors?Cp:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(La)?La:this._anyControlsHaveStatus(Cp)?Cp:Yc}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Mp(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=iq(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=sq(this._rawAsyncValidators)}},Ap=class extends Sp{constructor(e,n,r){super(eM(n),tM(r,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,n){return this.controls[e]?this.controls[e]:(this.controls[e]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(e,n,r={}){this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(e,n,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],n&&this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,n={}){aq(this,!0,e),Object.keys(e).forEach(r=>{oq(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e={},n={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(e,n,r)=>(e[r]=n.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(n,r)=>r._syncPendingControls()?!0:n);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(n=>{let r=this.controls[n];r&&e(r,n)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[n,r]of Object.entries(this.controls))if(this.contains(n)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(n,r,i)=>((r.enabled||this.disabled)&&(n[i]=r.value),n))}_reduceChildren(e,n){let r=e;return this._forEachChild((i,s)=>{r=n(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var jw=new j("CallSetDisabledState",{providedIn:"root",factory:()=>Uw}),Uw="always";function uq(t,e){return[...e.path,t]}function nM(t,e,n=Uw){rM(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),lq(t,e),hq(t,e),dq(t,e),cq(t,e)}function BR(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function cq(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function rM(t,e){let n=tq(t);e.validator!==null?t.setValidators(VR(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=nq(t);e.asyncValidator!==null?t.setAsyncValidators(VR(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();BR(e._rawValidators,i),BR(e._rawAsyncValidators,i)}function lq(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&iM(t,e)})}function dq(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&iM(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function iM(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function hq(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function fq(t,e){t==null,rM(t,e)}function pq(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function gq(t){return Object.getPrototypeOf(t.constructor)===K4}function mq(t,e){t._syncPendingControls(),e.forEach(n=>{let r=n.control;r.updateOn==="submit"&&r._pendingChange&&(n.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function yq(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(s=>{s.constructor===ja?n=s:gq(s)?r=s:i=s}),i||r||n||null}var _q={provide:Va,useExisting:Ma(()=>el)},Xc=(()=>Promise.resolve())(),el=(()=>{let e=class e extends Va{constructor(r,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._directives=new Set,this.ngSubmit=new it,this.form=new Ap({},Lw(r),Vw(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(r){Xc.then(()=>{let i=this._findContainer(r.path);r.control=i.registerControl(r.name,r.control),nM(r.control,r,this.callSetDisabledState),r.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(r)})}getControl(r){return this.form.get(r.path)}removeControl(r){Xc.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name),this._directives.delete(r)})}addFormGroup(r){Xc.then(()=>{let i=this._findContainer(r.path),s=new Ap({});fq(s,r),i.registerControl(r.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(r){Xc.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name)})}getFormGroup(r){return this.form.get(r.path)}updateModel(r,i){Xc.then(()=>{this.form.get(r.path).setValue(i)})}setValue(r){this.control.setValue(r)}onSubmit(r){return this.submitted=!0,mq(this.form,this._directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submitted=!1}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(r){return r.pop(),r.length?this.form.get(r):this.form}};e.\u0275fac=function(i){return new(i||e)(Y(WR,10),Y(KR,10),Y(jw,8))},e.\u0275dir=An({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,s){i&1&&re("submit",function(a){return s.onSubmit(a)})("reset",function(){return s.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[dp([_q]),Ki]});let t=e;return t})();function $R(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function HR(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var vq=class extends Sp{constructor(e=null,n,r){super(eM(n),tM(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Mp(n)&&(n.nonNullable||n.initialValueIsDefault)&&(HR(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){$R(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){$R(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){HR(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var wq={provide:Jc,useExisting:Ma(()=>tl)},qR=(()=>Promise.resolve())(),tl=(()=>{let e=class e extends Jc{constructor(r,i,s,o,a,u){super(),this._changeDetectorRef=a,this.callSetDisabledState=u,this.control=new vq,this._registered=!1,this.name="",this.update=new it,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=yq(this,o)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),pq(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){nM(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){qR.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,s=i!==0&&io(i);qR.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?uq(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(Y(Va,9),Y(WR,10),Y(KR,10),Y(zR,10),Y(no,8),Y(jw,8))},e.\u0275dir=An({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[dp([wq]),Ki,gr]});let t=e;return t})(),Pp=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=An({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let t=e;return t})();var Eq=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Xe({type:e}),e.\u0275inj=Ze({});let t=e;return t})();var Iq=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Xe({type:e}),e.\u0275inj=Ze({imports:[Eq]});let t=e;return t})();var sM=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:jw,useValue:r.callSetDisabledState??Uw}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Xe({type:e}),e.\u0275inj=Ze({imports:[Iq]});let t=e;return t})();var Cq="firebase",bq="10.7.1";Tn(Cq,bq,"app");var yr=new mi("ANGULARFIRE2_VERSION");var Tq=(t,e)=>{let n=e?[e]:QD(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},mr=class{constructor(){return Tq(Dq)}},Dq="app-check";function Bw(){}var Np=class{zone;delegate;constructor(e,n=v_){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},$w=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Bw,{},Bw,Bw)),n.pipe(vt({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Xi=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new Np(Zone.current)),this.insideAngular=n.run(()=>new Np(Zone.current,hi)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(C(ge))};static \u0275prov=B({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function aM(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function Hw(t){return t.pipe(Rn(aM().outsideAngular))}function ot(t){return Sq(aM())(t)}function Sq(t){return function(n){return n=n.lift(new $w(t.ngZone)),n.pipe(cr(t.outsideAngular),Rn(t.insideAngular))}}var Aq="firebase",xq="10.7.1";dt.registerVersion(Aq,xq,"app-compat");var Rq=["ngOnDestroy"],cM=(t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(Rq.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let u=a?.[s];return typeof u=="function"?u.bind(a):u?.then?u.then(c=>n.run(()=>c)):n.run(()=>u)});return new Proxy(()=>{},{get:(a,u)=>o[u],apply:(a,u,c)=>o.then(l=>{let d=l?.(...c);return r?.spy?.apply&&r.spy.apply(s,c,d),d})})})});var kp=class{constructor(e){return e}},Vr=new j("angularfire2.app.options"),jr=new j("angularfire2.app.name");function wi(t,e,n){let r=typeof n=="string"&&n||"[DEFAULT]",i=typeof n=="object"&&n||{};i.name=i.name||r;let o=dt.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>dt.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let a=!!module.hot;Mq("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new kp(o)}var Mq=(t,...e)=>{vw()&&typeof console<"u"&&console[t](...e)},Pq={provide:kp,useFactory:wi,deps:[Vr,ge,[new Uc,jr]]},lM=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:Vr,useValue:n},{provide:jr,useValue:r}]}}constructor(n){dt.registerVersion("angularfire",yr.full,"core"),dt.registerVersion("angularfire",yr.full,"app-compat"),dt.registerVersion("angular",iw.full,n.toString())}static \u0275fac=function(r){return new(r||t)(C(Kt))};static \u0275mod=Xe({type:t});static \u0275inj=Ze({providers:[Pq]})}return t})();function Ji(t,e,n,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return Nq(i,o)||(uM("error",`${e} was already initialized on the ${n} Firebase App with different settings.${Oq?" You may need to reload as Firebase is not HMR aware.":""}`),uM("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}function Nq(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var Oq=typeof module<"u"&&!!module.hot,uM=(t,...e)=>{vw()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var kq=new Map,Fq={activated:!1,tokenObservers:[]},Lq={initialized:!1,enabled:!1};function _r(t){return kq.get(t)||Object.assign({},Fq)}function gM(){return Lq}var Vq="https://content-firebaseappcheck.googleapis.com/v1";var jq="exchangeDebugToken",dM={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},Qre=24*60*60*1e3;var Gw=class{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return I(this,null,function*(){this.stop();try{this.pending=new Ft,this.pending.promise.catch(n=>{}),yield Uq(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new Ft,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function Uq(t){return new Promise(e=>{setTimeout(e,t)})}var Bq={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},es=new HD("appCheck","AppCheck",Bq);function mM(t){if(!_r(t).activated)throw es.create("use-before-activation",{appName:t.name})}function yM(r,i){return I(this,arguments,function*({url:t,body:e},n){let s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let f=yield o.getHeartbeatsHeader();f&&(s["X-Firebase-Client"]=f)}let a={method:"POST",body:JSON.stringify(e),headers:s},u;try{u=yield fetch(t,a)}catch(f){throw es.create("fetch-network-error",{originalErrorMessage:f?.message})}if(u.status!==200)throw es.create("fetch-status-error",{httpStatus:u.status});let c;try{c=yield u.json()}catch(f){throw es.create("fetch-parse-error",{originalErrorMessage:f?.message})}let l=c.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw es.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});let d=Number(l[1])*1e3,h=Date.now();return{token:c.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function _M(t,e){let{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${Vq}/projects/${n}/apps/${r}:${jq}?key=${i}`,body:{debug_token:e}}}var $q="firebase-app-check-database",Hq=1,zw="firebase-app-check-store";var Fp=null;function qq(){return Fp||(Fp=new Promise((t,e)=>{try{let n=indexedDB.open($q,Hq);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var i;e(es.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(zw,{keyPath:"compositeKey"})}}}catch(n){e(es.create("storage-open",{originalErrorMessage:n?.message}))}}),Fp)}function Gq(t,e){return zq(Wq(t),e)}function zq(t,e){return I(this,null,function*(){let r=(yield qq()).transaction(zw,"readwrite"),s=r.objectStore(zw).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=u=>{o()},r.onerror=u=>{var c;a(es.create("storage-set",{originalErrorMessage:(c=u.target.error)===null||c===void 0?void 0:c.message}))}})})}function Wq(t){return`${t.options.appId}-${t.name}`}var Ww=new Oi("@firebase/app-check");function qw(t,e){return Ph()?Gq(t,e).catch(n=>{Ww.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function vM(){return gM().enabled}function wM(){return I(this,null,function*(){let t=gM();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var Kq={error:"UNKNOWN_ERROR"};function Qq(t){return Rh.encodeString(JSON.stringify(t),!1)}function Kw(t,e=!1){return I(this,null,function*(){let n=t.app;mM(n);let r=_r(n),i=r.token,s;if(i&&!nl(i)&&(r.token=void 0,i=void 0),!i){let u=yield r.cachedTokenPromise;u&&(nl(u)?i=u:yield qw(n,void 0))}if(!e&&i&&nl(i))return{token:i.token};let o=!1;if(vM()){r.exchangeTokenPromise||(r.exchangeTokenPromise=yM(_M(n,yield wM()),t.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let u=yield r.exchangeTokenPromise;return yield qw(n,u),r.token=u,{token:u.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield _r(n).exchangeTokenPromise}catch(u){u.code==="appCheck/throttled"?Ww.warn(u.message):Ww.error(u),s=u}let a;return i?s?nl(i)?a={token:i.token,internalError:s}:a=fM(s):(a={token:i.token},r.token=i,yield qw(n,i)):a=fM(s),o&&Jq(n,a),a})}function Yq(t){return I(this,null,function*(){let e=t.app;mM(e);let{provider:n}=_r(e);if(vM()){let r=yield wM(),{token:i}=yield yM(_M(e,r),t.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield n.getToken();return{token:r}}})}function Zq(t,e,n,r){let{app:i}=t,s=_r(i),o={next:n,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&nl(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),hM(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>hM(t))}function EM(t,e){let n=_r(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function hM(t){let{app:e}=t,n=_r(e),r=n.tokenRefresher;r||(r=Xq(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function Xq(t){let{app:e}=t;return new Gw(()=>I(this,null,function*(){let n=_r(e),r;if(n.token?r=yield Kw(t,!0):r=yield Kw(t),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=_r(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,i=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},dM.RETRIAL_MIN_WAIT,dM.RETRIAL_MAX_WAIT)}function Jq(t,e){let n=_r(t).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function nl(t){return t.expireTimeMillis-Date.now()>0}function fM(t){return{token:Qq(Kq),error:t}}var Qw=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=_r(this.app);for(let n of e)EM(this.app,n.next);return Promise.resolve()}};function e3(t,e){return new Qw(t,e)}function t3(t){return{getToken:e=>Kw(t,e),getLimitedUseToken:()=>Yq(t),addTokenListener:e=>Zq(t,"INTERNAL",e),removeTokenListener:e=>EM(t.app,e)}}var n3="@firebase/app-check",r3="0.8.1";var i3="app-check",pM="app-check-internal";function s3(){li(new Ht(i3,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return e3(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(pM).initialize()})),li(new Ht(pM,t=>{let e=t.getProvider("app-check").getImmediate();return t3(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Tn(n3,r3)}s3();var o3=["localhost","0.0.0.0","127.0.0.1"],aie=typeof window<"u"&&o3.includes(window.location.hostname);var rl=new j("angularfire2.auth.use-emulator"),il=new j("angularfire2.auth.settings"),sl=new j("angularfire2.auth.tenant-id"),ol=new j("angularfire2.auth.langugage-code"),al=new j("angularfire2.auth.use-device-language"),ul=new j("angularfire.auth.persistence"),cl=(t,e,n,r,i,s,o,a)=>Ji(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let u=e.runOutsideAngular(()=>t.auth());if(n&&u.useEmulator(...n),r&&(u.tenantId=r),u.languageCode=i,s&&u.useDeviceLanguage(),o)for(let[c,l]of Object.entries(o))u.settings[c]=l;return a&&u.setPersistence(a),u},[n,r,i,s,o,a]),oo=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,u,c,l,d,h,f){let p=new Tt,m=q(void 0).pipe(Rn(o.outsideAngular),Be(()=>s.runOutsideAngular(()=>import("./chunk-QYOT5QM5.js"))),H(()=>wi(n,s,r)),H(g=>cl(g,s,a,c,l,d,u,h)),cf({bufferSize:1,refCount:!1}));if(so(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=q(null);else{m.pipe(qn()).subscribe();let g=m.pipe(Be(v=>v.getRedirectResult().then(S=>S,()=>null)),ot,cf({bufferSize:1,refCount:!1})),_=m.pipe(Be(v=>new se(S=>({unsubscribe:s.runOutsideAngular(()=>v.onAuthStateChanged(F=>S.next(F),F=>S.error(F),()=>S.complete()))})))),y=m.pipe(Be(v=>new se(S=>({unsubscribe:s.runOutsideAngular(()=>v.onIdTokenChanged(F=>S.next(F),F=>S.error(F),()=>S.complete()))}))));this.authState=g.pipe(lf(_),cr(o.outsideAngular),Rn(o.insideAngular)),this.user=g.pipe(lf(y),cr(o.outsideAngular),Rn(o.insideAngular)),this.idToken=this.user.pipe(Be(v=>v?ve(v.getIdToken()):q(null))),this.idTokenResult=this.user.pipe(Be(v=>v?ve(v.getIdTokenResult()):q(null))),this.credential=Fi(g,p,this.authState.pipe(Wt(v=>!v))).pipe(H(v=>v?.user?v:null),cr(o.outsideAngular),Rn(o.insideAngular))}return cM(this,m,s,{spy:{apply:(g,_,y)=>{(g.startsWith("signIn")||g.startsWith("createUser"))&&y.then(v=>p.next(v))}}})}static \u0275fac=function(r){return new(r||t)(C(Vr),C(jr,8),C(Kt),C(ge),C(Xi),C(rl,8),C(il,8),C(sl,8),C(ol,8),C(al,8),C(ul,8),C(mr,8))};static \u0275prov=B({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),IM=(()=>{class t{constructor(){dt.registerVersion("angularfire",yr.full,"auth-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Xe({type:t});static \u0275inj=Ze({providers:[oo]})}return t})();var PM="firebasestorage.googleapis.com",NM="storageBucket",a3=2*60*1e3,u3=10*60*1e3,c3=1e3;var ht=class t extends Nh{constructor(e,n,r=0){super(Jw(e),`Firebase Storage: ${n} (${Jw(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,t.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Jw(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},at=function(t){return t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment",t}(at||{});function Jw(t){return"storage/"+t}function aE(){let t="An unknown error occurred, please check the error payload for server response.";return new ht(at.UNKNOWN,t)}function l3(t){return new ht(at.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function d3(t){return new ht(at.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function h3(){let t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ht(at.UNAUTHENTICATED,t)}function f3(){return new ht(at.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function p3(t){return new ht(at.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function OM(){return new ht(at.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function kM(){return new ht(at.CANCELED,"User canceled the upload/download.")}function g3(t){return new ht(at.INVALID_URL,"Invalid URL '"+t+"'.")}function m3(t){return new ht(at.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function y3(){return new ht(at.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+NM+"' property when initializing the app?")}function FM(){return new ht(at.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function _3(){return new ht(at.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function v3(){return new ht(at.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function w3(t){return new ht(at.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function ao(t){return new ht(at.INVALID_ARGUMENT,t)}function LM(){return new ht(at.APP_DELETED,"The Firebase app was deleted.")}function uE(t){return new ht(at.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function dl(t,e){return new ht(at.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function ll(t){throw new ht(at.INTERNAL_ERROR,"Internal error: "+t)}var pn=class t{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=t.makeFromUrl(e,n)}catch{return new t(e,"")}if(r.path==="")return r;throw m3(e)}static makeFromUrl(e,n){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(S){S.path.charAt(S.path.length-1)==="/"&&(S.path_=S.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),u={bucket:1,path:3};function c(S){S.path_=decodeURIComponent(S.path)}let l="v[A-Za-z0-9_]+",d=n.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",f=new RegExp(`^https?://${d}/${l}/b/${i}/o${h}`,"i"),p={bucket:1,path:3},m=n===PM?"(?:storage.googleapis.com|storage.cloud.google.com)":n,g="([^?#]*)",_=new RegExp(`^https?://${m}/${i}/${g}`,"i"),v=[{regex:a,indices:u,postModify:s},{regex:f,indices:p,postModify:c},{regex:_,indices:{bucket:1,path:2},postModify:c}];for(let S=0;S<v.length;S++){let F=v[S],x=F.regex.exec(e);if(x){let M=x[F.indices.bucket],P=x[F.indices.path];P||(P=""),r=new t(M,P),F.postModify(r);break}}if(r==null)throw g3(e);return r}},tE=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function E3(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function u(){return a===2}let c=!1;function l(...g){c||(c=!0,e.apply(null,g))}function d(g){i=setTimeout(()=>{i=null,t(f,u())},g)}function h(){s&&clearTimeout(s)}function f(g,..._){if(c){h();return}if(g){h(),l.call(null,g,..._);return}if(u()||o){h(),l.call(null,g,..._);return}r<64&&(r*=2);let v;a===1?(a=2,v=0):v=(r+Math.random())*1e3,d(v)}let p=!1;function m(g){p||(p=!0,h(),!c&&(i!==null?(g||(a=2),clearTimeout(i),d(0)):g||(a=1)))}return d(0),s=setTimeout(()=>{o=!0,m(!0)},n),m}function I3(t){t(!1)}function C3(t){return t!==void 0}function b3(t){return typeof t=="function"}function T3(t){return typeof t=="object"&&!Array.isArray(t)}function Up(t){return typeof t=="string"||t instanceof String}function CM(t){return cE()&&t instanceof Blob}function cE(){return typeof Blob<"u"}function nE(t,e,n,r){if(r<e)throw ao(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw ao(`Invalid value for '${t}'. Expected ${n} or less.`)}function ts(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function VM(t){let e=encodeURIComponent,n="?";for(let r in t)if(t.hasOwnProperty(r)){let i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var $a=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}($a||{});function jM(t,e){let n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}var rE=class{constructor(e,n,r,i,s,o,a,u,c,l,d,h=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=u,this.timeout_=c,this.progressCallback_=l,this.connectionFactory_=d,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((f,p)=>{this.resolve_=f,this.reject_=p,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new Ba(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let u=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,c)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===$a.NO_ERROR,u=s.getStatus();if(!a||jM(u,this.additionalRetryCodes_)&&this.retry){let l=s.getErrorCode()===$a.ABORT;r(!1,new Ba(!1,null,l));return}let c=this.successCodes_.indexOf(u)!==-1;r(!0,new Ba(c,s))})},n=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let u=this.callback_(a,a.getResponse());C3(u)?s(u):s()}catch(u){o(u)}else if(a!==null){let u=aE();u.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,u)):o(u)}else if(i.canceled){let u=this.appDelete_?LM():kM();o(u)}else{let u=OM();o(u)}};this.canceled_?n(!1,new Ba(!1,null,!0)):this.backoffId_=E3(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&I3(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Ba=class{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}};function D3(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function S3(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function A3(t,e){e&&(t["X-Firebase-GMPID"]=e)}function x3(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function R3(t,e,n,r,i,s,o=!0){let a=VM(t.urlParams),u=t.url+a,c=Object.assign({},t.headers);return A3(c,e),D3(c,n),S3(c,s),x3(c,r),new rE(u,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}function M3(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function P3(...t){let e=M3();if(e!==void 0){let n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(cE())return new Blob(t);throw new ht(at.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function N3(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}function O3(t){if(typeof atob>"u")throw w3("base-64");return atob(t)}var Nn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},hl=class{constructor(e,n){this.data=e,this.contentType=n||null}};function lE(t,e){switch(t){case Nn.RAW:return new hl(UM(e));case Nn.BASE64:case Nn.BASE64URL:return new hl(BM(t,e));case Nn.DATA_URL:return new hl(F3(e),L3(e))}throw aE()}function UM(t){let e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{let s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function k3(t){let e;try{e=decodeURIComponent(t)}catch{throw dl(Nn.DATA_URL,"Malformed data URL.")}return UM(e)}function BM(t,e){switch(t){case Nn.BASE64:{let i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw dl(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Nn.BASE64URL:{let i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw dl(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=O3(e)}catch(i){throw i.message.includes("polyfill")?i:dl(t,"Invalid character found")}let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}var jp=class{constructor(e){this.base64=!1,this.contentType=null;let n=e.match(/^data:([^,]+)?,/);if(n===null)throw dl(Nn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=n[1]||null;r!=null&&(this.base64=V3(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function F3(t){let e=new jp(t);return e.base64?BM(Nn.BASE64,e.rest):k3(e.rest)}function L3(t){return new jp(t).contentType}function V3(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}var Ha=class t{constructor(e,n){let r=0,i="";CM(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(CM(this.data_)){let r=this.data_,i=N3(r,e,n);return i===null?null:new t(i)}else{let r=new Uint8Array(this.data_.buffer,e,n-e);return new t(r,!0)}}static getBlob(...e){if(cE()){let n=e.map(r=>r instanceof t?r.data_:r);return new t(P3.apply(null,n))}else{let n=e.map(o=>Up(o)?lE(Nn.RAW,o).data:o.data_),r=0;n.forEach(o=>{r+=o.byteLength});let i=new Uint8Array(r),s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new t(i,!0)}}uploadData(){return this.data_}};function dE(t){let e;try{e=JSON.parse(t)}catch{return null}return T3(e)?e:null}function j3(t){if(t.length===0)return null;let e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function U3(t,e){let n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function $M(t){let e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}function B3(t,e){return e}var Qt=class{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||B3}},Vp=null;function $3(t){return!Up(t)||t.length<2?t:$M(t)}function Bp(){if(Vp)return Vp;let t=[];t.push(new Qt("bucket")),t.push(new Qt("generation")),t.push(new Qt("metageneration")),t.push(new Qt("name","fullPath",!0));function e(s,o){return $3(o)}let n=new Qt("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}let i=new Qt("size");return i.xform=r,t.push(i),t.push(new Qt("timeCreated")),t.push(new Qt("updated")),t.push(new Qt("md5Hash",null,!0)),t.push(new Qt("cacheControl",null,!0)),t.push(new Qt("contentDisposition",null,!0)),t.push(new Qt("contentEncoding",null,!0)),t.push(new Qt("contentLanguage",null,!0)),t.push(new Qt("contentType",null,!0)),t.push(new Qt("metadata","customMetadata",!0)),Vp=t,Vp}function H3(t,e){function n(){let r=t.bucket,i=t.fullPath,s=new pn(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function q3(t,e,n){let r={};r.type="file";let i=n.length;for(let s=0;s<i;s++){let o=n[s];r[o.local]=o.xform(r,e[o.server])}return H3(r,t),r}function HM(t,e,n){let r=dE(e);return r===null?null:q3(t,r,n)}function G3(t,e,n,r){let i=dE(e);if(i===null||!Up(i.downloadTokens))return null;let s=i.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(c=>{let l=t.bucket,d=t.fullPath,h="/b/"+o(l)+"/o/"+o(d),f=ts(h,n,r),p=VM({alt:"media",token:c});return f+p})[0]}function hE(t,e){let n={},r=e.length;for(let i=0;i<r;i++){let s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}var bM="prefixes",TM="items";function z3(t,e,n){let r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[bM])for(let i of n[bM]){let s=i.replace(/\/$/,""),o=t._makeStorageReference(new pn(e,s));r.prefixes.push(o)}if(n[TM])for(let i of n[TM]){let s=t._makeStorageReference(new pn(e,i.name));r.items.push(s)}return r}function W3(t,e,n){let r=dE(n);return r===null?null:z3(t,e,r)}var vr=class{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function Br(t){if(!t)throw aE()}function $p(t,e){function n(r,i){let s=HM(t,i,e);return Br(s!==null),s}return n}function K3(t,e){function n(r,i){let s=W3(t,e,i);return Br(s!==null),s}return n}function Q3(t,e){function n(r,i){let s=HM(t,i,e);return Br(s!==null),G3(s,i,t.host,t._protocol)}return n}function za(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=f3():i=h3():n.getStatus()===402?i=d3(t.bucket):n.getStatus()===403?i=p3(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function Hp(t){let e=za(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=l3(t.path)),s.serverResponse=i.serverResponse,s}return n}function qM(t,e,n){let r=e.fullServerUrl(),i=ts(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new vr(i,s,$p(t,n),o);return a.errorHandler=Hp(e),a}function Y3(t,e,n,r,i){let s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",n&&n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);let o=e.bucketOnlyServerUrl(),a=ts(o,t.host,t._protocol),u="GET",c=t.maxOperationRetryTime,l=new vr(a,u,K3(t,e.bucket),c);return l.urlParams=s,l.errorHandler=za(e),l}function Z3(t,e,n){let r=e.fullServerUrl(),i=ts(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new vr(i,s,Q3(t,n),o);return a.errorHandler=Hp(e),a}function X3(t,e,n,r){let i=e.fullServerUrl(),s=ts(i,t.host,t._protocol),o="PATCH",a=hE(n,r),u={"Content-Type":"application/json; charset=utf-8"},c=t.maxOperationRetryTime,l=new vr(s,o,$p(t,r),c);return l.headers=u,l.body=a,l.errorHandler=Hp(e),l}function J3(t,e){let n=e.fullServerUrl(),r=ts(n,t.host,t._protocol),i="DELETE",s=t.maxOperationRetryTime;function o(u,c){}let a=new vr(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=Hp(e),a}function eG(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function GM(t,e,n){let r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=eG(null,e)),r}function tG(t,e,n,r,i){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let v="";for(let S=0;S<2;S++)v=v+Math.random().toString().slice(2);return v}let u=a();o["Content-Type"]="multipart/related; boundary="+u;let c=GM(e,r,i),l=hE(c,n),d="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+l+`\r
--`+u+`\r
Content-Type: `+c.contentType+`\r
\r
`,h=`\r
--`+u+"--",f=Ha.getBlob(d,r,h);if(f===null)throw FM();let p={name:c.fullPath},m=ts(s,t.host,t._protocol),g="POST",_=t.maxUploadRetryTime,y=new vr(m,g,$p(t,n),_);return y.urlParams=p,y.headers=o,y.body=f.uploadData(),y.errorHandler=za(e),y}var qa=class{constructor(e,n,r,i){this.current=e,this.total=n,this.finalized=!!r,this.metadata=i||null}};function fE(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{Br(!1)}return Br(!!n&&(e||["active"]).indexOf(n)!==-1),n}function nG(t,e,n,r,i){let s=e.bucketOnlyServerUrl(),o=GM(e,r,i),a={name:o.fullPath},u=ts(s,t.host,t._protocol),c="POST",l={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},d=hE(o,n),h=t.maxUploadRetryTime;function f(m){fE(m);let g;try{g=m.getResponseHeader("X-Goog-Upload-URL")}catch{Br(!1)}return Br(Up(g)),g}let p=new vr(u,c,f,h);return p.urlParams=a,p.headers=l,p.body=d,p.errorHandler=za(e),p}function rG(t,e,n,r){let i={"X-Goog-Upload-Command":"query"};function s(c){let l=fE(c,["active","final"]),d=null;try{d=c.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Br(!1)}d||Br(!1);let h=Number(d);return Br(!isNaN(h)),new qa(h,r.size(),l==="final")}let o="POST",a=t.maxUploadRetryTime,u=new vr(n,o,s,a);return u.headers=i,u.errorHandler=za(e),u}var DM=256*1024;function iG(t,e,n,r,i,s,o,a){let u=new qa(0,0);if(o?(u.current=o.current,u.total=o.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw _3();let c=u.total-u.current,l=c;i>0&&(l=Math.min(l,i));let d=u.current,h=d+l,f="";l===0?f="finalize":c===l?f="upload, finalize":f="upload";let p={"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":`${u.current}`},m=r.slice(d,h);if(m===null)throw FM();function g(S,F){let x=fE(S,["active","final"]),M=u.current+l,P=r.size(),K;return x==="final"?K=$p(e,s)(S,F):K=null,new qa(M,P,x==="final",K)}let _="POST",y=e.maxUploadRetryTime,v=new vr(n,_,g,y);return v.headers=p,v.body=m.uploadData(),v.progressCallback=a||null,v.errorHandler=za(t),v}var zM={STATE_CHANGED:"state_changed"},nn={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function eE(t){switch(t){case"running":case"pausing":case"canceling":return nn.RUNNING;case"paused":return nn.PAUSED;case"success":return nn.SUCCESS;case"canceled":return nn.CANCELED;case"error":return nn.ERROR;default:return nn.ERROR}}var iE=class{constructor(e,n,r){if(b3(e)||n!=null||r!=null)this.next=e,this.error=n??void 0,this.complete=r??void 0;else{let s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}};function Ua(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}var SM=null,sE=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=$a.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=$a.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=$a.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw ll("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(let s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ll("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ll("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ll("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ll("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},oE=class extends sE{initXhr(){this.xhr_.responseType="text"}};function Ur(){return SM?SM():new oE}var fl=class{constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=Bp(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(at.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let s=this.isExponentialBackoffExpired();if(jM(i.status,[]))if(s)i=OM();else{this.sleepTime=Math.max(this.sleepTime*2,c3),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(at.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){let e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{let r=nG(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Ur,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((n,r)=>{let i=rG(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,Ur,n,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=DM*this._chunkMultiplier,n=new qa(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=iG(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(u){this._error=u,this._transition("error");return}let a=this._ref.storage._makeRequest(o,Ur,i,s,!1);this._request=a,a.getPromise().then(u=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(u.current),u.finalized?(this._metadata=u.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){DM*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{let r=qM(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Ur,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{let r=tG(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Ur,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=kM(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let e=eE(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,i){let s=new iE(n||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(eE(this._state)){case nn.SUCCESS:Ua(this._resolve.bind(null,this.snapshot))();break;case nn.CANCELED:case nn.ERROR:let n=this._reject;Ua(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(eE(this._state)){case nn.RUNNING:case nn.PAUSED:e.next&&Ua(e.next.bind(e,this.snapshot))();break;case nn.SUCCESS:e.complete&&Ua(e.complete.bind(e))();break;case nn.CANCELED:case nn.ERROR:e.error&&Ua(e.error.bind(e,this._error))();break;default:e.error&&Ua(e.error.bind(e,this._error))()}}resume(){let e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){let e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){let e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}};var Ga=class t{constructor(e,n){this._service=e,n instanceof pn?this._location=n:this._location=pn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new t(e,n)}get root(){let e=new pn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return $M(this._location.path)}get storage(){return this._service}get parent(){let e=j3(this._location.path);if(e===null)return null;let n=new pn(this._location.bucket,e);return new t(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw uE(e)}};function sG(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new fl(t,new Ha(e),n)}function oG(t){let e={prefixes:[],items:[]};return WM(t,e).then(()=>e)}function WM(t,e,n){return I(this,null,function*(){let i=yield KM(t,{pageToken:n});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&(yield WM(t,e,i.nextPageToken))})}function KM(t,e){e!=null&&typeof e.maxResults=="number"&&nE("options.maxResults",1,1e3,e.maxResults);let n=e||{},r=Y3(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,Ur)}function aG(t){t._throwIfRoot("getMetadata");let e=qM(t.storage,t._location,Bp());return t.storage.makeRequestWithTokens(e,Ur)}function uG(t,e){t._throwIfRoot("updateMetadata");let n=X3(t.storage,t._location,e,Bp());return t.storage.makeRequestWithTokens(n,Ur)}function cG(t){t._throwIfRoot("getDownloadURL");let e=Z3(t.storage,t._location,Bp());return t.storage.makeRequestWithTokens(e,Ur).then(n=>{if(n===null)throw v3();return n})}function lG(t){t._throwIfRoot("deleteObject");let e=J3(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Ur)}function QM(t,e){let n=U3(t._location.path,e),r=new pn(t._location.bucket,n);return new Ga(t.storage,r)}function dG(t){return/^[A-Za-z]+:\/\//.test(t)}function hG(t,e){return new Ga(t,e)}function YM(t,e){if(t instanceof pl){let n=t;if(n._bucket==null)throw y3();let r=new Ga(n,n._bucket);return e!=null?YM(r,e):r}else return e!==void 0?QM(t,e):t}function fG(t,e){if(e&&dG(e)){if(t instanceof pl)return hG(t,e);throw ao("To use ref(service, url), the first argument must be a Storage instance.")}else return YM(t,e)}function AM(t,e){let n=e?.[NM];return n==null?null:pn.makeFromBucketSpec(n,t)}function pG(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";let{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:ta(i,t.app.options.projectId))}var pl=class{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=PM,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=a3,this._maxUploadRetryTime=u3,this._requests=new Set,i!=null?this._bucket=pn.makeFromBucketSpec(i,this._host):this._bucket=AM(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=pn.makeFromBucketSpec(this._url,e):this._bucket=AM(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){nE("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){nE("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return I(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let n=yield e.getToken();if(n!==null)return n.accessToken}return null})}_getAppCheckToken(){return I(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ga(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new tE(LM());{let o=R3(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,n){return I(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()})}},xM="@firebase/storage",RM="0.12.0";var gG="storage";function ZM(t,e,n){return t=J(t),sG(t,e,n)}function XM(t){return t=J(t),aG(t)}function JM(t,e){return t=J(t),uG(t,e)}function eP(t,e){return t=J(t),KM(t,e)}function tP(t){return t=J(t),oG(t)}function nP(t){return t=J(t),cG(t)}function rP(t){return t=J(t),lG(t)}function pE(t,e){return t=J(t),fG(t,e)}function iP(t,e){return QM(t,e)}function sP(t,e,n,r={}){pG(t,e,n,r)}function mG(t,{instanceIdentifier:e}){let n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new pl(n,r,i,e,na)}function yG(){li(new Ht(gG,mG,"PUBLIC").setMultipleInstances(!0)),Tn(xM,RM,""),Tn(xM,RM,"esm2017")}yG();var Wa=class{constructor(e,n,r){this._delegate=e,this.task=n,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}};var qp=class{constructor(e,n){this._delegate=e,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new Wa(this._delegate.snapshot,this,this._ref)}then(e,n){return this._delegate.then(r=>{if(e)return e(new Wa(r,this,this._ref))},n)}on(e,n,r,i){let s;return n&&(typeof n=="function"?s=o=>n(new Wa(o,this,this._ref)):s={next:n.next?o=>n.next(new Wa(o,this,this._ref)):void 0,complete:n.complete||void 0,error:n.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}},Gp=class{constructor(e,n){this._delegate=e,this._service=n}get prefixes(){return this._delegate.prefixes.map(e=>new uo(e,this._service))}get items(){return this._delegate.items.map(e=>new uo(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}};var uo=class t{constructor(e,n){this._delegate=e,this.storage=n}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){let n=iP(this._delegate,e);return new t(n,this.storage)}get root(){return new t(this._delegate.root,this.storage)}get parent(){let e=this._delegate.parent;return e==null?null:new t(e,this.storage)}put(e,n){return this._throwIfRoot("put"),new qp(ZM(this._delegate,e,n),this)}putString(e,n=Nn.RAW,r){this._throwIfRoot("putString");let i=lE(n,e),s=Object.assign({},r);return s.contentType==null&&i.contentType!=null&&(s.contentType=i.contentType),new qp(new fl(this._delegate,new Ha(i.data,!0),s),this)}listAll(){return tP(this._delegate).then(e=>new Gp(e,this.storage))}list(e){return eP(this._delegate,e||void 0).then(n=>new Gp(n,this.storage))}getMetadata(){return XM(this._delegate)}updateMetadata(e){return JM(this._delegate,e)}getDownloadURL(){return nP(this._delegate)}delete(){return this._throwIfRoot("delete"),rP(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw uE(e)}};var zp=class{constructor(e,n){this.app=e,this._delegate=n}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(oP(e))throw ao("ref() expected a child path but got a URL, use refFromURL instead.");return new uo(pE(this._delegate,e),this)}refFromURL(e){if(!oP(e))throw ao("refFromURL() expected a full URL but got a child path, use ref() instead.");try{pn.makeFromUrl(e,this._delegate.host)}catch{throw ao("refFromUrl() expected a valid full URL but got an invalid one.")}return new uo(pE(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,n,r={}){sP(this._delegate,e,n,r)}};function oP(t){return/^[A-Za-z]+:\/\//.test(t)}var _G="@firebase/storage-compat",vG="0.3.3";var wG="storage-compat";function EG(t,{instanceIdentifier:e}){let n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("storage").getImmediate({identifier:e});return new zp(n,r)}function IG(t){let e={TaskState:nn,TaskEvent:zM,StringFormat:Nn,Storage:zp,Reference:uo};t.INTERNAL.registerComponent(new Ht(wG,EG,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion(_G,vG)}IG(dt);function CG(t){return new se(e=>{let n=o=>e.next(o),r=o=>e.error(o),i=()=>e.complete();n(t.snapshot);let s=t.on("state_changed",n);return t.then(o=>{n(o),i()},o=>{n(t.snapshot),r(o)}),function(){s()}}).pipe(C_(0))}function aP(t){let e=CG(t);return{task:t,then:t.then.bind(t),catch:t.catch.bind(t),pause:t.pause.bind(t),cancel:t.cancel.bind(t),resume:t.resume.bind(t),snapshotChanges:()=>e,percentageChanges:()=>e.pipe(H(n=>n.bytesTransferred/n.totalBytes*100))}}function Wp(t){return{getDownloadURL:()=>q(void 0).pipe(Hw,Be(()=>t.getDownloadURL()),ot),getMetadata:()=>q(void 0).pipe(Hw,Be(()=>t.getMetadata()),ot),delete:()=>ve(t.delete()),child:e=>Wp(t.child(e)),updateMetadata:e=>ve(t.updateMetadata(e)),put:(e,n)=>{let r=t.put(e,n);return aP(r)},putString:(e,n,r)=>{let i=t.putString(e,n,r);return aP(i)},list:e=>ve(t.list(e)),listAll:()=>ve(t.listAll())}}var bG=new j("angularfire2.storageBucket"),TG=new j("angularfire2.storage.maxUploadRetryTime"),DG=new j("angularfire2.storage.maxOperationRetryTime"),SG=new j("angularfire2.storage.use-emulator"),AG=(()=>{class t{storage;constructor(n,r,i,s,o,a,u,c,l,d){let h=wi(n,o,r);this.storage=Ji(`${h.name}.storage.${i}`,"AngularFireStorage",h.name,()=>{let f=o.runOutsideAngular(()=>h.storage(i||void 0)),p=l;return p&&f.useEmulator(...p),u&&f.setMaxUploadRetryTime(u),c&&f.setMaxOperationRetryTime(c),f},[u,c])}ref(n){return Wp(this.storage.ref(n))}refFromURL(n){return Wp(this.storage.refFromURL(n))}upload(n,r,i){let s=this.storage.ref(n);return Wp(s).put(r,i)}static \u0275fac=function(r){return new(r||t)(C(Vr),C(jr,8),C(bG,8),C(Kt),C(ge),C(Xi),C(TG,8),C(DG,8),C(SG,8),C(mr,8))};static \u0275prov=B({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var xG=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Xe({type:t});static \u0275inj=Ze({})}return t})(),uP=(()=>{class t{constructor(){dt.registerVersion("angularfire",yr.full,"gcs-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Xe({type:t});static \u0275inj=Ze({providers:[AG],imports:[xG]})}return t})();var RG=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Er={},L,FE=FE||{},ie=RG||self;function ag(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Al(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function MG(t){return Object.prototype.hasOwnProperty.call(t,gE)&&t[gE]||(t[gE]=++PG)}var gE="closure_uid_"+(1e9*Math.random()>>>0),PG=0;function NG(t,e,n){return t.call.apply(t.bind,arguments)}function OG(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function rn(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?rn=NG:rn=OG,rn.apply(null,arguments)}function Kp(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Vt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function ns(){this.s=this.s,this.o=this.o}var kG=0;ns.prototype.s=!1;ns.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),kG!=0)&&MG(this)};ns.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var EP=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function LE(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function cP(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(ag(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function sn(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}sn.prototype.h=function(){this.defaultPrevented=!0};var FG=function(){if(!ie.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};ie.addEventListener("test",n,e),ie.removeEventListener("test",n,e)}catch{}return t}();function wl(t){return/^[\s\xa0]*$/.test(t)}function ug(){var t=ie.navigator;return t&&(t=t.userAgent)?t:""}function $r(t){return ug().indexOf(t)!=-1}function VE(t){return VE[" "](t),t}VE[" "]=function(){};function LG(t,e){var n=Tz;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var VG=$r("Opera"),Za=$r("Trident")||$r("MSIE"),IP=$r("Edge"),wE=IP||Za,CP=$r("Gecko")&&!(ug().toLowerCase().indexOf("webkit")!=-1&&!$r("Edge"))&&!($r("Trident")||$r("MSIE"))&&!$r("Edge"),jG=ug().toLowerCase().indexOf("webkit")!=-1&&!$r("Edge");function bP(){var t=ie.document;return t?t.documentMode:void 0}var EE;e:{if(Qp="",Yp=function(){var t=ug();if(CP)return/rv:([^\);]+)(\)|;)/.exec(t);if(IP)return/Edge\/([\d\.]+)/.exec(t);if(Za)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(jG)return/WebKit\/(\S+)/.exec(t);if(VG)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),Yp&&(Qp=Yp?Yp[1]:""),Za&&(Zp=bP(),Zp!=null&&Zp>parseFloat(Qp))){EE=String(Zp);break e}EE=Qp}var Qp,Yp,Zp,IE;ie.document&&Za?(mE=bP(),IE=mE||parseInt(EE,10)||void 0):IE=void 0;var mE,UG=IE;function El(t,e){if(sn.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(CP){e:{try{VE(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:BG[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&El.$.h.call(this)}}Vt(El,sn);var BG={2:"touch",3:"pen",4:"mouse"};El.prototype.h=function(){El.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var xl="closure_listenable_"+(1e6*Math.random()|0),$G=0;function HG(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++$G,this.fa=this.ia=!1}function cg(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function jE(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function qG(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function TP(t){let e={};for(let n in t)e[n]=t[n];return e}var lP="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function DP(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<lP.length;s++)n=lP[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function lg(t){this.src=t,this.g={},this.h=0}lg.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=bE(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new HG(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function CE(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=EP(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(cg(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function bE(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var UE="closure_lm_"+(1e6*Math.random()|0),yE={};function SP(t,e,n,r,i){if(r&&r.once)return xP(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)SP(t,e[s],n,r,i);return null}return n=HE(n),t&&t[xl]?t.O(e,n,Al(r)?!!r.capture:!!r,i):AP(t,e,n,!1,r,i)}function AP(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=Al(i)?!!i.capture:!!i,a=$E(t);if(a||(t[UE]=a=new lg(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=GG(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)FG||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(MP(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function GG(){function t(n){return e.call(t.src,t.listener,n)}let e=zG;return t}function xP(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)xP(t,e[s],n,r,i);return null}return n=HE(n),t&&t[xl]?t.P(e,n,Al(r)?!!r.capture:!!r,i):AP(t,e,n,!0,r,i)}function RP(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)RP(t,e[s],n,r,i);else r=Al(r)?!!r.capture:!!r,n=HE(n),t&&t[xl]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=bE(s,n,r,i),-1<n&&(cg(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=$E(t))&&(e=t.g[e.toString()],t=-1,e&&(t=bE(e,n,r,i)),(n=-1<t?e[t]:null)&&BE(n))}function BE(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[xl])CE(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(MP(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=$E(e))?(CE(n,t),n.h==0&&(n.src=null,e[UE]=null)):cg(t)}}}function MP(t){return t in yE?yE[t]:yE[t]="on"+t}function zG(t,e){if(t.fa)t=!0;else{e=new El(e,this);var n=t.listener,r=t.la||t.src;t.ia&&BE(t),t=n.call(r,e)}return t}function $E(t){return t=t[UE],t instanceof lg?t:null}var _E="__closure_events_fn_"+(1e9*Math.random()>>>0);function HE(t){return typeof t=="function"?t:(t[_E]||(t[_E]=function(e){return t.handleEvent(e)}),t[_E])}function Lt(){ns.call(this),this.i=new lg(this),this.S=this,this.J=null}Vt(Lt,ns);Lt.prototype[xl]=!0;Lt.prototype.removeEventListener=function(t,e,n,r){RP(this,t,e,n,r)};function Zt(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new sn(e,t);else if(e instanceof sn)e.target=e.target||t;else{var i=e;e=new sn(r,t),DP(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=Xp(o,r,!0,e)&&i}if(o=e.g=t,i=Xp(o,r,!0,e)&&i,i=Xp(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=Xp(o,r,!1,e)&&i}Lt.prototype.N=function(){if(Lt.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)cg(n[r]);delete t.g[e],t.h--}}this.J=null};Lt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};Lt.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function Xp(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,u=o.la||o.src;o.ia&&CE(t.i,o),i=a.call(u,r)!==!1&&i}}return i&&!r.defaultPrevented}var qE=ie.JSON.stringify,TE=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function WG(){var t=GE;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var DE=class{constructor(){this.h=this.g=null}add(e,n){let r=PP.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},PP=new TE(()=>new SE,t=>t.reset()),SE=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function KG(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function QG(t){ie.setTimeout(()=>{throw t},0)}var Il,Cl=!1,GE=new DE,NP=()=>{let t=ie.Promise.resolve(void 0);Il=()=>{t.then(YG)}},YG=()=>{for(var t;t=WG();){try{t.h.call(t.g)}catch(n){QG(n)}var e=PP;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Cl=!1};function dg(t,e){Lt.call(this),this.h=t||1,this.g=e||ie,this.j=rn(this.qb,this),this.l=Date.now()}Vt(dg,Lt);L=dg.prototype;L.ga=!1;L.T=null;L.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Zt(this,"tick"),this.ga&&(zE(this),this.start()))}};L.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function zE(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}L.N=function(){dg.$.N.call(this),zE(this),delete this.g};function WE(t,e,n){if(typeof t=="function")n&&(t=rn(t,n));else if(t&&typeof t.handleEvent=="function")t=rn(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:ie.setTimeout(t,e||0)}function OP(t){t.g=WE(()=>{t.g=null,t.i&&(t.i=!1,OP(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var AE=class extends ns{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:OP(this)}N(){super.N(),this.g&&(ie.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function bl(t){ns.call(this),this.h=t,this.g={}}Vt(bl,ns);var dP=[];function kP(t,e,n,r){Array.isArray(n)||(n&&(dP[0]=n.toString()),n=dP);for(var i=0;i<n.length;i++){var s=SP(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function FP(t){jE(t.g,function(e,n){this.g.hasOwnProperty(n)&&BE(e)},t),t.g={}}bl.prototype.N=function(){bl.$.N.call(this),FP(this)};bl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function hg(){this.g=!0}hg.prototype.Ea=function(){this.g=!1};function ZG(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var d=l.split("_");o=2<=d.length&&d[1]=="type"?o+(l+"="+c+"&"):o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function XG(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function Qa(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+ez(t,n)+(r?" "+r:"")})}function JG(t,e){t.info(function(){return"TIMEOUT: "+e})}hg.prototype.info=function(){};function ez(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return qE(n)}catch{return e}}var fo={},hP=null;function fg(){return hP=hP||new Lt}fo.Ta="serverreachability";function LP(t){sn.call(this,fo.Ta,t)}Vt(LP,sn);function Tl(t){let e=fg();Zt(e,new LP(e))}fo.STAT_EVENT="statevent";function VP(t,e){sn.call(this,fo.STAT_EVENT,t),this.stat=e}Vt(VP,sn);function gn(t){let e=fg();Zt(e,new VP(e,t))}fo.Ua="timingevent";function jP(t,e){sn.call(this,fo.Ua,t),this.size=e}Vt(jP,sn);function Rl(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return ie.setTimeout(function(){t()},e)}var pg={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},UP={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function KE(){}KE.prototype.h=null;function fP(t){return t.h||(t.h=t.i())}function BP(){}var Ml={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function QE(){sn.call(this,"d")}Vt(QE,sn);function YE(){sn.call(this,"c")}Vt(YE,sn);var xE;function gg(){}Vt(gg,KE);gg.prototype.g=function(){return new XMLHttpRequest};gg.prototype.i=function(){return{}};xE=new gg;function Pl(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new bl(this),this.P=tz,t=wE?125:void 0,this.V=new dg(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new $P}function $P(){this.i=null,this.g="",this.h=!1}var tz=45e3,HP={},RE={};L=Pl.prototype;L.setTimeout=function(t){this.P=t};function ME(t,e,n){t.L=1,t.A=yg(Ii(e)),t.u=n,t.S=!0,qP(t,null)}function qP(t,e){t.G=Date.now(),Nl(t),t.B=Ii(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),XP(n.i,"t",r),t.o=0,n=t.l.J,t.h=new $P,t.g=vN(t.l,n?e:null,!t.u),0<t.O&&(t.M=new AE(rn(t.Pa,t,t.g),t.O)),kP(t.U,t.g,"readystatechange",t.nb),e=t.I?TP(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),Tl(),ZG(t.j,t.v,t.B,t.m,t.W,t.u)}L.nb=function(t){t=t.target;let e=this.M;e&&Hr(t)==3?e.l():this.Pa(t)};L.Pa=function(t){try{if(t==this.g)e:{let l=Hr(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>l)&&(l!=3||wE||this.g&&(this.h.h||this.g.ja()||yP(this.g)))){this.J||l!=4||e==7||(e==8||0>=d?Tl(3):Tl(2)),mg(this);var n=this.g.da();this.ca=n;t:if(GP(this)){var r=yP(this.g);t="";var i=r.length,s=Hr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){co(this),vl(this);var o="";break t}this.h.i=new ie.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,XG(this.j,this.v,this.B,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!wl(a)){var c=a;break t}}c=null}if(n=c)Qa(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,PE(this,n);else{this.i=!1,this.s=3,gn(12),co(this),vl(this);break e}}this.S?(zP(this,l,o),wE&&this.i&&l==3&&(kP(this.U,this.V,"tick",this.mb),this.V.start())):(Qa(this.j,this.m,o,null),PE(this,o)),l==4&&co(this),this.i&&!this.J&&(l==4?gN(this.l,this):(this.i=!1,Nl(this)))}else Iz(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,gn(12)):(this.s=0,gn(13)),co(this),vl(this)}}}catch{}finally{}};function GP(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function zP(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=nz(t,n),i==RE){e==4&&(t.s=4,gn(14),r=!1),Qa(t.j,t.m,null,"[Incomplete Response]");break}else if(i==HP){t.s=4,gn(15),Qa(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Qa(t.j,t.m,i,null),PE(t,i);GP(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,gn(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),n0(e),e.M=!0,gn(11))):(Qa(t.j,t.m,n,"[Invalid Chunked Response]"),co(t),vl(t))}L.mb=function(){if(this.g){var t=Hr(this.g),e=this.g.ja();this.o<e.length&&(mg(this),zP(this,t,e),this.i&&t!=4&&Nl(this))}};function nz(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?RE:(n=Number(e.substring(n,r)),isNaN(n)?HP:(r+=1,r+n>e.length?RE:(e=e.slice(r,r+n),t.o=r+n,e)))}L.cancel=function(){this.J=!0,co(this)};function Nl(t){t.Y=Date.now()+t.P,WP(t,t.P)}function WP(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=Rl(rn(t.lb,t),e)}function mg(t){t.C&&(ie.clearTimeout(t.C),t.C=null)}L.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(JG(this.j,this.B),this.L!=2&&(Tl(),gn(17)),co(this),this.s=2,vl(this)):WP(this,this.Y-t)};function vl(t){t.l.H==0||t.J||gN(t.l,t)}function co(t){mg(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,zE(t.V),FP(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function PE(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||NE(n.i,t))){if(!t.K&&NE(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)rg(n),wg(n);else break e;t0(n),gn(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=Rl(rn(n.ib,n),6e3));if(1>=tN(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else lo(n,11)}else if((t.K||n.g==t)&&rg(n),!wl(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let c=i[e];if(n.V=c[0],c=c[1],n.H==2)if(c[0]=="c"){n.K=c[1],n.pa=c[2];let l=c[3];l!=null&&(n.ra=l,n.l.info("VER="+n.ra));let d=c[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let h=c[5];h!=null&&typeof h=="number"&&0<h&&(r=1.5*h,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let f=t.g;if(f){let p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=r.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(ZE(s,s.h),s.h=null))}if(r.F){let m=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;m&&(r.Da=m,nt(r.I,r.F,m))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=_N(r,r.J?r.pa:null,r.Y),o.K){nN(r.i,o);var a=o,u=r.L;u&&a.setTimeout(u),a.C&&(mg(a),Nl(a)),r.g=o}else fN(r);0<n.j.length&&Eg(n)}else c[0]!="stop"&&c[0]!="close"||lo(n,7);else n.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?lo(n,7):e0(n):c[0]!="noop"&&n.h&&n.h.Aa(c),n.A=0)}}Tl(4)}catch{}}function rz(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(ag(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function iz(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(ag(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function KP(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(ag(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=iz(t),r=rz(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var QP=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function sz(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function ho(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof ho){this.h=t.h,tg(this,t.j),this.s=t.s,this.g=t.g,ng(this,t.m),this.l=t.l;var e=t.i,n=new Dl;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),pP(this,n),this.o=t.o}else t&&(e=String(t).match(QP))?(this.h=!1,tg(this,e[1]||"",!0),this.s=yl(e[2]||""),this.g=yl(e[3]||"",!0),ng(this,e[4]),this.l=yl(e[5]||"",!0),pP(this,e[6]||"",!0),this.o=yl(e[7]||"")):(this.h=!1,this.i=new Dl(null,this.h))}ho.prototype.toString=function(){var t=[],e=this.j;e&&t.push(_l(e,gP,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(_l(e,gP,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(_l(n,n.charAt(0)=="/"?uz:az,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",_l(n,lz)),t.join("")};function Ii(t){return new ho(t)}function tg(t,e,n){t.j=n?yl(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function ng(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function pP(t,e,n){e instanceof Dl?(t.i=e,dz(t.i,t.h)):(n||(e=_l(e,cz)),t.i=new Dl(e,t.h))}function nt(t,e,n){t.i.set(e,n)}function yg(t){return nt(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function yl(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function _l(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,oz),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function oz(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var gP=/[#\/\?@]/g,az=/[#\?:]/g,uz=/[#\?]/g,cz=/[#\?@]/g,lz=/#/g;function Dl(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function rs(t){t.g||(t.g=new Map,t.h=0,t.i&&sz(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}L=Dl.prototype;L.add=function(t,e){rs(this),this.i=null,t=Xa(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function YP(t,e){rs(t),e=Xa(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function ZP(t,e){return rs(t),e=Xa(t,e),t.g.has(e)}L.forEach=function(t,e){rs(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};L.ta=function(){rs(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};L.Z=function(t){rs(this);let e=[];if(typeof t=="string")ZP(this,t)&&(e=e.concat(this.g.get(Xa(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};L.set=function(t,e){return rs(this),this.i=null,t=Xa(this,t),ZP(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};L.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function XP(t,e,n){YP(t,e),0<n.length&&(t.i=null,t.g.set(Xa(t,e),LE(n)),t.h+=n.length)}L.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function Xa(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function dz(t,e){e&&!t.j&&(rs(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(YP(this,r),XP(this,i,n))},t)),t.j=e}var hz=class{constructor(t,e){this.g=t,this.map=e}};function JP(t){this.l=t||fz,ie.PerformanceNavigationTiming?(t=ie.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(ie.g&&ie.g.Ka&&ie.g.Ka()&&ie.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var fz=10;function eN(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function tN(t){return t.h?1:t.g?t.g.size:0}function NE(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function ZE(t,e){t.g?t.g.add(e):t.h=e}function nN(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}JP.prototype.cancel=function(){if(this.i=rN(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function rN(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return LE(t.i)}var pz=class{stringify(t){return ie.JSON.stringify(t,void 0)}parse(t){return ie.JSON.parse(t,void 0)}};function gz(){this.g=new pz}function mz(t,e,n){let r=n||"";try{KP(t,function(i,s){let o=i;Al(i)&&(o=qE(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function yz(t,e){let n=new hg;if(ie.Image){let r=new Image;r.onload=Kp(Jp,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Kp(Jp,n,r,"TestLoadImage: error",!1,e),r.onabort=Kp(Jp,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Kp(Jp,n,r,"TestLoadImage: timeout",!1,e),ie.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function Jp(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Ol(t){this.l=t.ec||null,this.j=t.ob||!1}Vt(Ol,KE);Ol.prototype.g=function(){return new _g(this.l,this.j)};Ol.prototype.i=function(t){return function(){return t}}({});function _g(t,e){Lt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=XE,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Vt(_g,Lt);var XE=0;L=_g.prototype;L.open=function(t,e){if(this.readyState!=XE)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Sl(this)};L.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||ie).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};L.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,kl(this)),this.readyState=XE};L.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Sl(this)),this.g&&(this.readyState=3,Sl(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof ie.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;iN(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function iN(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}L.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?kl(this):Sl(this),this.readyState==3&&iN(this)}};L.Za=function(t){this.g&&(this.response=this.responseText=t,kl(this))};L.Ya=function(t){this.g&&(this.response=t,kl(this))};L.ka=function(){this.g&&kl(this)};function kl(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Sl(t)}L.setRequestHeader=function(t,e){this.v.append(t,e)};L.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};L.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Sl(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(_g.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var _z=ie.JSON.parse;function mt(t){Lt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=sN,this.L=this.M=!1}Vt(mt,Lt);var sN="",vz=/^https?$/i,wz=["POST","PUT"];L=mt.prototype;L.Oa=function(t){this.M=t};L.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():xE.g(),this.C=this.u?fP(this.u):fP(xE),this.g.onreadystatechange=rn(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){mP(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=ie.FormData&&t instanceof ie.FormData,!(0<=EP(wz,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{uN(this),0<this.B&&((this.L=Ez(this.g))?(this.g.timeout=this.B,this.g.ontimeout=rn(this.ua,this)):this.A=WE(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){mP(this,s)}};function Ez(t){return Za&&typeof t.timeout=="number"&&t.ontimeout!==void 0}L.ua=function(){typeof FE<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Zt(this,"timeout"),this.abort(8))};function mP(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,oN(t),vg(t)}function oN(t){t.F||(t.F=!0,Zt(t,"complete"),Zt(t,"error"))}L.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Zt(this,"complete"),Zt(this,"abort"),vg(this))};L.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),vg(this,!0)),mt.$.N.call(this)};L.La=function(){this.s||(this.G||this.v||this.l?aN(this):this.kb())};L.kb=function(){aN(this)};function aN(t){if(t.h&&typeof FE<"u"&&(!t.C[1]||Hr(t)!=4||t.da()!=2)){if(t.v&&Hr(t)==4)WE(t.La,0,t);else if(Zt(t,"readystatechange"),Hr(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(QP)[1]||null;!i&&ie.self&&ie.self.location&&(i=ie.self.location.protocol.slice(0,-1)),r=!vz.test(i?i.toLowerCase():"")}n=r}if(n)Zt(t,"complete"),Zt(t,"success");else{t.m=6;try{var s=2<Hr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",oN(t)}}finally{vg(t)}}}}function vg(t,e){if(t.g){uN(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Zt(t,"ready");try{n.onreadystatechange=r}catch{}}}function uN(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(ie.clearTimeout(t.A),t.A=null)}L.isActive=function(){return!!this.g};function Hr(t){return t.g?t.g.readyState:0}L.da=function(){try{return 2<Hr(this)?this.g.status:-1}catch{return-1}};L.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};L.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),_z(e)}};function yP(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case sN:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function Iz(t){let e={};t=(t.g&&2<=Hr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(wl(t[r]))continue;var n=KG(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}qG(e,function(r){return r.join(", ")})}L.Ia=function(){return this.m};L.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function cN(t){let e="";return jE(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function JE(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=cN(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):nt(t,e,n))}function gl(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function lN(t){this.Ga=0,this.j=[],this.l=new hg,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=gl("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=gl("baseRetryDelayMs",5e3,t),this.hb=gl("retryDelaySeedMs",1e4,t),this.eb=gl("forwardChannelMaxRetries",2,t),this.xa=gl("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new JP(t&&t.concurrentRequestLimit),this.Ja=new gz,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}L=lN.prototype;L.ra=8;L.H=1;function e0(t){if(dN(t),t.H==3){var e=t.W++,n=Ii(t.I);if(nt(n,"SID",t.K),nt(n,"RID",e),nt(n,"TYPE","terminate"),Fl(t,n),e=new Pl(t,t.l,e),e.L=2,e.A=yg(Ii(n)),n=!1,ie.navigator&&ie.navigator.sendBeacon)try{n=ie.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&ie.Image&&(new Image().src=e.A,n=!0),n||(e.g=vN(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Nl(e)}yN(t)}function wg(t){t.g&&(n0(t),t.g.cancel(),t.g=null)}function dN(t){wg(t),t.u&&(ie.clearTimeout(t.u),t.u=null),rg(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&ie.clearTimeout(t.m),t.m=null)}function Eg(t){if(!eN(t.i)&&!t.m){t.m=!0;var e=t.Na;Il||NP(),Cl||(Il(),Cl=!0),GE.add(e,t),t.C=0}}function Cz(t,e){return tN(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Rl(rn(t.Na,t,e),mN(t,t.C)),t.C++,!0)}L.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new Pl(this,this.l,t),s=this.s;if(this.U&&(s?(s=TP(s),DP(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=hN(this,i,e),n=Ii(this.I),nt(n,"RID",t),nt(n,"CVER",22),this.F&&nt(n,"X-HTTP-Session-Id",this.F),Fl(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(cN(s)))+"&"+e:this.o&&JE(n,this.o,s)),ZE(this.i,i),this.bb&&nt(n,"TYPE","init"),this.P?(nt(n,"$req",e),nt(n,"SID","null"),i.aa=!0,ME(i,n,null)):ME(i,n,e),this.H=2}}else this.H==3&&(t?_P(this,t):this.j.length==0||eN(this.i)||_P(this))};function _P(t,e){var n;e?n=e.m:n=t.W++;let r=Ii(t.I);nt(r,"SID",t.K),nt(r,"RID",n),nt(r,"AID",t.V),Fl(t,r),t.o&&t.s&&JE(r,t.o,t.s),n=new Pl(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=hN(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),ZE(t.i,n),ME(n,r,e)}function Fl(t,e){t.na&&jE(t.na,function(n,r){nt(e,r,n)}),t.h&&KP({},function(n,r){nt(e,r,n)})}function hN(t,e,n){n=Math.min(t.j.length,n);var r=t.h?rn(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let u=0;u<n;u++){let c=i[u].g,l=i[u].map;if(c-=s,0>c)s=Math.max(0,i[u].g-100),a=!1;else try{mz(l,o,"req"+c+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function fN(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Il||NP(),Cl||(Il(),Cl=!0),GE.add(e,t),t.A=0}}function t0(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Rl(rn(t.Ma,t),mN(t,t.A)),t.A++,!0)}L.Ma=function(){if(this.u=null,pN(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Rl(rn(this.jb,this),t)}};L.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,gn(10),wg(this),pN(this))};function n0(t){t.B!=null&&(ie.clearTimeout(t.B),t.B=null)}function pN(t){t.g=new Pl(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Ii(t.wa);nt(e,"RID","rpc"),nt(e,"SID",t.K),nt(e,"AID",t.V),nt(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&nt(e,"TO",t.qa),nt(e,"TYPE","xmlhttp"),Fl(t,e),t.o&&t.s&&JE(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=yg(Ii(e)),n.u=null,n.S=!0,qP(n,t)}L.ib=function(){this.v!=null&&(this.v=null,wg(this),t0(this),gn(19))};function rg(t){t.v!=null&&(ie.clearTimeout(t.v),t.v=null)}function gN(t,e){var n=null;if(t.g==e){rg(t),n0(t),t.g=null;var r=2}else if(NE(t.i,e))n=e.F,nN(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=fg(),Zt(r,new jP(r,n)),Eg(t)}else fN(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&Cz(t,e)||r==2&&t0(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:lo(t,5);break;case 4:lo(t,10);break;case 3:lo(t,6);break;default:lo(t,2)}}}function mN(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function lo(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=rn(t.pb,t);n||(n=new ho("//www.google.com/images/cleardot.gif"),ie.location&&ie.location.protocol=="http"||tg(n,"https"),yg(n)),yz(n.toString(),r)}else gn(2);t.H=0,t.h&&t.h.za(e),yN(t),dN(t)}L.pb=function(t){t?(this.l.info("Successfully pinged google.com"),gn(2)):(this.l.info("Failed to ping google.com"),gn(1))};function yN(t){if(t.H=0,t.ma=[],t.h){let e=rN(t.i);(e.length!=0||t.j.length!=0)&&(cP(t.ma,e),cP(t.ma,t.j),t.i.i.length=0,LE(t.j),t.j.length=0),t.h.ya()}}function _N(t,e,n){var r=n instanceof ho?Ii(n):new ho(n);if(r.g!="")e&&(r.g=e+"."+r.g),ng(r,r.m);else{var i=ie.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new ho(null);r&&tg(s,r),e&&(s.g=e),i&&ng(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&nt(r,n,e),nt(r,"VER",t.ra),Fl(t,r),r}function vN(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new mt(new Ol({ob:n})):new mt(t.va),e.Oa(t.J),e}L.isActive=function(){return!!this.h&&this.h.isActive(this)};function wN(){}L=wN.prototype;L.Ba=function(){};L.Aa=function(){};L.za=function(){};L.ya=function(){};L.isActive=function(){return!0};L.Va=function(){};function ig(){if(Za&&!(10<=Number(UG)))throw Error("Environmental error: no available transport.")}ig.prototype.g=function(t,e){return new On(t,e)};function On(t,e){Lt.call(this),this.g=new lN(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!wl(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!wl(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Ja(this)}Vt(On,Lt);On.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;gn(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=_N(t,null,t.Y),Eg(t)};On.prototype.close=function(){e0(this.g)};On.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=qE(t),t=n);e.j.push(new hz(e.fb++,t)),e.H==3&&Eg(e)};On.prototype.N=function(){this.g.h=null,delete this.j,e0(this.g),delete this.g,On.$.N.call(this)};function EN(t){QE.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Vt(EN,QE);function IN(){YE.call(this),this.status=1}Vt(IN,YE);function Ja(t){this.g=t}Vt(Ja,wN);Ja.prototype.Ba=function(){Zt(this.g,"a")};Ja.prototype.Aa=function(t){Zt(this.g,new EN(t))};Ja.prototype.za=function(t){Zt(this.g,new IN)};Ja.prototype.ya=function(){Zt(this.g,"b")};function bz(){this.blockSize=-1}function wr(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Vt(wr,bz);wr.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function vE(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}wr.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)vE(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){vE(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){vE(this,r),i=0;break}}this.h=i,this.i+=e};wr.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function $e(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var Tz={};function r0(t){return-128<=t&&128>t?LG(t,function(e){return new $e([e|0],0>e?-1:0)}):new $e([t|0],0>t?-1:0)}function qr(t){if(isNaN(t)||!isFinite(t))return Ya;if(0>t)return Yt(qr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=OE;return new $e(e,0)}function CN(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Yt(CN(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=qr(Math.pow(e,8)),r=Ya,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=qr(Math.pow(e,s)),r=r.R(s).add(qr(o))):(r=r.R(n),r=r.add(qr(o)))}return r}var OE=4294967296,Ya=r0(0),kE=r0(1),vP=r0(16777216);L=$e.prototype;L.ea=function(){if(Zn(this))return-Yt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:OE+r)*e,e*=OE}return t};L.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Ei(this))return"0";if(Zn(this))return"-"+Yt(this).toString(t);for(var e=qr(Math.pow(t,6)),n=this,r="";;){var i=og(n,e).g;n=sg(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Ei(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};L.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Ei(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Zn(t){return t.h==-1}L.X=function(t){return t=sg(this,t),Zn(t)?-1:Ei(t)?0:1};function Yt(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new $e(n,~t.h).add(kE)}L.abs=function(){return Zn(this)?Yt(this):this};L.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new $e(n,n[n.length-1]&-2147483648?-1:0)};function sg(t,e){return t.add(Yt(e))}L.R=function(t){if(Ei(this)||Ei(t))return Ya;if(Zn(this))return Zn(t)?Yt(this).R(Yt(t)):Yt(Yt(this).R(t));if(Zn(t))return Yt(this.R(Yt(t)));if(0>this.X(vP)&&0>t.X(vP))return qr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,u=t.D(i)&65535;n[2*r+2*i]+=o*u,eg(n,2*r+2*i),n[2*r+2*i+1]+=s*u,eg(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,eg(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,eg(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new $e(n,0)};function eg(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function ml(t,e){this.g=t,this.h=e}function og(t,e){if(Ei(e))throw Error("division by zero");if(Ei(t))return new ml(Ya,Ya);if(Zn(t))return e=og(Yt(t),e),new ml(Yt(e.g),Yt(e.h));if(Zn(e))return e=og(t,Yt(e)),new ml(Yt(e.g),e.h);if(30<t.g.length){if(Zn(t)||Zn(e))throw Error("slowDivide_ only works with positive integers.");for(var n=kE,r=e;0>=r.X(t);)n=wP(n),r=wP(r);var i=Ka(n,1),s=Ka(r,1);for(r=Ka(r,2),n=Ka(n,2);!Ei(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=Ka(r,1),n=Ka(n,1)}return e=sg(t,i.R(e)),new ml(i,e)}for(i=Ya;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=qr(n),o=s.R(e);Zn(o)||0<o.X(t);)n-=r,s=qr(n),o=s.R(e);Ei(s)&&(s=kE),i=i.add(s),t=sg(t,o)}return new ml(i,t)}L.gb=function(t){return og(this,t).h};L.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new $e(n,this.h&t.h)};L.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new $e(n,this.h|t.h)};L.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new $e(n,this.h^t.h)};function wP(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new $e(n,t.h)}function Ka(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new $e(i,t.h)}ig.prototype.createWebChannel=ig.prototype.g;On.prototype.send=On.prototype.u;On.prototype.open=On.prototype.m;On.prototype.close=On.prototype.close;pg.NO_ERROR=0;pg.TIMEOUT=8;pg.HTTP_ERROR=6;UP.COMPLETE="complete";BP.EventType=Ml;Ml.OPEN="a";Ml.CLOSE="b";Ml.ERROR="c";Ml.MESSAGE="d";Lt.prototype.listen=Lt.prototype.O;mt.prototype.listenOnce=mt.prototype.P;mt.prototype.getLastError=mt.prototype.Sa;mt.prototype.getLastErrorCode=mt.prototype.Ia;mt.prototype.getStatus=mt.prototype.da;mt.prototype.getResponseJson=mt.prototype.Wa;mt.prototype.getResponseText=mt.prototype.ja;mt.prototype.send=mt.prototype.ha;mt.prototype.setWithCredentials=mt.prototype.Oa;wr.prototype.digest=wr.prototype.l;wr.prototype.reset=wr.prototype.reset;wr.prototype.update=wr.prototype.j;$e.prototype.add=$e.prototype.add;$e.prototype.multiply=$e.prototype.R;$e.prototype.modulo=$e.prototype.gb;$e.prototype.compare=$e.prototype.X;$e.prototype.toNumber=$e.prototype.ea;$e.prototype.toString=$e.prototype.toString;$e.prototype.getBits=$e.prototype.D;$e.fromNumber=qr;$e.fromString=CN;var bN=Er.createWebChannelTransport=function(){return new ig},TN=Er.getStatEventTarget=function(){return fg()},Ig=Er.ErrorCode=pg,DN=Er.EventType=UP,SN=Er.Event=fo,i0=Er.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},zie=Er.FetchXmlHttpFactory=Ol,Ll=Er.WebChannel=BP,AN=Er.XhrIo=mt,xN=Er.Md5=wr,po=Er.Integer=$e;var RN="@firebase/firestore";var xt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};xt.UNAUTHENTICATED=new xt(null),xt.GOOGLE_CREDENTIALS=new xt("google-credentials-uid"),xt.FIRST_PARTY=new xt("first-party-uid"),xt.MOCK_USER=new xt("mock-user");var xu="10.7.0";var ls=new Oi("@firebase/firestore");function iu(){return ls.logLevel}function x1(t){ls.setLogLevel(t)}function A(t,...e){if(ls.logLevel<=Hn.DEBUG){let n=e.map(sC);ls.debug(`Firestore (${xu}): ${t}`,...n)}}function wt(t,...e){if(ls.logLevel<=Hn.ERROR){let n=e.map(sC);ls.error(`Firestore (${xu}): ${t}`,...n)}}function Jn(t,...e){if(ls.logLevel<=Hn.WARN){let n=e.map(sC);ls.warn(`Firestore (${xu}): ${t}`,...n)}}function sC(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function U(t="Unexpected state"){let e=`FIRESTORE (${xu}) INTERNAL ASSERTION FAILED: `+t;throw wt(e),new Error(e)}function G(t,e){t||U()}function R1(t,e){t||U()}function V(t,e){return t}var E={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},D=class extends Nh{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Rt=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var Ng=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},c0=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(xt.UNAUTHENTICATED))}shutdown(){}},l0=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},d0=class{constructor(e){this.t=e,this.currentUser=xt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve(),s=new Rt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Rt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let u=s;e.enqueueRetryable(()=>I(this,null,function*(){yield u.promise,yield i(this.currentUser)}))},a=u=>{A("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?a(u):(A("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Rt)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(A("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(G(typeof r.accessToken=="string"),new Ng(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return G(e===null||typeof e=="string"),new xt(e)}},h0=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=xt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},f0=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new h0(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(xt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},p0=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},g0=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&A("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,A("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{A("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):A("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(G(typeof n.token=="string"),this.R=n.token,new p0(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function Dz(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Og=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=Dz(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function ae(t,e){return t<e?-1:t>e?1:0}function fu(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function M1(t){return t+"\0"}var ft=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new D(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new D(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new D(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new D(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ae(this.nanoseconds,e.nanoseconds):ae(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var W=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new ft(0,0))}static max(){return new t(new ft(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var kg=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&U(),r===void 0?r=e.length-n:r>e.length-n&&U(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},Oe=class t extends kg{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new D(E.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},Sz=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Et=class t extends kg{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return Sz.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new D(E.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new D(E.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new D(E.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new D(E.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var k=class t{constructor(e){this.path=e}static fromPath(e){return new t(Oe.fromString(e))}static fromName(e){return new t(Oe.fromString(e).popFirst(5))}static empty(){return new t(Oe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Oe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Oe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new Oe(e.slice()))}};var pu=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};function m0(t){return t.fields.find(e=>e.kind===2)}function mo(t){return t.fields.filter(e=>e.kind!==2)}pu.UNKNOWN_ID=-1;var lu=class{constructor(e,n){this.fieldPath=e,this.kind=n}};var Ql=class t{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new t(0,er.min())}};function P1(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=W.fromTimestamp(r===1e9?new ft(n+1,0):new ft(n,r));return new er(i,k.empty(),e)}function N1(t){return new er(t.readTime,t.key,-1)}var er=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(W.min(),k.empty(),-1)}static max(){return new t(W.max(),k.empty(),-1)}};function oC(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=k.comparator(t.documentKey,e.documentKey),n!==0?n:ae(t.largestBatchId,e.largestBatchId))}var O1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Fg=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Es(t){return I(this,null,function*(){if(t.code!==E.FAILED_PRECONDITION||t.message!==O1)throw t;A("LocalStore","Unexpectedly lost primary lease")})}var w=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&U(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let u=0;u<s;u++){let c=u;n(e[c]).next(l=>{o[c]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};var Lg=class t{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new Rt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Io(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=aC(r.target.error);this.V.reject(new Io(e,i))}}static open(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(s){throw new Io(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(A("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let n=this.transaction.objectStore(e);return new _0(n)}},ds=class t{constructor(e,n,r){this.name=e,this.version=n,this.p=r,t.S(Mh())===12.2&&wt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return A("SimpleDb","Removing database:",e),yo(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Ph())return!1;if(t.C())return!0;let e=Mh(),n=t.S(e),r=0<n&&n<10,i=t.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,n){return e.store(n)}static S(e){let n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){let n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){return I(this,null,function*(){return this.db||(A("SimpleDb","Opening database:",this.name),this.db=yield new Promise((n,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;n(o)},i.onblocked=()=>{r(new Io(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new D(E.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new D(E.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Io(e,o))},i.onupgradeneeded=s=>{A("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.N(o,i.transaction,s.oldVersion,this.version).next(()=>{A("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=n=>this.B(n)),this.db})}L(e){this.B=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){return I(this,null,function*(){let s=n==="readonly",o=0;for(;;){++o;try{this.db=yield this.O(e);let a=Lg.open(this.db,e,s?"readonly":"readwrite",r),u=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),w.reject(c))).toPromise();return u.catch(()=>{}),yield a.m,u}catch(a){let u=a,c=u.name!=="FirebaseError"&&o<3;if(A("SimpleDb","Transaction failed with error:",u.message,"Retrying:",c),this.close(),!c)return Promise.reject(u)}}})}close(){this.db&&this.db.close(),this.db=void 0}},y0=class{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return yo(this.k.delete())}},Io=class extends D{constructor(e,n){super(E.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}};function Is(t){return t.name==="IndexedDbTransactionError"}var _0=class{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(A("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(A("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),yo(r)}add(e){return A("SimpleDb","ADD",this.store.name,e,e),yo(this.store.add(e))}get(e){return yo(this.store.get(e)).next(n=>(n===void 0&&(n=null),A("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return A("SimpleDb","DELETE",this.store.name,e),yo(this.store.delete(e))}count(){return A("SimpleDb","COUNT",this.store.name),yo(this.store.count())}W(e,n){let r=this.options(e,n);if(r.index||typeof this.store.getAll!="function"){let i=this.cursor(r),s=[];return this.G(i,(o,a)=>{s.push(a)}).next(()=>s)}{let i=this.store.getAll(r.range);return new w((s,o)=>{i.onerror=a=>{o(a.target.error)},i.onsuccess=a=>{s(a.target.result)}})}}j(e,n){let r=this.store.getAll(e,n===null?void 0:n);return new w((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,n){A("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,n);r.J=!1;let i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,n){let r;n?r=e:(r={},n=e);let i=this.cursor(r);return this.G(i,n)}Z(e){let n=this.cursor({});return new w((r,i)=>{n.onerror=s=>{let o=aC(s.target.error);i(o)},n.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){let r=[];return new w((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let u=new y0(a),c=n(a.primaryKey,a.value,u);if(c instanceof w){let l=c.catch(d=>(u.done(),w.reject(d)));r.push(l)}u.isDone?i():u.$===null?a.continue():a.continue(u.$)}}).next(()=>w.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){let r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}};function yo(t){return new w((e,n)=>{t.onsuccess=r=>{let i=r.target.result;e(i)},t.onerror=r=>{let i=aC(r.target.error);n(i)}})}var MN=!1;function aC(t){let e=ds.S(Mh());if(e>=12.2&&e<13){let n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){let r=new D("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return MN||(MN=!0,setTimeout(()=>{throw r},0)),r}}return t}var v0=class{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){A("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>I(this,null,function*(){this.task=null;try{A("IndexBackiller",`Documents written: ${yield this.X.te()}`)}catch(n){Is(n)?A("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):yield Es(n)}yield this.ee(6e4)}))}},w0=class{constructor(e,n){this.localStore=e,this.persistence=n}te(e=50){return I(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.ne(n,e))})}ne(e,n){let r=new Set,i=n,s=!0;return w.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return A("IndexBackiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(A("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{let o=N1(s);oC(o,r)>0&&(r=o)}),new er(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}};var kn=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function vd(t){return t==null}function Yl(t){return t===0&&1/t==-1/0}function k1(t){return typeof t=="number"&&Number.isInteger(t)&&!Yl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function mn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=PN(e)),e=Az(t.get(n),e);return PN(e)}function Az(t,e){let n=e,r=t.length;for(let i=0;i<r;i++){let s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function PN(t){return t+""}function Gr(t){let e=t.length;if(G(e>=2),e===2)return G(t.charAt(0)===""&&t.charAt(1)===""),Oe.emptyPath();let n=e-2,r=[],i="";for(let s=0;s<e;){let o=t.indexOf("",s);switch((o<0||o>n)&&U(),t.charAt(o+1)){case"":let a=t.substring(s,o),u;i.length===0?u=a:(i+=a,u=i,i=""),r.push(u);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:U()}s=o+2}return new Oe(r)}var NN=["userId","batchId"];function Sg(t,e){return[t,mn(e)]}function F1(t,e,n){return[t,mn(e),n]}var xz={},Rz=["prefixPath","collectionGroup","readTime","documentId"],Mz=["prefixPath","collectionGroup","documentId"],Pz=["collectionGroup","readTime","prefixPath","documentId"],Nz=["canonicalId","targetId"],Oz=["targetId","path"],kz=["path","targetId"],Fz=["collectionId","parent"],Lz=["indexId","uid"],Vz=["uid","sequenceNumber"],jz=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Uz=["indexId","uid","orderedDocumentKey"],Bz=["userId","collectionPath","documentId"],$z=["userId","collectionPath","largestBatchId"],Hz=["userId","collectionGroup","largestBatchId"],L1=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],qz=[...L1,"documentOverlays"],V1=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],j1=V1,Gz=[...j1,"indexConfiguration","indexState","indexEntries"];var Zl=class extends Fg{constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}};function Ut(t,e){let n=V(t);return ds.M(n.ae,e)}function ON(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Oo(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function U1(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var rt=class t{constructor(e,n){this.comparator=e,this.root=n||Wr.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Wr.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Wr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new cu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new cu(this.root,e,this.comparator,!1)}getReverseIterator(){return new cu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new cu(this.root,e,this.comparator,!0)}},cu=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Wr=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw U();let e=this.left.check();if(e!==this.right.check())throw U();return e+(this.isRed()?0:1)}};Wr.EMPTY=null,Wr.RED=!0,Wr.BLACK=!1;Wr.EMPTY=new class{constructor(){this.size=0}get key(){throw U()}get value(){throw U()}get color(){throw U()}get left(){throw U()}get right(){throw U()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Wr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Qe=class t{constructor(e){this.comparator=e,this.data=new rt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Vg(this.data.getIterator())}getIteratorFrom(e){return new Vg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},Vg=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function eu(t){return t.hasNext()?t.getNext():void 0}var Fn=class t{constructor(e){this.fields=e,e.sort(Et.comparator)}static empty(){return new t([])}unionWith(e){let n=new Qe(Et.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return fu(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var jg=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function B1(){return typeof atob<"u"}var jt=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new jg("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ae(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};jt.EMPTY_BYTE_STRING=new jt("");var zz=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function hs(t){if(G(!!t),typeof t=="string"){let e=0,n=zz.exec(t);if(G(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:yt(t.seconds),nanos:yt(t.nanos)}}function yt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function fs(t){return typeof t=="string"?jt.fromBase64String(t):jt.fromUint8Array(t)}function xm(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function uC(t){let e=t.mapValue.fields.__previous_value__;return xm(e)?uC(e):e}function Xl(t){let e=hs(t.mapValue.fields.__local_write_time__.timestampValue);return new ft(e.seconds,e.nanos)}var E0=class{constructor(e,n,r,i,s,o,a,u,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=c}},ps=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var us={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Ag={nullValue:"NULL_VALUE"};function Co(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?xm(t)?4:$1(t)?9007199254740991:10:U()}function Yr(t,e){if(t===e)return!0;let n=Co(t);if(n!==Co(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Xl(t).isEqual(Xl(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=hs(i.timestampValue),a=hs(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return fs(i.bytesValue).isEqual(fs(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return yt(i.geoPointValue.latitude)===yt(s.geoPointValue.latitude)&&yt(i.geoPointValue.longitude)===yt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return yt(i.integerValue)===yt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=yt(i.doubleValue),a=yt(s.doubleValue);return o===a?Yl(o)===Yl(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return fu(t.arrayValue.values||[],e.arrayValue.values||[],Yr);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(ON(o)!==ON(a))return!1;for(let u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!Yr(o[u],a[u])))return!1;return!0}(t,e);default:return U()}}function Jl(t,e){return(t.values||[]).find(n=>Yr(n,e))!==void 0}function gs(t,e){if(t===e)return 0;let n=Co(t),r=Co(e);if(n!==r)return ae(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ae(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=yt(s.integerValue||s.doubleValue),u=yt(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(t,e);case 3:return kN(t.timestampValue,e.timestampValue);case 4:return kN(Xl(t),Xl(e));case 5:return ae(t.stringValue,e.stringValue);case 6:return function(s,o){let a=fs(s),u=fs(o);return a.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),u=o.split("/");for(let c=0;c<a.length&&c<u.length;c++){let l=ae(a[c],u[c]);if(l!==0)return l}return ae(a.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=ae(yt(s.latitude),yt(o.latitude));return a!==0?a:ae(yt(s.longitude),yt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],u=o.values||[];for(let c=0;c<a.length&&c<u.length;++c){let l=gs(a[c],u[c]);if(l)return l}return ae(a.length,u.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===us.mapValue&&o===us.mapValue)return 0;if(s===us.mapValue)return 1;if(o===us.mapValue)return-1;let a=s.fields||{},u=Object.keys(a),c=o.fields||{},l=Object.keys(c);u.sort(),l.sort();for(let d=0;d<u.length&&d<l.length;++d){let h=ae(u[d],l[d]);if(h!==0)return h;let f=gs(a[u[d]],c[l[d]]);if(f!==0)return f}return ae(u.length,l.length)}(t.mapValue,e.mapValue);default:throw U()}}function kN(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ae(t,e);let n=hs(t),r=hs(e),i=ae(n.seconds,r.seconds);return i!==0?i:ae(n.nanos,r.nanos)}function gu(t){return I0(t)}function I0(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=hs(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return fs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return k.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=I0(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${I0(n.fields[o])}`;return i+"}"}(t.mapValue):U()}function bo(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function C0(t){return!!t&&"integerValue"in t}function ed(t){return!!t&&"arrayValue"in t}function FN(t){return!!t&&"nullValue"in t}function LN(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function xg(t){return!!t&&"mapValue"in t}function ql(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return Oo(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ql(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ql(t.arrayValue.values[n]);return e}return Object.assign({},t)}function $1(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function Wz(t){return"nullValue"in t?Ag:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?bo(ps.empty(),k.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:U()}function Kz(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?bo(ps.empty(),k.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?us:U()}function VN(t,e){let n=gs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function jN(t,e){let n=gs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}var an=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!xg(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ql(n)}setAll(e){let n=Et.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=ql(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());xg(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Yr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];xg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Oo(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(ql(this.value))}};function H1(t){let e=[];return Oo(t.fields,(n,r)=>{let i=new Et([n]);if(xg(r)){let s=H1(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Fn(e)}var Mt=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,W.min(),W.min(),W.min(),an.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,W.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,W.min(),W.min(),an.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,W.min(),W.min(),an.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(W.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=an.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=an.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=W.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Zr=class{constructor(e,n){this.position=e,this.inclusive=n}};function UN(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=k.comparator(k.fromName(o.referenceValue),n.key):r=gs(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function BN(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Yr(t.position[n],e.position[n]))return!1;return!0}var To=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function Qz(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Ug=class{},be=class t extends Ug{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new D0(e,n,r):n==="array-contains"?new x0(e,r):n==="in"?new Bg(e,r):n==="not-in"?new R0(e,r):n==="array-contains-any"?new M0(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new S0(e,r):new A0(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(gs(n,this.value)):n!==null&&Co(this.value)===Co(n)&&this.matchesComparison(gs(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return U()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},He=class t extends Ug{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new t(e,n)}matches(e){return mu(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}};function mu(t){return t.op==="and"}function b0(t){return t.op==="or"}function cC(t){return q1(t)&&mu(t)}function q1(t){for(let e of t.filters)if(e instanceof He)return!1;return!0}function T0(t){if(t instanceof be)return t.field.canonicalString()+t.op.toString()+gu(t.value);if(cC(t))return t.filters.map(e=>T0(e)).join(",");{let e=t.filters.map(n=>T0(n)).join(",");return`${t.op}(${e})`}}function G1(t,e){return t instanceof be?function(r,i){return i instanceof be&&r.op===i.op&&r.field.isEqual(i.field)&&Yr(r.value,i.value)}(t,e):t instanceof He?function(r,i){return i instanceof He&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&G1(o,i.filters[a]),!0):!1}(t,e):void U()}function z1(t,e){let n=t.filters.concat(e);return He.create(n,t.op)}function W1(t){return t instanceof be?function(n){return`${n.field.canonicalString()} ${n.op} ${gu(n.value)}`}(t):t instanceof He?function(n){return n.op.toString()+" {"+n.getFilters().map(W1).join(" ,")+"}"}(t):"Filter"}var D0=class extends be{constructor(e,n,r){super(e,n,r),this.key=k.fromName(r.referenceValue)}matches(e){let n=k.comparator(e.key,this.key);return this.matchesComparison(n)}},S0=class extends be{constructor(e,n){super(e,"in",n),this.keys=K1("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},A0=class extends be{constructor(e,n){super(e,"not-in",n),this.keys=K1("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function K1(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>k.fromName(r.referenceValue))}var x0=class extends be{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return ed(n)&&Jl(n.arrayValue,this.value)}},Bg=class extends be{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&Jl(this.value.arrayValue,n)}},R0=class extends be{constructor(e,n){super(e,"not-in",n)}matches(e){if(Jl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!Jl(this.value.arrayValue,n)}},M0=class extends be{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!ed(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Jl(this.value.arrayValue,r))}};var P0=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}};function N0(t,e=null,n=[],r=[],i=null,s=null,o=null){return new P0(t,e,n,r,i,s,o)}function Do(t){let e=V(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>T0(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),vd(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>gu(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>gu(r)).join(",")),e.ce=n}return e.ce}function wd(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Qz(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!G1(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!BN(t.startAt,e.startAt)&&BN(t.endAt,e.endAt)}function $g(t){return k.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Hg(t,e){return t.filters.filter(n=>n instanceof be&&n.field.isEqual(e))}function $N(t,e,n){let r=Ag,i=!0;for(let s of Hg(t,e)){let o=Ag,a=!0;switch(s.op){case"<":case"<=":o=Wz(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Ag}VN({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];VN({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function HN(t,e,n){let r=us,i=!0;for(let s of Hg(t,e)){let o=us,a=!0;switch(s.op){case">=":case">":o=Kz(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=us}jN({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];jN({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}var Ir=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}};function Q1(t,e,n,r,i,s,o,a){return new Ir(t,e,n,r,i,s,o,a)}function Ru(t){return new Ir(t)}function qN(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function lC(t){return t.collectionGroup!==null}function du(t){let e=V(t);if(e.le===null){e.le=[];let n=new Set;for(let s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Qe(Et.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new To(s,r))}),n.has(Et.keyField().canonicalString())||e.le.push(new To(Et.keyField(),r))}return e.le}function yn(t){let e=V(t);return e.he||(e.he=Yz(e,du(t))),e.he}function Yz(t,e){if(t.limitType==="F")return N0(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new To(i.field,s)});let n=t.endAt?new Zr(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Zr(t.startAt.position,t.startAt.inclusive):null;return N0(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function O0(t,e){let n=t.filters.concat([e]);return new Ir(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function qg(t,e,n){return new Ir(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ed(t,e){return wd(yn(t),yn(e))&&t.limitType===e.limitType}function Y1(t){return`${Do(yn(t))}|lt:${t.limitType}`}function su(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>W1(i)).join(", ")}]`),vd(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>gu(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>gu(i)).join(",")),`Target(${r})`}(yn(t))}; limitType=${t.limitType})`}function Id(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):k.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of du(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,u){let c=UN(o,a,u);return o.inclusive?c<=0:c<0}(r.startAt,du(r),i)||r.endAt&&!function(o,a,u){let c=UN(o,a,u);return o.inclusive?c>=0:c>0}(r.endAt,du(r),i))}(t,e)}function Z1(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function X1(t){return(e,n)=>{let r=!1;for(let i of du(t)){let s=Zz(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Zz(t,e,n){let r=t.field.isKeyField()?k.comparator(e.key,n.key):function(s,o,a){let u=o.data.field(s),c=a.data.field(s);return u!==null&&c!==null?gs(u,c):U()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return U()}}var Xr=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Oo(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return U1(this.inner)}size(){return this.innerSize}};var Xz=new rt(k.comparator);function xn(){return Xz}var J1=new rt(k.comparator);function $l(...t){let e=J1;for(let n of t)e=e.insert(n.key,n);return e}function eO(t){let e=J1;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function zr(){return Gl()}function tO(){return Gl()}function Gl(){return new Xr(t=>t.toString(),(t,e)=>t.isEqual(e))}var Jz=new rt(k.comparator),e9=new Qe(k.comparator);function de(...t){let e=e9;for(let n of t)e=e.add(n);return e}var t9=new Qe(ae);function dC(){return t9}function nO(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Yl(e)?"-0":e}}function rO(t){return{integerValue:""+t}}function iO(t,e){return k1(e)?rO(e):nO(t,e)}var yu=class{constructor(){this._=void 0}};function n9(t,e,n){return t instanceof ms?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&xm(s)&&(s=uC(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Ti?oO(t,e):t instanceof Di?aO(t,e):function(i,s){let o=sO(i,s),a=GN(o)+GN(i.Ie);return C0(o)&&C0(i.Ie)?rO(a):nO(i.serializer,a)}(t,e)}function r9(t,e,n){return t instanceof Ti?oO(t,e):t instanceof Di?aO(t,e):n}function sO(t,e){return t instanceof ys?function(r){return C0(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var ms=class extends yu{},Ti=class extends yu{constructor(e){super(),this.elements=e}};function oO(t,e){let n=uO(e);for(let r of t.elements)n.some(i=>Yr(i,r))||n.push(r);return{arrayValue:{values:n}}}var Di=class extends yu{constructor(e){super(),this.elements=e}};function aO(t,e){let n=uO(e);for(let r of t.elements)n=n.filter(i=>!Yr(i,r));return{arrayValue:{values:n}}}var ys=class extends yu{constructor(e,n){super(),this.serializer=e,this.Ie=n}};function GN(t){return yt(t.integerValue||t.doubleValue)}function uO(t){return ed(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var So=class{constructor(e,n){this.field=e,this.transform=n}};function i9(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Ti&&i instanceof Ti||r instanceof Di&&i instanceof Di?fu(r.elements,i.elements,Yr):r instanceof ys&&i instanceof ys?Yr(r.Ie,i.Ie):r instanceof ms&&i instanceof ms}(t.transform,e.transform)}var k0=class{constructor(e,n){this.version=e,this.transformResults=n}},_t=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Rg(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var _u=class{};function cO(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new vs(t.key,_t.none()):new _s(t.key,t.data,_t.none());{let n=t.data,r=an.empty(),i=new Qe(Et.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Cr(t.key,r,new Fn(i.toArray()),_t.none())}}function s9(t,e,n){t instanceof _s?function(i,s,o){let a=i.value.clone(),u=WN(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Cr?function(i,s,o){if(!Rg(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=WN(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(lO(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function zl(t,e,n,r){return t instanceof _s?function(s,o,a,u){if(!Rg(s.precondition,o))return a;let c=s.value.clone(),l=KN(s.fieldTransforms,u,o);return c.setAll(l),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof Cr?function(s,o,a,u){if(!Rg(s.precondition,o))return a;let c=KN(s.fieldTransforms,u,o),l=o.data;return l.setAll(lO(s)),l.setAll(c),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,o,a){return Rg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function o9(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=sO(r.transform,i||null);s!=null&&(n===null&&(n=an.empty()),n.set(r.field,s))}return n||null}function zN(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&fu(r,i,(s,o)=>i9(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var _s=class extends _u{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Cr=class extends _u{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function lO(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function WN(t,e,n){let r=new Map;G(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,r9(o,a,n[i]))}return r}function KN(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,n9(s,o,e))}return r}var vs=class extends _u{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},td=class extends _u{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var nd=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&s9(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=zl(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=zl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=tO();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let u=cO(o,a);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(W.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),de())}isEqual(e){return this.batchId===e.batchId&&fu(this.mutations,e.mutations,(n,r)=>zN(n,r))&&fu(this.baseMutations,e.baseMutations,(n,r)=>zN(n,r))}},F0=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){G(e.mutations.length===r.length);let i=function(){return Jz}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var rd=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var L0=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var St,De;function dO(t){switch(t){default:return U();case E.CANCELLED:case E.UNKNOWN:case E.DEADLINE_EXCEEDED:case E.RESOURCE_EXHAUSTED:case E.INTERNAL:case E.UNAVAILABLE:case E.UNAUTHENTICATED:return!1;case E.INVALID_ARGUMENT:case E.NOT_FOUND:case E.ALREADY_EXISTS:case E.PERMISSION_DENIED:case E.FAILED_PRECONDITION:case E.ABORTED:case E.OUT_OF_RANGE:case E.UNIMPLEMENTED:case E.DATA_LOSS:return!0}}function hO(t){if(t===void 0)return wt("GRPC error has no .code"),E.UNKNOWN;switch(t){case St.OK:return E.OK;case St.CANCELLED:return E.CANCELLED;case St.UNKNOWN:return E.UNKNOWN;case St.DEADLINE_EXCEEDED:return E.DEADLINE_EXCEEDED;case St.RESOURCE_EXHAUSTED:return E.RESOURCE_EXHAUSTED;case St.INTERNAL:return E.INTERNAL;case St.UNAVAILABLE:return E.UNAVAILABLE;case St.UNAUTHENTICATED:return E.UNAUTHENTICATED;case St.INVALID_ARGUMENT:return E.INVALID_ARGUMENT;case St.NOT_FOUND:return E.NOT_FOUND;case St.ALREADY_EXISTS:return E.ALREADY_EXISTS;case St.PERMISSION_DENIED:return E.PERMISSION_DENIED;case St.FAILED_PRECONDITION:return E.FAILED_PRECONDITION;case St.ABORTED:return E.ABORTED;case St.OUT_OF_RANGE:return E.OUT_OF_RANGE;case St.UNIMPLEMENTED:return E.UNIMPLEMENTED;case St.DATA_LOSS:return E.DATA_LOSS;default:return U()}}(De=St||(St={}))[De.OK=0]="OK",De[De.CANCELLED=1]="CANCELLED",De[De.UNKNOWN=2]="UNKNOWN",De[De.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",De[De.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",De[De.NOT_FOUND=5]="NOT_FOUND",De[De.ALREADY_EXISTS=6]="ALREADY_EXISTS",De[De.PERMISSION_DENIED=7]="PERMISSION_DENIED",De[De.UNAUTHENTICATED=16]="UNAUTHENTICATED",De[De.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",De[De.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",De[De.ABORTED=10]="ABORTED",De[De.OUT_OF_RANGE=11]="OUT_OF_RANGE",De[De.UNIMPLEMENTED=12]="UNIMPLEMENTED",De[De.INTERNAL=13]="INTERNAL",De[De.UNAVAILABLE=14]="UNAVAILABLE",De[De.DATA_LOSS=15]="DATA_LOSS";var QN=null;function fO(){return new TextEncoder}var a9=new po([4294967295,4294967295],0);function YN(t){let e=fO().encode(t),n=new xN;return n.update(e),new Uint8Array(n.digest())}function ZN(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new po([n,r],0),new po([i,s],0)]}var V0=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Eo(`Invalid padding: ${n}`);if(r<0)throw new Eo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Eo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Eo(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=po.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(po.fromNumber(r)));return i.compare(a9)===1&&(i=new po([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let n=YN(e),[r,i]=ZN(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;let n=YN(e),[r,i]=ZN(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);this.Re(o)}}Re(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},Eo=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var id=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,sd.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(W.min(),i,new rt(ae),xn(),de())}},sd=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,de(),de(),de())}};var hu=class{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}},Gg=class{constructor(e,n){this.targetId=e,this.fe=n}},zg=class{constructor(e,n,r=jt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},Wg=class{constructor(){this.ge=0,this.pe=JN(),this.ye=jt.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=de(),n=de(),r=de();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:U()}}),new sd(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=JN()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,G(this.ge>=0)}Be(){this.Se=!0,this.we=!0}},j0=class{constructor(e){this.Le=e,this.ke=new Map,this.qe=xn(),this.Qe=XN(),this.Ke=new rt(ae)}$e(e){for(let n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(let n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{let r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:U()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){let n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){let s=i.target;if($g(s))if(r===0){let o=new k(s.path);this.We(n,o,Mt.newNoDocument(o,W.min()))}else G(r===1);else{let o=this.Ze(n);if(o!==r){let a=this.Xe(e),u=a?this.et(a,e,o):1;if(u!==0){this.He(n);let c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,c)}QN?.tt(function(l,d,h,f,p){var m,g,_,y,v,S;let F={localCacheCount:l,existenceFilterCount:d.count,databaseId:h.database,projectId:h.projectId},x=d.unchangedNames;return x&&(F.bloomFilter={applied:p===0,hashCount:(m=x?.hashCount)!==null&&m!==void 0?m:0,bitmapLength:(y=(_=(g=x?.bits)===null||g===void 0?void 0:g.bitmap)===null||_===void 0?void 0:_.length)!==null&&y!==void 0?y:0,padding:(S=(v=x?.bits)===null||v===void 0?void 0:v.padding)!==null&&S!==void 0?S:0,mightContain:M=>{var P;return(P=f?.mightContain(M))!==null&&P!==void 0&&P}}),F}(o,e.fe,this.Le.nt(),a,u))}}}}Xe(e){let n=e.fe.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=fs(r).toUint8Array()}catch(u){if(u instanceof jg)return Jn("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new V0(o,i,s)}catch(u){return Jn(u instanceof Eo?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Te===0?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){let r=this.Le.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){let n=new Map;this.ke.forEach((s,o)=>{let a=this.Ye(o);if(a){if(s.current&&$g(a.target)){let u=new k(a.target.path);this.qe.get(u)!==null||this.st(o,u)||this.We(o,u,Mt.newNoDocument(u,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=de();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{let c=this.Ye(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));let i=new id(e,n,this.Ke,this.qe,r);return this.qe=xn(),this.Qe=XN(),this.Ke=new rt(ae),i}Ue(e,n){if(!this.je(e))return;let r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;let i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){let n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new Wg,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new Qe(ae),this.Qe=this.Qe.insert(e,n)),n}je(e){let n=this.Ye(e)!==null;return n||A("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){let n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new Wg),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}};function XN(){return new rt(k.comparator)}function JN(){return new rt(k.comparator)}var u9=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),c9=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),l9=(()=>({and:"AND",or:"OR"}))(),U0=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function B0(t,e){return t.useProto3Json||vd(e)?e:{value:e}}function vu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function pO(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function d9(t,e){return vu(t,e.toTimestamp())}function It(t){return G(!!t),W.fromTimestamp(function(n){let r=hs(n);return new ft(r.seconds,r.nanos)}(t))}function hC(t,e){return function(r){return new Oe(["projects",r.projectId,"databases",r.database])}(t).child("documents").child(e).canonicalString()}function gO(t){let e=Oe.fromString(t);return G(bO(e)),e}function od(t,e){return hC(t.databaseId,e.path)}function Kr(t,e){let n=gO(e);if(n.get(1)!==t.databaseId.projectId)throw new D(E.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new D(E.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new k(yO(n))}function $0(t,e){return hC(t.databaseId,e)}function mO(t){let e=gO(t);return e.length===4?Oe.emptyPath():yO(e)}function ad(t){return new Oe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function yO(t){return G(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function e1(t,e,n){return{name:od(t,e),fields:n.value.mapValue.fields}}function _O(t,e,n){let r=Kr(t,e.name),i=It(e.updateTime),s=e.createTime?It(e.createTime):W.min(),o=new an({mapValue:{fields:e.fields}}),a=Mt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function h9(t,e){return"found"in e?function(r,i){G(!!i.found),i.found.name,i.found.updateTime;let s=Kr(r,i.found.name),o=It(i.found.updateTime),a=i.found.createTime?It(i.found.createTime):W.min(),u=new an({mapValue:{fields:i.found.fields}});return Mt.newFoundDocument(s,o,a,u)}(t,e):"missing"in e?function(r,i){G(!!i.missing),G(!!i.readTime);let s=Kr(r,i.missing),o=It(i.readTime);return Mt.newNoDocument(s,o)}(t,e):U()}function f9(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:U()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,l){return c.useProto3Json?(G(l===void 0||typeof l=="string"),jt.fromBase64String(l||"")):(G(l===void 0||l instanceof Uint8Array),jt.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){let l=c.code===void 0?E.UNKNOWN:hO(c.code);return new D(l,c.message||"")}(o);n=new zg(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Kr(t,r.document.name),s=It(r.document.updateTime),o=r.document.createTime?It(r.document.createTime):W.min(),a=new an({mapValue:{fields:r.document.fields}}),u=Mt.newFoundDocument(i,s,o,a),c=r.targetIds||[],l=r.removedTargetIds||[];n=new hu(c,l,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Kr(t,r.document),s=r.readTime?It(r.readTime):W.min(),o=Mt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new hu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Kr(t,r.document),s=r.removedTargetIds||[];n=new hu([],s,i,null)}else{if(!("filter"in e))return U();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new L0(i,s),a=r.targetId;n=new Gg(a,o)}}return n}function ud(t,e){let n;if(e instanceof _s)n={update:e1(t,e.key,e.value)};else if(e instanceof vs)n={delete:od(t,e.key)};else if(e instanceof Cr)n={update:e1(t,e.key,e.data),updateMask:v9(e.fieldMask)};else{if(!(e instanceof td))return U();n={verify:od(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof ms)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ti)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Di)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ys)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw U()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:d9(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:U()}(t,e.precondition)),n}function H0(t,e){let n=e.currentDocument?function(s){return s.updateTime!==void 0?_t.updateTime(It(s.updateTime)):s.exists!==void 0?_t.exists(s.exists):_t.none()}(e.currentDocument):_t.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;if("setToServerValue"in a)G(a.setToServerValue==="REQUEST_TIME"),u=new ms;else if("appendMissingElements"in a){let l=a.appendMissingElements.values||[];u=new Ti(l)}else if("removeAllFromArray"in a){let l=a.removeAllFromArray.values||[];u=new Di(l)}else"increment"in a?u=new ys(o,a.increment):U();let c=Et.fromServerFormat(a.fieldPath);return new So(c,u)}(t,i)):[];if(e.update){e.update.name;let i=Kr(t,e.update.name),s=new an({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(u){let c=u.fieldPaths||[];return new Fn(c.map(l=>Et.fromServerFormat(l)))}(e.updateMask);return new Cr(i,s,o,n,r)}return new _s(i,s,n,r)}if(e.delete){let i=Kr(t,e.delete);return new vs(i,n)}if(e.verify){let i=Kr(t,e.verify);return new td(i,n)}return U()}function p9(t,e){return t&&t.length>0?(G(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?It(i.updateTime):It(s);return o.isEqual(W.min())&&(o=It(s)),new k0(o,i.transformResults||[])}(n,e))):[]}function vO(t,e){return{documents:[$0(t,e.path)]}}function wO(t,e){let n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=$0(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=$0(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);let i=function(u){if(u.length!==0)return CO(He.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);let s=function(u){if(u.length!==0)return u.map(c=>function(d){return{field:ou(d.field),direction:m9(d.dir)}}(c))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);let o=B0(t,e.limit);return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),n}function EO(t){let e=mO(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){G(r===1);let l=n.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];n.where&&(s=function(d){let h=IO(d);return h instanceof He&&cC(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(h=>function(p){return new To(au(p.field),function(g){switch(g){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,vd(h)?null:h}(n.limit));let u=null;n.startAt&&(u=function(d){let h=!!d.before,f=d.values||[];return new Zr(f,h)}(n.startAt));let c=null;return n.endAt&&(c=function(d){let h=!d.before,f=d.values||[];return new Zr(f,h)}(n.endAt)),Q1(e,i,o,s,a,"F",u,c)}function g9(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return U()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function IO(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=au(n.unaryFilter.field);return be.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=au(n.unaryFilter.field);return be.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=au(n.unaryFilter.field);return be.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=au(n.unaryFilter.field);return be.create(o,"!=",{nullValue:"NULL_VALUE"});default:return U()}}(t):t.fieldFilter!==void 0?function(n){return be.create(au(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return U()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return He.create(n.compositeFilter.filters.map(r=>IO(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return U()}}(n.compositeFilter.op))}(t):U()}function m9(t){return u9[t]}function y9(t){return c9[t]}function _9(t){return l9[t]}function ou(t){return{fieldPath:t.canonicalString()}}function au(t){return Et.fromServerFormat(t.fieldPath)}function CO(t){return t instanceof be?function(n){if(n.op==="=="){if(LN(n.value))return{unaryFilter:{field:ou(n.field),op:"IS_NAN"}};if(FN(n.value))return{unaryFilter:{field:ou(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(LN(n.value))return{unaryFilter:{field:ou(n.field),op:"IS_NOT_NAN"}};if(FN(n.value))return{unaryFilter:{field:ou(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ou(n.field),op:y9(n.op),value:n.value}}}(t):t instanceof He?function(n){let r=n.getFilters().map(i=>CO(i));return r.length===1?r[0]:{compositeFilter:{op:_9(n.op),filters:r}}}(t):U()}function v9(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function bO(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var wu=class t{constructor(e,n,r,i,s=W.min(),o=W.min(),a=jt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Kg=class{constructor(e){this.ut=e}};function w9(t,e){let n;if(e.document)n=_O(t.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=k.fromSegments(e.noDocument.path),i=xo(e.noDocument.readTime);n=Mt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return U();{let r=k.fromSegments(e.unknownDocument.path),i=xo(e.unknownDocument.version);n=Mt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){let s=new ft(i[0],i[1]);return W.fromTimestamp(s)}(e.readTime)),n}function t1(t,e){let n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Qg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:od(s,o.key),fields:o.data.value.mapValue.fields,updateTime:vu(s,o.version.toTimestamp()),createTime:vu(s,o.createTime.toTimestamp())}}(t.ut,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Ao(e.version)};else{if(!e.isUnknownDocument())return U();r.unknownDocument={path:n.path.toArray(),version:Ao(e.version)}}return r}function Qg(t){let e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ao(t){let e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function xo(t){let e=new ft(t.seconds,t.nanoseconds);return W.fromTimestamp(e)}function _o(t,e){let n=(e.baseMutations||[]).map(s=>H0(t.ut,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>H0(t.ut,s)),i=ft.fromMillis(e.localWriteTimeMs);return new nd(e.batchId,i,n,r)}function Hl(t){let e=xo(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?xo(t.lastLimboFreeSnapshotVersion):W.min(),r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return G(s.documents.length===1),yn(Ru(mO(s.documents[0])))}(t.query):function(s){return yn(EO(s))}(t.query),new wu(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,jt.fromBase64String(t.resumeToken))}function TO(t,e){let n=Ao(e.snapshotVersion),r=Ao(e.lastLimboFreeSnapshotVersion),i;i=$g(e.target)?vO(t.ut,e.target):wO(t.ut,e.target);let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Do(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function fC(t){let e=EO({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?qg(e,e.limit,"L"):e}function s0(t,e){return new rd(e.largestBatchId,H0(t.ut,e.overlayMutation))}function n1(t,e){let n=e.path.lastSegment();return[t,mn(e.path.popLast()),n]}function r1(t,e,n,r){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:Ao(r.readTime),documentKey:mn(r.documentKey.path),largestBatchId:r.largestBatchId}}var q0=class{getBundleMetadata(e,n){return i1(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:xo(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return i1(e).put(function(i){return{bundleId:i.id,createTime:Ao(It(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return s1(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:fC(s.bundledQuery),readTime:xo(s.readTime)}}(r)})}saveNamedQuery(e,n){return s1(e).put(function(i){return{name:i.name,readTime:Ao(It(i.readTime)),bundledQuery:i.bundledQuery}}(n))}};function i1(t){return Ut(t,"bundles")}function s1(t){return Ut(t,"namedQueries")}var Yg=class t{constructor(e,n){this.serializer=e,this.userId=n}static ct(e,n){let r=n.uid||"";return new t(e,r)}getOverlay(e,n){return Vl(e).get(n1(this.userId,n)).next(r=>r?s0(this.serializer,r):null)}getOverlays(e,n){let r=zr();return w.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){let i=[];return r.forEach((s,o)=>{let a=new rd(n,o);i.push(this.lt(e,a))}),w.waitFor(i)}removeOverlaysForBatchId(e,n,r){let i=new Set;n.forEach(o=>i.add(mn(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Vl(e).H("collectionPathOverlayIndex",a))}),w.waitFor(s)}getOverlaysForCollection(e,n,r){let i=zr(),s=mn(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Vl(e).W("collectionPathOverlayIndex",o).next(a=>{for(let u of a){let c=s0(this.serializer,u);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,n,r,i){let s=zr(),o,a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Vl(e).Y({index:"collectionGroupOverlayIndex",range:a},(u,c,l)=>{let d=s0(this.serializer,c);s.size()<i||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):l.done()}).next(()=>s)}lt(e,n){return Vl(e).put(function(i,s,o){let[a,u,c]=n1(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:ud(i.ut,o.mutation)}}(this.serializer,this.userId,n))}};function Vl(t){return Ut(t,"documentOverlays")}var Ci=class{constructor(){}ht(e,n){this.Pt(e,n),n.It()}Pt(e,n){if("nullValue"in e)this.Tt(n,5);else if("booleanValue"in e)this.Tt(n,10),n.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(n,15),n.Et(yt(e.integerValue));else if("doubleValue"in e){let r=yt(e.doubleValue);isNaN(r)?this.Tt(n,13):(this.Tt(n,15),Yl(r)?n.Et(0):n.Et(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Tt(n,20),typeof r=="string"?n.dt(r):(n.dt(`${r.seconds||""}`),n.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,n),this.Rt(n);else if("bytesValue"in e)this.Tt(n,30),n.Vt(fs(e.bytesValue)),this.Rt(n);else if("referenceValue"in e)this.ft(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Tt(n,45),n.Et(r.latitude||0),n.Et(r.longitude||0)}else"mapValue"in e?$1(e)?this.Tt(n,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,n),this.Rt(n)):"arrayValue"in e?(this.yt(e.arrayValue,n),this.Rt(n)):U()}At(e,n){this.Tt(n,25),this.wt(e,n)}wt(e,n){n.dt(e)}gt(e,n){let r=e.fields||{};this.Tt(n,55);for(let i of Object.keys(r))this.At(i,n),this.Pt(r[i],n)}yt(e,n){let r=e.values||[];this.Tt(n,50);for(let i of r)this.Pt(i,n)}ft(e,n){this.Tt(n,37),k.fromName(e).path.forEach(r=>{this.Tt(n,60),this.wt(r,n)})}Tt(e,n){e.Et(n)}Rt(e){e.Et(2)}};Ci.St=new Ci;function E9(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function o1(t){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=E9(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}var G0=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Dt(r.value),r=n.next();this.Ct()}vt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{let i=n.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{let i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){let n=this.Bt(e),r=o1(n);this.Lt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}kt(e){let n=this.Bt(e),r=o1(n);this.Lt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Lt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Bt(e){let n=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Dt(e){let n=255&e;n===0?(this.Qt(0),this.Qt(255)):n===255?(this.Qt(255),this.Qt(0)):this.Qt(n)}Ft(e){let n=255&e;n===0?(this.$t(0),this.$t(255)):n===255?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Lt(1),this.buffer[this.position++]=e}$t(e){this.Lt(1),this.buffer[this.position++]=~e}Lt(e){let n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},z0=class{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}},W0=class{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}},vo=class{constructor(){this.Wt=new G0,this.Gt=new z0(this.Wt),this.zt=new W0(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return e===0?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}};var wo=class t{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Ht(){let e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}};function is(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=a1(t.arrayValue,e.arrayValue),n!==0?n:(n=a1(t.directionalValue,e.directionalValue),n!==0?n:k.comparator(t.documentKey,e.documentKey)))}function a1(t,e){for(let n=0;n<t.length&&n<e.length;++n){let r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}var Zg=class{constructor(e){this.Jt=new Qe((n,r)=>Et.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(let n of e.filters){let r=n;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(G(e.collectionGroup===this.collectionId),this.Xt)return!1;let n=m0(e);if(n!==void 0&&!this.tn(n))return!1;let r=mo(e),i=new Set,s=0,o=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){let a=this.Jt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let u=r[s];if(!this.nn(a,u)||!this.rn(this.Yt[o++],u))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Yt.length||!this.rn(this.Yt[o++],a))return!1}return!0}sn(){if(this.Xt)return null;let e=new Qe(Et.comparator),n=[];for(let r of this.Zt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new lu(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new lu(r.field,0))}for(let r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new lu(r.field,r.dir==="asc"?0:1)));return new pu(pu.UNKNOWN_ID,this.collectionId,n,Ql.empty())}tn(e){for(let n of this.Zt)if(this.nn(n,e))return!0;return!1}nn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}rn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}};function DO(t){var e,n;if(G(t instanceof be||t instanceof He),t instanceof be){if(t instanceof Bg){let i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>be.create(t.field,"==",s)))||[];return He.create(i,"or")}return t}let r=t.filters.map(i=>DO(i));return He.create(r,t.op)}function I9(t){if(t.getFilters().length===0)return[];let e=Y0(DO(t));return G(SO(e)),K0(e)||Q0(e)?[e]:e.getFilters()}function K0(t){return t instanceof be}function Q0(t){return t instanceof He&&cC(t)}function SO(t){return K0(t)||Q0(t)||function(n){if(n instanceof He&&b0(n)){for(let r of n.getFilters())if(!K0(r)&&!Q0(r))return!1;return!0}return!1}(t)}function Y0(t){if(G(t instanceof be||t instanceof He),t instanceof be)return t;if(t.filters.length===1)return Y0(t.filters[0]);let e=t.filters.map(r=>Y0(r)),n=He.create(e,t.op);return n=Xg(n),SO(n)?n:(G(n instanceof He),G(mu(n)),G(n.filters.length>1),n.filters.reduce((r,i)=>pC(r,i)))}function pC(t,e){let n;return G(t instanceof be||t instanceof He),G(e instanceof be||e instanceof He),n=t instanceof be?e instanceof be?function(i,s){return He.create([i,s],"and")}(t,e):u1(t,e):e instanceof be?u1(e,t):function(i,s){if(G(i.filters.length>0&&s.filters.length>0),mu(i)&&mu(s))return z1(i,s.getFilters());let o=b0(i)?i:s,a=b0(i)?s:i,u=o.filters.map(c=>pC(c,a));return He.create(u,"or")}(t,e),Xg(n)}function u1(t,e){if(mu(e))return z1(e,t.getFilters());{let n=e.filters.map(r=>pC(t,r));return He.create(n,"or")}}function Xg(t){if(G(t instanceof be||t instanceof He),t instanceof be)return t;let e=t.getFilters();if(e.length===1)return Xg(e[0]);if(q1(t))return t;let n=e.map(i=>Xg(i)),r=[];return n.forEach(i=>{i instanceof be?r.push(i):i instanceof He&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:He.create(r,t.op)}var Z0=class{constructor(){this.on=new cd}addToCollectionParentIndex(e,n){return this.on.add(n),w.resolve()}getCollectionParents(e,n){return w.resolve(this.on.getEntries(n))}addFieldIndex(e,n){return w.resolve()}deleteFieldIndex(e,n){return w.resolve()}deleteAllFieldIndexes(e){return w.resolve()}createTargetIndexes(e,n){return w.resolve()}getDocumentsMatchingTarget(e,n){return w.resolve(null)}getIndexType(e,n){return w.resolve(0)}getFieldIndexes(e,n){return w.resolve([])}getNextCollectionGroupToUpdate(e){return w.resolve(null)}getMinOffset(e,n){return w.resolve(er.min())}getMinOffsetFromCollectionGroup(e,n){return w.resolve(er.min())}updateCollectionGroup(e,n,r){return w.resolve()}updateIndexEntries(e,n){return w.resolve()}},cd=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Qe(Oe.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Qe(Oe.comparator)).toArray()}};var Cg=new Uint8Array(0),X0=class{constructor(e,n){this.user=e,this.databaseId=n,this._n=new cd,this.an=new Xr(r=>Do(r),(r,i)=>wd(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this._n.has(n)){let r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this._n.add(n)});let s={collectionId:r,parent:mn(i)};return c1(e).put(s)}return w.resolve()}getCollectionParents(e,n){let r=[],i=IDBKeyRange.bound([n,""],[M1(n),""],!1,!0);return c1(e).W(i).next(s=>{for(let o of s){if(o.collectionId!==n)break;r.push(Gr(o.parent))}return r})}addFieldIndex(e,n){let r=jl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(n);delete i.indexId;let s=r.add(i);if(n.indexState){let o=nu(e);return s.next(a=>{o.put(r1(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){let r=jl(e),i=nu(e),s=tu(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let n=jl(e),r=tu(e),i=nu(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return w.forEach(this.un(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new Zg(r).sn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){let r=tu(e),i=!0,s=new Map;return w.forEach(this.un(n),o=>this.cn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=de(),a=[];return w.forEach(s,(u,c)=>{A("IndexedDbIndexManager",`Using index ${function(v){return`id=${v.indexId}|cg=${v.collectionGroup}|f=${v.fields.map(S=>`${S.fieldPath}:${S.kind}`).join(",")}`}(u)} to execute ${Do(n)}`);let l=function(v,S){let F=m0(S);if(F===void 0)return null;for(let x of Hg(v,F.fieldPath))switch(x.op){case"array-contains-any":return x.value.arrayValue.values||[];case"array-contains":return[x.value]}return null}(c,u),d=function(v,S){let F=new Map;for(let x of mo(S))for(let M of Hg(v,x.fieldPath))switch(M.op){case"==":case"in":F.set(x.fieldPath.canonicalString(),M.value);break;case"not-in":case"!=":return F.set(x.fieldPath.canonicalString(),M.value),Array.from(F.values())}return null}(c,u),h=function(v,S){let F=[],x=!0;for(let M of mo(S)){let P=M.kind===0?$N(v,M.fieldPath,v.startAt):HN(v,M.fieldPath,v.startAt);F.push(P.value),x&&(x=P.inclusive)}return new Zr(F,x)}(c,u),f=function(v,S){let F=[],x=!0;for(let M of mo(S)){let P=M.kind===0?HN(v,M.fieldPath,v.endAt):$N(v,M.fieldPath,v.endAt);F.push(P.value),x&&(x=P.inclusive)}return new Zr(F,x)}(c,u),p=this.ln(u,c,h),m=this.ln(u,c,f),g=this.hn(u,c,d),_=this.Pn(u.indexId,l,p,h.inclusive,m,f.inclusive,g);return w.forEach(_,y=>r.j(y,n.limit).next(v=>{v.forEach(S=>{let F=k.fromSegments(S.documentKey);o.has(F)||(o=o.add(F),a.push(F))})}))}).next(()=>a)}return w.resolve(null)})}un(e){let n=this.an.get(e);return n||(e.filters.length===0?n=[e]:n=I9(He.create(e.filters,"and")).map(r=>N0(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,n),n)}Pn(e,n,r,i,s,o,a){let u=(n!=null?n.length:1)*Math.max(r.length,s.length),c=u/(n!=null?n.length:1),l=[];for(let d=0;d<u;++d){let h=n?this.In(n[d/c]):Cg,f=this.Tn(e,h,r[d%c],i),p=this.En(e,h,s[d%c],o),m=a.map(g=>this.Tn(e,h,g,!0));l.push(...this.createRange(f,p,m))}return l}Tn(e,n,r,i){let s=new wo(e,k.empty(),n,r);return i?s:s.Ht()}En(e,n,r,i){let s=new wo(e,k.empty(),n,r);return i?s.Ht():s}cn(e,n){let r=new Zg(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.en(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2,i=this.un(n);return w.forEach(i,s=>this.cn(e,s).next(o=>{o?r!==0&&o.fields.length<function(u){let c=new Qe(Et.comparator),l=!1;for(let d of u.filters)for(let h of d.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?l=!0:c=c.add(h.field));for(let d of u.orderBy)d.field.isKeyField()||(c=c.add(d.field));return c.size+(l?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}dn(e,n){let r=new vo;for(let i of mo(e)){let s=n.data.field(i.fieldPath);if(s==null)return null;let o=r.jt(i.kind);Ci.St.ht(s,o)}return r.Ut()}In(e){let n=new vo;return Ci.St.ht(e,n.jt(0)),n.Ut()}An(e,n){let r=new vo;return Ci.St.ht(bo(this.databaseId,n),r.jt(function(s){let o=mo(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Ut()}hn(e,n,r){if(r===null)return[];let i=[];i.push(new vo);let s=0;for(let o of mo(e)){let a=r[s++];for(let u of i)if(this.Rn(n,o.fieldPath)&&ed(a))i=this.Vn(i,o,a);else{let c=u.jt(o.kind);Ci.St.ht(a,c)}}return this.mn(i)}ln(e,n,r){return this.hn(e,n,r.position)}mn(e){let n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Ut();return n}Vn(e,n,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let u=new vo;u.seed(a.Ut()),Ci.St.ht(o,u.jt(n.kind)),s.push(u)}return s}Rn(e,n){return!!e.filters.find(r=>r instanceof be&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){let r=jl(e),i=nu(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{let o=[];return w.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(l,d){let h=d?new Ql(d.sequenceNumber,new er(xo(d.readTime),new k(Gr(d.documentKey)),d.largestBatchId)):Ql.empty(),f=l.fields.map(([p,m])=>new lu(Et.fromServerFormat(p),m));return new pu(l.indexId,l.collectionGroup,f,h)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ae(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){let i=jl(e),s=nu(e);return this.fn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>w.forEach(a,u=>s.put(r1(u.indexId,this.user,o,r)))))}updateIndexEntries(e,n){let r=new Map;return w.forEach(n,(i,s)=>{let o=r.get(i.collectionGroup);return(o?w.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),w.forEach(a,u=>this.gn(e,i,u).next(c=>{let l=this.pn(s,u);return c.isEqual(l)?w.resolve():this.yn(e,s,u,c,l)}))))})}wn(e,n,r,i){return tu(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,n.key),documentKey:n.key.path.toArray()})}Sn(e,n,r,i){return tu(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,n.key),n.key.path.toArray()])}gn(e,n,r){let i=tu(e),s=new Qe(is);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,n)])},(o,a)=>{s=s.add(new wo(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}pn(e,n){let r=new Qe(is),i=this.dn(n,e);if(i==null)return r;let s=m0(n);if(s!=null){let o=e.data.field(s.fieldPath);if(ed(o))for(let a of o.arrayValue.values||[])r=r.add(new wo(n.indexId,e.key,this.In(a),i))}else r=r.add(new wo(n.indexId,e.key,Cg,i));return r}yn(e,n,r,i,s){A("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);let o=[];return function(u,c,l,d,h){let f=u.getIterator(),p=c.getIterator(),m=eu(f),g=eu(p);for(;m||g;){let _=!1,y=!1;if(m&&g){let v=l(m,g);v<0?y=!0:v>0&&(_=!0)}else m!=null?y=!0:_=!0;_?(d(g),g=eu(p)):y?(h(m),m=eu(f)):(m=eu(f),g=eu(p))}}(i,s,is,a=>{o.push(this.wn(e,n,r,a))},a=>{o.push(this.Sn(e,n,r,a))}),w.waitFor(o)}fn(e){let n=1;return nu(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>is(o,a)).filter((o,a,u)=>!a||is(o,u[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=is(o,e),u=is(o,n);if(a===0)i[0]=e.Ht();else if(a>0&&u<0)i.push(o),i.push(o.Ht());else if(u>0)break}i.push(n);let s=[];for(let o=0;o<i.length;o+=2){if(this.bn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Cg,[]],u=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Cg,[]];s.push(IDBKeyRange.bound(a,u))}return s}bn(e,n){return is(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(l1)}getMinOffset(e,n){return w.mapArray(this.un(n),r=>this.cn(e,r).next(i=>i||U())).next(l1)}};function c1(t){return Ut(t,"collectionParents")}function tu(t){return Ut(t,"indexEntries")}function jl(t){return Ut(t,"indexConfiguration")}function nu(t){return Ut(t,"indexState")}function l1(t){G(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){let i=t[r].indexState.offset;oC(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new er(e.readTime,e.documentKey,n)}var d1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Xn=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function AO(t,e,n){let r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId),a=0,u=r.Y({range:o},(l,d,h)=>(a++,h.delete()));s.push(u.next(()=>{G(a===1)}));let c=[];for(let l of n.mutations){let d=F1(e,l.key.path,n.batchId);s.push(i.delete(d)),c.push(l.key)}return w.waitFor(s).next(()=>c)}function Jg(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw U();e=t.noDocument}return JSON.stringify(e).length}Xn.DEFAULT_COLLECTION_PERCENTILE=10,Xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Xn.DEFAULT=new Xn(41943040,Xn.DEFAULT_COLLECTION_PERCENTILE,Xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Xn.DISABLED=new Xn(-1,0,0);var em=class t{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,n,r,i){G(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new t(s,n,r,i)}checkEmpty(e){let n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ss(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){let s=uu(e),o=ss(e);return o.add({}).next(a=>{G(typeof a=="number");let u=new nd(a,n,r,i),c=function(f,p,m){let g=m.baseMutations.map(y=>ud(f.ut,y)),_=m.mutations.map(y=>ud(f.ut,y));return{userId:p,batchId:m.batchId,localWriteTimeMs:m.localWriteTime.toMillis(),baseMutations:g,mutations:_}}(this.serializer,this.userId,u),l=[],d=new Qe((h,f)=>ae(h.canonicalString(),f.canonicalString()));for(let h of i){let f=F1(this.userId,h.key.path,a);d=d.add(h.key.path.popLast()),l.push(o.put(c)),l.push(s.put(f,xz))}return d.forEach(h=>{l.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Dn[a]=u.keys()}),w.waitFor(l).next(()=>u)})}lookupMutationBatch(e,n){return ss(e).get(n).next(r=>r?(G(r.userId===this.userId),_o(this.serializer,r)):null)}Cn(e,n){return this.Dn[n]?w.resolve(this.Dn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){let i=r.keys();return this.Dn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return ss(e).Y({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&(G(a.batchId>=r),s=_o(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return ss(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ss(e).W("userMutationsIndex",n).next(r=>r.map(i=>_o(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){let r=Sg(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return uu(e).Y({range:i},(o,a,u)=>{let[c,l,d]=o,h=Gr(l);if(c===this.userId&&n.path.isEqual(h))return ss(e).get(d).next(f=>{if(!f)throw U();G(f.userId===this.userId),s.push(_o(this.serializer,f))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Qe(ae),i=[];return n.forEach(s=>{let o=Sg(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=uu(e).Y({range:a},(c,l,d)=>{let[h,f,p]=c,m=Gr(f);h===this.userId&&s.path.isEqual(m)?r=r.add(p):d.done()});i.push(u)}),w.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=Sg(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new Qe(ae);return uu(e).Y({range:o},(u,c,l)=>{let[d,h,f]=u,p=Gr(h);d===this.userId&&r.isPrefixOf(p)?p.length===i&&(a=a.add(f)):l.done()}).next(()=>this.vn(e,a))}vn(e,n){let r=[],i=[];return n.forEach(s=>{i.push(ss(e).get(s).next(o=>{if(o===null)throw U();G(o.userId===this.userId),r.push(_o(this.serializer,o))}))}),w.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return AO(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Fn(n.batchId)}),w.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return w.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return uu(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){let u=Gr(s[1]);i.push(u)}else a.done()}).next(()=>{G(i.length===0)})})}containsKey(e,n){return xO(e,this.userId,n)}Mn(e){return RO(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function xO(t,e,n){let r=Sg(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return uu(t).Y({range:s,J:!0},(a,u,c)=>{let[l,d,h]=a;l===e&&d===i&&(o=!0),c.done()}).next(()=>o)}function ss(t){return Ut(t,"mutations")}function uu(t){return Ut(t,"documentMutations")}function RO(t){return Ut(t,"mutationQueues")}var Eu=class t{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new t(0)}static Nn(){return new t(-1)}};var J0=class{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Bn(e).next(n=>{let r=new Eu(n.highestTargetId);return n.highestTargetId=r.next(),this.Ln(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(n=>W.fromTimestamp(new ft(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Ln(e,i)))}addTargetData(e,n){return this.kn(e,n).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.qn(n,r),this.Ln(e,r))))}updateTargetData(e,n){return this.kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>ru(e).delete(n.targetId)).next(()=>this.Bn(e)).next(r=>(G(r.targetCount>0),r.targetCount-=1,this.Ln(e,r)))}removeTargets(e,n,r){let i=0,s=[];return ru(e).Y((o,a)=>{let u=Hl(a);u.sequenceNumber<=n&&r.get(u.targetId)===null&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>w.waitFor(s)).next(()=>i)}forEachTarget(e,n){return ru(e).Y((r,i)=>{let s=Hl(i);n(s)})}Bn(e){return h1(e).get("targetGlobalKey").next(n=>(G(n!==null),n))}Ln(e,n){return h1(e).put("targetGlobalKey",n)}kn(e,n){return ru(e).put(TO(this.serializer,n))}qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(n=>n.targetCount)}getTargetData(e,n){let r=Do(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return ru(e).Y({range:i,index:"queryTargetsIndex"},(o,a,u)=>{let c=Hl(a);wd(n,c.target)&&(s=c,u.done())}).next(()=>s)}addMatchingKeys(e,n,r){let i=[],s=os(e);return n.forEach(o=>{let a=mn(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),w.waitFor(i)}removeMatchingKeys(e,n,r){let i=os(e);return w.forEach(n,s=>{let o=mn(s.path);return w.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){let r=os(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){let r=IDBKeyRange.bound([n],[n+1],!1,!0),i=os(e),s=de();return i.Y({range:r,J:!0},(o,a,u)=>{let c=Gr(o[1]),l=new k(c);s=s.add(l)}).next(()=>s)}containsKey(e,n){let r=mn(n.path),i=IDBKeyRange.bound([r],[M1(r)],!1,!0),s=0;return os(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],u,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}_t(e,n){return ru(e).get(n).next(r=>r?Hl(r):null)}};function ru(t){return Ut(t,"targets")}function h1(t){return Ut(t,"targetGlobal")}function os(t){return Ut(t,"targetDocuments")}function f1([t,e],[n,r]){let i=ae(t,n);return i===0?ae(e,r):i}var eI=class{constructor(e){this.Qn=e,this.buffer=new Qe(f1),this.Kn=0}$n(){return++this.Kn}Un(e){let n=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();f1(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},tI=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Wn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return this.Wn!==null}Gn(e){A("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>I(this,null,function*(){this.Wn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(n){Is(n)?A("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield Es(n)}yield this.Gn(3e5)}))}},nI=class{constructor(e,n){this.zn=e,this.params=n}calculateTargetCount(e,n){return this.zn.jn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return w.resolve(kn._e);let r=new eI(n);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.zn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.zn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(A("LruGarbageCollector","Garbage collection skipped; disabled"),w.resolve(d1)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(A("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),d1):this.Jn(e,n))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,n){let r,i,s,o,a,u,c,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(A("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(c=Date.now(),iu()<=Hn.DEBUG&&A("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-l}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(u-a)+`ms
	Removed ${d} documents in `+(c-u)+`ms
Total Duration: ${c-l}ms`),w.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}};function C9(t,e){return new nI(t,e)}var rI=class{constructor(e,n){this.db=e,this.garbageCollector=C9(this,n)}jn(e){let n=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Yn(e){let n=0;return this.Hn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Hn(e,n){return this.Zn(e,(r,i)=>n(i))}addReference(e,n,r){return bg(e,r)}removeReference(e,n,r){return bg(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return bg(e,n)}Xn(e,n){return function(i,s){let o=!1;return RO(i).Z(a=>xO(i,a,s).next(u=>(u&&(o=!0),w.resolve(!u)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Zn(e,(o,a)=>{if(a<=n){let u=this.Xn(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,W.min()),os(e).delete(function(d){return[0,mn(d.path)]}(o))))});i.push(u)}}).next(()=>w.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return bg(e,n)}Zn(e,n){let r=os(e),i,s=kn._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:c})=>{o===0?(s!==kn._e&&n(new k(Gr(i)),s),s=c,i=u):s=kn._e}).next(()=>{s!==kn._e&&n(new k(Gr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function bg(t,e){return os(t).put(function(r,i){return{targetId:0,path:mn(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}var tm=class{constructor(){this.changes=new Xr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Mt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?w.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var iI=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return go(e).put(r)}removeEntry(e,n,r){return go(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Qg(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.er(e,r)))}getEntry(e,n){let r=Mt.newInvalidDocument(n);return go(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Ul(n))},(i,s)=>{r=this.tr(n,s)}).next(()=>r)}nr(e,n){let r={size:0,document:Mt.newInvalidDocument(n)};return go(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Ul(n))},(i,s)=>{r={document:this.tr(n,s),size:Jg(s)}}).next(()=>r)}getEntries(e,n){let r=xn();return this.rr(e,n,(i,s)=>{let o=this.tr(i,s);r=r.insert(i,o)}).next(()=>r)}ir(e,n){let r=xn(),i=new rt(k.comparator);return this.rr(e,n,(s,o)=>{let a=this.tr(s,o);r=r.insert(s,a),i=i.insert(s,Jg(o))}).next(()=>({documents:r,sr:i}))}rr(e,n,r){if(n.isEmpty())return w.resolve();let i=new Qe(m1);n.forEach(u=>i=i.add(u));let s=IDBKeyRange.bound(Ul(i.first()),Ul(i.last())),o=i.getIterator(),a=o.getNext();return go(e).Y({index:"documentKeyIndex",range:s},(u,c,l)=>{let d=k.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&m1(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?l.U(Ul(a)):l.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){let o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Qg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return go(e).W(IDBKeyRange.bound(a,u,!0)).next(c=>{s?.incrementDocumentReadCount(c.length);let l=xn();for(let d of c){let h=this.tr(k.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);h.isFoundDocument()&&(Id(n,h)||i.has(h.key))&&(l=l.insert(h.key,h))}return l})}getAllFromCollectionGroup(e,n,r,i){let s=xn(),o=g1(n,r),a=g1(n,er.max());return go(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,c,l)=>{let d=this.tr(k.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(d.key,d),s.size===i&&l.done()}).next(()=>s)}newChangeBuffer(e){return new sI(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return p1(e).get("remoteDocumentGlobalKey").next(n=>(G(!!n),n))}er(e,n){return p1(e).put("remoteDocumentGlobalKey",n)}tr(e,n){if(n){let r=w9(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(W.min())))return r}return Mt.newInvalidDocument(e)}};function MO(t){return new iI(t)}var sI=class extends tm{constructor(e,n){super(),this._r=e,this.trackRemovals=n,this.ar=new Xr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let n=[],r=0,i=new Qe((s,o)=>ae(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ar.get(s);if(n.push(this._r.removeEntry(e,s,a.readTime)),o.isValidDocument()){let u=t1(this._r.serializer,o);i=i.add(s.path.popLast());let c=Jg(u);r+=c-a.size,n.push(this._r.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){let u=t1(this._r.serializer,o.convertToNoDocument(W.min()));n.push(this._r.addEntry(e,s,u))}}),i.forEach(s=>{n.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),n.push(this._r.updateMetadata(e,r)),w.waitFor(n)}getFromCache(e,n){return this._r.nr(e,n).next(r=>(this.ar.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this._r.ir(e,n).next(({documents:r,sr:i})=>(i.forEach((s,o)=>{this.ar.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function p1(t){return Ut(t,"remoteDocumentGlobal")}function go(t){return Ut(t,"remoteDocumentsV14")}function Ul(t){let e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function g1(t,e){let n=e.documentKey.path.toArray();return[t,Qg(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function m1(t,e){let n=t.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=ae(n[s],r[s]),i)return i;return i=ae(n.length,r.length),i||(i=ae(n[n.length-2],r[r.length-2]),i||ae(n[n.length-1],r[r.length-1]))}var oI=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var nm=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&zl(r.mutation,i,Fn.empty(),ft.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,de()).next(()=>r))}getLocalViewOfDocuments(e,n,r=de()){let i=zr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=$l();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=zr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,de()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=xn(),o=Gl(),a=function(){return Gl()}();return n.forEach((u,c)=>{let l=r.get(c.key);i.has(c.key)&&(l===void 0||l.mutation instanceof Cr)?s=s.insert(c.key,c):l!==void 0?(o.set(c.key,l.mutation.getFieldMask()),zl(l.mutation,c,l.mutation.getFieldMask(),ft.now())):o.set(c.key,Fn.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((c,l)=>o.set(c,l)),n.forEach((c,l)=>{var d;return a.set(c,new oI(l,(d=o.get(c))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){let r=Gl(),i=new rt((o,a)=>o-a),s=de();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(u=>{let c=n.get(u);if(c===null)return;let l=r.get(u)||Fn.empty();l=a.applyToLocalView(c,l),r.set(u,l);let d=(i.get(a.batchId)||de()).add(u);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let u=a.getNext(),c=u.key,l=u.value,d=tO();l.forEach(h=>{if(!s.has(h)){let f=cO(n.get(h),r.get(h));f!==null&&d.set(h,f),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,d))}return w.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return k.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):lC(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):w.resolve(zr()),a=-1,u=s;return o.next(c=>w.forEach(c,(l,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(l)?w.resolve():this.remoteDocumentCache.getEntry(e,l).next(h=>{u=u.insert(l,h)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,u,c,de())).next(l=>({batchId:a,changes:eO(l)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new k(n)).next(r=>{let i=$l();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=$l();return this.indexManager.getCollectionParents(e,s).next(a=>w.forEach(a,u=>{let c=function(d,h){return new Ir(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(l=>{l.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((u,c)=>{let l=c.getKey();o.get(l)===null&&(o=o.insert(l,Mt.newInvalidDocument(l)))});let a=$l();return o.forEach((u,c)=>{let l=s.get(u);l!==void 0&&zl(l.mutation,c,Fn.empty(),ft.now()),Id(n,c)&&(a=a.insert(u,c))}),a})}};var aI=class{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,n){return w.resolve(this.ur.get(n))}saveBundleMetadata(e,n){return this.ur.set(n.id,function(i){return{id:i.id,version:i.version,createTime:It(i.createTime)}}(n)),w.resolve()}getNamedQuery(e,n){return w.resolve(this.cr.get(n))}saveNamedQuery(e,n){return this.cr.set(n.name,function(i){return{name:i.name,query:fC(i.bundledQuery),readTime:It(i.readTime)}}(n)),w.resolve()}};var uI=class{constructor(){this.overlays=new rt(k.comparator),this.lr=new Map}getOverlay(e,n){return w.resolve(this.overlays.get(n))}getOverlays(e,n){let r=zr();return w.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.lt(e,n,s)}),w.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),w.resolve()}getOverlaysForCollection(e,n,r){let i=zr(),s=n.length+1,o=new k(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let u=a.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return w.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new rt((c,l)=>c-l),o=this.overlays.getIterator();for(;o.hasNext();){let c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let l=s.get(c.largestBatchId);l===null&&(l=zr(),s=s.insert(c.largestBatchId,l)),l.set(c.getKey(),c)}}let a=zr(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,l)=>a.set(c,l)),!(a.size()>=i)););return w.resolve(a)}lt(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new rd(n,r));let s=this.lr.get(n);s===void 0&&(s=de(),this.lr.set(n,s)),this.lr.set(n,s.add(r.key))}};var ld=class{constructor(){this.hr=new Qe(At.Pr),this.Ir=new Qe(At.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,n){let r=new At(e,n);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.dr(new At(e,n))}Ar(e,n){e.forEach(r=>this.removeReference(r,n))}Rr(e){let n=new k(new Oe([])),r=new At(n,e),i=new At(n,e+1),s=[];return this.Ir.forEachInRange([r,i],o=>{this.dr(o),s.push(o.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){let n=new k(new Oe([])),r=new At(n,e),i=new At(n,e+1),s=de();return this.Ir.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new At(e,0),r=this.hr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},At=class{constructor(e,n){this.key=e,this.gr=n}static Pr(e,n){return k.comparator(e.key,n.key)||ae(e.gr,n.gr)}static Tr(e,n){return ae(e.gr,n.gr)||k.comparator(e.key,n.key)}};var cI=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.pr=1,this.yr=new Qe(At.Pr)}checkEmpty(e){return w.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new nd(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.yr=this.yr.add(new At(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return w.resolve(o)}lookupMutationBatch(e,n){return w.resolve(this.wr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.Sr(r),s=i<0?0:i;return w.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return w.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(e){return w.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new At(n,0),i=new At(n,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],o=>{let a=this.wr(o.gr);s.push(a)}),w.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Qe(ae);return n.forEach(i=>{let s=new At(i,0),o=new At(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,o],a=>{r=r.add(a.gr)})}),w.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;k.isDocumentKey(s)||(s=s.child(""));let o=new At(new k(s),0),a=new Qe(ae);return this.yr.forEachWhile(u=>{let c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(u.gr)),!0)},o),w.resolve(this.br(a))}br(e){let n=[];return e.forEach(r=>{let i=this.wr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){G(this.Dr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.yr;return w.forEach(n.mutations,i=>{let s=new At(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,n){let r=new At(n,0),i=this.yr.firstAfterOrEqual(r);return w.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,w.resolve()}Dr(e,n){return this.Sr(e)}Sr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}wr(e){let n=this.Sr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var lI=class{constructor(e){this.Cr=e,this.docs=function(){return new rt(k.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return w.resolve(r?r.document.mutableCopy():Mt.newInvalidDocument(n))}getEntries(e,n){let r=xn();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Mt.newInvalidDocument(i))}),w.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=xn(),o=n.path,a=new k(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){let{key:c,value:{document:l}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||oC(N1(l),r)<=0||(i.has(l.key)||Id(n,l))&&(s=s.insert(l.key,l.mutableCopy()))}return w.resolve(s)}getAllFromCollectionGroup(e,n,r,i){U()}vr(e,n){return w.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new dI(this)}getSize(e){return w.resolve(this.size)}},dI=class extends tm{constructor(e){super(),this._r=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),w.waitFor(n)}getFromCache(e,n){return this._r.getEntry(e,n)}getAllFromCache(e,n){return this._r.getEntries(e,n)}};var hI=class{constructor(e){this.persistence=e,this.Fr=new Xr(n=>Do(n),wd),this.lastRemoteSnapshotVersion=W.min(),this.highestTargetId=0,this.Mr=0,this.Or=new ld,this.targetCount=0,this.Nr=Eu.On()}forEachTarget(e,n){return this.Fr.forEach((r,i)=>n(i)),w.resolve()}getLastRemoteSnapshotVersion(e){return w.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return w.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),w.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Mr&&(this.Mr=n),w.resolve()}kn(e){this.Fr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Nr=new Eu(n),this.highestTargetId=n),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,n){return this.kn(n),this.targetCount+=1,w.resolve()}updateTargetData(e,n){return this.kn(n),w.resolve()}removeTargetData(e,n){return this.Fr.delete(n.target),this.Or.Rr(n.targetId),this.targetCount-=1,w.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Fr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Fr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),w.waitFor(s).next(()=>i)}getTargetCount(e){return w.resolve(this.targetCount)}getTargetData(e,n){let r=this.Fr.get(n)||null;return w.resolve(r)}addMatchingKeys(e,n,r){return this.Or.Er(n,r),w.resolve()}removeMatchingKeys(e,n,r){this.Or.Ar(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),w.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Or.Rr(n),w.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Or.mr(n);return w.resolve(r)}containsKey(e,n){return w.resolve(this.Or.containsKey(n))}};var rm=class{constructor(e,n){this.Br={},this.overlays={},this.Lr=new kn(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new hI(this),this.indexManager=new Z0,this.remoteDocumentCache=function(i){return new lI(i)}(r=>this.referenceDelegate.Qr(r)),this.serializer=new Kg(n),this.Kr=new aI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new uI,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new cI(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,n,r){A("MemoryPersistence","Starting transaction:",e);let i=new fI(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,n){return w.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}},fI=class extends Fg{constructor(e){super(),this.currentSequenceNumber=e}},im=class t{constructor(e){this.persistence=e,this.Gr=new ld,this.zr=null}static jr(e){return new t(e)}get Hr(){if(this.zr)return this.zr;throw U()}addReference(e,n,r){return this.Gr.addReference(r,n),this.Hr.delete(r.toString()),w.resolve()}removeReference(e,n,r){return this.Gr.removeReference(r,n),this.Hr.add(r.toString()),w.resolve()}markPotentiallyOrphaned(e,n){return this.Hr.add(n.toString()),w.resolve()}removeTarget(e,n){this.Gr.Rr(n.targetId).forEach(i=>this.Hr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}$r(){this.zr=new Set}Ur(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return w.forEach(this.Hr,r=>{let i=k.fromPath(r);return this.Jr(e,i).next(s=>{s||n.removeEntry(i,W.min())})}).next(()=>(this.zr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Jr(e,n).next(r=>{r?this.Hr.delete(n.toString()):this.Hr.add(n.toString())})}Qr(e){return 0}Jr(e,n){return w.or([()=>w.resolve(this.Gr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Wr(e,n)])}};var pI=class{constructor(e){this.serializer=e}N(e,n,r,i){let s=new Lg("createOrUpgrade",n);r<1&&i>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",NN,{unique:!0}),u.createObjectStore("documentMutations")}(e),y1(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=w.resolve();return r<3&&i>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),y1(e)),o=o.next(()=>function(u){let c=u.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:W.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",l)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(u,c){return c.store("mutations").W().next(l=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",NN,{unique:!0});let d=c.store("mutations"),h=l.map(f=>d.put(f));return w.waitFor(h)})}(e,s))),o=o.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Zr(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(o=o.next(()=>this.ei(s))),r<8&&i>=8&&(o=o.next(()=>this.ti(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ni(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(u){let c=u.createObjectStore("documentOverlays",{keyPath:Bz});c.createIndex("collectionPathOverlayIndex",$z,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",Hz,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){let c=u.createObjectStore("remoteDocumentsV14",{keyPath:Rz});c.createIndex("documentKeyIndex",Mz),c.createIndex("collectionGroupIndex",Pz)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ii(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:Lz}).createIndex("sequenceNumberIndex",Vz,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:jz}).createIndex("documentKeyIndex",Uz,{unique:!1})}(e))),o}Xr(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=Jg(i)}).next(()=>{let r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){let n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>w.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>w.forEach(a,u=>{G(u.userId===s.userId);let c=_o(this.serializer,u);return AO(e,s.userId,c).next(()=>{})}))}))}ei(e){let n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.Y((o,a)=>{let u=new Oe(o),c=function(d){return[0,mn(d)]}(u);s.push(n.get(c).next(l=>l?w.resolve():(d=>n.put({targetId:0,path:mn(d),sequenceNumber:i.highestListenSequenceNumber}))(u)))}).next(()=>w.waitFor(s))})}ti(e,n){e.createObjectStore("collectionParents",{keyPath:Fz});let r=n.store("collectionParents"),i=new cd,s=o=>{if(i.add(o)){let a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:mn(u)})}};return n.store("remoteDocuments").Y({J:!0},(o,a)=>{let u=new Oe(o);return s(u.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([o,a,u],c)=>{let l=Gr(a);return s(l.popLast())}))}ni(e){let n=e.store("targets");return n.Y((r,i)=>{let s=Hl(i),o=TO(this.serializer,s);return n.put(o)})}ri(e,n){let r=n.store("remoteDocuments"),i=[];return r.Y((s,o)=>{let a=n.store("remoteDocumentsV14"),u=function(d){return d.document?new k(Oe.fromString(d.document.name).popFirst(5)):d.noDocument?k.fromSegments(d.noDocument.path):d.unknownDocument?k.fromSegments(d.unknownDocument.path):U()}(o).path.toArray(),c={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))}).next(()=>w.waitFor(i))}ii(e,n){let r=n.store("mutations"),i=MO(this.serializer),s=new rm(im.jr,this.serializer.ut);return r.W().next(o=>{let a=new Map;return o.forEach(u=>{var c;let l=(c=a.get(u.userId))!==null&&c!==void 0?c:de();_o(this.serializer,u).keys().forEach(d=>l=l.add(d)),a.set(u.userId,l)}),w.forEach(a,(u,c)=>{let l=new xt(c),d=Yg.ct(this.serializer,l),h=s.getIndexManager(l),f=em.ct(l,this.serializer,h,s.referenceDelegate);return new nm(i,f,d,h).recalculateAndSaveOverlaysForDocumentKeys(new Zl(n,kn._e),u).next()})})}};function y1(t){t.createObjectStore("targetDocuments",{keyPath:Oz}).createIndex("documentTargetsIndex",kz,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Nz,{unique:!0}),t.createObjectStore("targetGlobal")}var o0="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",gI=class t{constructor(e,n,r,i,s,o,a,u,c,l,d=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.si=s,this.window=o,this.document=a,this.oi=c,this._i=l,this.ai=d,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=h=>Promise.resolve(),!t.D())throw new D(E.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new rI(this,i),this.Ii=n+"main",this.serializer=new Kg(u),this.Ti=new ds(this.Ii,this.ai,new pI(this.serializer)),this.qr=new J0(this.referenceDelegate,this.serializer),this.remoteDocumentCache=MO(this.serializer),this.Kr=new q0,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,l===!1&&wt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new D(E.FAILED_PRECONDITION,o0);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Lr=new kn(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){return this.Pi=n=>I(this,null,function*(){if(this.started)return e(n)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(n=>I(this,null,function*(){n.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget(()=>I(this,null,function*(){this.started&&(yield this.di())})))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Tg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(n=>{n||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(n=>this.isPrimary&&!n?this.pi(e).next(()=>!1):!!n&&this.yi(e).next(()=>!0))).catch(e=>{if(Is(e))return A("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return A("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return Bl(e).get("owner").next(n=>w.resolve(this.wi(n)))}Si(e){return Tg(e).delete(this.clientId)}bi(){return I(this,null,function*(){if(this.isPrimary&&!this.Di(this.hi,18e5)){this.hi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{let r=Ut(n,"clientMetadata");return r.W().next(i=>{let s=this.Ci(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return w.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ei)for(let n of e)this.Ei.removeItem(this.vi(n.clientId))}})}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?w.resolve(!0):Bl(e).get("owner").next(n=>{if(n!==null&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)){if(this.wi(n)&&this.networkEnabled)return!0;if(!this.wi(n)){if(!n.allowTabSynchronization)throw new D(E.FAILED_PRECONDITION,o0);return!1}}return!(!this.networkEnabled||!this.inForeground)||Tg(e).W().next(r=>this.Ci(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&A("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return I(this,null,function*(){this.kr=!1,this.Mi(),this.li&&(this.li.cancel(),this.li=null),this.xi(),this.Oi(),yield this.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let n=new Zl(e,kn._e);return this.pi(n).next(()=>this.Si(n))}),this.Ti.close(),this.Ni()})}Ci(e,n){return e.filter(r=>this.Di(r.updateTimeMs,n)&&!this.Fi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>Tg(e).W().next(n=>this.Ci(n,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,n){return em.ct(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new X0(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return Yg.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,n,r){A("IndexedDbPersistence","Starting transaction:",e);let i=n==="readonly"?"readonly":"readwrite",s=function(u){return u===15?Gz:u===14?j1:u===13?V1:u===12?qz:u===11?L1:void U()}(this.ai),o;return this.Ti.runTransaction(e,i,s,a=>(o=new Zl(a,this.Lr?this.Lr.next():kn._e),n==="readwrite-primary"?this.fi(o).next(u=>!!u||this.gi(o)).next(u=>{if(!u)throw wt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new D(E.FAILED_PRECONDITION,O1);return r(o)}).next(u=>this.yi(o).next(()=>u)):this.Li(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Li(e){return Bl(e).get("owner").next(n=>{if(n!==null&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)&&!this.wi(n)&&!(this._i||this.allowTabSynchronization&&n.allowTabSynchronization))throw new D(E.FAILED_PRECONDITION,o0)})}yi(e){let n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Bl(e).put("owner",n)}static D(){return ds.D()}pi(e){let n=Bl(e);return n.get("owner").next(r=>this.wi(r)?(A("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):w.resolve())}Di(e,n){let r=Date.now();return!(e<r-n)&&(!(e>r)||(wt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ai(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground=this.document.visibilityState==="visible")}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ui=()=>{this.Mi();let n=/(?:Version|Mobile)\/1[456]/;$D()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var n;try{let r=((n=this.Ei)===null||n===void 0?void 0:n.getItem(this.vi(e)))!==null;return A("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return wt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){wt("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Bl(t){return Ut(t,"owner")}function Tg(t){return Ut(t,"clientMetadata")}function gC(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var mI=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.ki=r,this.qi=i}static Qi(e,n){let r=de(),i=de();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var yI=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var sm=class{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,n){this.Gi=e,this.indexManager=n,this.Ki=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.zi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ji(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new yI;return this.Hi(e,n,o).next(a=>{if(s.result=a,this.$i)return this.Ji(e,n,o,a.size)})}).next(()=>s.result)}Ji(e,n,r,i){return r.documentReadCount<this.Ui?(iu()<=Hn.DEBUG&&A("QueryEngine","SDK will not create cache indexes for query:",su(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),w.resolve()):(iu()<=Hn.DEBUG&&A("QueryEngine","Query:",su(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(iu()<=Hn.DEBUG&&A("QueryEngine","The SDK decides to create cache indexes for query:",su(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,yn(n))):w.resolve())}zi(e,n){if(qN(n))return w.resolve(null);let r=yn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=qg(n,null,"F"),r=yn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=de(...s);return this.Gi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{let c=this.Yi(n,a);return this.Zi(n,c,o,u.readTime)?this.zi(e,qg(n,null,"F")):this.Xi(e,c,n,u)}))})))}ji(e,n,r,i){return qN(n)||i.isEqual(W.min())?w.resolve(null):this.Gi.getDocuments(e,r).next(s=>{let o=this.Yi(n,s);return this.Zi(n,o,r,i)?w.resolve(null):(iu()<=Hn.DEBUG&&A("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),su(n)),this.Xi(e,o,n,P1(i,-1)).next(a=>a))})}Yi(e,n){let r=new Qe(X1(e));return n.forEach((i,s)=>{Id(e,s)&&(r=r.add(s))}),r}Zi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,n,r){return iu()<=Hn.DEBUG&&A("QueryEngine","Using full collection scan to execute query:",su(n)),this.Gi.getDocumentsMatchingQuery(e,n,er.min(),r)}Xi(e,n,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var _I=class{constructor(e,n,r,i){this.persistence=e,this.es=n,this.serializer=i,this.ts=new rt(ae),this.ns=new Xr(s=>Do(s),wd),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new nm(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ts))}};function PO(t,e,n,r){return new _I(t,e,n,r)}function NO(t,e){return I(this,null,function*(){let n=V(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.os(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],u=de();for(let c of i){o.push(c.batchId);for(let l of c.mutations)u=u.add(l.key)}for(let c of s){a.push(c.batchId);for(let l of c.mutations)u=u.add(l.key)}return n.localDocuments.getDocuments(r,u).next(c=>({_s:c,removedBatchIds:o,addedBatchIds:a}))})})})}function b9(t,e){let n=V(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.ss.newChangeBuffer({trackRemovals:!0});return function(a,u,c,l){let d=c.batch,h=d.keys(),f=w.resolve();return h.forEach(p=>{f=f.next(()=>l.getEntry(u,p)).next(m=>{let g=c.docVersions.get(p);G(g!==null),m.version.compareTo(g)<0&&(d.applyToRemoteDocument(m,c),m.isValidDocument()&&(m.setReadTime(c.commitVersion),l.addEntry(m)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(u,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=de();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(u=u.add(a.batch.mutations[c].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function OO(t){let e=V(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.qr.getLastRemoteSnapshotVersion(n))}function T9(t,e){let n=V(t),r=e.snapshotVersion,i=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.ss.newChangeBuffer({trackRemovals:!0});i=n.ts;let a=[];e.targetChanges.forEach((l,d)=>{let h=i.get(d);if(!h)return;a.push(n.qr.removeMatchingKeys(s,l.removedDocuments,d).next(()=>n.qr.addMatchingKeys(s,l.addedDocuments,d)));let f=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(jt.EMPTY_BYTE_STRING,W.min()).withLastLimboFreeSnapshotVersion(W.min()):l.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(l.resumeToken,r)),i=i.insert(d,f),function(m,g,_){return m.resumeToken.approximateByteSize()===0||g.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=3e8?!0:_.addedDocuments.size+_.modifiedDocuments.size+_.removedDocuments.size>0}(h,f,l)&&a.push(n.qr.updateTargetData(s,f))});let u=xn(),c=de();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,l))}),a.push(kO(s,o,e.documentUpdates).next(l=>{u=l.us,c=l.cs})),!r.isEqual(W.min())){let l=n.qr.getLastRemoteSnapshotVersion(s).next(d=>n.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(l)}return w.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,c)).next(()=>u)}).then(s=>(n.ts=i,s))}function kO(t,e,n){let r=de(),i=de();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=xn();return n.forEach((a,u)=>{let c=s.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(W.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):A("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{us:o,cs:i}})}function D9(t,e){let n=V(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Iu(t,e){let n=V(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.qr.getTargetData(r,e).next(s=>s?(i=s,w.resolve(i)):n.qr.allocateTargetId(r).next(o=>(i=new wu(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ts.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ts=n.ts.insert(r.targetId,r),n.ns.set(e,r.targetId)),r})}function Cu(t,e,n){return I(this,null,function*(){let r=V(t),i=r.ts.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Is(o))throw o;A("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)})}function om(t,e,n){let r=V(t),i=W.min(),s=de();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,l){let d=V(u),h=d.ns.get(l);return h!==void 0?w.resolve(d.ts.get(h)):d.qr.getTargetData(c,l)}(r,o,yn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.es.getDocumentsMatchingQuery(o,e,n?i:W.min(),n?s:de())).next(a=>(VO(r,Z1(e),a),{documents:a,ls:s})))}function FO(t,e){let n=V(t),r=V(n.qr),i=n.ts.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function LO(t,e){let n=V(t),r=n.rs.get(e)||W.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.ss.getAllFromCollectionGroup(i,e,P1(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(VO(n,e,i),i))}function VO(t,e,n){let r=t.rs.get(e)||W.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.rs.set(e,r)}function S9(t,e,n,r){return I(this,null,function*(){let i=V(t),s=de(),o=xn();for(let c of n){let l=e.hs(c.metadata.name);c.document&&(s=s.add(l));let d=e.Ps(c);d.setReadTime(e.Is(c.metadata.readTime)),o=o.insert(l,d)}let a=i.ss.newChangeBuffer({trackRemovals:!0}),u=yield Iu(i,function(l){return yn(Ru(Oe.fromString(`__bundle__/docs/${l}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",c=>kO(c,a,o).next(l=>(a.apply(c),l)).next(l=>i.qr.removeMatchingKeysForTargetId(c,u.targetId).next(()=>i.qr.addMatchingKeys(c,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(c,l.us,l.cs)).next(()=>l.us)))})}function A9(r,i){return I(this,arguments,function*(t,e,n=de()){let s=yield Iu(t,yn(fC(e.bundledQuery))),o=V(t);return o.persistence.runTransaction("Save named query","readwrite",a=>{let u=It(e.readTime);if(s.snapshotVersion.compareTo(u)>=0)return o.Kr.saveNamedQuery(a,e);let c=s.withResumeToken(jt.EMPTY_BYTE_STRING,u);return o.ts=o.ts.insert(c.targetId,c),o.qr.updateTargetData(a,c).next(()=>o.qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.qr.addMatchingKeys(a,n,s.targetId)).next(()=>o.Kr.saveNamedQuery(a,e))})})}function _1(t,e){return`firestore_clients_${t}_${e}`}function v1(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function a0(t,e){return`firestore_targets_${t}_${e}`}var am=class t{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Ts(e,n,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new D(i.error.code,i.error.message))),o?new t(e,n,i.state,s):(wt("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Es(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Wl=class t{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ts(e,n){let r=JSON.parse(n),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new D(r.error.code,r.error.message))),s?new t(e,r.state,i):(wt("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Es(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},um=class t{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ts(e,n){let r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=dC();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=k1(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new t(e,s):(wt("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}},vI=class t{constructor(e,n){this.clientId=e,this.onlineState=n}static Ts(e){let n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t(n.clientId,n.onlineState):(wt("SharedClientState",`Failed to parse online state: ${e}`),null)}},dd=class{constructor(){this.activeTargetIds=dC()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Kl=class{constructor(e,n,r,i,s){this.window=e,this.si=n,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new rt(ae),this.started=!1,this.ps=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=_1(this.persistenceKey,this.Rs),this.ws=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.gs=this.gs.insert(this.Rs,new dd),this.Ss=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.Cs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.vs=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}start(){return I(this,null,function*(){let e=yield this.syncEngine.Bi();for(let r of e){if(r===this.Rs)continue;let i=this.getItem(_1(this.persistenceKey,r));if(i){let s=um.Ts(r,i);s&&(this.gs=this.gs.insert(s.clientId,s))}}this.Fs();let n=this.storage.getItem(this.Cs);if(n){let r=this.Ms(n);r&&this.xs(r)}for(let r of this.ps)this.fs(r);this.ps=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let n=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,n,r){this.Ns(e,n,r),this.Bs(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(a0(this.persistenceKey,e));if(r){let i=Wl.Ts(e,r);i&&(n=i.state)}}return this.Ls.ds(e),this.Fs(),n}removeLocalQueryTarget(e){this.Ls.As(e),this.Fs()}isLocalQueryTarget(e){return this.Ls.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(a0(this.persistenceKey,e))}updateQueryState(e,n,r){this.ks(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){let n=this.storage.getItem(e);return A("SharedClientState","READ",e,n),n}setItem(e,n){A("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){A("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){let n=e;if(n.storageArea===this.storage){if(A("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ys)return void wt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable(()=>I(this,null,function*(){if(this.started){if(n.key!==null){if(this.Ss.test(n.key)){if(n.newValue==null){let r=this.Ks(n.key);return this.$s(r,null)}{let r=this.Us(n.key,n.newValue);if(r)return this.$s(r.clientId,r)}}else if(this.bs.test(n.key)){if(n.newValue!==null){let r=this.Ws(n.key,n.newValue);if(r)return this.Gs(r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){let r=this.zs(n.key,n.newValue);if(r)return this.js(r)}}else if(n.key===this.Cs){if(n.newValue!==null){let r=this.Ms(n.newValue);if(r)return this.xs(r)}}else if(n.key===this.ws){let r=function(s){let o=kn._e;if(s!=null)try{let a=JSON.parse(s);G(typeof a=="number"),o=a}catch(a){wt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==kn._e&&this.sequenceNumberHandler(r)}else if(n.key===this.vs){let r=this.Hs(n.newValue);yield Promise.all(r.map(i=>this.syncEngine.Js(i)))}}}else this.ps.push(n)}))}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(e,n,r){let i=new am(this.currentUser,e,n,r),s=v1(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Bs(e){let n=v1(this.persistenceKey,this.currentUser,e);this.removeItem(n)}qs(e){let n={clientId:this.Rs,onlineState:e};this.storage.setItem(this.Cs,JSON.stringify(n))}ks(e,n,r){let i=a0(this.persistenceKey,e),s=new Wl(e,n,r);this.setItem(i,s.Es())}Qs(e){let n=JSON.stringify(Array.from(e));this.setItem(this.vs,n)}Ks(e){let n=this.Ss.exec(e);return n?n[1]:null}Us(e,n){let r=this.Ks(e);return um.Ts(r,n)}Ws(e,n){let r=this.bs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return am.Ts(new xt(s),i,n)}zs(e,n){let r=this.Ds.exec(e),i=Number(r[1]);return Wl.Ts(i,n)}Ms(e){return vI.Ts(e)}Hs(e){return JSON.parse(e)}Gs(e){return I(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Ys(e.batchId,e.state,e.error);A("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,n){let r=n?this.gs.insert(e,n):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.Xs(o,a).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let n=dC();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}},cm=class{constructor(){this.eo=new dd,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,n,r){this.no[e]=n}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new dd,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var wI=class{ro(e){}shutdown(){}};var lm=class{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){A("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ao)e(0)}_o(){A("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ao)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Dg=null;function u0(){return Dg===null?Dg=function(){return 268435456+Math.round(2147483648*Math.random())}():Dg++,"0x"+Dg.toString(16)}var x9={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var EI=class{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}};var on="WebChannelConnection",II=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+n.host,this.fo=`projects/${i}/databases/${s}`,this.po=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(n,r,i,s,o){let a=u0(),u=this.So(n,r);A("RestConnection",`Sending RPC '${n}' ${a}:`,u,i);let c={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(c,s,o),this.Do(n,u,c,i).then(l=>(A("RestConnection",`Received RPC '${n}' ${a}: `,l),l),l=>{throw Jn("RestConnection",`RPC '${n}' ${a} failed with error: `,l,"url: ",u,"request:",i),l})}Co(n,r,i,s,o,a){return this.wo(n,r,i,s,o)}bo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+xu}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}So(n,r){let i=x9[n];return`${this.mo}/v1/${r}:${i}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,n,r,i){let s=u0();return new Promise((o,a)=>{let u=new AN;u.setWithCredentials(!0),u.listenOnce(DN.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Ig.NO_ERROR:let l=u.getResponseJson();A(on,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(l)),o(l);break;case Ig.TIMEOUT:A(on,`RPC '${e}' ${s} timed out`),a(new D(E.DEADLINE_EXCEEDED,"Request time out"));break;case Ig.HTTP_ERROR:let d=u.getStatus();if(A(on,`RPC '${e}' ${s} failed with status:`,d,"response text:",u.getResponseText()),d>0){let h=u.getResponseJson();Array.isArray(h)&&(h=h[0]);let f=h?.error;if(f&&f.status&&f.message){let p=function(g){let _=g.toLowerCase().replace(/_/g,"-");return Object.values(E).indexOf(_)>=0?_:E.UNKNOWN}(f.status);a(new D(p,f.message))}else a(new D(E.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new D(E.UNAVAILABLE,"Connection failed."));break;default:U()}}finally{A(on,`RPC '${e}' ${s} completed.`)}});let c=JSON.stringify(i);A(on,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",c,r,15)})}vo(e,n,r){let i=u0(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=bN(),a=TN(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.bo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;let l=s.join("");A(on,`Creating RPC '${e}' stream ${i}: ${l}`,u);let d=o.createWebChannel(l,u),h=!1,f=!1,p=new EI({co:g=>{f?A(on,`Not sending because RPC '${e}' stream ${i} is closed:`,g):(h||(A(on,`Opening RPC '${e}' stream ${i} transport.`),d.open(),h=!0),A(on,`RPC '${e}' stream ${i} sending:`,g),d.send(g))},lo:()=>d.close()}),m=(g,_,y)=>{g.listen(_,v=>{try{y(v)}catch(S){setTimeout(()=>{throw S},0)}})};return m(d,Ll.EventType.OPEN,()=>{f||A(on,`RPC '${e}' stream ${i} transport opened.`)}),m(d,Ll.EventType.CLOSE,()=>{f||(f=!0,A(on,`RPC '${e}' stream ${i} transport closed`),p.Ro())}),m(d,Ll.EventType.ERROR,g=>{f||(f=!0,Jn(on,`RPC '${e}' stream ${i} transport errored:`,g),p.Ro(new D(E.UNAVAILABLE,"The operation could not be completed")))}),m(d,Ll.EventType.MESSAGE,g=>{var _;if(!f){let y=g.data[0];G(!!y);let v=y,S=v.error||((_=v[0])===null||_===void 0?void 0:_.error);if(S){A(on,`RPC '${e}' stream ${i} received error:`,S);let F=S.status,x=function(K){let he=St[K];if(he!==void 0)return hO(he)}(F),M=S.message;x===void 0&&(x=E.INTERNAL,M="Unknown error status: "+F+" with message "+S.message),f=!0,p.Ro(new D(x,M)),d.close()}else A(on,`RPC '${e}' stream ${i} received:`,y),p.Vo(y)}}),m(a,SN.STAT_EVENT,g=>{g.stat===i0.PROXY?A(on,`RPC '${e}' stream ${i} detected buffering proxy`):g.stat===i0.NOPROXY&&A(on,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.Ao()},0),p}};function jO(){return typeof window<"u"?window:null}function Mg(){return typeof document<"u"?document:null}function Cd(t){return new U0(t,!0)}var hd=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=n,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();let n=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,n-r);i>0&&A("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){this.No!==null&&(this.No.skipDelay(),this.No=null)}cancel(){this.No!==null&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}};var dm=class{constructor(e,n,r,i,s,o,a,u){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new hd(e,n)}jo(){return this.state===1||this.state===5||this.Ho()}Ho(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Jo()}stop(){return I(this,null,function*(){this.jo()&&(yield this.close(0))})}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&this.Wo===null&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}Xo(){return I(this,null,function*(){if(this.Ho())return this.close(0)})}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}close(e,n){return I(this,null,function*(){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,e!==4?this.zo.reset():n&&n.code===E.RESOURCE_EXHAUSTED?(wt(n.toString()),wt("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):n&&n.code===E.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.r_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Io(n)})}r_(){}auth(){this.state=1;let e=this.i_(this.Uo),n=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===n&&this.s_(r,i)},r=>{e(()=>{let i=new D(E.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,n){let r=this.i_(this.Uo);this.stream=this.__(e,n),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){this.state=5,this.zo.ko(()=>I(this,null,function*(){this.state=0,this.start()}))}o_(e){return A("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return n=>{this.si.enqueueAndForget(()=>this.Uo===e?n():(A("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},CI=class extends dm{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}__(e,n){return this.connection.vo("Listen",e,n)}onMessage(e){this.zo.reset();let n=f9(this.serializer,e),r=function(s){if(!("targetChange"in s))return W.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?W.min():o.readTime?It(o.readTime):W.min()}(e);return this.listener.a_(n,r)}u_(e){let n={};n.database=ad(this.serializer),n.addTarget=function(s,o){let a,u=o.target;if(a=$g(u)?{documents:vO(s,u)}:{query:wO(s,u)},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=pO(s,o.resumeToken);let c=B0(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(W.min())>0){a.readTime=vu(s,o.snapshotVersion.toTimestamp());let c=B0(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);let r=g9(this.serializer,e);r&&(n.labels=r),this.e_(n)}c_(e){let n={};n.database=ad(this.serializer),n.removeTarget=e,this.e_(n)}},bI=class extends dm{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,n){return this.connection.vo("Write",e,n)}onMessage(e){if(G(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();let n=p9(e.writeResults,e.commitTime),r=It(e.commitTime);return this.listener.I_(r,n)}return G(!e.writeResults||e.writeResults.length===0),this.l_=!0,this.listener.T_()}E_(){let e={};e.database=ad(this.serializer),this.e_(e)}P_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>ud(this.serializer,r))};this.e_(n)}};var TI=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new D(E.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,n,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,n,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===E.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new D(E.UNKNOWN,i.toString())})}Co(e,n,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,n,r,s,o,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===E.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new D(E.UNKNOWN,s.toString())})}terminate(){this.d_=!0}};var DI=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){this.V_===0&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){this.state==="Online"?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,e==="Online"&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(wt(n),this.f_=!1):A("OnlineStateTracker",n)}S_(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}};var SI=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(o=>{r.enqueueAndForget(()=>I(this,null,function*(){Cs(this)&&(A("RemoteStore","Restarting streams for network reachability change."),yield function(u){return I(this,null,function*(){let c=V(u);c.C_.add(4),yield Mu(c),c.M_.set("Unknown"),c.C_.delete(4),yield bd(c)})}(this))}))}),this.M_=new DI(r,i)}};function bd(t){return I(this,null,function*(){if(Cs(t))for(let e of t.v_)yield e(!0)})}function Mu(t){return I(this,null,function*(){for(let e of t.v_)yield e(!1)})}function Rm(t,e){let n=V(t);n.D_.has(e.targetId)||(n.D_.set(e.targetId,e),_C(n)?yC(n):Nu(n).Ho()&&mC(n,e))}function fd(t,e){let n=V(t),r=Nu(n);n.D_.delete(e),r.Ho()&&UO(n,e),n.D_.size===0&&(r.Ho()?r.Zo():Cs(n)&&n.M_.set("Unknown"))}function mC(t,e){if(t.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(W.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Nu(t).u_(e)}function UO(t,e){t.x_.Oe(e),Nu(t).c_(e)}function yC(t){t.x_=new j0({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.D_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),Nu(t).start(),t.M_.g_()}function _C(t){return Cs(t)&&!Nu(t).jo()&&t.D_.size>0}function Cs(t){return V(t).C_.size===0}function BO(t){t.x_=void 0}function R9(t){return I(this,null,function*(){t.D_.forEach((e,n)=>{mC(t,e)})})}function M9(t,e){return I(this,null,function*(){BO(t),_C(t)?(t.M_.w_(e),yC(t)):t.M_.set("Unknown")})}function P9(t,e,n){return I(this,null,function*(){if(t.M_.set("Online"),e instanceof zg&&e.state===2&&e.cause)try{yield function(i,s){return I(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.D_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.D_.delete(a),i.x_.removeTarget(a))})}(t,e)}catch(r){A("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield hm(t,r)}else if(e instanceof hu?t.x_.$e(e):e instanceof Gg?t.x_.Je(e):t.x_.Ge(e),!n.isEqual(W.min()))try{let r=yield OO(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.x_.it(o);return a.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){let l=s.D_.get(c);l&&s.D_.set(c,l.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,c)=>{let l=s.D_.get(u);if(!l)return;s.D_.set(u,l.withResumeToken(jt.EMPTY_BYTE_STRING,l.snapshotVersion)),UO(s,u);let d=new wu(l.target,u,c,l.sequenceNumber);mC(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){A("RemoteStore","Failed to raise snapshot:",r),yield hm(t,r)}})}function hm(t,e,n){return I(this,null,function*(){if(!Is(e))throw e;t.C_.add(1),yield Mu(t),t.M_.set("Offline"),n||(n=()=>OO(t.localStore)),t.asyncQueue.enqueueRetryable(()=>I(this,null,function*(){A("RemoteStore","Retrying IndexedDB access"),yield n(),t.C_.delete(1),yield bd(t)}))})}function $O(t,e){return e().catch(n=>hm(t,n,e))}function Pu(t){return I(this,null,function*(){let e=V(t),n=ws(e),r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;N9(e);)try{let i=yield D9(e.localStore,r);if(i===null){e.b_.length===0&&n.Zo();break}r=i.batchId,O9(e,i)}catch(i){yield hm(e,i)}HO(e)&&qO(e)})}function N9(t){return Cs(t)&&t.b_.length<10}function O9(t,e){t.b_.push(e);let n=ws(t);n.Ho()&&n.h_&&n.P_(e.mutations)}function HO(t){return Cs(t)&&!ws(t).jo()&&t.b_.length>0}function qO(t){ws(t).start()}function k9(t){return I(this,null,function*(){ws(t).E_()})}function F9(t){return I(this,null,function*(){let e=ws(t);for(let n of t.b_)e.P_(n.mutations)})}function L9(t,e,n){return I(this,null,function*(){let r=t.b_.shift(),i=F0.from(r,e,n);yield $O(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield Pu(t)})}function V9(t,e){return I(this,null,function*(){e&&ws(t).h_&&(yield function(r,i){return I(this,null,function*(){if(function(o){return dO(o)&&o!==E.ABORTED}(i.code)){let s=r.b_.shift();ws(r).Yo(),yield $O(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Pu(r)}})}(t,e)),HO(t)&&qO(t)})}function w1(t,e){return I(this,null,function*(){let n=V(t);n.asyncQueue.verifyOperationInProgress(),A("RemoteStore","RemoteStore received new credentials");let r=Cs(n);n.C_.add(3),yield Mu(n),r&&n.M_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.C_.delete(3),yield bd(n)})}function AI(t,e){return I(this,null,function*(){let n=V(t);e?(n.C_.delete(2),yield bd(n)):e||(n.C_.add(2),yield Mu(n),n.M_.set("Unknown"))})}function Nu(t){return t.O_||(t.O_=function(n,r,i){let s=V(n);return s.A_(),new CI(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:R9.bind(null,t),Io:M9.bind(null,t),a_:P9.bind(null,t)}),t.v_.push(e=>I(this,null,function*(){e?(t.O_.Yo(),_C(t)?yC(t):t.M_.set("Unknown")):(yield t.O_.stop(),BO(t))}))),t.O_}function ws(t){return t.N_||(t.N_=function(n,r,i){let s=V(n);return s.A_(),new bI(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:k9.bind(null,t),Io:V9.bind(null,t),T_:F9.bind(null,t),I_:L9.bind(null,t)}),t.v_.push(e=>I(this,null,function*(){e?(t.N_.Yo(),yield Pu(t)):(yield t.N_.stop(),t.b_.length>0&&(A("RemoteStore",`Stopping write stream with ${t.b_.length} pending writes`),t.b_=[]))}))),t.N_}var xI=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Rt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new D(E.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Ou(t,e){if(wt("AsyncQueue",`${e}: ${t}`),Is(t))return new D(E.UNAVAILABLE,`${e}: ${t}`);throw t}var fm=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||k.comparator(n.key,r.key):(n,r)=>k.comparator(n.key,r.key),this.keyedMap=$l(),this.sortedSet=new rt(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var pm=class{constructor(){this.B_=new rt(k.comparator)}track(e){let n=e.doc.key,r=this.B_.get(n);r?e.type!==0&&r.type===3?this.B_=this.B_.insert(n,e):e.type===3&&r.type!==1?this.B_=this.B_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.B_=this.B_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.B_=this.B_.remove(n):e.type===1&&r.type===2?this.B_=this.B_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):U():this.B_=this.B_.insert(n,e)}L_(){let e=[];return this.B_.inorderTraversal((n,r)=>{e.push(r)}),e}},bu=class t{constructor(e,n,r,i,s,o,a,u,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,fm.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ed(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var RI=class{constructor(){this.k_=void 0,this.listeners=[]}},MI=class{constructor(){this.queries=new Xr(e=>Y1(e),Ed),this.onlineState="Unknown",this.q_=new Set}};function vC(t,e){return I(this,null,function*(){let n=V(t),r=e.query,i=!1,s=n.queries.get(r);if(s||(i=!0,s=new RI),i)try{s.k_=yield n.onListen(r)}catch(o){let a=Ou(o,`Initialization of query '${su(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.listeners.push(e),e.Q_(n.onlineState),s.k_&&e.K_(s.k_)&&EC(n)})}function wC(t,e){return I(this,null,function*(){let n=V(t),r=e.query,i=!1,s=n.queries.get(r);if(s){let o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=s.listeners.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)})}function j9(t,e){let n=V(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.listeners)a.K_(i)&&(r=!0);o.k_=i}}r&&EC(n)}function U9(t,e,n){let r=V(t),i=r.queries.get(e);if(i)for(let s of i.listeners)s.onError(n);r.queries.delete(e)}function EC(t){t.q_.forEach(e=>{e.next()})}var pd=class{constructor(e,n,r){this.query=e,this.U_=n,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new bu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.W_?this.z_(e)&&(this.U_.next(e),n=!0):this.j_(e,this.onlineState)&&(this.H_(e),n=!0),this.G_=e,n}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let n=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),n=!0),n}j_(e,n){if(!e.fromCache)return!0;let r=n!=="Offline";return(!this.options.J_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}z_(e){if(e.docChanges.length>0)return!0;let n=this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}H_(e){e=bu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}};var PI=class{constructor(e,n){this.Y_=e,this.byteLength=n}Z_(){return"metadata"in this.Y_}};var gm=class{constructor(e){this.serializer=e}hs(e){return Kr(this.serializer,e)}Ps(e){return e.metadata.exists?_O(this.serializer,e.document,!1):Mt.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return It(e)}},NI=class{constructor(e,n,r){this.X_=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=GO(e)}ea(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.Y_.namedQuery)this.queries.push(e.Y_.namedQuery);else if(e.Y_.documentMetadata){this.documents.push({metadata:e.Y_.documentMetadata}),e.Y_.documentMetadata.exists||++n;let r=Oe.fromString(e.Y_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Y_.document&&(this.documents[this.documents.length-1].document=e.Y_.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ta(e){let n=new Map,r=new gm(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.hs(i.metadata.name);for(let o of i.metadata.queries){let a=(n.get(o)||de()).add(s);n.set(o,a)}}return n}complete(){return I(this,null,function*(){let e=yield S9(this.localStore,new gm(this.serializer),this.documents,this.X_.id),n=this.ta(this.documents);for(let r of this.queries)yield A9(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,na:this.collectionGroups,ra:e}})}};function GO(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var mm=class{constructor(e){this.key=e}},ym=class{constructor(e){this.key=e}},_m=class{constructor(e,n){this.query=e,this.ia=n,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=de(),this.mutatedKeys=de(),this._a=X1(e),this.aa=new fm(this._a)}get ua(){return this.ia}ca(e,n){let r=n?n.la:new pm,i=n?n.aa:this.aa,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((l,d)=>{let h=i.get(l),f=Id(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),m=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations),g=!1;h&&f?h.data.isEqual(f.data)?p!==m&&(r.track({type:3,doc:f}),g=!0):this.ha(h,f)||(r.track({type:2,doc:f}),g=!0,(u&&this._a(f,u)>0||c&&this._a(f,c)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),g=!0):h&&!f&&(r.track({type:1,doc:h}),g=!0,(u||c)&&(a=!0)),g&&(f?(o=o.add(f),s=m?s.add(l):s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{aa:o,la:r,Zi:a,mutatedKeys:s}}ha(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;let o=e.la.L_();o.sort((l,d)=>function(f,p){let m=g=>{switch(g){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return U()}};return m(f)-m(p)}(l.type,d.type)||this._a(l.doc,d.doc)),this.Pa(r),i=i!=null&&i;let a=n&&!i?this.Ia():[],u=this.oa.size===0&&this.current&&!i?1:0,c=u!==this.sa;return this.sa=u,o.length!==0||c?{snapshot:new bu(this.query,e.aa,s,o,e.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:a}:{Ta:a}}Q_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({aa:this.aa,la:new pm,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(n=>this.ia=this.ia.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ia=this.ia.delete(n)),this.current=e.current)}Ia(){if(!this.current)return[];let e=this.oa;this.oa=de(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});let n=[];return e.forEach(r=>{this.oa.has(r)||n.push(new ym(r))}),this.oa.forEach(r=>{e.has(r)||n.push(new mm(r))}),n}da(e){this.ia=e.ls,this.oa=de();let n=this.ca(e.documents);return this.applyChanges(n,!0)}Aa(){return bu.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,this.sa===0,this.hasCachedResults)}},OI=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},kI=class{constructor(e){this.key=e,this.Ra=!1}},FI=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Va={},this.ma=new Xr(a=>Y1(a),Ed),this.fa=new Map,this.ga=new Set,this.pa=new rt(k.comparator),this.ya=new Map,this.wa=new ld,this.Sa={},this.ba=new Map,this.Da=Eu.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return this.Ca===!0}};function B9(t,e){return I(this,null,function*(){let n=DC(t),r,i,s=n.ma.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{let o=yield Iu(n.localStore,yn(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=yield IC(n,e,r,a==="current",o.resumeToken),n.isPrimaryClient&&Rm(n.remoteStore,o)}return i})}function IC(t,e,n,r,i){return I(this,null,function*(){t.va=(d,h,f)=>function(m,g,_,y){return I(this,null,function*(){let v=g.view.ca(_);v.Zi&&(v=yield om(m.localStore,g.query,!1).then(({documents:M})=>g.view.ca(M,v)));let S=y&&y.targetChanges.get(g.targetId),F=y&&y.targetMismatches.get(g.targetId)!=null,x=g.view.applyChanges(v,m.isPrimaryClient,S,F);return LI(m,g.targetId,x.Ta),x.snapshot})}(t,d,h,f);let s=yield om(t.localStore,e,!0),o=new _m(e,s.ls),a=o.ca(s.documents),u=sd.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(a,t.isPrimaryClient,u);LI(t,n,c.Ta);let l=new OI(e,n,o);return t.ma.set(e,l),t.fa.has(n)?t.fa.get(n).push(e):t.fa.set(n,[e]),c.snapshot})}function $9(t,e){return I(this,null,function*(){let n=V(t),r=n.ma.get(e),i=n.fa.get(r.targetId);if(i.length>1)return n.fa.set(r.targetId,i.filter(s=>!Ed(s,e))),void n.ma.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Cu(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),fd(n.remoteStore,r.targetId),Tu(n,r.targetId)}).catch(Es))):(Tu(n,r.targetId),yield Cu(n.localStore,r.targetId,!0))})}function H9(t,e,n){return I(this,null,function*(){let r=SC(t);try{let i=yield function(o,a){let u=V(o),c=ft.now(),l=a.reduce((f,p)=>f.add(p.key),de()),d,h;return u.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=xn(),m=de();return u.ss.getEntries(f,l).next(g=>{p=g,p.forEach((_,y)=>{y.isValidDocument()||(m=m.add(_))})}).next(()=>u.localDocuments.getOverlayedDocuments(f,p)).next(g=>{d=g;let _=[];for(let y of a){let v=o9(y,d.get(y.key).overlayedDocument);v!=null&&_.push(new Cr(y.key,v,H1(v.value.mapValue),_t.exists(!0)))}return u.mutationQueue.addMutationBatch(f,c,_,a)}).next(g=>{h=g;let _=g.applyToLocalDocumentSet(d,m);return u.documentOverlayCache.saveOverlays(f,g.batchId,_)})}).then(()=>({batchId:h.batchId,changes:eO(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let c=o.Sa[o.currentUser.toKey()];c||(c=new rt(ae)),c=c.insert(a,u),o.Sa[o.currentUser.toKey()]=c}(r,i.batchId,n),yield xi(r,i.changes),yield Pu(r.remoteStore)}catch(i){let s=Ou(i,"Failed to persist write");n.reject(s)}})}function zO(t,e){return I(this,null,function*(){let n=V(t);try{let r=yield T9(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.ya.get(s);o&&(G(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ra=!0:i.modifiedDocuments.size>0?G(o.Ra):i.removedDocuments.size>0&&(G(o.Ra),o.Ra=!1))}),yield xi(n,r,e)}catch(r){yield Es(r)}})}function E1(t,e,n){let r=V(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.ma.forEach((s,o)=>{let a=o.view.Q_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let u=V(o);u.onlineState=a;let c=!1;u.queries.forEach((l,d)=>{for(let h of d.listeners)h.Q_(a)&&(c=!0)}),c&&EC(u)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function q9(t,e,n){return I(this,null,function*(){let r=V(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.ya.get(e),s=i&&i.key;if(s){let o=new rt(k.comparator);o=o.insert(s,Mt.newNoDocument(s,W.min()));let a=de().add(s),u=new id(W.min(),new Map,new rt(ae),o,a);yield zO(r,u),r.pa=r.pa.remove(s),r.ya.delete(e),TC(r)}else yield Cu(r.localStore,e,!1).then(()=>Tu(r,e,n)).catch(Es)})}function G9(t,e){return I(this,null,function*(){let n=V(t),r=e.batch.batchId;try{let i=yield b9(n.localStore,e);bC(n,r,null),CC(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield xi(n,i)}catch(i){yield Es(i)}})}function z9(t,e,n){return I(this,null,function*(){let r=V(t);try{let i=yield function(o,a){let u=V(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return u.mutationQueue.lookupMutationBatch(c,a).next(d=>(G(d!==null),l=d.keys(),u.mutationQueue.removeMutationBatch(c,d))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,l,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>u.localDocuments.getDocuments(c,l))})}(r.localStore,e);bC(r,e,n),CC(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield xi(r,i)}catch(i){yield Es(i)}})}function W9(t,e){return I(this,null,function*(){let n=V(t);Cs(n.remoteStore)||A("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=V(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(n.localStore);if(r===-1)return void e.resolve();let i=n.ba.get(r)||[];i.push(e),n.ba.set(r,i)}catch(r){let i=Ou(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function CC(t,e){(t.ba.get(e)||[]).forEach(n=>{n.resolve()}),t.ba.delete(e)}function bC(t,e,n){let r=V(t),i=r.Sa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Sa[r.currentUser.toKey()]=i}}function Tu(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.fa.get(e))t.ma.delete(r),n&&t.Va.Fa(r,n);t.fa.delete(e),t.isPrimaryClient&&t.wa.Rr(e).forEach(r=>{t.wa.containsKey(r)||WO(t,r)})}function WO(t,e){t.ga.delete(e.path.canonicalString());let n=t.pa.get(e);n!==null&&(fd(t.remoteStore,n),t.pa=t.pa.remove(e),t.ya.delete(n),TC(t))}function LI(t,e,n){for(let r of n)r instanceof mm?(t.wa.addReference(r.key,e),K9(t,r)):r instanceof ym?(A("SyncEngine","Document no longer in limbo: "+r.key),t.wa.removeReference(r.key,e),t.wa.containsKey(r.key)||WO(t,r.key)):U()}function K9(t,e){let n=e.key,r=n.path.canonicalString();t.pa.get(n)||t.ga.has(r)||(A("SyncEngine","New document in limbo: "+n),t.ga.add(r),TC(t))}function TC(t){for(;t.ga.size>0&&t.pa.size<t.maxConcurrentLimboResolutions;){let e=t.ga.values().next().value;t.ga.delete(e);let n=new k(Oe.fromString(e)),r=t.Da.next();t.ya.set(r,new kI(n)),t.pa=t.pa.insert(n,r),Rm(t.remoteStore,new wu(yn(Ru(n.path)),r,"TargetPurposeLimboResolution",kn._e))}}function xi(t,e,n){return I(this,null,function*(){let r=V(t),i=[],s=[],o=[];r.ma.isEmpty()||(r.ma.forEach((a,u)=>{o.push(r.va(u,e,n).then(c=>{if((c||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,c?.fromCache?"not-current":"current"),c){i.push(c);let l=mI.Qi(u.targetId,c);s.push(l)}}))}),yield Promise.all(o),r.Va.a_(i),yield function(u,c){return I(this,null,function*(){let l=V(u);try{yield l.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>w.forEach(c,h=>w.forEach(h.ki,f=>l.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>w.forEach(h.qi,f=>l.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!Is(d))throw d;A("LocalStore","Failed to update sequence numbers: "+d)}for(let d of c){let h=d.targetId;if(!d.fromCache){let f=l.ts.get(h),p=f.snapshotVersion,m=f.withLastLimboFreeSnapshotVersion(p);l.ts=l.ts.insert(h,m)}}})}(r.localStore,s))})}function Q9(t,e){return I(this,null,function*(){let n=V(t);if(!n.currentUser.isEqual(e)){A("SyncEngine","User change. New user:",e.toKey());let r=yield NO(n.localStore,e);n.currentUser=e,function(s,o){s.ba.forEach(a=>{a.forEach(u=>{u.reject(new D(E.CANCELLED,o))})}),s.ba.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield xi(n,r._s)}})}function Y9(t,e){let n=V(t),r=n.ya.get(e);if(r&&r.Ra)return de().add(r.key);{let i=de(),s=n.fa.get(e);if(!s)return i;for(let o of s){let a=n.ma.get(o);i=i.unionWith(a.view.ua)}return i}}function Z9(t,e){return I(this,null,function*(){let n=V(t),r=yield om(n.localStore,e.query,!0),i=e.view.da(r);return n.isPrimaryClient&&LI(n,e.targetId,i.Ta),i})}function X9(t,e){return I(this,null,function*(){let n=V(t);return LO(n.localStore,e).then(r=>xi(n,r))})}function J9(t,e,n,r){return I(this,null,function*(){let i=V(t),s=yield function(a,u){let c=V(a),l=V(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",d=>l.Cn(d,u).next(h=>h?c.localDocuments.getDocuments(d,h):w.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?yield Pu(i.remoteStore):n==="acknowledged"||n==="rejected"?(bC(i,e,r||null),CC(i,e),function(a,u){V(V(a).mutationQueue).Fn(u)}(i.localStore,e)):U(),yield xi(i,s)):A("SyncEngine","Cannot apply mutation batch with id: "+e)})}function e5(t,e){return I(this,null,function*(){let n=V(t);if(DC(n),SC(n),e===!0&&n.Ca!==!0){let r=n.sharedClientState.getAllActiveQueryTargets(),i=yield I1(n,r.toArray());n.Ca=!0,yield AI(n.remoteStore,!0);for(let s of i)Rm(n.remoteStore,s)}else if(e===!1&&n.Ca!==!1){let r=[],i=Promise.resolve();n.fa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Tu(n,o),Cu(n.localStore,o,!0))),fd(n.remoteStore,o)}),yield i,yield I1(n,r),function(o){let a=V(o);a.ya.forEach((u,c)=>{fd(a.remoteStore,c)}),a.wa.Vr(),a.ya=new Map,a.pa=new rt(k.comparator)}(n),n.Ca=!1,yield AI(n.remoteStore,!1)}})}function I1(t,e,n){return I(this,null,function*(){let r=V(t),i=[],s=[];for(let o of e){let a,u=r.fa.get(o);if(u&&u.length!==0){a=yield Iu(r.localStore,yn(u[0]));for(let c of u){let l=r.ma.get(c),d=yield Z9(r,l);d.snapshot&&s.push(d.snapshot)}}else{let c=yield FO(r.localStore,o);a=yield Iu(r.localStore,c),yield IC(r,KO(c),o,!1,a.resumeToken)}i.push(a)}return r.Va.a_(s),i})}function KO(t){return Q1(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function t5(t){return function(n){return V(V(n).persistence).Bi()}(V(t).localStore)}function n5(t,e,n,r){return I(this,null,function*(){let i=V(t);if(i.Ca)return void A("SyncEngine","Ignoring unexpected query state notification.");let s=i.fa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{let o=yield LO(i.localStore,Z1(s[0])),a=id.createSynthesizedRemoteEventForCurrentChange(e,n==="current",jt.EMPTY_BYTE_STRING);yield xi(i,o,a);break}case"rejected":yield Cu(i.localStore,e,!0),Tu(i,e,r);break;default:U()}})}function r5(t,e,n){return I(this,null,function*(){let r=DC(t);if(r.Ca){for(let i of e){if(r.fa.has(i)){A("SyncEngine","Adding an already active target "+i);continue}let s=yield FO(r.localStore,i),o=yield Iu(r.localStore,s);yield IC(r,KO(s),o.targetId,!1,o.resumeToken),Rm(r.remoteStore,o)}for(let i of n)r.fa.has(i)&&(yield Cu(r.localStore,i,!1).then(()=>{fd(r.remoteStore,i),Tu(r,i)}).catch(Es))}})}function DC(t){let e=V(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=zO.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Y9.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=q9.bind(null,e),e.Va.a_=j9.bind(null,e.eventManager),e.Va.Fa=U9.bind(null,e.eventManager),e}function SC(t){let e=V(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=G9.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=z9.bind(null,e),e}function i5(t,e,n){let r=V(t);(function(s,o,a){return I(this,null,function*(){try{let u=yield o.getMetadata();if(yield function(f,p){let m=V(f),g=It(p.createTime);return m.persistence.runTransaction("hasNewerBundle","readonly",_=>m.Kr.getBundleMetadata(_,p.id)).then(_=>!!_&&_.createTime.compareTo(g)>=0)}(s.localStore,u))return yield o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(u)),Promise.resolve(new Set);a._updateProgress(GO(u));let c=new NI(u,s.localStore,o.serializer),l=yield o.Ma();for(;l;){let h=yield c.ea(l);h&&a._updateProgress(h),l=yield o.Ma()}let d=yield c.complete();return yield xi(s,d.ra,void 0),yield function(f,p){let m=V(f);return m.persistence.runTransaction("Save bundle","readwrite",g=>m.Kr.saveBundleMetadata(g,p))}(s.localStore,u),a._completeWith(d.progress),Promise.resolve(d.na)}catch(u){return Jn("SyncEngine",`Loading bundle failed with ${u}`),a._failWith(u),Promise.resolve(new Set)}})})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var gd=class{constructor(){this.synchronizeTabs=!1}initialize(e){return I(this,null,function*(){this.serializer=Cd(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return PO(this.persistence,new sm,e.initialUser,this.serializer)}createPersistence(e){return new rm(im.jr,this.serializer)}createSharedClientState(e){return new cm}terminate(){return I(this,null,function*(){this.gcScheduler&&this.gcScheduler.stop(),yield this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var vm=class t extends gd{constructor(e,n,r){super(),this.xa=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return I(this,null,function*(){yield t_(t.prototype,this,"initialize").call(this,e),yield this.xa.initialize(this,e),yield SC(this.xa.syncEngine),yield Pu(this.xa.remoteStore),yield this.persistence.mi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return PO(this.persistence,new sm,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){let r=this.persistence.referenceDelegate.garbageCollector;return new tI(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){let r=new w0(n,this.persistence);return new v0(e.asyncQueue,r)}createPersistence(e){let n=gC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Xn.withCacheSize(this.cacheSizeBytes):Xn.DEFAULT;return new gI(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,jO(),Mg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new cm}},VI=class t extends vm{constructor(e,n){super(e,n,!1),this.xa=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){return I(this,null,function*(){yield t_(t.prototype,this,"initialize").call(this,e);let n=this.xa.syncEngine;this.sharedClientState instanceof Kl&&(this.sharedClientState.syncEngine={Ys:J9.bind(null,n),Zs:n5.bind(null,n),Xs:r5.bind(null,n),Bi:t5.bind(null,n),Js:X9.bind(null,n)},yield this.sharedClientState.start()),yield this.persistence.mi(r=>I(this,null,function*(){yield e5(this.xa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let n=jO();if(!Kl.D(n))throw new D(E.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=gC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Kl(n,e.asyncQueue,r,e.clientId,e.initialUser)}},md=class{initialize(e,n){return I(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>E1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Q9.bind(null,this.syncEngine),yield AI(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new MI}()}createDatastore(e){let n=Cd(e.databaseInfo.databaseId),r=function(s){return new II(s)}(e.databaseInfo);return function(s,o,a,u){return new TI(s,o,a,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new SI(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>E1(this.syncEngine,n,0),function(){return lm.D()?new lm:new wI}())}createSyncEngine(e,n){return function(i,s,o,a,u,c,l){let d=new FI(i,s,o,a,u,c);return l&&(d.Ca=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return function(n){return I(this,null,function*(){let r=V(n);A("RemoteStore","RemoteStore shutting down."),r.C_.add(5),yield Mu(r),r.F_.shutdown(),r.M_.set("Unknown")})}(this.remoteStore)}};function C1(t,e=10240){let n=0;return{read(){return I(this,null,function*(){if(n<t.byteLength){let i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}})},cancel(){return I(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Du=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):wt("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var jI=class{constructor(e,n){this.Ba=e,this.serializer=n,this.metadata=new Rt,this.buffer=new Uint8Array,this.La=function(){return new TextDecoder("utf-8")}(),this.ka().then(r=>{r&&r.Z_()?this.metadata.resolve(r.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.Y_)}`))},r=>this.metadata.reject(r))}close(){return this.Ba.cancel()}getMetadata(){return I(this,null,function*(){return this.metadata.promise})}Ma(){return I(this,null,function*(){return yield this.getMetadata(),this.ka()})}ka(){return I(this,null,function*(){let e=yield this.qa();if(e===null)return null;let n=this.La.decode(e),r=Number(n);isNaN(r)&&this.Qa(`length string (${n}) is not valid number`);let i=yield this.Ka(r);return new PI(JSON.parse(i),e.length+r)})}$a(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}qa(){return I(this,null,function*(){for(;this.$a()<0&&!(yield this.Ua()););if(this.buffer.length===0)return null;let e=this.$a();e<0&&this.Qa("Reached the end of bundle when a length string is expected.");let n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n})}Ka(e){return I(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ua())&&this.Qa("Reached the end of bundle when more is expected.");let n=this.La.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n})}Qa(e){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${e}`)}Ua(){return I(this,null,function*(){let e=yield this.Ba.read();if(!e.done){let n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done})}};var UI=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){return I(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new D(E.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");let n=yield function(i,s){return I(this,null,function*(){let o=V(i),a=ad(o.serializer)+"/documents",u={documents:s.map(h=>od(o.serializer,h))},c=yield o.Co("BatchGetDocuments",a,u,s.length),l=new Map;c.forEach(h=>{let f=h9(o.serializer,h);l.set(f.key.toString(),f)});let d=[];return s.forEach(h=>{let f=l.get(h.toString());G(!!f),d.push(f)}),d})}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n})}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new vs(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return I(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;let e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{let i=k.fromPath(r);this.mutations.push(new td(i,this.precondition(i)))}),yield function(r,i){return I(this,null,function*(){let s=V(r),o=ad(s.serializer)+"/documents",a={writes:i.map(u=>ud(s.serializer,u))};yield s.wo("Commit",o,a)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw U();n=W.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new D(E.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){let n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(W.min())?_t.exists(!1):_t.updateTime(n):_t.none()}preconditionForUpdate(e){let n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(W.min()))throw new D(E.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return _t.updateTime(n)}return _t.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var BI=class{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Wa=r.maxAttempts,this.zo=new hd(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){this.zo.ko(()=>I(this,null,function*(){let e=new UI(this.datastore),n=this.za(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.ja(i)}))}).catch(r=>{this.ja(r)})}))}za(e){try{let n=this.updateFunction(e);return!vd(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(e)}Ha(e){if(e.name==="FirebaseError"){let n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!dO(n)}return!1}};var $I=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=xt.UNAUTHENTICATED,this.clientId=Og.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>I(this,null,function*(){A("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(A("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}getConfiguration(){return I(this,null,function*(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}})}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new D(E.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Rt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>I(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=Ou(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Pg(t,e){return I(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),A("FirestoreClient","Initializing OfflineComponentProvider");let n=yield t.getConfiguration();yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>I(this,null,function*(){r.isEqual(i)||(yield NO(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function HI(t,e){return I(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield AC(t);A("FirestoreClient","Initializing OnlineComponentProvider");let r=yield t.getConfiguration();yield e.initialize(n,r),t.setCredentialChangeListener(i=>w1(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,s)=>w1(e.remoteStore,s)),t._onlineComponents=e})}function QO(t){return t.name==="FirebaseError"?t.code===E.FAILED_PRECONDITION||t.code===E.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function AC(t){return I(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){A("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Pg(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!QO(n))throw n;Jn("Error using user provided cache. Falling back to memory cache: "+n),yield Pg(t,new gd)}}else A("FirestoreClient","Using default OfflineComponentProvider"),yield Pg(t,new gd);return t._offlineComponents})}function Mm(t){return I(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(A("FirestoreClient","Using user provided OnlineComponentProvider"),yield HI(t,t._uninitializedComponentsProvider._online)):(A("FirestoreClient","Using default OnlineComponentProvider"),yield HI(t,new md))),t._onlineComponents})}function YO(t){return AC(t).then(e=>e.persistence)}function xC(t){return AC(t).then(e=>e.localStore)}function ZO(t){return Mm(t).then(e=>e.remoteStore)}function RC(t){return Mm(t).then(e=>e.syncEngine)}function s5(t){return Mm(t).then(e=>e.datastore)}function Su(t){return I(this,null,function*(){let e=yield Mm(t),n=e.eventManager;return n.onListen=B9.bind(null,e.syncEngine),n.onUnlisten=$9.bind(null,e.syncEngine),n})}function o5(t){return t.asyncQueue.enqueue(()=>I(this,null,function*(){let e=yield YO(t),n=yield ZO(t);return e.setNetworkEnabled(!0),function(i){let s=V(i);return s.C_.delete(0),bd(s)}(n)}))}function a5(t){return t.asyncQueue.enqueue(()=>I(this,null,function*(){let e=yield YO(t),n=yield ZO(t);return e.setNetworkEnabled(!1),function(i){return I(this,null,function*(){let s=V(i);s.C_.add(0),yield Mu(s),s.M_.set("Offline")})}(n)}))}function u5(t,e){let n=new Rt;return t.asyncQueue.enqueueAndForget(()=>I(this,null,function*(){return function(i,s,o){return I(this,null,function*(){try{let a=yield function(c,l){let d=V(c);return d.persistence.runTransaction("read document","readonly",h=>d.localDocuments.getDocument(h,l))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new D(E.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let u=Ou(a,`Failed to get document '${s} from cache`);o.reject(u)}})}(yield xC(t),e,n)})),n.promise}function XO(t,e,n={}){let r=new Rt;return t.asyncQueue.enqueueAndForget(()=>I(this,null,function*(){return function(s,o,a,u,c){let l=new Du({next:h=>{o.enqueueAndForget(()=>wC(s,d));let f=h.docs.has(a);!f&&h.fromCache?c.reject(new D(E.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&u&&u.source==="server"?c.reject(new D(E.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new pd(Ru(a.path),l,{includeMetadataChanges:!0,J_:!0});return vC(s,d)}(yield Su(t),t.asyncQueue,e,n,r)})),r.promise}function c5(t,e){let n=new Rt;return t.asyncQueue.enqueueAndForget(()=>I(this,null,function*(){return function(i,s,o){return I(this,null,function*(){try{let a=yield om(i,s,!0),u=new _m(s,a.ls),c=u.ca(a.documents),l=u.applyChanges(c,!1);o.resolve(l.snapshot)}catch(a){let u=Ou(a,`Failed to execute query '${s} against cache`);o.reject(u)}})}(yield xC(t),e,n)})),n.promise}function JO(t,e,n={}){let r=new Rt;return t.asyncQueue.enqueueAndForget(()=>I(this,null,function*(){return function(s,o,a,u,c){let l=new Du({next:h=>{o.enqueueAndForget(()=>wC(s,d)),h.fromCache&&u.source==="server"?c.reject(new D(E.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new pd(a,l,{includeMetadataChanges:!0,J_:!0});return vC(s,d)}(yield Su(t),t.asyncQueue,e,n,r)})),r.promise}function l5(t,e){let n=new Du(e);return t.asyncQueue.enqueueAndForget(()=>I(this,null,function*(){return function(i,s){V(i).q_.add(s),s.next()}(yield Su(t),n)})),()=>{n.Na(),t.asyncQueue.enqueueAndForget(()=>I(this,null,function*(){return function(i,s){V(i).q_.delete(s)}(yield Su(t),n)}))}}function d5(t,e,n,r){let i=function(o,a){let u;return u=typeof o=="string"?fO().encode(o):o,function(l,d){return new jI(l,d)}(function(l,d){if(l instanceof Uint8Array)return C1(l,d);if(l instanceof ArrayBuffer)return C1(new Uint8Array(l),d);if(l instanceof ReadableStream)return l.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),a)}(n,Cd(e));t.asyncQueue.enqueueAndForget(()=>I(this,null,function*(){i5(yield RC(t),i,r)}))}function h5(t,e){return t.asyncQueue.enqueue(()=>I(this,null,function*(){return function(r,i){let s=V(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Kr.getNamedQuery(o,i))}(yield xC(t),e)}))}function ek(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var b1=new Map;function MC(t,e,n){if(!n)throw new D(E.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function PC(t,e,n,r){if(e===!0&&r===!0)throw new D(E.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function T1(t){if(!k.isDocumentKey(t))throw new D(E.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function D1(t){if(k.isDocumentKey(t))throw new D(E.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Pm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":U()}function Se(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new D(E.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=Pm(t);throw new D(E.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function tk(t,e){if(e<=0)throw new D(E.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}var wm=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new D(E.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new D(E.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}PC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ek((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new D(E.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new D(E.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new D(E.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Ro=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new wm({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new D(E.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new D(E.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new wm(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new c0;switch(r.type){case"firstParty":return new f0(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new D(E.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=b1.get(n);r&&(A("ComponentProvider","Removing Datastore"),b1.delete(n),r.terminate())}(this),Promise.resolve()}};function nk(t,e,n,r={}){var i;let s=(t=Se(t,Ro))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Jn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if(typeof r.mockUserToken=="string")a=r.mockUserToken,u=xt.MOCK_USER;else{a=ta(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new D(E.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new xt(c)}t._authCredentials=new l0(new Ng(a,u))}}var Xt=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},Je=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},Qr=class t extends Xt{constructor(e,n,r){super(e,n,Ru(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Je(this.firestore,null,new k(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function NC(t,e,...n){if(t=J(t),MC("collection","path",e),t instanceof Ro){let r=Oe.fromString(e,...n);return D1(r),new Qr(t,null,r)}{if(!(t instanceof Je||t instanceof Qr))throw new D(E.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(Oe.fromString(e,...n));return D1(r),new Qr(t.firestore,null,r)}}function rk(t,e){if(t=Se(t,Ro),MC("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new D(E.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Xt(t,null,function(r){return new Ir(Oe.emptyPath(),r)}(e))}function Td(t,e,...n){if(t=J(t),arguments.length===1&&(e=Og.newId()),MC("doc","path",e),t instanceof Ro){let r=Oe.fromString(e,...n);return T1(r),new Je(t,null,new k(r))}{if(!(t instanceof Je||t instanceof Qr))throw new D(E.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(Oe.fromString(e,...n));return T1(r),new Je(t.firestore,t instanceof Qr?t.converter:null,new k(r))}}function OC(t,e){return t=J(t),e=J(e),(t instanceof Je||t instanceof Qr)&&(e instanceof Je||e instanceof Qr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function kC(t,e){return t=J(t),e=J(e),t instanceof Xt&&e instanceof Xt&&t.firestore===e.firestore&&Ed(t._query,e._query)&&t.converter===e.converter}var qI=class{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new hd(this,"async_queue_retry"),this.iu=()=>{let n=Mg();n&&A("AsyncQueue","Visibility state changed to "+n.visibilityState),this.zo.Qo()};let e=Mg();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;let n=Mg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});let n=new Rt;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}_u(){return I(this,null,function*(){if(this.Ya.length!==0){try{yield this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(e){if(!Is(e))throw e;A("AsyncQueue","Operation failed with retryable error: "+e)}this.Ya.length>0&&this.zo.ko(()=>this._u())}})}ou(e){let n=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{this.eu=r,this.tu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw wt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.tu=!1,r))));return this.Ja=n,n}enqueueAfterDelay(e,n,r){this.su(),this.ru.indexOf(e)>-1&&(n=0);let i=xI.createAndSchedule(this,e,n,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&U()}verifyOperationInProgress(){}uu(){return I(this,null,function*(){let e;do e=this.Ja,yield e;while(e!==this.Ja)})}cu(e){for(let n of this.Xa)if(n.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.Xa)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){let n=this.Xa.indexOf(e);this.Xa.splice(n,1)}};function GI(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var zI=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Rt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var ik=-1,ut=class extends Ro{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new qI}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||sk(this),this._firestoreClient.terminate()}};function kt(t){return t._firestoreClient||sk(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function sk(t){var e,n,r;let i=t._freezeSettings(),s=function(a,u,c,l){return new E0(a,u,c,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,ek(l.experimentalLongPollingOptions),l.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new $I(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function ok(t,e){gk(t=Se(t,ut));let n=kt(t);if(n._uninitializedComponentsProvider)throw new D(E.FAILED_PRECONDITION,"SDK cache is already specified.");Jn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=t._freezeSettings(),i=new md;return uk(n,i,new vm(i,r.cacheSizeBytes,e?.forceOwnership))}function ak(t){gk(t=Se(t,ut));let e=kt(t);if(e._uninitializedComponentsProvider)throw new D(E.FAILED_PRECONDITION,"SDK cache is already specified.");Jn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=t._freezeSettings(),r=new md;return uk(e,r,new VI(r,n.cacheSizeBytes))}function uk(t,e,n){let r=new Rt;return t.asyncQueue.enqueue(()=>I(this,null,function*(){try{yield Pg(t,n),yield HI(t,e),r.resolve()}catch(i){let s=i;if(!QO(s))throw s;Jn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function ck(t){if(t._initialized&&!t._terminated)throw new D(E.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Rt;return t._queue.enqueueAndForgetEvenWhileRestricted(()=>I(this,null,function*(){try{yield function(r){return I(this,null,function*(){if(!ds.D())return Promise.resolve();let i=r+"main";yield ds.delete(i)})}(gC(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}})),e.promise}function lk(t){return function(n){let r=new Rt;return n.asyncQueue.enqueueAndForget(()=>I(this,null,function*(){return W9(yield RC(n),r)})),r.promise}(kt(t=Se(t,ut)))}function dk(t){return o5(kt(t=Se(t,ut)))}function hk(t){return a5(kt(t=Se(t,ut)))}function fk(t,e){let n=kt(t=Se(t,ut)),r=new zI;return d5(n,t._databaseId,e,r),r}function pk(t,e){return h5(kt(t=Se(t,ut)),e).then(n=>n?new Xt(t,null,n.query):null)}function gk(t){if(t._initialized||t._terminated)throw new D(E.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Jr=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(jt.fromBase64String(e))}catch(n){throw new D(E.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(jt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var br=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new D(E.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Et(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Si=class{constructor(e){this._methodName=e}};var Mo=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new D(E.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new D(E.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ae(this._lat,e._lat)||ae(this._long,e._long)}};var f5=/^__.*__$/,WI=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Cr(e,this.data,this.fieldMask,n,this.fieldTransforms):new _s(e,this.data,n,this.fieldTransforms)}},Em=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Cr(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function mk(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw U()}}var Im=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Au(e),i}Ru(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return Cm(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(e.length===0)throw this.mu("Document fields must not be empty");if(mk(this.Iu)&&f5.test(e))throw this.mu('Document fields cannot begin and end with "__"')}},KI=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Cd(e)}pu(e,n,r,i=!1){return new Im({Iu:e,methodName:n,gu:r,path:Et.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function ko(t){let e=t._freezeSettings(),n=Cd(t._databaseId);return new KI(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Nm(t,e,n,r,i,s={}){let o=t.pu(s.merge||s.mergeFields?2:0,e,n,i);VC("Data must be an object, but it was:",o,r);let a=vk(r,o),u,c;if(s.merge)u=new Fn(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){let l=[];for(let d of s.mergeFields){let h=JI(e,d,n);if(!o.contains(h))throw new D(E.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);Ek(l,h)||l.push(h)}u=new Fn(l),c=o.fieldTransforms.filter(d=>u.covers(d.field))}else u=null,c=o.fieldTransforms;return new WI(new an(a),u,c)}var yd=class t extends Si{_toFieldTransform(e){if(e.Iu!==2)throw e.Iu===1?e.mu(`${this._methodName}() can only appear at the top level of your update data`):e.mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};function yk(t,e,n){return new Im({Iu:3,gu:e.settings.gu,methodName:t._methodName,du:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var QI=class t extends Si{_toFieldTransform(e){return new So(e.path,new ms)}isEqual(e){return e instanceof t}},YI=class extends Si{constructor(e,n){super(e),this.yu=n}_toFieldTransform(e){let n=yk(this,e,!0),r=this.yu.map(s=>Fo(s,n)),i=new Ti(r);return new So(e.path,i)}isEqual(e){return this===e}},ZI=class extends Si{constructor(e,n){super(e),this.yu=n}_toFieldTransform(e){let n=yk(this,e,!0),r=this.yu.map(s=>Fo(s,n)),i=new Di(r);return new So(e.path,i)}isEqual(e){return this===e}},XI=class extends Si{constructor(e,n){super(e),this.wu=n}_toFieldTransform(e){let n=new ys(e.serializer,iO(e.serializer,this.wu));return new So(e.path,n)}isEqual(e){return this===e}};function FC(t,e,n,r){let i=t.pu(1,e,n);VC("Data must be an object, but it was:",i,r);let s=[],o=an.empty();Oo(r,(u,c)=>{let l=jC(e,u,n);c=J(c);let d=i.Ru(l);if(c instanceof yd)s.push(l);else{let h=Fo(c,d);h!=null&&(s.push(l),o.set(l,h))}});let a=new Fn(s);return new Em(o,a,i.fieldTransforms)}function LC(t,e,n,r,i,s){let o=t.pu(1,e,n),a=[JI(e,r,n)],u=[i];if(s.length%2!=0)throw new D(E.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(JI(e,s[h])),u.push(s[h+1]);let c=[],l=an.empty();for(let h=a.length-1;h>=0;--h)if(!Ek(c,a[h])){let f=a[h],p=u[h];p=J(p);let m=o.Ru(f);if(p instanceof yd)c.push(f);else{let g=Fo(p,m);g!=null&&(c.push(f),l.set(f,g))}}let d=new Fn(c);return new Em(l,d,o.fieldTransforms)}function _k(t,e,n,r=!1){return Fo(n,t.pu(r?4:3,e))}function Fo(t,e){if(wk(t=J(t)))return VC("Unsupported field value:",e,t),vk(t,e);if(t instanceof Si)return function(r,i){if(!mk(i.Iu))throw i.mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.du&&e.Iu!==4)throw e.mu("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let u=Fo(a,i.Vu(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=J(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return iO(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=ft.fromDate(r);return{timestampValue:vu(i.serializer,s)}}if(r instanceof ft){let s=new ft(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:vu(i.serializer,s)}}if(r instanceof Mo)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Jr)return{bytesValue:pO(i.serializer,r._byteString)};if(r instanceof Je){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.mu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:hC(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.mu(`Unsupported field value: ${Pm(r)}`)}(t,e)}function vk(t,e){let n={};return U1(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Oo(t,(r,i)=>{let s=Fo(i,e.Eu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function wk(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ft||t instanceof Mo||t instanceof Jr||t instanceof Je||t instanceof Si)}function VC(t,e,n){if(!wk(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=Pm(n);throw r==="an object"?e.mu(t+" a custom object"):e.mu(t+" "+r)}}function JI(t,e,n){if((e=J(e))instanceof br)return e._internalPath;if(typeof e=="string")return jC(t,e);throw Cm("Field path arguments must be of type string or ",t,!1,void 0,n)}var p5=new RegExp("[~\\*/\\[\\]]");function jC(t,e,n){if(e.search(p5)>=0)throw Cm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new br(...e.split("."))._internalPath}catch{throw Cm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Cm(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new D(E.INVALID_ARGUMENT,a+t+u)}function Ek(t,e){return t.some(n=>n.isEqual(e))}var Po=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Je(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new eC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(Om("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},eC=class extends Po{data(){return super.data()}};function Om(t,e){return typeof e=="string"?jC(t,e):e instanceof br?e._internalPath:e._delegate._internalPath}function Ik(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new D(E.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var _d=class{},No=class extends _d{};function Ri(t,e,...n){let r=[];e instanceof _d&&r.push(e),r=r.concat(n),function(s){let o=s.filter(u=>u instanceof tC).length,a=s.filter(u=>u instanceof bm).length;if(o>1||o>0&&a>0)throw new D(E.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var bm=class t extends No{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return Pk(e._query,n),new Xt(e.firestore,e.converter,O0(e._query,n))}_parse(e){let n=ko(e.firestore);return function(s,o,a,u,c,l,d){let h;if(c.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new D(E.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){A1(d,l);let f=[];for(let p of d)f.push(S1(u,s,p));h={arrayValue:{values:f}}}else h=S1(u,s,d)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||A1(d,l),h=_k(a,o,d,l==="in"||l==="not-in");return be.create(c,l,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function Ck(t,e,n){let r=e,i=Om("where",t);return bm._create(i,r,n)}var tC=class t extends _d{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:He.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let u of a)Pk(o,u),o=O0(o,u)}(e._query,n),new Xt(e.firestore,e.converter,O0(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var nC=class t extends No{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t(e,n)}_apply(e){let n=function(i,s,o){if(i.startAt!==null)throw new D(E.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new D(E.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new To(s,o)}(e._query,this._field,this._direction);return new Xt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new Ir(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}};function bk(t,e="asc"){let n=e,r=Om("orderBy",t);return nC._create(r,n)}var Tm=class t extends No{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){return new Xt(e.firestore,e.converter,qg(e._query,this._limit,this._limitType))}};function Tk(t){return tk("limit",t),Tm._create("limit",t,"F")}function Dk(t){return tk("limitToLast",t),Tm._create("limitToLast",t,"L")}var Dm=class t extends No{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=Mk(e,this.type,this._docOrFields,this._inclusive);return new Xt(e.firestore,e.converter,function(i,s){return new Ir(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function Sk(...t){return Dm._create("startAt",t,!0)}function Ak(...t){return Dm._create("startAfter",t,!1)}var Sm=class t extends No{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=Mk(e,this.type,this._docOrFields,this._inclusive);return new Xt(e.firestore,e.converter,function(i,s){return new Ir(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function xk(...t){return Sm._create("endBefore",t,!1)}function Rk(...t){return Sm._create("endAt",t,!0)}function Mk(t,e,n,r){if(n[0]=J(n[0]),n[0]instanceof Po)return function(s,o,a,u,c){if(!u)throw new D(E.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let l=[];for(let d of du(s))if(d.field.isKeyField())l.push(bo(o,u.key));else{let h=u.data.field(d.field);if(xm(h))throw new D(E.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){let f=d.field.canonicalString();throw new D(E.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}l.push(h)}return new Zr(l,c)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{let i=ko(t.firestore);return function(o,a,u,c,l,d){let h=o.explicitOrderBy;if(l.length>h.length)throw new D(E.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let f=[];for(let p=0;p<l.length;p++){let m=l[p];if(h[p].field.isKeyField()){if(typeof m!="string")throw new D(E.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof m}`);if(!lC(o)&&m.indexOf("/")!==-1)throw new D(E.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${m}' contains a slash.`);let g=o.path.child(Oe.fromString(m));if(!k.isDocumentKey(g))throw new D(E.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${g}' is not because it contains an odd number of segments.`);let _=new k(g);f.push(bo(a,_))}else{let g=_k(u,c,m);f.push(g)}}return new Zr(f,d)}(t._query,t.firestore._databaseId,i,e,n,r)}}function S1(t,e,n){if(typeof(n=J(n))=="string"){if(n==="")throw new D(E.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!lC(e)&&n.indexOf("/")!==-1)throw new D(E.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(Oe.fromString(n));if(!k.isDocumentKey(r))throw new D(E.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return bo(t,new k(r))}if(n instanceof Je)return bo(t,n._key);throw new D(E.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Pm(n)}.`)}function A1(t,e){if(!Array.isArray(t)||t.length===0)throw new D(E.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Pk(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new D(E.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new D(E.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var Au=class{convertValue(e,n="none"){switch(Co(e)){case 0:return null;case 1:return e.booleanValue;case 2:return yt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(fs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw U()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return Oo(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new Mo(yt(e.latitude),yt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=uC(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Xl(e));default:return null}}convertTimestamp(e){let n=hs(e);return new ft(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=Oe.fromString(e);G(bO(r));let i=new ps(r.get(1),r.get(3)),s=new k(r.popFirst(5));return i.isEqual(n)||wt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function km(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var rC=class extends Au{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Je(this.firestore,null,n)}};var bi=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},tr=class extends Po{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new cs(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(Om("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},cs=class extends tr{data(e={}){return super.data(e)}},Tr=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new bi(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new cs(this._firestore,this._userDataWriter,r.key,r,new bi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new D(E.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let u=new cs(i._firestore,i._userDataWriter,a.doc.key,a.doc,new bi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let u=new cs(i._firestore,i._userDataWriter,a.doc.key,a.doc,new bi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),c=-1,l=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),l=o.indexOf(a.doc.key)),{type:g5(a.type),doc:u,oldIndex:c,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function g5(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return U()}}function UC(t,e){return t instanceof tr&&e instanceof tr?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Tr&&e instanceof Tr&&t._firestore===e._firestore&&kC(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function Nk(t){t=Se(t,Je);let e=Se(t.firestore,ut);return XO(kt(e),t._key).then(n=>qC(e,t,n))}var Ai=class extends Au{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Je(this.firestore,null,n)}};function Ok(t){t=Se(t,Je);let e=Se(t.firestore,ut),n=kt(e),r=new Ai(e);return u5(n,t._key).then(i=>new tr(e,r,t._key,i,new bi(i!==null&&i.hasLocalMutations,!0),t.converter))}function kk(t){t=Se(t,Je);let e=Se(t.firestore,ut);return XO(kt(e),t._key,{source:"server"}).then(n=>qC(e,t,n))}function Fk(t){t=Se(t,Xt);let e=Se(t.firestore,ut),n=kt(e),r=new Ai(e);return Ik(t._query),JO(n,t._query).then(i=>new Tr(e,r,t,i))}function Lk(t){t=Se(t,Xt);let e=Se(t.firestore,ut),n=kt(e),r=new Ai(e);return c5(n,t._query).then(i=>new Tr(e,r,t,i))}function Vk(t){t=Se(t,Xt);let e=Se(t.firestore,ut),n=kt(e),r=new Ai(e);return JO(n,t._query,{source:"server"}).then(i=>new Tr(e,r,t,i))}function BC(t,e,n){t=Se(t,Je);let r=Se(t.firestore,ut),i=km(t.converter,e,n);return ku(r,[Nm(ko(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,_t.none())])}function $C(t,e,n,...r){t=Se(t,Je);let i=Se(t.firestore,ut),s=ko(i),o;return o=typeof(e=J(e))=="string"||e instanceof br?LC(s,"updateDoc",t._key,e,n,r):FC(s,"updateDoc",t._key,e),ku(i,[o.toMutation(t._key,_t.exists(!0))])}function jk(t){return ku(Se(t.firestore,ut),[new vs(t._key,_t.none())])}function Uk(t,e){let n=Se(t.firestore,ut),r=Td(t),i=km(t.converter,e);return ku(n,[Nm(ko(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,_t.exists(!1))]).then(()=>r)}function HC(t,...e){var n,r,i;t=J(t);let s={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||GI(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges};if(GI(e[o])){let d=e[o];e[o]=(n=d.next)===null||n===void 0?void 0:n.bind(d),e[o+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let u,c,l;if(t instanceof Je)c=Se(t.firestore,ut),l=Ru(t._key.path),u={next:d=>{e[o]&&e[o](qC(c,t,d))},error:e[o+1],complete:e[o+2]};else{let d=Se(t,Xt);c=Se(d.firestore,ut),l=d._query;let h=new Ai(c);u={next:f=>{e[o]&&e[o](new Tr(c,h,d,f))},error:e[o+1],complete:e[o+2]},Ik(t._query)}return function(h,f,p,m){let g=new Du(m),_=new pd(f,g,p);return h.asyncQueue.enqueueAndForget(()=>I(this,null,function*(){return vC(yield Su(h),_)})),()=>{g.Na(),h.asyncQueue.enqueueAndForget(()=>I(this,null,function*(){return wC(yield Su(h),_)}))}}(kt(c),l,a,u)}function Bk(t,e){return l5(kt(t=Se(t,ut)),GI(e)?e:{next:e})}function ku(t,e){return function(r,i){let s=new Rt;return r.asyncQueue.enqueueAndForget(()=>I(this,null,function*(){return H9(yield RC(r),i,s)})),s.promise}(kt(t),e)}function qC(t,e,n){let r=n.docs.get(e._key),i=new Ai(t);return new tr(t,i,e._key,r,new bi(n.hasPendingWrites,n.fromCache),e.converter)}var m5={maxAttempts:5};var Am=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=ko(e)}set(e,n,r){this._verifyNotCommitted();let i=as(e,this._firestore),s=km(i.converter,n,r),o=Nm(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,_t.none())),this}update(e,n,r,...i){this._verifyNotCommitted();let s=as(e,this._firestore),o;return o=typeof(n=J(n))=="string"||n instanceof br?LC(this._dataReader,"WriteBatch.update",s._key,n,r,i):FC(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,_t.exists(!0))),this}delete(e){this._verifyNotCommitted();let n=as(e,this._firestore);return this._mutations=this._mutations.concat(new vs(n._key,_t.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new D(E.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function as(t,e){if((t=J(t)).firestore!==e)throw new D(E.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var iC=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=ko(n)}get(n){let r=as(n,this._firestore),i=new rC(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return U();let o=s[0];if(o.isFoundDocument())return new Po(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Po(this._firestore,i,r._key,null,r.converter);throw U()})}set(n,r,i){let s=as(n,this._firestore),o=km(s.converter,r,i),a=Nm(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){let o=as(n,this._firestore),a;return a=typeof(r=J(r))=="string"||r instanceof br?LC(this._dataReader,"Transaction.update",o._key,r,i,s):FC(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){let r=as(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){let n=as(e,this._firestore),r=new Ai(this._firestore);return super.get(e).then(i=>new tr(this._firestore,r,n._key,i._document,new bi(!1,!1),n.converter))}};function $k(t,e,n){t=Se(t,ut);let r=Object.assign(Object.assign({},m5),n);return function(s){if(s.maxAttempts<1)throw new D(E.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let u=new Rt;return s.asyncQueue.enqueueAndForget(()=>I(this,null,function*(){let c=yield s5(s);new BI(s.asyncQueue,c,a,o,u).run()})),u.promise}(kt(t),i=>e(new iC(t,i)),r)}function Hk(){return new yd("deleteField")}function qk(){return new QI("serverTimestamp")}function Gk(...t){return new YI("arrayUnion",t)}function zk(...t){return new ZI("arrayRemove",t)}function Wk(t){return new XI("increment",t)}(function(e,n=!0){(function(i){xu=i})(na),li(new Ht("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new ut(new d0(r.getProvider("auth-internal")),new g0(r.getProvider("app-check-internal")),function(c,l){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new D(E.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ps(c.options.projectId,l)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Tn(RN,"4.4.0",e),Tn(RN,"4.4.0","esm2017")})();var y5="@firebase/firestore-compat",_5="0.3.23";function YC(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new D("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function Kk(){if(typeof Uint8Array>"u")throw new D("unimplemented","Uint8Arrays are not available in this environment.")}function Qk(){if(!B1())throw new D("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Fm=class t{constructor(e){this._delegate=e}static fromBase64String(e){return Qk(),new t(Jr.fromBase64String(e))}static fromUint8Array(e){return Kk(),new t(Jr.fromUint8Array(e))}toBase64(){return Qk(),this._delegate.toBase64()}toUint8Array(){return Kk(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function GC(t){return v5(t,["next","error","complete"])}function v5(t,e){if(typeof t!="object"||t===null)return!1;let n=t;for(let r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}var zC=class{enableIndexedDbPersistence(e,n){return ok(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return ak(e._delegate)}clearIndexedDbPersistence(e){return ck(e._delegate)}},Lm=class{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof ps||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Jn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){nk(this._delegate,e,n,r)}enableNetwork(){return dk(this._delegate)}disableNetwork(){return hk(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,PC("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return lk(this._delegate)}onSnapshotsInSync(e){return Bk(this._delegate,e)}get app(){if(!this._appCompat)throw new D("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Vu(this,NC(this._delegate,e))}catch(n){throw _n(n,"collection()","Firestore.collection()")}}doc(e){try{return new ei(this,Td(this._delegate,e))}catch(n){throw _n(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Uo(this,rk(this._delegate,e))}catch(n){throw _n(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return $k(this._delegate,n=>e(new Vm(this,n)))}batch(){return kt(this._delegate),new jm(new Am(this._delegate,e=>ku(this._delegate,e)))}loadBundle(e){return fk(this._delegate,e)}namedQuery(e){return pk(this._delegate,e).then(n=>n?new Uo(this,n):null)}},Fu=class extends Au{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fm(new Jr(e))}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return ei.forKey(n,this.firestore,null)}};function w5(t){x1(t)}var Vm=class{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new Fu(e)}get(e){let n=Lo(e);return this._delegate.get(n).then(r=>new Vo(this._firestore,new tr(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){let i=Lo(e);return r?(YC("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=Lo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=Lo(e);return this._delegate.delete(n),this}},jm=class{constructor(e){this._delegate=e}set(e,n,r){let i=Lo(e);return r?(YC("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=Lo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=Lo(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}},Lu=class t{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){let r=new cs(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new jo(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){let r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new t(e,new Fu(e),n),i.set(n,s)),s}};Lu.INSTANCES=new WeakMap;var ei=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Fu(e)}static forPath(e,n,r){if(e.length%2!==0)throw new D("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new t(n,new Je(n._delegate,r,new k(e)))}static forKey(e,n,r){return new t(n,new Je(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Vu(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Vu(this.firestore,NC(this._delegate,e))}catch(n){throw _n(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=J(e),e instanceof Je?OC(this._delegate,e):!1}set(e,n){n=YC("DocumentReference.set",n);try{return n?BC(this._delegate,e,n):BC(this._delegate,e)}catch(r){throw _n(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?$C(this._delegate,e):$C(this._delegate,e,n,...r)}catch(i){throw _n(i,"updateDoc()","DocumentReference.update()")}}delete(){return jk(this._delegate)}onSnapshot(...e){let n=Yk(e),r=Zk(e,i=>new Vo(this.firestore,new tr(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return HC(this._delegate,n,r)}get(e){let n;return e?.source==="cache"?n=Ok(this._delegate):e?.source==="server"?n=kk(this._delegate):n=Nk(this._delegate),n.then(r=>new Vo(this.firestore,new tr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(Lu.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function _n(t,e,n){return t.message=t.message.replace(e,n),t}function Yk(t){for(let e of t)if(typeof e=="object"&&!GC(e))return e;return{}}function Zk(t,e){var n,r;let i;return GC(t[0])?i=t[0]:GC(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Vo=class{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new ei(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return UC(this._delegate,e._delegate)}},jo=class extends Vo{data(e){let n=this._delegate.data(e);return this._delegate._converter||R1(n!==void 0,"Document in a QueryDocumentSnapshot should exist"),n}},Uo=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Fu(e)}where(e,n,r){try{return new t(this.firestore,Ri(this._delegate,Ck(e,n,r)))}catch(i){throw _n(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new t(this.firestore,Ri(this._delegate,bk(e,n)))}catch(r){throw _n(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new t(this.firestore,Ri(this._delegate,Tk(e)))}catch(n){throw _n(n,"limit()","Query.limit()")}}limitToLast(e){try{return new t(this.firestore,Ri(this._delegate,Dk(e)))}catch(n){throw _n(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new t(this.firestore,Ri(this._delegate,Sk(...e)))}catch(n){throw _n(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new t(this.firestore,Ri(this._delegate,Ak(...e)))}catch(n){throw _n(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new t(this.firestore,Ri(this._delegate,xk(...e)))}catch(n){throw _n(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new t(this.firestore,Ri(this._delegate,Rk(...e)))}catch(n){throw _n(n,"endAt()","Query.endAt()")}}isEqual(e){return kC(this._delegate,e._delegate)}get(e){let n;return e?.source==="cache"?n=Lk(this._delegate):e?.source==="server"?n=Vk(this._delegate):n=Fk(this._delegate),n.then(r=>new Dd(this.firestore,new Tr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let n=Yk(e),r=Zk(e,i=>new Dd(this.firestore,new Tr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return HC(this._delegate,n,r)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(Lu.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},WC=class{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new jo(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Dd=class{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new Uo(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new jo(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new WC(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new jo(this._firestore,r))})}isEqual(e){return UC(this._delegate,e._delegate)}},Vu=class t extends Uo{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new ei(this.firestore,e):null}doc(e){try{return e===void 0?new ei(this.firestore,Td(this._delegate)):new ei(this.firestore,Td(this._delegate,e))}catch(n){throw _n(n,"doc()","CollectionReference.doc()")}}add(e){return Uk(this._delegate,e).then(n=>new ei(this.firestore,n))}isEqual(e){return OC(this._delegate,e._delegate)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(Lu.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Lo(t){return Se(t,Je)}var KC=class t{constructor(...e){this._delegate=new br(...e)}static documentId(){return new t(Et.keyField().canonicalString())}isEqual(e){return e=J(e),e instanceof br?this._delegate._internalPath.isEqual(e._internalPath):!1}};var QC=class t{constructor(e){this._delegate=e}static serverTimestamp(){let e=qk();return e._methodName="FieldValue.serverTimestamp",new t(e)}static delete(){let e=Hk();return e._methodName="FieldValue.delete",new t(e)}static arrayUnion(...e){let n=Gk(...e);return n._methodName="FieldValue.arrayUnion",new t(n)}static arrayRemove(...e){let n=zk(...e);return n._methodName="FieldValue.arrayRemove",new t(n)}static increment(e){let n=Wk(e);return n._methodName="FieldValue.increment",new t(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var E5={Firestore:Lm,GeoPoint:Mo,Timestamp:ft,Blob:Fm,Transaction:Vm,WriteBatch:jm,DocumentReference:ei,DocumentSnapshot:Vo,Query:Uo,QueryDocumentSnapshot:jo,QuerySnapshot:Dd,CollectionReference:Vu,FieldPath:KC,FieldValue:QC,setLogLevel:w5,CACHE_SIZE_UNLIMITED:ik};function I5(t,e){t.INTERNAL.registerComponent(new Ht("firestore-compat",n=>{let r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},E5)))}function C5(t){I5(t,(e,n)=>new Lm(e,n,new zC)),t.registerVersion(y5,_5)}C5(dt);function b5(t,e=hi){return new se(n=>{let r;return e!=null?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}function Xk(t,e){return b5(t,e)}function T5(t,e){return Xk(t,e).pipe(qs(void 0),vc(),H(n=>{let[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function JC(t,e){return Xk(t,e).pipe(H(n=>({payload:n,type:"query"})))}var Um=class{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){let r=this.ref.collection(e),{ref:i,query:s}=rF(r,n);return new $m(i,s,this.afs)}snapshotChanges(){return T5(this.ref,this.afs.schedulers.outsideAngular).pipe(ot)}valueChanges(e={}){return this.snapshotChanges().pipe(H(({payload:n})=>e.idField?Le(N({},n.data()),{[e.idField]:n.id}):n.data()))}get(e){return ve(this.ref.get(e)).pipe(ot)}};function Bm(t,e){return JC(t,e).pipe(qs(void 0),vc(),H(n=>{let[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{let c=s.find(d=>d.doc.ref.isEqual(a.ref)),l=r?.payload.docs.find(d=>d.ref.isEqual(a.ref));c&&JSON.stringify(c.doc.metadata)===JSON.stringify(a.metadata)||!c&&l&&JSON.stringify(l.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),o}))}function Jk(t,e,n){return Bm(t,n).pipe(Rr((r,i)=>D5(r,i.map(s=>s.payload),e),[]),$s(),H(r=>r.map(i=>({type:i.type,payload:i}))))}function D5(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=S5(t,r))}),t}function ZC(t,e,n,...r){let i=t.slice();return i.splice(e,n,...r),i}function S5(t,e){switch(e.type){case"added":if(!(t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)))return ZC(t,e.newIndex,0,e);break;case"modified":if(t[e.oldIndex]==null||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}else return ZC(t,e.newIndex,1,e);break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return ZC(t,e.oldIndex,1);break}return t}function eF(t){return(!t||t.length===0)&&(t=["added","removed","modified"]),t}var $m=class{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=Bm(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(H(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(qs(void 0),vc(),Wt(([r,i])=>i.length>0||!r),H(([,r])=>r),ot)}auditTrail(e){return this.stateChanges(e).pipe(Rr((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=eF(e);return Jk(this.query,n,this.afs.schedulers.outsideAngular).pipe(ot)}valueChanges(e={}){return JC(this.query,this.afs.schedulers.outsideAngular).pipe(H(n=>n.payload.docs.map(r=>e.idField?Le(N({},r.data()),{[e.idField]:r.id}):r.data())),ot)}get(e){return ve(this.query.get(e)).pipe(ot)}add(e){return this.ref.add(e)}doc(e){return new Um(this.ref.doc(e),this.afs)}},XC=class{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return!e||e.length===0?Bm(this.query,this.afs.schedulers.outsideAngular).pipe(ot):Bm(this.query,this.afs.schedulers.outsideAngular).pipe(H(n=>n.filter(r=>e.indexOf(r.type)>-1)),Wt(n=>n.length>0),ot)}auditTrail(e){return this.stateChanges(e).pipe(Rr((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=eF(e);return Jk(this.query,n,this.afs.schedulers.outsideAngular).pipe(ot)}valueChanges(e={}){return JC(this.query,this.afs.schedulers.outsideAngular).pipe(H(r=>r.payload.docs.map(i=>e.idField?N({[e.idField]:i.id},i.data()):i.data())),ot)}get(e){return ve(this.query.get(e)).pipe(ot)}},tF=new j("angularfire2.enableFirestorePersistence"),nF=new j("angularfire2.firestore.persistenceSettings"),A5=new j("angularfire2.firestore.settings"),x5=new j("angularfire2.firestore.use-emulator");function rF(t,e=n=>n){return{query:e(t),ref:t}}var eb=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,u,c,l,d,h,f,p,m,g,_,y){this.schedulers=u;let v=wi(n,a,r),S=l;d&&cl(v,a,h,p,m,g,f,_),[this.firestore,this.persistenceEnabled$]=Ji(`${v.name}.firestore`,"AngularFirestore",v.name,()=>{let F=a.runOutsideAngular(()=>v.firestore());if(s&&F.settings(s),S&&F.useEmulator(...S),i&&!so(o)){let x=()=>{try{return ve(F.enablePersistence(c||void 0).then(()=>!0,()=>!1))}catch(M){return typeof console<"u"&&console.warn(M),q(!1)}};return[F,a.runOutsideAngular(x)]}else return[F,q(!1)]},[s,S,i])}collection(n,r){let i;typeof n=="string"?i=this.firestore.collection(n):i=n;let{ref:s,query:o}=rF(i,r),a=this.schedulers.ngZone.run(()=>s);return new $m(a,o,this)}collectionGroup(n,r){let i=r||(o=>o),s=this.firestore.collectionGroup(n);return new XC(i(s),this)}doc(n){let r;typeof n=="string"?r=this.firestore.doc(n):r=n;let i=this.schedulers.ngZone.run(()=>r);return new Um(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(C(Vr),C(jr,8),C(tF,8),C(A5,8),C(Kt),C(ge),C(Xi),C(nF,8),C(x5,8),C(oo,8),C(rl,8),C(il,8),C(sl,8),C(ol,8),C(al,8),C(ul,8),C(mr,8))};static \u0275prov=B({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),iF=(()=>{class t{constructor(){dt.registerVersion("angularfire",yr.full,"fst-compat")}static enablePersistence(n){return{ngModule:t,providers:[{provide:tF,useValue:!0},{provide:nF,useValue:n}]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Xe({type:t});static \u0275inj=Ze({providers:[eb]})}return t})();var sF="@firebase/database",oF="1.0.2";var hT="";function fT(t){hT=t}var ub=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ct(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Oh(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var cb=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return $n(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var LF=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new ub(e)}}catch{}return new cb},$o=LF("localStorage"),lb=LF("sessionStorage");var $u=new Oi("@firebase/database"),VF=function(){let t=1;return function(){return t++}}(),jF=function(t){let e=KD(t),n=new WD;n.update(e);let r=n.digest();return Rh.encodeByteArray(r)},Yd=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Yd.apply(null,r):typeof r=="object"?e+=Ct(r):e+=r,e+=" "}return e},Ho=null,aF=!0,UF=function(t,e){R(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?($u.logLevel=Hn.VERBOSE,Ho=$u.log.bind($u),e&&lb.set("logging_enabled",!0)):typeof t=="function"?Ho=t:(Ho=null,lb.remove("logging_enabled"))},Bt=function(...t){if(aF===!0&&(aF=!1,Ho===null&&lb.get("logging_enabled")===!0&&UF(!0)),Ho){let e=Yd.apply(null,t);Ho(e)}},Zd=function(t){return function(...e){Bt(t,...e)}},db=function(...t){let e="FIREBASE INTERNAL ERROR: "+Yd(...t);$u.error(e)},ri=function(...t){let e=`FIREBASE FATAL ERROR: ${Yd(...t)}`;throw $u.error(e),new Error(e)},un=function(...t){let e="FIREBASE WARNING: "+Yd(...t);$u.warn(e)},M5=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&un("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},my=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},P5=function(t){if(Ar()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Ss="[MIN_NAME]",Mi="[MAX_NAME]",Go=function(t,e){if(t===e)return 0;if(t===Ss||e===Mi)return-1;if(e===Ss||t===Mi)return 1;{let n=uF(t),r=uF(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},N5=function(t,e){return t===e?0:t<e?-1:1},Sd=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Ct(e))},pT=function(t){if(typeof t!="object"||t===null)return Ct(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=Ct(e[r]),n+=":",n+=pT(t[e[r]]);return n+="}",n},BF=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function $t(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var $F=function(t){R(!my(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,u;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let c=[];for(u=n;u;u-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(u=e;u;u-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(i?1:0),c.reverse();let l=c.join(""),d="";for(u=0;u<64;u+=8){let h=parseInt(l.substr(u,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},O5=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},k5=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function F5(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var L5=new RegExp("^-?(0*)\\d{1,10}$"),V5=-2147483648,j5=2147483647,uF=function(t){if(L5.test(t)){let e=Number(t);if(e>=V5&&e<=j5)return e}return null},Zu=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw un("Exception was thrown by user callback.",n),e},Math.floor(0))}},U5=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Md=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var hb=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){un(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var fb=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Bt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',un(e)}},Pd=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),qm="5",HF="v",qF="s",GF="r",zF="f",WF=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,KF="ls",QF="p",pb="ac",YF="websocket",ZF="long_polling";var Gm=class{constructor(e,n,r,i,s=!1,o="",a=!1,u=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=$o.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&$o.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function B5(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function XF(t,e,n){R(typeof e=="string","typeof type must == string"),R(typeof n=="object","typeof params must == object");let r;if(e===YF)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===ZF)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);B5(t)&&(n.ns=t.namespace);let i=[];return $t(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var gb=class{constructor(){this.counters_={}}incrementCounter(e,n=1){$n(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return UD(this.counters_)}};var tb={},nb={};function gT(t){let e=t.toString();return tb[e]||(tb[e]=new gb),tb[e]}function $5(t,e){let n=t.toString();return nb[n]||(nb[n]=e()),nb[n]}var mb=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Zu(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var cF="start",H5="close",q5="pLPCommand",G5="pRTLPCB",JF="id",eL="pw",tL="ser",z5="cb",W5="seg",K5="ts",Q5="d",Y5="dframe",nL=1870,rL=30,Z5=nL-rL,X5=25e3,J5=3e4,Fd=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Zd(e),this.stats_=gT(n),this.urlFn=u=>(this.appCheckToken&&(u[pb]=this.appCheckToken),XF(n,ZF,u))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new mb(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(J5)),P5(()=>{if(this.isClosed_)return;this.scriptTagHolder=new yb((...s)=>{let[o,a,u,c,l]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===cF)this.id=a,this.password=u;else if(o===H5)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[cF]="t",r[tL]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[z5]=this.scriptTagHolder.uniqueCallbackIdentifier),r[HF]=qm,this.transportSessionId&&(r[qF]=this.transportSessionId),this.lastSessionId&&(r[KF]=this.lastSessionId),this.applicationId&&(r[QF]=this.applicationId),this.appCheckToken&&(r[pb]=this.appCheckToken),typeof location<"u"&&location.hostname&&WF.test(location.hostname)&&(r[GF]=zF);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return Ar()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!O5()&&!k5()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=Ct(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=jD(n),i=BF(r,Z5);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(Ar())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[Y5]="t",r[JF]=e,r[eL]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=Ct(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},yb=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,Ar())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=VF(),window[q5+this.uniqueCallbackIdentifier]=e,window[G5+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Bt("frame writing exception"),a.stack&&Bt(a.stack),Bt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Bt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[JF]=this.myID,e[eL]=this.myPW,e[tL]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+rL+r.length<=nL;){let o=this.pendingSegs.shift();r=r+"&"+W5+i+"="+o.seg+"&"+K5+i+"="+o.ts+"&"+Q5+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(X5)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){Ar()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Bt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var eW=16384,tW=45e3,zm=null;typeof MozWebSocket<"u"?zm=MozWebSocket:typeof WebSocket<"u"&&(zm=WebSocket);var Uu=(()=>{class t{constructor(n,r,i,s,o,a,u){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Zd(this.connId),this.stats_=gT(r),this.connURL=t.connectionURL_(r,a,u,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[HF]=qm,!Ar()&&typeof location<"u"&&location.hostname&&WF.test(location.hostname)&&(a[GF]=zF),r&&(a[qF]=r),i&&(a[KF]=i),s&&(a[pb]=s),o&&(a[QF]=o),XF(n,YF,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,$o.set("previous_websocket_failure",!0);try{let i;if(Ar()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${qm}/${hT}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new zm(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&zm!==null&&!t.forceDisallow_}static previouslyFailed(){return $o.isInMemoryStorage||$o.get("previous_websocket_failure")===!0}markConnectionHealthy(){$o.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=Oh(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(R(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=Ct(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=BF(r,eW);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(tW))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),iL=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[Fd,Uu]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=Uu&&Uu.isAvailable(),i=r&&!Uu.previouslyFailed();if(n.webSocketOnly&&(r||un("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Uu];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),nW=6e4,rW=5e3,iW=10*1024,sW=100*1024,rb="t",lF="d",oW="s",dF="r",aW="e",hF="o",fF="a",pF="n",gF="p",uW="h",_b=class{constructor(e,n,r,i,s,o,a,u,c,l){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=u,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Zd("c:"+this.id+":"),this.transportManager_=new iL(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Md(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>sW?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>iW?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(rb in e){let n=e[rb];n===fF?this.upgradeIfSecondaryHealthy_():n===dF?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===hF&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=Sd("t",e),r=Sd("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:gF,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:fF,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:pF,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=Sd("t",e),r=Sd("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=Sd(rb,e);if(lF in e){let r=e[lF];if(n===uW){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===pF){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===oW?this.onConnectionShutdown_(r):n===dF?this.onReset_(r):n===aW?db("Server Error: "+r):n===hF?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):db("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),qm!==r&&un("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Md(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(nW))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Md(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(rW))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:gF,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&($o.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Wm=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var Km=class{constructor(e){this.allowedEvents_=e,this.listeners_={},R(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){R(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var Qm=class t extends Km{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!n_()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return R(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var mF=32,yF=768,Fe=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function ke(){return new Fe("")}function ye(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function As(t){return t.pieces_.length-t.pieceNum_}function Ye(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Fe(t.pieces_,e)}function mT(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function cW(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Ld(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function sL(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Fe(e,0)}function ct(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Fe)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new Fe(n,0)}function _e(t){return t.pieceNum_>=t.pieces_.length}function vn(t,e){let n=ye(t),r=ye(e);if(n===null)return e;if(n===r)return vn(Ye(t),Ye(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function lW(t,e){let n=Ld(t,0),r=Ld(e,0);for(let i=0;i<n.length&&i<r.length;i++){let s=Go(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function yT(t,e){if(As(t)!==As(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function nr(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(As(t)>As(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var vb=class{constructor(e,n){this.errorPrefix_=n,this.parts_=Ld(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=pc(this.parts_[r]);oL(this)}};function dW(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=pc(e),oL(t)}function hW(t){let e=t.parts_.pop();t.byteLength_-=pc(e),t.parts_.length>0&&(t.byteLength_-=1)}function oL(t){if(t.byteLength_>yF)throw new Error(t.errorPrefix_+"has a key path longer than "+yF+" bytes ("+t.byteLength_+").");if(t.parts_.length>mF)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+mF+") or object contains a cycle "+Bo(t))}function Bo(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var wb=class t extends Km{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return R(e==="visible","Unknown event type: "+e),[this.visible_]}};var Ad=1e3,fW=60*5*1e3,_F=30*1e3,pW=1.3,gW=3e4,mW="server_kill",vF=3,_T=(()=>{class t extends Wm{constructor(n,r,i,s,o,a,u,c){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=u,this.authOverride_=c,this.id=t.nextPersistentConnectionId_++,this.log_=Zd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ad,this.maxReconnectDelay_=fW,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!Ar())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");wb.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&Qm.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(Ct(o)),R(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new Ft,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let u=a.d;a.s==="ok"?r.resolve(u):r.reject(u)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),R(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),R(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let u={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,u),this.connected_&&this.sendListen_(u)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,u=>{let c=u.d,l=u.s;t.warnOnListenWarnings_(c,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",u),l!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(l,c))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&$n(n,"w")){let i=Ni(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();un(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||GD(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=_F)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=qD(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),R(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let u=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(u):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+Ct(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):db("Unrecognized action received from server: "+Ct(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){R(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ad,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Ad,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>gW&&(this.reconnectDelay_=Ad),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*pW)}this.onConnectStatus_(!1)}establishConnection_(){return I(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,u=null,c=function(){u?u.close():(a=!0,i())},l=function(h){R(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(h)};this.realtime_={close:c,sendRequest:l};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?Bt("getToken() completed but was canceled"):(Bt("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,u=new _b(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,p=>{un(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(mW)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&un(h),c())}}})}interrupt(n){Bt("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){Bt("Resuming connection for reason: "+n),delete this.interruptReasons_[n],kh(this.interruptReasons_)&&(this.reconnectDelay_=Ad,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>pT(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new Fe(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){Bt("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=vF&&(this.reconnectDelay_=_F,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){Bt("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=vF&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";Ar()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+hT.replace(/\./g,"-")]=1,n_()?n["framework.cordova"]=1:BD()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=Qm.getInstance().currentlyOnline();return kh(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),Ee=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var Hu=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new Ee(Ss,e),i=new Ee(Ss,n);return this.compare(r,i)!==0}minPost(){return Ee.MIN}};var Hm,Ym=class extends Hu{static get __EMPTY_NODE(){return Hm}static set __EMPTY_NODE(e){Hm=e}compare(e,n){return Go(e.name,n.name)}isDefinedOn(e){throw ea("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return Ee.MIN}maxPost(){return new Ee(Mi,Hm)}makePost(e,n){return R(typeof e=="string","KeyIndex indexValue must always be a string."),new Ee(e,Hm)}toString(){return".key"}},ni=new Ym;var Bu=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Dr=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??rr.EMPTY_NODE,this.right=o??rr.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return rr.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return rr.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),Eb=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new Dr(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},rr=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Dr.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Dr.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Bu(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Bu(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Bu(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Bu(this.root_,null,this.comparator_,!0,e)}};rr.EMPTY_NODE=new Eb;function yW(t,e){return Go(t.name,e.name)}function vT(t,e){return Go(t,e)}var Ib;function _W(t){Ib=t}var aL=function(t){return typeof t=="number"?"number:"+$F(t):"string:"+t},uL=function(t){if(t.isLeafNode()){let e=t.val();R(typeof e=="string"||typeof e=="number"||typeof e=="object"&&$n(e,".sv"),"Priority must be a string or number.")}else R(t===Ib||t.isEmpty(),"priority of unexpected type.");R(t===Ib||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var wF,qu=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,R(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),uL(this.priorityNode_)}static set __childrenNodeConstructor(n){wF=n}static get __childrenNodeConstructor(){return wF}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return _e(n)?this:ye(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=ye(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(R(i!==".priority"||As(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ye(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+aL(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=$F(this.value_):n+=this.value_,this.lazyHash_=jF(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(R(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return R(s>=0,"Unknown leaf type: "+r),R(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),cL,lL;function vW(t){cL=t}function wW(t){lL=t}var Cb=class extends Hu{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?Go(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return Ee.MIN}maxPost(){return new Ee(Mi,new qu("[PRIORITY-POST]",lL))}makePost(e,n){let r=cL(e);return new Ee(n,new qu("[PRIORITY-POST]",r))}toString(){return".priority"}},et=new Cb;var EW=Math.log(2),bb=class{constructor(e){let n=s=>parseInt(Math.log(s)/EW,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Zm=function(t,e,n,r){t.sort(e);let i=function(u,c){let l=c-u,d,h;if(l===0)return null;if(l===1)return d=t[u],h=n?n(d):d,new Dr(h,d.node,Dr.BLACK,null,null);{let f=parseInt(l/2,10)+u,p=i(u,f),m=i(f+1,c);return d=t[f],h=n?n(d):d,new Dr(h,d.node,Dr.BLACK,p,m)}},s=function(u){let c=null,l=null,d=t.length,h=function(p,m){let g=d-p,_=d;d-=p;let y=i(g+1,_),v=t[g],S=n?n(v):v;f(new Dr(S,v.node,m,null,y))},f=function(p){c?(c.left=p,c=p):(l=p,c=p)};for(let p=0;p<u.count;++p){let m=u.nextBitIsOne(),g=Math.pow(2,u.count-(p+1));m?h(g,Dr.BLACK):(h(g,Dr.BLACK),h(g,Dr.RED))}return l},o=new bb(t.length),a=s(o);return new rr(r||e,a)};var ib,ju={},Gu=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return R(ju&&et,"ChildrenNode.ts has not been loaded"),ib=ib||new t({".priority":ju},{".priority":et}),ib}get(e){let n=Ni(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof rr?n:null}hasIndex(e){return $n(this.indexSet_,e.toString())}addIndex(e,n){R(e!==ni,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(Ee.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=Zm(r,e.getCompare()):a=ju;let u=e.toString(),c=Object.assign({},this.indexSet_);c[u]=e;let l=Object.assign({},this.indexes_);return l[u]=a,new t(l,c)}addToIndexes(e,n){let r=fc(this.indexes_,(i,s)=>{let o=Ni(this.indexSet_,s);if(R(o,"Missing index implementation for "+s),i===ju)if(o.isDefinedOn(e.node)){let a=[],u=n.getIterator(Ee.Wrap),c=u.getNext();for(;c;)c.name!==e.name&&a.push(c),c=u.getNext();return a.push(e),Zm(a,o.getCompare())}else return ju;else{let a=n.get(e.name),u=i;return a&&(u=u.remove(new Ee(e.name,a))),u.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=fc(this.indexes_,i=>{if(i===ju)return i;{let s=n.get(e.name);return s?i.remove(new Ee(e.name,s)):i}});return new t(r,this.indexSet_)}};var xd,ue=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&uL(this.priorityNode_),this.children_.isEmpty()&&R(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return xd||(xd=new t(new rr(vT),null,Gu.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||xd}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?xd:r}}getChild(n){let r=ye(n);return r===null?this:this.getImmediateChild(r).getChild(Ye(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(R(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new Ee(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?xd:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=ye(n);if(i===null)return r;{R(ye(n)!==".priority"||As(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Ye(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(et,(a,u)=>{r[a]=u.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let u in r)a[u]=r[u];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+aL(this.getPriority().val())+":"),this.forEachChild(et,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":jF(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new Ee(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new Ee(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new Ee(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,Ee.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,Ee.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===Xd?-1:0}withIndex(n){if(n===ni||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===ni||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(et),s=r.getIterator(et),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===ni?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),Tb=class extends ue{constructor(){super(new rr(vT),ue.EMPTY_NODE,Gu.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ue.EMPTY_NODE}isEmpty(){return!1}},Xd=new Tb;Object.defineProperties(Ee,{MIN:{value:new Ee(Ss,ue.EMPTY_NODE)},MAX:{value:new Ee(Mi,Xd)}});Ym.__EMPTY_NODE=ue.EMPTY_NODE;qu.__childrenNodeConstructor=ue;_W(Xd);wW(Xd);var IW=!0;function pt(t,e=null){if(t===null)return ue.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),R(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new qu(n,pt(e))}if(!(t instanceof Array)&&IW){let n=[],r=!1;if($t(t,(o,a)=>{if(o.substring(0,1)!=="."){let u=pt(a);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),n.push(new Ee(o,u)))}}),n.length===0)return ue.EMPTY_NODE;let s=Zm(n,yW,o=>o.name,vT);if(r){let o=Zm(n,et.getCompare());return new ue(s,pt(e),new Gu({".priority":o},{".priority":et}))}else return new ue(s,pt(e),Gu.Default)}else{let n=ue.EMPTY_NODE;return $t(t,(r,i)=>{if($n(t,r)&&r.substring(0,1)!=="."){let s=pt(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(pt(e))}}vW(pt);var Vd=class extends Hu{constructor(e){super(),this.indexPath_=e,R(!_e(e)&&ye(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?Go(e.name,n.name):s}makePost(e,n){let r=pt(e),i=ue.EMPTY_NODE.updateChild(this.indexPath_,r);return new Ee(n,i)}maxPost(){let e=ue.EMPTY_NODE.updateChild(this.indexPath_,Xd);return new Ee(Mi,e)}toString(){return Ld(this.indexPath_,0).join("/")}};var Db=class extends Hu{compare(e,n){let r=e.node.compareTo(n.node);return r===0?Go(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return Ee.MIN}maxPost(){return Ee.MAX}makePost(e,n){let r=pt(e);return new Ee(n,r)}toString(){return".value"}},wT=new Db;function dL(t){return{type:"value",snapshotNode:t}}function zu(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function jd(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Ud(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function CW(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var Bd=class{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){R(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(jd(n,a)):R(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(zu(n,r)):o.trackChildChange(Ud(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(et,(i,s)=>{n.hasChild(i)||r.trackChildChange(jd(i,s))}),n.isLeafNode()||n.forEachChild(et,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Ud(i,s,o))}else r.trackChildChange(zu(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?ue.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var Xm=class t{constructor(e){this.indexedFilter_=new Bd(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new Ee(n,r))||(r=ue.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=ue.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(ue.EMPTY_NODE);let s=this;return n.forEachChild(et,(o,a)=>{s.matches(new Ee(o,a))||(i=i.updateImmediateChild(o,ue.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var Sb=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{let r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Xm(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new Ee(n,r))||(r=ue.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=ue.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=ue.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(ue.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,ue.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();let a=e;R(a.numChildren()===this.limit_,"");let u=new Ee(n,r),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),l=this.rangedFilter_.matches(u);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=i.getChildAfterChild(this.index_,c,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);let f=h==null?1:o(h,u);if(l&&!r.isEmpty()&&f>=0)return s?.trackChildChange(Ud(n,r,d)),a.updateImmediateChild(n,r);{s?.trackChildChange(jd(n,d));let m=a.updateImmediateChild(n,ue.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(zu(h.name,h.node)),m.updateImmediateChild(h.name,h.node)):m}}else return r.isEmpty()?e:l&&o(c,u)>=0?(s!=null&&(s.trackChildChange(jd(c.name,c.node)),s.trackChildChange(zu(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(c.name,ue.EMPTY_NODE)):e}};var $d=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=et}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return R(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return R(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ss}hasEnd(){return this.endSet_}getIndexEndValue(){return R(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return R(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Mi}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return R(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===et}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function bW(t){return t.loadsAllData()?new Bd(t.getIndex()):t.hasLimit()?new Sb(t):new Xm(t)}function TW(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function DW(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function Ab(t,e,n){let r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function SW(t,e,n){let r;return t.index_===ni||n?r=Ab(t,e,n):r=Ab(t,e,Mi),r.startAfterSet_=!0,r}function xb(t,e,n){let r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function AW(t,e,n){let r;return t.index_===ni||n?r=xb(t,e,n):r=xb(t,e,Ss),r.endBeforeSet_=!0,r}function yy(t,e){let n=t.copy();return n.index_=e,n}function EF(t){let e={};if(t.isDefault())return e;let n;if(t.index_===et?n="$priority":t.index_===wT?n="$value":t.index_===ni?n="$key":(R(t.index_ instanceof Vd,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Ct(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=Ct(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+Ct(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=Ct(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+Ct(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function IF(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==et&&(e.i=t.index_.toString()),e}var Rb=class t extends Wm{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Zd("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(R(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let u=EF(e._queryParams);this.restRequest_(s+".json",u,(c,l)=>{let d=l;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(s,d,!1,r),Ni(this.listens_,o)===a){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",i(h,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=EF(e._queryParams),r=e._path.toString(),i=new Ft;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+zD(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let u=null;if(a.status>=200&&a.status<300){try{u=Oh(a.responseText)}catch{un("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,u)}else a.status!==401&&a.status!==404&&un("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var Mb=class{constructor(){this.rootNode_=ue.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function Jm(){return{value:null,children:new Map}}function Xu(t,e,n){if(_e(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=ye(e);t.children.has(r)||t.children.set(r,Jm());let i=t.children.get(r);e=Ye(e),Xu(i,e,n)}}function Pb(t,e){if(_e(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(et,(r,i)=>{Xu(t,new Fe(r),i)}),Pb(t,e)}}else if(t.children.size>0){let n=ye(e);return e=Ye(e),t.children.has(n)&&Pb(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function Nb(t,e,n){t.value!==null?n(e,t.value):xW(t,(r,i)=>{let s=new Fe(e.toString()+"/"+r);Nb(i,s,n)})}function xW(t,e){t.children.forEach((n,r)=>{e(r,n)})}var Ob=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&$t(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var CF=10*1e3,RW=30*1e3,MW=5*60*1e3,kb=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new Ob(e);let r=CF+(RW-CF)*Math.random();Md(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;$t(e,(i,s)=>{s>0&&$n(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),Md(this.reportStats_.bind(this),Math.floor(Math.random()*2*MW))}};var ti=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(ti||{});function ET(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function IT(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function CT(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var Fb=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=ti.ACK_USER_WRITE,this.source=ET()}operationForChild(e){if(_e(this.path)){if(this.affectedTree.value!=null)return R(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new Fe(e));return new t(ke(),n,this.revert)}}else return R(ye(this.path)===e,"operationForChild called for unrelated child."),new t(Ye(this.path),this.affectedTree,this.revert)}};var ey=class t{constructor(e,n){this.source=e,this.path=n,this.type=ti.LISTEN_COMPLETE}operationForChild(e){return _e(this.path)?new t(this.source,ke()):new t(this.source,Ye(this.path))}};var Wu=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=ti.OVERWRITE}operationForChild(e){return _e(this.path)?new t(this.source,ke(),this.snap.getImmediateChild(e)):new t(this.source,Ye(this.path),this.snap)}};var Hd=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=ti.MERGE}operationForChild(e){if(_e(this.path)){let n=this.children.subtree(new Fe(e));return n.isEmpty()?null:n.value?new Wu(this.source,ke(),n.value):new t(this.source,ke(),n)}else return R(ye(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,Ye(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var ii=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(_e(e))return this.isFullyInitialized()&&!this.filtered_;let n=ye(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var Lb=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function PW(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(CW(o.childName,o.snapshotNode))}),Rd(t,i,"child_removed",e,r,n),Rd(t,i,"child_added",e,r,n),Rd(t,i,"child_moved",s,r,n),Rd(t,i,"child_changed",e,r,n),Rd(t,i,"value",e,r,n),i}function Rd(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,u)=>OW(t,a,u)),o.forEach(a=>{let u=NW(t,a,s);i.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(u,t.query_))})})}function NW(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function OW(t,e,n){if(e.childName==null||n.childName==null)throw ea("Should only compare child_ events.");let r=new Ee(e.childName,e.snapshotNode),i=new Ee(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function _y(t,e){return{eventCache:t,serverCache:e}}function Nd(t,e,n,r){return _y(new ii(e,n,r),t.serverCache)}function hL(t,e,n,r){return _y(t.eventCache,new ii(e,n,r))}function ty(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function qo(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var sb,kW=()=>(sb||(sb=new rr(N5)),sb),wn=class t{constructor(e,n=kW()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return $t(e,(r,i)=>{n=n.set(new Fe(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:ke(),value:this.value};if(_e(e))return null;{let r=ye(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Ye(e),n);return s!=null?{path:ct(new Fe(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(_e(e))return this;{let n=ye(e),r=this.children.get(n);return r!==null?r.subtree(Ye(e)):new t(null)}}set(e,n){if(_e(e))return new t(n,this.children);{let r=ye(e),s=(this.children.get(r)||new t(null)).set(Ye(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(_e(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=ye(e),r=this.children.get(n);if(r){let i=r.remove(Ye(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(_e(e))return this.value;{let n=ye(e),r=this.children.get(n);return r?r.get(Ye(e)):null}}setTree(e,n){if(_e(e))return n;{let r=ye(e),s=(this.children.get(r)||new t(null)).setTree(Ye(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(ke(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(ct(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,ke(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(_e(e))return null;{let s=ye(e),o=this.children.get(s);return o?o.findOnPath_(Ye(e),ct(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,ke(),n)}foreachOnPath_(e,n,r){if(_e(e))return this;{this.value&&r(n,this.value);let i=ye(e),s=this.children.get(i);return s?s.foreachOnPath_(Ye(e),ct(n,i),r):new t(null)}}foreach(e){this.foreach_(ke(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(ct(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var Sr=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new wn(null))}};function Od(t,e,n){if(_e(e))return new Sr(new wn(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=vn(i,e);return s=s.updateChild(o,n),new Sr(t.writeTree_.set(i,s))}else{let i=new wn(n),s=t.writeTree_.setTree(e,i);return new Sr(s)}}}function Vb(t,e,n){let r=t;return $t(n,(i,s)=>{r=Od(r,ct(e,i),s)}),r}function bF(t,e){if(_e(e))return Sr.empty();{let n=t.writeTree_.setTree(e,new wn(null));return new Sr(n)}}function jb(t,e){return zo(t,e)!=null}function zo(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(vn(n.path,e)):null}function TF(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(et,(r,i)=>{e.push(new Ee(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new Ee(r,i.value))}),e}function Ts(t,e){if(_e(e))return t;{let n=zo(t,e);return n!=null?new Sr(new wn(n)):new Sr(t.writeTree_.subtree(e))}}function Ub(t){return t.writeTree_.isEmpty()}function Ku(t,e){return fL(ke(),t.writeTree_,e)}function fL(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(R(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=fL(ct(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(ct(t,".priority"),r)),n}}function vy(t,e){return yL(e,t)}function FW(t,e,n,r,i){R(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Od(t.visibleWrites,e,n)),t.lastWriteId=r}function LW(t,e,n,r){R(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=Vb(t.visibleWrites,e,n),t.lastWriteId=r}function VW(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function jW(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);R(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&UW(a,r.path)?i=!1:nr(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return BW(t),!0;if(r.snap)t.visibleWrites=bF(t.visibleWrites,r.path);else{let a=r.children;$t(a,u=>{t.visibleWrites=bF(t.visibleWrites,ct(r.path,u))})}return!0}else return!1}function UW(t,e){if(t.snap)return nr(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&nr(ct(t.path,n),e))return!0;return!1}function BW(t){t.visibleWrites=pL(t.allWrites,$W,ke()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function $W(t){return t.visible}function pL(t,e,n){let r=Sr.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)nr(n,o)?(a=vn(n,o),r=Od(r,a,s.snap)):nr(o,n)&&(a=vn(o,n),r=Od(r,ke(),s.snap.getChild(a)));else if(s.children){if(nr(n,o))a=vn(n,o),r=Vb(r,a,s.children);else if(nr(o,n))if(a=vn(o,n),_e(a))r=Vb(r,ke(),s.children);else{let u=Ni(s.children,ye(a));if(u){let c=u.getChild(Ye(a));r=Od(r,ke(),c)}}}else throw ea("WriteRecord should have .snap or .children")}}return r}function gL(t,e,n,r,i){if(!r&&!i){let s=zo(t.visibleWrites,e);if(s!=null)return s;{let o=Ts(t.visibleWrites,e);if(Ub(o))return n;if(n==null&&!jb(o,ke()))return null;{let a=n||ue.EMPTY_NODE;return Ku(o,a)}}}else{let s=Ts(t.visibleWrites,e);if(!i&&Ub(s))return n;if(!i&&n==null&&!jb(s,ke()))return null;{let o=function(c){return(c.visible||i)&&(!r||!~r.indexOf(c.writeId))&&(nr(c.path,e)||nr(e,c.path))},a=pL(t.allWrites,o,e),u=n||ue.EMPTY_NODE;return Ku(a,u)}}}function HW(t,e,n){let r=ue.EMPTY_NODE,i=zo(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(et,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=Ts(t.visibleWrites,e);return n.forEachChild(et,(o,a)=>{let u=Ku(Ts(s,new Fe(o)),a);r=r.updateImmediateChild(o,u)}),TF(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=Ts(t.visibleWrites,e);return TF(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function qW(t,e,n,r,i){R(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=ct(e,n);if(jb(t.visibleWrites,s))return null;{let o=Ts(t.visibleWrites,s);return Ub(o)?i.getChild(n):Ku(o,i.getChild(n))}}function GW(t,e,n,r){let i=ct(e,n),s=zo(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=Ts(t.visibleWrites,i);return Ku(o,r.getNode().getImmediateChild(n))}else return null}function zW(t,e){return zo(t.visibleWrites,e)}function WW(t,e,n,r,i,s,o){let a,u=Ts(t.visibleWrites,e),c=zo(u,ke());if(c!=null)a=c;else if(n!=null)a=Ku(u,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let l=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),f=h.getNext();for(;f&&l.length<i;)d(f,r)!==0&&l.push(f),f=h.getNext();return l}else return[]}function KW(){return{visibleWrites:Sr.empty(),allWrites:[],lastWriteId:-1}}function ny(t,e,n,r){return gL(t.writeTree,t.treePath,e,n,r)}function bT(t,e){return HW(t.writeTree,t.treePath,e)}function DF(t,e,n,r){return qW(t.writeTree,t.treePath,e,n,r)}function ry(t,e){return zW(t.writeTree,ct(t.treePath,e))}function QW(t,e,n,r,i,s){return WW(t.writeTree,t.treePath,e,n,r,i,s)}function TT(t,e,n){return GW(t.writeTree,t.treePath,e,n)}function mL(t,e){return yL(ct(t.treePath,e),t.writeTree)}function yL(t,e){return{treePath:t,writeTree:e}}var Bb=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;R(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),R(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,Ud(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,jd(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,zu(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,Ud(r,e.snapshotNode,i.oldSnap));else throw ea("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var $b=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},_L=new $b,qd=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new ii(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return TT(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:qo(this.viewCache_),s=QW(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function YW(t){return{filter:t}}function ZW(t,e){R(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),R(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function XW(t,e,n,r,i){let s=new Bb,o,a;if(n.type===ti.OVERWRITE){let c=n;c.source.fromUser?o=Hb(t,e,c.path,c.snap,r,i,s):(R(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!_e(c.path),o=iy(t,e,c.path,c.snap,r,i,a,s))}else if(n.type===ti.MERGE){let c=n;c.source.fromUser?o=e6(t,e,c.path,c.children,r,i,s):(R(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=qb(t,e,c.path,c.children,r,i,a,s))}else if(n.type===ti.ACK_USER_WRITE){let c=n;c.revert?o=r6(t,e,c.path,r,i,s):o=t6(t,e,c.path,c.affectedTree,r,i,s)}else if(n.type===ti.LISTEN_COMPLETE)o=n6(t,e,n.path,r,s);else throw ea("Unknown operation type: "+n.type);let u=s.getChanges();return JW(e,o,u),{viewCache:o,changes:u}}function JW(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=ty(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(dL(ty(e)))}}function vL(t,e,n,r,i,s){let o=e.eventCache;if(ry(r,n)!=null)return e;{let a,u;if(_e(n))if(R(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=qo(e),l=c instanceof ue?c:ue.EMPTY_NODE,d=bT(r,l);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let c=ny(r,qo(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{let c=ye(n);if(c===".priority"){R(As(n)===1,"Can't have a priority with additional path components");let l=o.getNode();u=e.serverCache.getNode();let d=DF(r,n,l,u);d!=null?a=t.filter.updatePriority(l,d):a=o.getNode()}else{let l=Ye(n),d;if(o.isCompleteForChild(c)){u=e.serverCache.getNode();let h=DF(r,n,o.getNode(),u);h!=null?d=o.getNode().getImmediateChild(c).updateChild(l,h):d=o.getNode().getImmediateChild(c)}else d=TT(r,c,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),c,d,l,i,s):a=o.getNode()}}return Nd(e,a,o.isFullyInitialized()||_e(n),t.filter.filtersNodes())}}function iy(t,e,n,r,i,s,o,a){let u=e.serverCache,c,l=o?t.filter:t.filter.getIndexedFilter();if(_e(n))c=l.updateFullNode(u.getNode(),r,null);else if(l.filtersNodes()&&!u.isFiltered()){let f=u.getNode().updateChild(n,r);c=l.updateFullNode(u.getNode(),f,null)}else{let f=ye(n);if(!u.isCompleteForPath(n)&&As(n)>1)return e;let p=Ye(n),g=u.getNode().getImmediateChild(f).updateChild(p,r);f===".priority"?c=l.updatePriority(u.getNode(),g):c=l.updateChild(u.getNode(),f,g,p,_L,null)}let d=hL(e,c,u.isFullyInitialized()||_e(n),l.filtersNodes()),h=new qd(i,d,s);return vL(t,d,n,i,h,a)}function Hb(t,e,n,r,i,s,o){let a=e.eventCache,u,c,l=new qd(i,e,s);if(_e(n))c=t.filter.updateFullNode(e.eventCache.getNode(),r,o),u=Nd(e,c,!0,t.filter.filtersNodes());else{let d=ye(n);if(d===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),r),u=Nd(e,c,a.isFullyInitialized(),a.isFiltered());else{let h=Ye(n),f=a.getNode().getImmediateChild(d),p;if(_e(h))p=r;else{let m=l.getCompleteChild(d);m!=null?mT(h)===".priority"&&m.getChild(sL(h)).isEmpty()?p=m:p=m.updateChild(h,r):p=ue.EMPTY_NODE}if(f.equals(p))u=e;else{let m=t.filter.updateChild(a.getNode(),d,p,h,l,o);u=Nd(e,m,a.isFullyInitialized(),t.filter.filtersNodes())}}}return u}function SF(t,e){return t.eventCache.isCompleteForChild(e)}function e6(t,e,n,r,i,s,o){let a=e;return r.foreach((u,c)=>{let l=ct(n,u);SF(e,ye(l))&&(a=Hb(t,a,l,c,i,s,o))}),r.foreach((u,c)=>{let l=ct(n,u);SF(e,ye(l))||(a=Hb(t,a,l,c,i,s,o))}),a}function AF(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function qb(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u=e,c;_e(n)?c=r:c=new wn(null).setTree(n,r);let l=e.serverCache.getNode();return c.children.inorderTraversal((d,h)=>{if(l.hasChild(d)){let f=e.serverCache.getNode().getImmediateChild(d),p=AF(t,f,h);u=iy(t,u,new Fe(d),p,i,s,o,a)}}),c.children.inorderTraversal((d,h)=>{let f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!l.hasChild(d)&&!f){let p=e.serverCache.getNode().getImmediateChild(d),m=AF(t,p,h);u=iy(t,u,new Fe(d),m,i,s,o,a)}}),u}function t6(t,e,n,r,i,s,o){if(ry(i,n)!=null)return e;let a=e.serverCache.isFiltered(),u=e.serverCache;if(r.value!=null){if(_e(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return iy(t,e,n,u.getNode().getChild(n),i,s,a,o);if(_e(n)){let c=new wn(null);return u.getNode().forEachChild(ni,(l,d)=>{c=c.set(new Fe(l),d)}),qb(t,e,n,c,i,s,a,o)}else return e}else{let c=new wn(null);return r.foreach((l,d)=>{let h=ct(n,l);u.isCompleteForPath(h)&&(c=c.set(l,u.getNode().getChild(h)))}),qb(t,e,n,c,i,s,a,o)}}function n6(t,e,n,r,i){let s=e.serverCache,o=hL(e,s.getNode(),s.isFullyInitialized()||_e(n),s.isFiltered());return vL(t,o,n,r,_L,i)}function r6(t,e,n,r,i,s){let o;if(ry(r,n)!=null)return e;{let a=new qd(r,e,i),u=e.eventCache.getNode(),c;if(_e(n)||ye(n)===".priority"){let l;if(e.serverCache.isFullyInitialized())l=ny(r,qo(e));else{let d=e.serverCache.getNode();R(d instanceof ue,"serverChildren would be complete if leaf node"),l=bT(r,d)}l=l,c=t.filter.updateFullNode(u,l,s)}else{let l=ye(n),d=TT(r,l,e.serverCache);d==null&&e.serverCache.isCompleteForChild(l)&&(d=u.getImmediateChild(l)),d!=null?c=t.filter.updateChild(u,l,d,Ye(n),a,s):e.eventCache.getNode().hasChild(l)?c=t.filter.updateChild(u,l,ue.EMPTY_NODE,Ye(n),a,s):c=u,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=ny(r,qo(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||ry(r,ke())!=null,Nd(e,c,o,t.filter.filtersNodes())}}var Gb=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new Bd(r.getIndex()),s=bW(r);this.processor_=YW(s);let o=n.serverCache,a=n.eventCache,u=i.updateFullNode(ue.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(ue.EMPTY_NODE,a.getNode(),null),l=new ii(u,o.isFullyInitialized(),i.filtersNodes()),d=new ii(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=_y(d,l),this.eventGenerator_=new Lb(this.query_)}get query(){return this.query_}};function i6(t){return t.viewCache_.serverCache.getNode()}function s6(t){return ty(t.viewCache_)}function o6(t,e){let n=qo(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!_e(e)&&!n.getImmediateChild(ye(e)).isEmpty())?n.getChild(e):null}function xF(t){return t.eventRegistrations_.length===0}function a6(t,e){t.eventRegistrations_.push(e)}function RF(t,e,n){let r=[];if(n){R(e==null,"A cancel should cancel all event registrations.");let i=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function MF(t,e,n,r){e.type===ti.MERGE&&e.source.queryId!==null&&(R(qo(t.viewCache_),"We should always have a full cache before handling merges"),R(ty(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=XW(t.processor_,i,e,n,r);return ZW(t.processor_,s.viewCache),R(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,wL(t,s.changes,s.viewCache.eventCache.getNode(),null)}function u6(t,e){let n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(et,(s,o)=>{r.push(zu(s,o))}),n.isFullyInitialized()&&r.push(dL(n.getNode())),wL(t,r,n.getNode(),e)}function wL(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return PW(t.eventGenerator_,e,n,i)}var sy,oy=class{constructor(){this.views=new Map}};function c6(t){R(!sy,"__referenceConstructor has already been defined"),sy=t}function l6(){return R(sy,"Reference.ts has not been loaded"),sy}function d6(t){return t.views.size===0}function DT(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return R(s!=null,"SyncTree gave us an op for an invalid query."),MF(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat(MF(o,e,n,r));return s}}function EL(t,e,n,r,i){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=ny(n,i?r:null),u=!1;a?u=!0:r instanceof ue?(a=bT(n,r),u=!1):(a=ue.EMPTY_NODE,u=!1);let c=_y(new ii(a,u,!1),new ii(r,i,!1));return new Gb(e,c)}return o}function h6(t,e,n,r,i,s){let o=EL(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),a6(o,n),u6(o,n)}function f6(t,e,n,r){let i=e._queryIdentifier,s=[],o=[],a=xs(t);if(i==="default")for(let[u,c]of t.views.entries())o=o.concat(RF(c,n,r)),xF(c)&&(t.views.delete(u),c.query._queryParams.loadsAllData()||s.push(c.query));else{let u=t.views.get(i);u&&(o=o.concat(RF(u,n,r)),xF(u)&&(t.views.delete(i),u.query._queryParams.loadsAllData()||s.push(u.query)))}return a&&!xs(t)&&s.push(new(l6())(e._repo,e._path)),{removed:s,events:o}}function IL(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Ds(t,e){let n=null;for(let r of t.views.values())n=n||o6(r,e);return n}function CL(t,e){if(e._queryParams.loadsAllData())return wy(t);{let r=e._queryIdentifier;return t.views.get(r)}}function bL(t,e){return CL(t,e)!=null}function xs(t){return wy(t)!=null}function wy(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var ay;function p6(t){R(!ay,"__referenceConstructor has already been defined"),ay=t}function g6(){return R(ay,"Reference.ts has not been loaded"),ay}var m6=1,uy=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new wn(null),this.pendingWriteTree_=KW(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function ST(t,e,n,r,i){return FW(t.pendingWriteTree_,e,n,r,i),i?Ju(t,new Wu(ET(),e,n)):[]}function y6(t,e,n,r){LW(t.pendingWriteTree_,e,n,r);let i=wn.fromObject(n);return Ju(t,new Hd(ET(),e,i))}function bs(t,e,n=!1){let r=VW(t.pendingWriteTree_,e);if(jW(t.pendingWriteTree_,e)){let s=new wn(null);return r.snap!=null?s=s.set(ke(),!0):$t(r.children,o=>{s=s.set(new Fe(o),!0)}),Ju(t,new Fb(r.path,s,n))}else return[]}function Jd(t,e,n){return Ju(t,new Wu(IT(),e,n))}function _6(t,e,n){let r=wn.fromObject(n);return Ju(t,new Hd(IT(),e,r))}function v6(t,e){return Ju(t,new ey(IT(),e))}function w6(t,e,n){let r=AT(t,n);if(r){let i=xT(r),s=i.path,o=i.queryId,a=vn(s,e),u=new ey(CT(o),a);return RT(t,s,u)}else return[]}function cy(t,e,n,r,i=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||bL(o,e))){let u=f6(o,e,n,r);d6(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let c=u.removed;if(a=u.events,!i){let l=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,f)=>xs(f));if(l&&!d){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let f=C6(h);for(let p=0;p<f.length;++p){let m=f[p],g=m.query,_=AL(t,m);t.listenProvider_.startListening(kd(g),Gd(t,g),_.hashFn,_.onComplete)}}}!d&&c.length>0&&!r&&(l?t.listenProvider_.stopListening(kd(e),null):c.forEach(h=>{let f=t.queryToTagMap.get(Iy(h));t.listenProvider_.stopListening(kd(h),f)}))}b6(t,c)}return a}function TL(t,e,n,r){let i=AT(t,r);if(i!=null){let s=xT(i),o=s.path,a=s.queryId,u=vn(o,e),c=new Wu(CT(a),u,n);return RT(t,o,c)}else return[]}function E6(t,e,n,r){let i=AT(t,r);if(i){let s=xT(i),o=s.path,a=s.queryId,u=vn(o,e),c=wn.fromObject(n),l=new Hd(CT(a),u,c);return RT(t,o,l)}else return[]}function zb(t,e,n,r=!1){let i=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(h,f)=>{let p=vn(h,i);s=s||Ds(f,p),o=o||xs(f)});let a=t.syncPointTree_.get(i);a?(o=o||xs(a),s=s||Ds(a,ke())):(a=new oy,t.syncPointTree_=t.syncPointTree_.set(i,a));let u;s!=null?u=!0:(u=!1,s=ue.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((f,p)=>{let m=Ds(p,ke());m&&(s=s.updateImmediateChild(f,m))}));let c=bL(a,e);if(!c&&!e._queryParams.loadsAllData()){let h=Iy(e);R(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let f=T6();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}let l=vy(t.pendingWriteTree_,i),d=h6(a,e,n,l,s,u);if(!c&&!o&&!r){let h=CL(a,e);d=d.concat(D6(t,e,h))}return d}function Ey(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let u=vn(o,e),c=Ds(a,u);if(c)return c});return gL(i,e,s,n,!0)}function I6(t,e){let n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(c,l)=>{let d=vn(c,n);r=r||Ds(l,d)});let i=t.syncPointTree_.get(n);i?r=r||Ds(i,ke()):(i=new oy,t.syncPointTree_=t.syncPointTree_.set(n,i));let s=r!=null,o=s?new ii(r,!0,!1):null,a=vy(t.pendingWriteTree_,e._path),u=EL(i,e,a,s?o.getNode():ue.EMPTY_NODE,s);return s6(u)}function Ju(t,e){return DL(e,t.syncPointTree_,null,vy(t.pendingWriteTree_,ke()))}function DL(t,e,n,r){if(_e(t.path))return SL(t,e,n,r);{let i=e.get(ke());n==null&&i!=null&&(n=Ds(i,ke()));let s=[],o=ye(t.path),a=t.operationForChild(o),u=e.children.get(o);if(u&&a){let c=n?n.getImmediateChild(o):null,l=mL(r,o);s=s.concat(DL(a,u,c,l))}return i&&(s=s.concat(DT(i,t,r,n))),s}}function SL(t,e,n,r){let i=e.get(ke());n==null&&i!=null&&(n=Ds(i,ke()));let s=[];return e.children.inorderTraversal((o,a)=>{let u=n?n.getImmediateChild(o):null,c=mL(r,o),l=t.operationForChild(o);l&&(s=s.concat(SL(l,a,u,c)))}),i&&(s=s.concat(DT(i,t,r,n))),s}function AL(t,e){let n=e.query,r=Gd(t,n);return{hashFn:()=>(i6(e)||ue.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?w6(t,n._path,r):v6(t,n._path);{let s=F5(i,n);return cy(t,n,null,s)}}}}function Gd(t,e){let n=Iy(e);return t.queryToTagMap.get(n)}function Iy(t){return t._path.toString()+"$"+t._queryIdentifier}function AT(t,e){return t.tagToQueryMap.get(e)}function xT(t){let e=t.indexOf("$");return R(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Fe(t.substr(0,e))}}function RT(t,e,n){let r=t.syncPointTree_.get(e);R(r,"Missing sync point for query tag that we're tracking");let i=vy(t.pendingWriteTree_,e);return DT(r,n,i,null)}function C6(t){return t.fold((e,n,r)=>{if(n&&xs(n))return[wy(n)];{let i=[];return n&&(i=IL(n)),$t(r,(s,o)=>{i=i.concat(o)}),i}})}function kd(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(g6())(t._repo,t._path):t}function b6(t,e){for(let n=0;n<e.length;++n){let r=e[n];if(!r._queryParams.loadsAllData()){let i=Iy(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function T6(){return m6++}function D6(t,e,n){let r=e._path,i=Gd(t,e),s=AL(t,n),o=t.listenProvider_.startListening(kd(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)R(!xs(a.value),"If we're adding a query, it shouldn't be shadowed");else{let u=a.fold((c,l,d)=>{if(!_e(c)&&l&&xs(l))return[wy(l).query];{let h=[];return l&&(h=h.concat(IL(l).map(f=>f.query))),$t(d,(f,p)=>{h=h.concat(p)}),h}});for(let c=0;c<u.length;++c){let l=u[c];t.listenProvider_.stopListening(kd(l),Gd(t,l))}}return o}var Wb=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},Kb=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=ct(this.path_,e);return new t(this.syncTree_,n)}node(){return Ey(this.syncTree_,this.path_)}},S6=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},PF=function(t,e,n){if(!t||typeof t!="object")return t;if(R(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return A6(t[".sv"],e,n);if(typeof t[".sv"]=="object")return x6(t[".sv"],e);R(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},A6=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:R(!1,"Unexpected server value: "+t)}},x6=function(t,e,n){t.hasOwnProperty("increment")||R(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&R(!1,"Unexpected increment value: "+r);let i=e.node();if(R(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},xL=function(t,e,n,r){return PT(e,new Kb(n,t),r)},MT=function(t,e,n){return PT(t,new Wb(e),n)};function PT(t,e,n){let r=t.getPriority().val(),i=PF(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=PF(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new qu(a,pt(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new qu(i))),o.forEachChild(et,(a,u)=>{let c=PT(u,e.getImmediateChild(a),n);c!==u&&(s=s.updateImmediateChild(a,c))}),s}}var zd=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function Cy(t,e){let n=e instanceof Fe?e:new Fe(e),r=t,i=ye(n);for(;i!==null;){let s=Ni(r.node.children,i)||{children:{},childCount:0};r=new zd(i,r,s),n=Ye(n),i=ye(n)}return r}function Wo(t){return t.node.value}function NT(t,e){t.node.value=e,Qb(t)}function RL(t){return t.node.childCount>0}function R6(t){return Wo(t)===void 0&&!RL(t)}function by(t,e){$t(t.node.children,(n,r)=>{e(new zd(n,t,r))})}function ML(t,e,n,r){n&&!r&&e(t),by(t,i=>{ML(i,e,!0,r)}),n&&r&&e(t)}function M6(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function eh(t){return new Fe(t.parent===null?t.name:eh(t.parent)+"/"+t.name)}function Qb(t){t.parent!==null&&P6(t.parent,t.name,t)}function P6(t,e,n){let r=R6(n),i=$n(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,Qb(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,Qb(t))}var N6=/[\[\].#$\/\u0000-\u001F\u007F]/,O6=/[\[\].#$\u0000-\u001F\u007F]/,ob=10*1024*1024,Ty=function(t){return typeof t=="string"&&t.length!==0&&!N6.test(t)},PL=function(t){return typeof t=="string"&&t.length!==0&&!O6.test(t)},k6=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),PL(t)},Wd=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!my(t)||t&&typeof t=="object"&&$n(t,".sv")},si=function(t,e,n,r){r&&e===void 0||th(bn(t,"value"),e,n)},th=function(t,e,n){let r=n instanceof Fe?new vb(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Bo(r));if(typeof e=="function")throw new Error(t+"contains a function "+Bo(r)+" with contents = "+e.toString());if(my(e))throw new Error(t+"contains "+e.toString()+" "+Bo(r));if(typeof e=="string"&&e.length>ob/3&&pc(e)>ob)throw new Error(t+"contains a string greater than "+ob+" utf8 bytes "+Bo(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if($t(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Ty(o)))throw new Error(t+" contains an invalid key ("+o+") "+Bo(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);dW(r,o),th(t,a,r),hW(r)}),i&&s)throw new Error(t+' contains ".value" child '+Bo(r)+" in addition to actual children.")}},F6=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];let s=Ld(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!Ty(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(lW);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&nr(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},NL=function(t,e,n,r){if(r&&e===void 0)return;let i=bn(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];$t(e,(o,a)=>{let u=new Fe(o);if(th(i,a,ct(n,u)),mT(u)===".priority"&&!Wd(a))throw new Error(i+"contains an invalid value for '"+u.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(u)}),F6(i,s)},OT=function(t,e,n){if(!(n&&e===void 0)){if(my(e))throw new Error(bn(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Wd(e))throw new Error(bn(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},nh=function(t,e,n,r){if(!(r&&n===void 0)&&!Ty(n))throw new Error(bn(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},ec=function(t,e,n,r){if(!(r&&n===void 0)&&!PL(n))throw new Error(bn(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},L6=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),ec(t,e,n,r)},Ln=function(t,e){if(ye(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},OL=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Ty(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!k6(n))throw new Error(bn(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var Yb=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Dy(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!yT(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function kL(t,e,n){Dy(t,n),FL(t,r=>yT(r,e))}function Vn(t,e,n){Dy(t,n),FL(t,r=>nr(r,e)||nr(e,r))}function FL(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?(V6(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function V6(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();Ho&&Bt("event: "+n.toString()),Zu(r)}}}var LL="repo_interrupt",j6=25,Zb=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Yb,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Jm(),this.transactionQueueTree_=new zd,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function U6(t,e,n){if(t.stats_=gT(t.repoInfo_),t.forceRestClient_||U5())t.server_=new Rb(t.repoInfo_,(r,i,s,o)=>{NF(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>OF(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ct(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new _T(t.repoInfo_,e,(r,i,s,o)=>{NF(t,r,i,s,o)},r=>{OF(t,r)},r=>{B6(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=$5(t.repoInfo_,()=>new kb(t.stats_,t.server_)),t.infoData_=new Mb,t.infoSyncTree_=new uy({startListening:(r,i,s,o)=>{let a=[],u=t.infoData_.getNode(r._path);return u.isEmpty()||(a=Jd(t.infoSyncTree_,r._path,u),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),kT(t,"connected",!1),t.serverSyncTree_=new uy({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,u)=>{let c=o(a,u);Vn(t.eventQueue_,r._path,c)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function VL(t){let n=t.infoData_.getNode(new Fe(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function rh(t){return S6({timestamp:VL(t)})}function NF(t,e,n,r,i){t.dataUpdateCount++;let s=new Fe(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let u=fc(n,c=>pt(c));o=E6(t.serverSyncTree_,s,u,i)}else{let u=pt(n);o=TL(t.serverSyncTree_,s,u,i)}else if(r){let u=fc(n,c=>pt(c));o=_6(t.serverSyncTree_,s,u)}else{let u=pt(n);o=Jd(t.serverSyncTree_,s,u)}let a=s;o.length>0&&(a=Qu(t,s)),Vn(t.eventQueue_,a,o)}function OF(t,e){kT(t,"connected",e),e===!1&&q6(t)}function B6(t,e){$t(e,(n,r)=>{kT(t,n,r)})}function kT(t,e,n){let r=new Fe("/.info/"+e),i=pt(n);t.infoData_.updateSnapshot(r,i);let s=Jd(t.infoSyncTree_,r,i);Vn(t.eventQueue_,r,s)}function Sy(t){return t.nextWriteId_++}function $6(t,e,n){let r=I6(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{let s=pt(i).withIndex(e._queryParams.getIndex());zb(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Jd(t.serverSyncTree_,e._path,s);else{let a=Gd(t.serverSyncTree_,e);o=TL(t.serverSyncTree_,e._path,s,a)}return Vn(t.eventQueue_,e._path,o),cy(t.serverSyncTree_,e,n,null,!0),s},i=>(tc(t,"get for query "+Ct(e)+" failed: "+i),Promise.reject(new Error(i))))}function FT(t,e,n,r,i){tc(t,"set",{path:e.toString(),value:n,priority:r});let s=rh(t),o=pt(n,r),a=Ey(t.serverSyncTree_,e),u=MT(o,a,s),c=Sy(t),l=ST(t.serverSyncTree_,e,u,c,!0);Dy(t.eventQueue_,l),t.server_.put(e.toString(),o.val(!0),(h,f)=>{let p=h==="ok";p||un("set at "+e+" failed: "+h);let m=bs(t.serverSyncTree_,c,!p);Vn(t.eventQueue_,e,m),Rs(t,i,h,f)});let d=VT(t,e);Qu(t,d),Vn(t.eventQueue_,d,[])}function H6(t,e,n,r){tc(t,"update",{path:e.toString(),value:n});let i=!0,s=rh(t),o={};if($t(n,(a,u)=>{i=!1,o[a]=xL(ct(e,a),pt(u),t.serverSyncTree_,s)}),i)Bt("update() called with empty data.  Don't do anything."),Rs(t,r,"ok",void 0);else{let a=Sy(t),u=y6(t.serverSyncTree_,e,o,a);Dy(t.eventQueue_,u),t.server_.merge(e.toString(),n,(c,l)=>{let d=c==="ok";d||un("update at "+e+" failed: "+c);let h=bs(t.serverSyncTree_,a,!d),f=h.length>0?Qu(t,e):e;Vn(t.eventQueue_,f,h),Rs(t,r,c,l)}),$t(n,c=>{let l=VT(t,ct(e,c));Qu(t,l)}),Vn(t.eventQueue_,e,[])}}function q6(t){tc(t,"onDisconnectEvents");let e=rh(t),n=Jm();Nb(t.onDisconnect_,ke(),(i,s)=>{let o=xL(i,s,t.serverSyncTree_,e);Xu(n,i,o)});let r=[];Nb(n,ke(),(i,s)=>{r=r.concat(Jd(t.serverSyncTree_,i,s));let o=VT(t,i);Qu(t,o)}),t.onDisconnect_=Jm(),Vn(t.eventQueue_,ke(),r)}function G6(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&Pb(t.onDisconnect_,e),Rs(t,n,r,i)})}function kF(t,e,n,r){let i=pt(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Xu(t.onDisconnect_,e,i),Rs(t,r,s,o)})}function z6(t,e,n,r,i){let s=pt(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&Xu(t.onDisconnect_,e,s),Rs(t,i,o,a)})}function W6(t,e,n,r){if(kh(n)){Bt("onDisconnect().update() called with empty data.  Don't do anything."),Rs(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&$t(n,(o,a)=>{let u=pt(a);Xu(t.onDisconnect_,ct(e,o),u)}),Rs(t,r,i,s)})}function K6(t,e,n){let r;ye(e._path)===".info"?r=zb(t.infoSyncTree_,e,n):r=zb(t.serverSyncTree_,e,n),kL(t.eventQueue_,e._path,r)}function Xb(t,e,n){let r;ye(e._path)===".info"?r=cy(t.infoSyncTree_,e,n):r=cy(t.serverSyncTree_,e,n),kL(t.eventQueue_,e._path,r)}function jL(t){t.persistentConnection_&&t.persistentConnection_.interrupt(LL)}function Q6(t){t.persistentConnection_&&t.persistentConnection_.resume(LL)}function tc(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Bt(n,...e)}function Rs(t,e,n,r){e&&Zu(()=>{if(n==="ok")e(null);else{let i=(n||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function Y6(t,e,n,r,i,s){tc(t,"transaction on "+e);let o={path:e,update:n,onComplete:r,status:null,order:VF(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=LT(t,e,void 0);o.currentInputSnapshot=a;let u=o.update(a.val());if(u===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{th("transaction failed: Data returned ",u,o.path),o.status=0;let c=Cy(t.transactionQueueTree_,e),l=Wo(c)||[];l.push(o),NT(c,l);let d;typeof u=="object"&&u!==null&&$n(u,".priority")?(d=Ni(u,".priority"),R(Wd(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(Ey(t.serverSyncTree_,e)||ue.EMPTY_NODE).getPriority().val();let h=rh(t),f=pt(u,d),p=MT(f,a,h);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=Sy(t);let m=ST(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);Vn(t.eventQueue_,e,m),Ay(t,t.transactionQueueTree_)}}function LT(t,e,n){return Ey(t.serverSyncTree_,e,n)||ue.EMPTY_NODE}function Ay(t,e=t.transactionQueueTree_){if(e||xy(t,e),Wo(e)){let n=BL(t,e);R(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&Z6(t,eh(e),n)}else RL(e)&&by(e,n=>{Ay(t,n)})}function Z6(t,e,n){let r=n.map(c=>c.currentWriteId),i=LT(t,e,r),s=i,o=i.hash();for(let c=0;c<n.length;c++){let l=n[c];R(l.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),l.status=1,l.retryCount++;let d=vn(e,l.path);s=s.updateChild(d,l.currentOutputSnapshotRaw)}let a=s.val(!0),u=e;t.server_.put(u.toString(),a,c=>{tc(t,"transaction put response",{path:u.toString(),status:c});let l=[];if(c==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,l=l.concat(bs(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();xy(t,Cy(t.transactionQueueTree_,e)),Ay(t,t.transactionQueueTree_),Vn(t.eventQueue_,e,l);for(let h=0;h<d.length;h++)Zu(d[h])}else{if(c==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{un("transaction at "+u.toString()+" failed: "+c);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=c}Qu(t,e)}},o)}function Qu(t,e){let n=UL(t,e),r=eh(n),i=BL(t,n);return X6(t,i,r),r}function X6(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let u=e[a],c=vn(n,u.path),l=!1,d;if(R(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===4)l=!0,d=u.abortReason,i=i.concat(bs(t.serverSyncTree_,u.currentWriteId,!0));else if(u.status===0)if(u.retryCount>=j6)l=!0,d="maxretry",i=i.concat(bs(t.serverSyncTree_,u.currentWriteId,!0));else{let h=LT(t,u.path,o);u.currentInputSnapshot=h;let f=e[a].update(h.val());if(f!==void 0){th("transaction failed: Data returned ",f,u.path);let p=pt(f);typeof f=="object"&&f!=null&&$n(f,".priority")||(p=p.updatePriority(h.getPriority()));let g=u.currentWriteId,_=rh(t),y=MT(p,h,_);u.currentOutputSnapshotRaw=p,u.currentOutputSnapshotResolved=y,u.currentWriteId=Sy(t),o.splice(o.indexOf(g),1),i=i.concat(ST(t.serverSyncTree_,u.path,y,u.currentWriteId,u.applyLocally)),i=i.concat(bs(t.serverSyncTree_,g,!0))}else l=!0,d="nodata",i=i.concat(bs(t.serverSyncTree_,u.currentWriteId,!0))}Vn(t.eventQueue_,n,i),i=[],l&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}xy(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Zu(r[a]);Ay(t,t.transactionQueueTree_)}function UL(t,e){let n,r=t.transactionQueueTree_;for(n=ye(e);n!==null&&Wo(r)===void 0;)r=Cy(r,n),e=Ye(e),n=ye(e);return r}function BL(t,e){let n=[];return $L(t,e,n),n.sort((r,i)=>r.order-i.order),n}function $L(t,e,n){let r=Wo(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);by(e,i=>{$L(t,i,n)})}function xy(t,e){let n=Wo(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,NT(e,n.length>0?n:void 0)}by(e,r=>{xy(t,r)})}function VT(t,e){let n=eh(UL(t,e)),r=Cy(t.transactionQueueTree_,e);return M6(r,i=>{ab(t,i)}),ab(t,r),ML(r,i=>{ab(t,i)}),n}function ab(t,e){let n=Wo(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(R(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(R(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(bs(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?NT(e,void 0):n.length=s+1,Vn(t.eventQueue_,eh(e),i);for(let o=0;o<r.length;o++)Zu(r[o])}}function J6(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function e8(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):un(`Invalid query segment '${n}' in query '${t}'`)}return e}var Jb=function(t,e){let n=t8(t),r=n.namespace;n.domain==="firebase.com"&&ri(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&ri("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||M5();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Gm(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new Fe(n.pathString)}},t8=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",u=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let l=t.indexOf("/");l===-1&&(l=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(l,d)),l<d&&(i=J6(t.substring(l,d)));let h=e8(t.substring(Math.min(t.length,d)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",u=parseInt(e.substring(c+1),10)):c=e.length;let f=e.slice(0,c);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=r}"ns"in h&&(s=h.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var FF="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",n8=function(){let t=0,e=[];return function(n){let r=n===t;t=n;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=FF.charAt(n%64),n=Math.floor(n/64);R(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=FF.charAt(e[i]);return R(o.length===20,"nextPushId: Length should be 20."),o}}();var ly=class{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Ct(this.snapshot.exportVal())}},dy=class{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Kd=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return R(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var hy=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new Ft;return G6(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Ln("OnDisconnect.remove",this._path);let e=new Ft;return kF(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Ln("OnDisconnect.set",this._path),si("OnDisconnect.set",e,this._path,!1);let n=new Ft;return kF(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){Ln("OnDisconnect.setWithPriority",this._path),si("OnDisconnect.setWithPriority",e,this._path,!1),OT("OnDisconnect.setWithPriority",n,!1);let r=new Ft;return z6(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){Ln("OnDisconnect.update",this._path),NL("OnDisconnect.update",e,this._path,!1);let n=new Ft;return W6(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var En=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return _e(this._path)?null:mT(this._path)}get ref(){return new jn(this._repo,this._path)}get _queryIdentifier(){let e=IF(this._queryParams),n=pT(e);return n==="{}"?"default":n}get _queryObject(){return IF(this._queryParams)}isEqual(e){if(e=J(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=yT(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+cW(this._path)}};function Ry(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Ps(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===ni){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==Ss)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==Mi)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===et){if(e!=null&&!Wd(e)||n!=null&&!Wd(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(R(t.getIndex()instanceof Vd||t.getIndex()===wT,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function My(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var jn=class t extends En{constructor(e,n){super(e,n,new $d,!1)}get parent(){let e=sL(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Yu=class t{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new Fe(e),r=Ms(this.ref,e);return new t(this._node.getChild(n),r,et)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new t(i,Ms(this.ref,r),et)))}hasChild(e){let n=new Fe(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function jT(t,e){return t=J(t),t._checkNotDeleted("ref"),e!==void 0?Ms(t._root,e):t._root}function UT(t,e){t=J(t),t._checkNotDeleted("refFromURL");let n=Jb(e,t._repo.repoInfo_.nodeAdmin);OL("refFromURL",n);let r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&ri("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),jT(t,n.path.toString())}function Ms(t,e){return t=J(t),ye(t._path)===null?L6("child","path",e,!1):ec("child","path",e,!1),new jn(t._repo,ct(t._path,e))}function HL(t,e){t=J(t),Ln("push",t._path),si("push",e,t._path,!0);let n=VL(t._repo),r=n8(n),i=Ms(t,r),s=Ms(t,r),o;return e!=null?o=Py(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function qL(t){return Ln("remove",t._path),Py(t,null)}function Py(t,e){t=J(t),Ln("set",t._path),si("set",e,t._path,!1);let n=new Ft;return FT(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function GL(t,e){t=J(t),Ln("setPriority",t._path),OT("setPriority",e,!1);let n=new Ft;return FT(t._repo,ct(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function zL(t,e,n){if(Ln("setWithPriority",t._path),si("setWithPriority",e,t._path,!1),OT("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let r=new Ft;return FT(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function WL(t,e){NL("update",e,t._path,!1);let n=new Ft;return H6(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function KL(t){t=J(t);let e=new Kd(()=>{}),n=new Qd(e);return $6(t._repo,t,n).then(r=>new Yu(r,new jn(t._repo,t._path),t._queryParams.getIndex()))}var Qd=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let r=n._queryParams.getIndex();return new ly("value",this,new Yu(e.snapshotNode,new jn(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new dy(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},fy=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new dy(this,e,n):null}createEvent(e,n){R(e.childName!=null,"Child events should have a childName.");let r=Ms(new jn(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new ly(e.type,this,new Yu(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function ih(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let u=n,c=(l,d)=>{Xb(t._repo,t,a),u(l,d)};c.userCallback=n.userCallback,c.context=n.context,n=c}let o=new Kd(n,s||void 0),a=e==="value"?new Qd(o):new fy(e,o);return K6(t._repo,t,a),()=>Xb(t._repo,t,a)}function Ny(t,e,n,r){return ih(t,"value",e,n,r)}function BT(t,e,n,r){return ih(t,"child_added",e,n,r)}function $T(t,e,n,r){return ih(t,"child_changed",e,n,r)}function HT(t,e,n,r){return ih(t,"child_moved",e,n,r)}function qT(t,e,n,r){return ih(t,"child_removed",e,n,r)}function GT(t,e,n){let r=null,i=n?new Kd(n):null;e==="value"?r=new Qd(i):e&&(r=new fy(e,i)),Xb(t._repo,t,r)}var Un=class{},py=class extends Un{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){si("endAt",this._value,e._path,!0);let n=xb(e._queryParams,this._value,this._key);if(My(n),Ps(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new En(e._repo,e._path,n,e._orderByCalled)}};function QL(t,e){return nh("endAt","key",e,!0),new py(t,e)}var eT=class extends Un{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){si("endBefore",this._value,e._path,!1);let n=AW(e._queryParams,this._value,this._key);if(My(n),Ps(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new En(e._repo,e._path,n,e._orderByCalled)}};function YL(t,e){return nh("endBefore","key",e,!0),new eT(t,e)}var gy=class extends Un{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){si("startAt",this._value,e._path,!0);let n=Ab(e._queryParams,this._value,this._key);if(My(n),Ps(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new En(e._repo,e._path,n,e._orderByCalled)}};function ZL(t=null,e){return nh("startAt","key",e,!0),new gy(t,e)}var tT=class extends Un{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){si("startAfter",this._value,e._path,!1);let n=SW(e._queryParams,this._value,this._key);if(My(n),Ps(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new En(e._repo,e._path,n,e._orderByCalled)}};function XL(t,e){return nh("startAfter","key",e,!0),new tT(t,e)}var nT=class extends Un{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new En(e._repo,e._path,TW(e._queryParams,this._limit),e._orderByCalled)}};function JL(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new nT(t)}var rT=class extends Un{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new En(e._repo,e._path,DW(e._queryParams,this._limit),e._orderByCalled)}};function eV(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new rT(t)}var iT=class extends Un{constructor(e){super(),this._path=e}_apply(e){Ry(e,"orderByChild");let n=new Fe(this._path);if(_e(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new Vd(n),i=yy(e._queryParams,r);return Ps(i),new En(e._repo,e._path,i,!0)}};function tV(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return ec("orderByChild","path",t,!1),new iT(t)}var sT=class extends Un{_apply(e){Ry(e,"orderByKey");let n=yy(e._queryParams,ni);return Ps(n),new En(e._repo,e._path,n,!0)}};function nV(){return new sT}var oT=class extends Un{_apply(e){Ry(e,"orderByPriority");let n=yy(e._queryParams,et);return Ps(n),new En(e._repo,e._path,n,!0)}};function rV(){return new oT}var aT=class extends Un{_apply(e){Ry(e,"orderByValue");let n=yy(e._queryParams,wT);return Ps(n),new En(e._repo,e._path,n,!0)}};function iV(){return new aT}var uT=class extends Un{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){if(si("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new py(this._value,this._key)._apply(new gy(this._value,this._key)._apply(e))}};function sV(t,e){return nh("equalTo","key",e,!0),new uT(t,e)}function ir(t,...e){let n=J(t);for(let r of e)n=r._apply(n);return n}c6(jn);p6(jn);var r8="FIREBASE_DATABASE_EMULATOR_HOST",cT={},i8=!1;function s8(t,e,n,r){t.repoInfo_=new Gm(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function zT(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||ri("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Bt("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=Jb(s,i),a=o.repoInfo,u,c;typeof process<"u"&&process.env&&(c=process.env[r8]),c?(u=!0,s=`http://${c}?ns=${a.namespace}`,o=Jb(s,i),a=o.repoInfo):u=!o.repoInfo.secure;let l=i&&u?new Pd(Pd.OWNER):new fb(t.name,t.options,e);OL("Invalid Firebase Database URL",o),_e(o.path)||ri("Database URL must point to the root of a Firebase Database (not including a child path).");let d=a8(a,t,l,new hb(t.name,n));return new lT(d,t)}function o8(t,e){let n=cT[e];(!n||n[t.key]!==t)&&ri(`Database ${e}(${t.repoInfo_}) has already been deleted.`),jL(t),delete n[t.key]}function a8(t,e,n,r){let i=cT[e.name];i||(i={},cT[e.name]=i);let s=i[t.toURLString()];return s&&ri("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Zb(t,i8,n,r),i[t.toURLString()]=s,s}var lT=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(U6(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new jn(this._repo,ke())),this._rootInternal}_delete(){return this._rootInternal!==null&&(o8(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&ri("Cannot call "+e+" on a deleted database.")}};function oV(){iL.IS_TRANSPORT_INITIALIZED&&un("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function aV(){oV(),Fd.forceDisallow()}function uV(){oV(),Uu.forceDisallow(),Fd.forceAllow()}function cV(t,e,n,r={}){t=J(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&ri("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&ri('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Pd(Pd.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:ta(r.mockUserToken,t.app.options.projectId);s=new Pd(o)}s8(i,e,n,s)}function lV(t){t=J(t),t._checkNotDeleted("goOffline"),jL(t._repo)}function dV(t){t=J(t),t._checkNotDeleted("goOnline"),Q6(t._repo)}function hV(t,e){UF(t,e)}function u8(t){fT(na),li(new Ht("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return zT(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),Tn(sF,oF,t),Tn(sF,oF,"esm2017")}var c8={".sv":"timestamp"};function fV(){return c8}function pV(t){return{".sv":{increment:t}}}var dT=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function gV(t,e,n){var r;if(t=J(t),Ln("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let i=(r=n?.applyLocally)!==null&&r!==void 0?r:!0,s=new Ft,o=(u,c,l)=>{let d=null;u?s.reject(u):(d=new Yu(l,new jn(t._repo,t._path),et),s.resolve(new dT(c,d)))},a=Ny(t,()=>{});return Y6(t._repo,t._path,e,o,a,i),s.promise}_T.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};_T.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};u8();var l8="@firebase/database-compat",d8="1.0.2";var h8=new Oi("@firebase/database-compat"),mV=function(t){let e="FIREBASE WARNING: "+t;h8.warn(e)};var f8=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(bn(t,e)+"must be a boolean.")},p8=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(bn(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var WT=class{constructor(e){this._delegate=e}cancel(e){Q("OnDisconnect.cancel",0,1,arguments.length),Pt("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){Q("OnDisconnect.remove",0,1,arguments.length),Pt("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){Q("OnDisconnect.set",1,2,arguments.length),Pt("OnDisconnect.set","onComplete",n,!0);let r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){Q("OnDisconnect.setWithPriority",2,3,arguments.length),Pt("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(Q("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,mV("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Pt("OnDisconnect.update","onComplete",n,!0);let r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}};var KT=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return Q("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var Ko=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return Q("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return Q("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return Q("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return Q("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return Q("DataSnapshot.child",0,1,arguments.length),e=String(e),ec("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return Q("DataSnapshot.hasChild",1,1,arguments.length),ec("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return Q("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return Q("DataSnapshot.forEach",1,1,arguments.length),Pt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return Q("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return Q("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return Q("DataSnapshot.ref",0,0,arguments.length),new Pi(this._database,this._delegate.ref)}get ref(){return this.getRef()}},Oy=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;Q("Query.on",2,4,arguments.length),Pt("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",r,i),a=(c,l)=>{n.call(o.context,new Ko(this.database,c),l)};a.userCallback=n,a.context=o.context;let u=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return Ny(this._delegate,a,u),n;case"child_added":return BT(this._delegate,a,u),n;case"child_removed":return qT(this._delegate,a,u),n;case"child_changed":return $T(this._delegate,a,u),n;case"child_moved":return HT(this._delegate,a,u),n;default:throw new Error(bn("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(Q("Query.off",0,3,arguments.length),p8("Query.off",e,!0),Pt("Query.off","callback",n,!0),r_("Query.off","context",r,!0),n){let i=()=>{};i.userCallback=n,i.context=r,GT(this._delegate,e,i)}else GT(this._delegate,e)}get(){return KL(this._delegate).then(e=>new Ko(this.database,e))}once(e,n,r,i){Q("Query.once",1,4,arguments.length),Pt("Query.once","callback",n,!0);let s=t.getCancelAndContextArgs_("Query.once",r,i),o=new Ft,a=(c,l)=>{let d=new Ko(this.database,c);n&&n.call(s.context,d,l),o.resolve(d)};a.userCallback=n,a.context=s.context;let u=c=>{s.cancel&&s.cancel.call(s.context,c),o.reject(c)};switch(e){case"value":Ny(this._delegate,a,u,{onlyOnce:!0});break;case"child_added":BT(this._delegate,a,u,{onlyOnce:!0});break;case"child_removed":qT(this._delegate,a,u,{onlyOnce:!0});break;case"child_changed":$T(this._delegate,a,u,{onlyOnce:!0});break;case"child_moved":HT(this._delegate,a,u,{onlyOnce:!0});break;default:throw new Error(bn("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return Q("Query.limitToFirst",1,1,arguments.length),new t(this.database,ir(this._delegate,JL(e)))}limitToLast(e){return Q("Query.limitToLast",1,1,arguments.length),new t(this.database,ir(this._delegate,eV(e)))}orderByChild(e){return Q("Query.orderByChild",1,1,arguments.length),new t(this.database,ir(this._delegate,tV(e)))}orderByKey(){return Q("Query.orderByKey",0,0,arguments.length),new t(this.database,ir(this._delegate,nV()))}orderByPriority(){return Q("Query.orderByPriority",0,0,arguments.length),new t(this.database,ir(this._delegate,rV()))}orderByValue(){return Q("Query.orderByValue",0,0,arguments.length),new t(this.database,ir(this._delegate,iV()))}startAt(e=null,n){return Q("Query.startAt",0,2,arguments.length),new t(this.database,ir(this._delegate,ZL(e,n)))}startAfter(e=null,n){return Q("Query.startAfter",0,2,arguments.length),new t(this.database,ir(this._delegate,XL(e,n)))}endAt(e=null,n){return Q("Query.endAt",0,2,arguments.length),new t(this.database,ir(this._delegate,QL(e,n)))}endBefore(e=null,n){return Q("Query.endBefore",0,2,arguments.length),new t(this.database,ir(this._delegate,YL(e,n)))}equalTo(e,n){return Q("Query.equalTo",1,2,arguments.length),new t(this.database,ir(this._delegate,sV(e,n)))}toString(){return Q("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return Q("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(Q("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){let i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,Pt(e,"cancel",i.cancel,!0),i.context=r,r_(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(bn(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new Pi(this.database,new jn(this._delegate._repo,this._delegate._path))}},Pi=class t extends Oy{constructor(e,n){super(e,new En(n._repo,n._path,new $d,!1)),this.database=e,this._delegate=n}getKey(){return Q("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return Q("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,Ms(this._delegate,e))}getParent(){Q("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return Q("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){Q("Reference.set",1,2,arguments.length),Pt("Reference.set","onComplete",n,!0);let r=Py(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(Q("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,mV("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Ln("Reference.update",this._delegate._path),Pt("Reference.update","onComplete",n,!0);let r=WL(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){Q("Reference.setWithPriority",2,3,arguments.length),Pt("Reference.setWithPriority","onComplete",r,!0);let i=zL(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){Q("Reference.remove",0,1,arguments.length),Pt("Reference.remove","onComplete",e,!0);let n=qL(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){Q("Reference.transaction",1,3,arguments.length),Pt("Reference.transaction","transactionUpdate",e,!1),Pt("Reference.transaction","onComplete",n,!0),f8("Reference.transaction","applyLocally",r,!0);let i=gV(this._delegate,e,{applyLocally:r}).then(s=>new KT(s.committed,new Ko(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){Q("Reference.setPriority",1,2,arguments.length),Pt("Reference.setPriority","onComplete",n,!0);let r=GL(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){Q("Reference.push",0,2,arguments.length),Pt("Reference.push","onComplete",n,!0);let r=HL(this._delegate,e),i=r.then(o=>new t(this.database,o));n&&i.then(()=>n(null),o=>n(o));let s=new t(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return Ln("Reference.onDisconnect",this._delegate._path),new WT(new hy(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var Qo=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:aV,forceLongPolling:uV}}useEmulator(e,n,r={}){cV(this._delegate,e,n,r)}ref(e){if(Q("database.ref",0,1,arguments.length),e instanceof Pi){let n=UT(this._delegate,e.toString());return new Pi(this,n)}else{let n=jT(this._delegate,e);return new Pi(this,n)}}refFromURL(e){Q("database.refFromURL",1,1,arguments.length);let r=UT(this._delegate,e);return new Pi(this,r)}goOffline(){return Q("database.goOffline",0,0,arguments.length),lV(this._delegate)}goOnline(){return Q("database.goOnline",0,0,arguments.length),dV(this._delegate)}};Qo.ServerValue={TIMESTAMP:fV(),increment:t=>pV(t)};function g8({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){fT(n);let a=new i_("database-standalone"),u=new Fh("auth-internal",a);u.setComponent(new Ht("auth-internal",()=>r,"PRIVATE"));let c;return i&&(c=new Fh("app-check-internal",a),c.setComponent(new Ht("app-check-internal",()=>i,"PRIVATE"))),{instance:new Qo(zT(t,u,c,e,o),t),namespace:s}}var m8=Object.freeze({__proto__:null,initStandalone:g8});var y8=Qo.ServerValue;function _8(t){t.INTERNAL.registerComponent(new Ht("database-compat",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new Qo(i,r)},"PUBLIC").setServiceProps({Reference:Pi,Query:Oy,Database:Qo,DataSnapshot:Ko,enableLogging:hV,INTERNAL:m8,ServerValue:y8}).setMultipleInstances(!0)),t.registerVersion(l8,d8)}_8(dt);function sh(t,e,n="on",r=hi){return new se(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),n==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),n==="on"?{unsubscribe(){s!=null&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(H(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),Hs())}function v8(t){return typeof t=="string"}function w8(t){return typeof t.exportVal=="function"}function EV(t){return t==null}function IV(t){return typeof t.set=="function"}function yV(t,e){return IV(e)?e:t.ref(e)}function CV(t,e){if(v8(t))return e.stringCase();if(IV(t))return e.firebaseCase();if(w8(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function bV(t){return(EV(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function TV(t,e,n){e=bV(e);let r=e.map(i=>sh(t,i,"on",n));return Fi(...r)}function E8(t,e,n){let r=TV(t,e).pipe(Rr((i,s)=>[...i,s],[]));return C8(t,r,n)}function I8(t,e){return sh(t,"value","on",e).pipe(H(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}function C8(t,e,n){return I8(t,n).pipe(x_(e),H(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(u=>u.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),S_(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),H(i=>i.actions))}function _V(t,e){return function(r,i){return CV(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function b8(t){return function(n){return n?CV(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function T8(t,e,n){return sh(t,"value","once",n).pipe(Be(r=>{let i=[q(r)];return e.forEach(s=>i.push(sh(t,s,"on",n))),Fi(...i).pipe(Rr(S8,[]))}),$s())}function DV(t,e){let n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function D8(t,e){if(EV(e))return 0;{let n=DV(t,e);return n===-1?t.length:n+1}}function S8(t,e){let{payload:n,prevKey:r,key:i}=e,s=DV(t,i),o=D8(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(u=>{let c={payload:u,type:"value",prevKey:a,key:u.key};return a=u.key,t=[...t,c],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(u=>u.payload.key!==n.key),t.splice(o,0,e));else{if(r==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=t.splice(s,1)[0];return t=t.slice(),t.splice(o,0,a),t}return t;default:return t}}function vV(t,e,n){return e=bV(e),T8(t,e,n)}function A8(t,e){let n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:_V(r,"update"),set:_V(r,"set"),push:i=>r.push(i),remove:b8(r),snapshotChanges(i){return vV(t,i,n).pipe(ot)},stateChanges(i){return TV(t,i,n).pipe(ot)},auditTrail(i){return E8(t,i,n).pipe(ot)},valueChanges(i,s){return vV(t,i,n).pipe(H(a=>a.map(u=>s&&s.idField?Le(N({},u.payload.val()),{[s.idField]:u.key}):u.payload.val())),ot)}}}function wV(t,e){return function(){return sh(t,"value","on",e)}}function x8(t,e){return{query:t,snapshotChanges(){return wV(t,e.schedulers.outsideAngular)().pipe(ot)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return wV(t,e.schedulers.outsideAngular)().pipe(ot,H(r=>r.payload.exists()?r.payload.val():null))}}}var R8=new j("angularfire2.realtimeDatabaseURL"),M8=new j("angularfire2.database.use-emulator"),oh=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,u,c,l,d,h,f,p,m,g){this.schedulers=a;let _=u,y=wi(n,o,r);c&&cl(y,o,l,h,f,p,d,m),this.database=Ji(`${y.name}.database.${i}`,"AngularFireDatabase",y.name,()=>{let v=o.runOutsideAngular(()=>y.database(i||void 0));return _&&v.useEmulator(..._),v},[_])}list(n,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>yV(this.database,n)),s=i;return r&&(s=r(i)),A8(s,this)}object(n){let r=this.schedulers.ngZone.runOutsideAngular(()=>yV(this.database,n));return x8(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(C(Vr),C(jr,8),C(R8,8),C(Kt),C(ge),C(Xi),C(M8,8),C(oo,8),C(rl,8),C(il,8),C(sl,8),C(ol,8),C(al,8),C(ul,8),C(mr,8))};static \u0275prov=B({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),SV=(()=>{class t{constructor(){dt.registerVersion("angularfire",yr.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Xe({type:t});static \u0275inj=Ze({providers:[oh]})}return t})();var xV={production:!1,firebase:{apiKey:"AIzaSyCJhzzcXoJ6UYk-0iM9n2m3gAA6sENIVa8",authDomain:"supernova-3436a.firebaseapp.com",databaseURL:"https://supernova-3436a-default-rtdb.europe-west1.firebasedatabase.app",projectId:"supernova-3436a",storageBucket:"supernova-3436a.appspot.com",messagingSenderId:"408716948950",appId:"1:408716948950:web:054172bc7001219ebc2077"}};var pe="primary",Eh=Symbol("RouteTitle"),JT=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function oc(t){return new JT(t)}function P8(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function N8(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!oi(t[n],e[n]))return!1;return!0}function oi(t,e){let n=t?eD(t):void 0,r=e?eD(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!VV(t[i],e[i]))return!1;return!0}function eD(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function VV(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function jV(t){return t.length>0?t[t.length-1]:null}function Fs(t){return E_(t)?t:ro(t)?ve(Promise.resolve(t)):q(t)}var O8={exact:BV,subset:$V},UV={exact:k8,subset:F8,ignored:()=>!0};function RV(t,e,n){return O8[n.paths](t.root,e.root,n.matrixParams)&&UV[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function k8(t,e){return oi(t,e)}function BV(t,e,n){if(!Zo(t.segments,e.segments)||!Ly(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!BV(t.children[r],e.children[r],n))return!1;return!0}function F8(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>VV(t[n],e[n]))}function $V(t,e,n){return HV(t,e,e.segments,n)}function HV(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!Zo(i,n)||e.hasChildren()||!Ly(i,n,r))}else if(t.segments.length===n.length){if(!Zo(t.segments,n)||!Ly(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!$V(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!Zo(t.segments,i)||!Ly(t.segments,i,r)||!t.children[pe]?!1:HV(t.children[pe],e,s,r)}}function Ly(t,e,n){return e.every((r,i)=>UV[n](t[i].parameters,r.parameters))}var Ns=class{constructor(e=new Ue([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=oc(this.queryParams)),this._queryParamMap}toString(){return j8.serialize(this)}},Ue=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Vy(this)}},Yo=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=oc(this.parameters)),this._parameterMap}toString(){return GV(this)}};function L8(t,e){return Zo(t,e)&&t.every((n,r)=>oi(n.parameters,e[r].parameters))}function Zo(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function V8(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===pe&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==pe&&(n=n.concat(e(i,r)))}),n}var Ih=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:()=>(()=>new fh)(),providedIn:"root"});let t=e;return t})(),fh=class{parse(e){let n=new nD(e);return new Ns(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${ah(e.root,!0)}`,r=$8(e.queryParams),i=typeof e.fragment=="string"?`#${U8(e.fragment)}`:"";return`${n}${r}${i}`}},j8=new fh;function Vy(t){return t.segments.map(e=>GV(e)).join("/")}function ah(t,e){if(!t.hasChildren())return Vy(t);if(e){let n=t.children[pe]?ah(t.children[pe],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==pe&&r.push(`${i}:${ah(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=V8(t,(r,i)=>i===pe?[ah(t.children[pe],!1)]:[`${i}:${ah(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[pe]!=null?`${Vy(t)}/${n[0]}`:`${Vy(t)}/(${n.join("//")})`}}function qV(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ky(t){return qV(t).replace(/%3B/gi,";")}function U8(t){return encodeURI(t)}function tD(t){return qV(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function jy(t){return decodeURIComponent(t)}function MV(t){return jy(t.replace(/\+/g,"%20"))}function GV(t){return`${tD(t.path)}${B8(t.parameters)}`}function B8(t){return Object.keys(t).map(e=>`;${tD(e)}=${tD(t[e])}`).join("")}function $8(t){let e=Object.keys(t).map(n=>{let r=t[n];return Array.isArray(r)?r.map(i=>`${ky(n)}=${ky(i)}`).join("&"):`${ky(n)}=${ky(r)}`}).filter(n=>!!n);return e.length?`?${e.join("&")}`:""}var H8=/^[^\/()?;#]+/;function QT(t){let e=t.match(H8);return e?e[0]:""}var q8=/^[^\/()?;=#]+/;function G8(t){let e=t.match(q8);return e?e[0]:""}var z8=/^[^=?&#]+/;function W8(t){let e=t.match(z8);return e?e[0]:""}var K8=/^[^&#]+/;function Q8(t){let e=t.match(K8);return e?e[0]:""}var nD=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ue([],{}):new Ue([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[pe]=new Ue(e,n)),r}parseSegment(){let e=QT(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new z(4009,!1);return this.capture(e),new Yo(jy(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=G8(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=QT(this.remaining);i&&(r=i,this.capture(r))}e[jy(n)]=jy(r)}parseQueryParam(e){let n=W8(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=Q8(this.remaining);o&&(r=o,this.capture(r))}let i=MV(n),s=MV(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=QT(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new z(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=pe);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[pe]:new Ue([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new z(4011,!1)}};function zV(t){return t.segments.length>0?new Ue([],{[pe]:t}):t}function WV(t){let e={};for(let r of Object.keys(t.children)){let i=t.children[r],s=WV(i);if(r===pe&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new Ue(t.segments,e);return Y8(n)}function Y8(t){if(t.numberOfChildren===1&&t.children[pe]){let e=t.children[pe];return new Ue(t.segments.concat(e.segments),e.children)}return t}function ac(t){return t instanceof Ns}function Z8(t,e,n=null,r=null){let i=KV(t);return QV(i,e,n,r)}function KV(t){let e;function n(s){let o={};for(let u of s.children){let c=n(u);o[u.outlet]=c}let a=new Ue(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=zV(r);return e??i}function QV(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return YT(i,i,i,n,r);let s=X8(e);if(s.toRoot())return YT(i,i,new Ue([],{}),n,r);let o=J8(s,i,t),a=o.processChildren?lh(o.segmentGroup,o.index,s.commands):ZV(o.segmentGroup,o.index,s.commands);return YT(i,o.segmentGroup,a,n,r)}function Uy(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function ph(t){return typeof t=="object"&&t!=null&&t.outlets}function YT(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([u,c])=>{s[u]=Array.isArray(c)?c.map(l=>`${l}`):`${c}`});let o;t===e?o=n:o=YV(t,e,n);let a=zV(WV(o));return new Ns(a,s,i)}function YV(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=YV(s,e,n)}),new Ue(t.segments,r)}var By=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&Uy(r[0]))throw new z(4003,!1);let i=r.find(ph);if(i&&i!==jV(r))throw new z(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function X8(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new By(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([u,c])=>{a[u]=typeof c=="string"?c.split("/"):c}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,u)=>{u==0&&a==="."||(u==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new By(n,e,r)}var ic=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function J8(t,e,n){if(t.isAbsolute)return new ic(e,!0,0);if(!n)return new ic(e,!1,NaN);if(n.parent===null)return new ic(n,!0,0);let r=Uy(t.commands[0])?0:1,i=n.segments.length-1+r;return e7(n,i,t.numberOfDoubleDots)}function e7(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new z(4005,!1);i=r.segments.length}return new ic(r,!1,i-s)}function t7(t){return ph(t[0])?t[0].outlets:{[pe]:t}}function ZV(t,e,n){if(t||(t=new Ue([],{})),t.segments.length===0&&t.hasChildren())return lh(t,e,n);let r=n7(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new Ue(t.segments.slice(0,r.pathIndex),{});return s.children[pe]=new Ue(t.segments.slice(r.pathIndex),t.children),lh(s,0,i)}else return r.match&&i.length===0?new Ue(t.segments,{}):r.match&&!t.hasChildren()?rD(t,e,n):r.match?lh(t,0,i):rD(t,e,n)}function lh(t,e,n){if(n.length===0)return new Ue(t.segments,{});{let r=t7(n),i={};if(Object.keys(r).some(s=>s!==pe)&&t.children[pe]&&t.numberOfChildren===1&&t.children[pe].segments.length===0){let s=lh(t.children[pe],e,n);return new Ue(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=ZV(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Ue(t.segments,i)}}function n7(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(ph(a))break;let u=`${a}`,c=r<n.length-1?n[r+1]:null;if(i>0&&u===void 0)break;if(u&&c&&typeof c=="object"&&c.outlets===void 0){if(!NV(u,c,o))return s;r+=2}else{if(!NV(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function rD(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(ph(s)){let u=r7(s.outlets);return new Ue(r,u)}if(i===0&&Uy(n[0])){let u=t.segments[e];r.push(new Yo(u.path,PV(n[0]))),i++;continue}let o=ph(s)?s.outlets[pe]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&Uy(a)?(r.push(new Yo(o,PV(a))),i+=2):(r.push(new Yo(o,{})),i++)}return new Ue(r,{})}function r7(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=rD(new Ue([],{}),0,r))}),e}function PV(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function NV(t,e,n){return t==n.path&&oi(e,n.parameters)}var dh="imperative",sr=class{constructor(e,n){this.id=e,this.url=n}},uc=class extends sr{constructor(e,n,r="imperative",i=null){super(e,n),this.type=0,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},ai=class extends sr{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Os=class extends sr{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},ks=class extends sr{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=16}},gh=class extends sr{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},$y=class extends sr{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},iD=class extends sr{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},sD=class extends sr{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},oD=class extends sr{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},aD=class extends sr{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},uD=class{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},cD=class{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},lD=class{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},dD=class{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},hD=class{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},fD=class{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Hy=class{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=15}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},mh=class{},yh=class{constructor(e){this.url=e}};var pD=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Ch,this.attachRef=null}},Ch=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new pD,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),qy=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=gD(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=gD(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=mD(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return mD(e,this._root).map(n=>n.value)}};function gD(t,e){if(t===e.value)return e;for(let n of e.children){let r=gD(t,n);if(r)return r}return null}function mD(t,e){if(t===e.value)return[e];for(let n of e.children){let r=mD(t,n);if(r.length)return r.unshift(e),r}return[]}var Bn=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function rc(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var Gy=class extends qy{constructor(e,n){super(e),this.snapshot=n,DD(this,e)}toString(){return this.snapshot.toString()}};function XV(t,e){let n=i7(t,e),r=new zt([new Yo("",{})]),i=new zt({}),s=new zt({}),o=new zt({}),a=new zt(""),u=new Xo(r,i,o,a,s,pe,e,n.root);return u.snapshot=n.root,new Gy(new Bn(u,[]),n)}function i7(t,e){let n={},r={},i={},s="",o=new _h([],n,i,s,r,pe,e,null,{});return new zy("",new Bn(o,[]))}var Xo=class{constructor(e,n,r,i,s,o,a,u){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(H(c=>c[Eh]))??q(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(H(e=>oc(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(H(e=>oc(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function TD(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:N(N({},e.params),t.params),data:N(N({},e.data),t.data),resolve:N(N(N(N({},t.data),e.data),i?.data),t._resolvedData)}:r={params:t.params,data:t.data,resolve:N(N({},t.data),t._resolvedData??{})},i&&e2(i)&&(r.resolve[Eh]=i.title),r}var _h=class{get title(){return this.data?.[Eh]}constructor(e,n,r,i,s,o,a,u,c){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=u,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=oc(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=oc(this.queryParams)),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},zy=class extends qy{constructor(e,n){super(n),this.url=e,DD(this,n)}toString(){return JV(this._root)}};function DD(t,e){e.value._routerState=t,e.children.forEach(n=>DD(t,n))}function JV(t){let e=t.children.length>0?` { ${t.children.map(JV).join(", ")} } `:"";return`${t.value}${e}`}function ZT(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,oi(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),oi(e.params,n.params)||t.paramsSubject.next(n.params),N8(e.url,n.url)||t.urlSubject.next(n.url),oi(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function yD(t,e){let n=oi(t.params,e.params)&&L8(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||yD(t.parent,e.parent))}function e2(t){return typeof t.title=="string"||t.title===null}var SD=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=pe,this.activateEvents=new it,this.deactivateEvents=new it,this.attachEvents=new it,this.detachEvents=new it,this.parentContexts=$(Ch),this.location=$(Gc),this.changeDetector=$(no),this.environmentInjector=$(Mn),this.inputBinder=$(Zy,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new z(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new z(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new z(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new z(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,u=this.parentContexts.getOrCreateContext(this.name).children,c=new _D(r,u,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:c,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=An({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[gr]});let t=e;return t})(),_D=class{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===Xo?this.route:e===Ch?this.childContexts:this.parent.get(e,n)}},Zy=new j(""),OV=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=yc([i.queryParams,i.params,i.data]).pipe(Be(([o,a,u],c)=>(u=N(N(N({},o),a),u),c===0?q(u):Promise.resolve(u)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=mR(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:u}of a.inputs)r.activatedComponentRef.setInput(u,o[u])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:e.\u0275fac});let t=e;return t})();function s7(t,e,n){let r=vh(t,e._root,n?n._root:void 0);return new Gy(r,e)}function vh(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=o7(t,e,n);return new Bn(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>vh(t,a)),o}}let r=a7(e.value),i=e.children.map(s=>vh(t,s));return new Bn(r,i)}}function o7(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return vh(t,r,i);return vh(t,r)})}function a7(t){return new Xo(new zt(t.url),new zt(t.params),new zt(t.queryParams),new zt(t.fragment),new zt(t.data),t.outlet,t.component,t)}var t2="ngNavigationCancelingError";function n2(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=ac(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=r2(!1,0,e);return i.url=n,i.navigationBehaviorOptions=r,i}function r2(t,e,n){let r=new Error("NavigationCancelingError: "+(t||""));return r[t2]=!0,r.cancellationCode=e,n&&(r.url=n),r}function u7(t){return i2(t)&&ac(t.url)}function i2(t){return t&&t[t2]}var c7=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=st({type:e,selectors:[["ng-component"]],standalone:!0,features:[aR],decls:1,vars:0,template:function(i,s){i&1&&je(0,"router-outlet")},dependencies:[SD],encapsulation:2});let t=e;return t})();function l7(t,e){return t.providers&&!t._injector&&(t._injector=hp(t.providers,e,`Route: ${t.path}`)),t._injector??e}function AD(t){let e=t.children&&t.children.map(AD),n=e?Le(N({},t),{children:e}):N({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==pe&&(n.component=c7),n}function ui(t){return t.outlet||pe}function d7(t,e){let n=t.filter(r=>ui(r)===e);return n.push(...t.filter(r=>ui(r)!==e)),n}function bh(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var h7=(t,e,n,r)=>H(i=>(new vD(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),vD=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),ZT(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=rc(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=rc(e);for(let o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=rc(e);for(let o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=rc(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new fD(s.value.snapshot))}),e.children.length&&this.forwardEvent(new dD(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(ZT(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),ZT(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=bh(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},Wy=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},sc=class{constructor(e,n){this.component=e,this.route=n}};function f7(t,e,n){let r=t._root,i=e?e._root:null;return uh(r,i,n,[r.value])}function p7(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function lc(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!uA(t)?t:e.get(t):r}function uh(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=rc(e);return t.children.forEach(o=>{g7(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>hh(a,n.getContext(o),i)),i}function g7(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let u=m7(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new Wy(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?uh(t,e,a?a.children:null,r,i):uh(t,e,n,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new sc(a.outlet.component,o))}else o&&hh(e,a,i),i.canActivateChecks.push(new Wy(r)),s.component?uh(t,null,a?a.children:null,r,i):uh(t,null,n,r,i);return i}function m7(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!Zo(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Zo(t.url,e.url)||!oi(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!yD(t,e)||!oi(t.queryParams,e.queryParams);case"paramsChange":default:return!yD(t,e)}}function hh(t,e,n){let r=rc(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?hh(o,e.children.getContext(s),n):hh(o,null,n):hh(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new sc(e.outlet.component,i)):n.canDeactivateChecks.push(new sc(null,i)):n.canDeactivateChecks.push(new sc(null,i))}function Th(t){return typeof t=="function"}function y7(t){return typeof t=="boolean"}function _7(t){return t&&Th(t.canLoad)}function v7(t){return t&&Th(t.canActivate)}function w7(t){return t&&Th(t.canActivateChild)}function E7(t){return t&&Th(t.canDeactivate)}function I7(t){return t&&Th(t.canMatch)}function s2(t){return t instanceof fi||t?.name==="EmptyError"}var Fy=Symbol("INITIAL_VALUE");function cc(){return Be(t=>yc(t.map(e=>e.pipe(pi(1),qs(Fy)))).pipe(H(e=>{for(let n of e)if(n!==!0){if(n===Fy)return Fy;if(n===!1||n instanceof Ns)return n}return!0}),Wt(e=>e!==Fy),pi(1)))}function C7(t,e){return Dt(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?q(Le(N({},n),{guardsResult:!0})):b7(o,r,i,t).pipe(Dt(a=>a&&y7(a)?T7(r,s,t,e):q(a)),H(a=>Le(N({},n),{guardsResult:a})))})}function b7(t,e,n,r){return ve(t).pipe(Dt(i=>R7(i.component,i.route,n,e,r)),qn(i=>i!==!0,!0))}function T7(t,e,n,r){return ve(e).pipe(Bs(i=>pa(S7(i.route.parent,r),D7(i.route,r),x7(t,i.path,n),A7(t,i.route,n))),qn(i=>i!==!0,!0))}function D7(t,e){return t!==null&&e&&e(new hD(t)),q(!0)}function S7(t,e){return t!==null&&e&&e(new lD(t)),q(!0)}function A7(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return q(!0);let i=r.map(s=>af(()=>{let o=bh(e)??n,a=lc(s,o),u=v7(a)?a.canActivate(e,t):zi(o,()=>a(e,t));return Fs(u).pipe(qn())}));return q(i).pipe(cc())}function x7(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>p7(o)).filter(o=>o!==null).map(o=>af(()=>{let a=o.guards.map(u=>{let c=bh(o.node)??n,l=lc(u,c),d=w7(l)?l.canActivateChild(r,t):zi(c,()=>l(r,t));return Fs(d).pipe(qn())});return q(a).pipe(cc())}));return q(s).pipe(cc())}function R7(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return q(!0);let o=s.map(a=>{let u=bh(e)??i,c=lc(a,u),l=E7(c)?c.canDeactivate(t,e,n,r):zi(u,()=>c(t,e,n,r));return Fs(l).pipe(qn())});return q(o).pipe(cc())}function M7(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return q(!0);let s=i.map(o=>{let a=lc(o,t),u=_7(a)?a.canLoad(e,n):zi(t,()=>a(e,n));return Fs(u)});return q(s).pipe(cc(),o2(r))}function o2(t){return g_(vt(e=>{if(ac(e))throw n2(t,e)}),H(e=>e===!0))}function P7(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return q(!0);let s=i.map(o=>{let a=lc(o,t),u=I7(a)?a.canMatch(e,n):zi(t,()=>a(e,n));return Fs(u)});return q(s).pipe(cc(),o2(r))}var wh=class{constructor(e){this.segmentGroup=e||null}},Ky=class extends Error{constructor(e){super(),this.urlTree=e}};function nc(t){return fa(new wh(t))}function N7(t){return fa(new z(4e3,!1))}function O7(t){return fa(r2(!1,3))}var wD=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return q(r);if(i.numberOfChildren>1||!i.children[pe])return N7(e.redirectTo);i=i.children[pe]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new Ky(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new Ns(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,u])=>{o[a]=this.createSegmentGroup(e,u,r,i)}),new Ue(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new z(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},ED={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function k7(t,e,n,r,i){let s=xD(t,e,n);return s.matched?(r=l7(e,r),P7(r,e,n,i).pipe(H(o=>o===!0?s:N({},ED)))):q(s)}function xD(t,e,n){if(e.path==="**")return F7(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?N({},ED):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||P8)(n,t,e);if(!i)return N({},ED);let s={};Object.entries(i.posParams??{}).forEach(([a,u])=>{s[a]=u.path});let o=i.consumed.length>0?N(N({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function F7(t){return{matched:!0,parameters:t.length>0?jV(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function kV(t,e,n,r){return n.length>0&&j7(t,n,r)?{segmentGroup:new Ue(e,V7(r,new Ue(n,t.children))),slicedSegments:[]}:n.length===0&&U7(t,n,r)?{segmentGroup:new Ue(t.segments,L7(t,e,n,r,t.children)),slicedSegments:n}:{segmentGroup:new Ue(t.segments,t.children),slicedSegments:n}}function L7(t,e,n,r,i){let s={};for(let o of r)if(Xy(t,n,o)&&!i[ui(o)]){let a=new Ue([],{});s[ui(o)]=a}return N(N({},i),s)}function V7(t,e){let n={};n[pe]=e;for(let r of t)if(r.path===""&&ui(r)!==pe){let i=new Ue([],{});n[ui(r)]=i}return n}function j7(t,e,n){return n.some(r=>Xy(t,e,r)&&ui(r)!==pe)}function U7(t,e,n){return n.some(r=>Xy(t,e,r))}function Xy(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function B7(t,e,n,r){return ui(t)!==r&&(r===pe||!Xy(e,n,t))?!1:xD(e,t,n).matched}function $7(t,e,n){return e.length===0&&!t.children[n]}var ID=class{};function H7(t,e,n,r,i,s,o="emptyOnly"){return new CD(t,e,n,r,i,o,s).recognize()}var q7=31,CD=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new wD(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new z(4002,`'${e.segmentGroup}'`)}recognize(){let e=kV(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(H(n=>{let r=new _h([],Object.freeze({}),Object.freeze(N({},this.urlTree.queryParams)),this.urlTree.fragment,{},pe,this.rootComponentType,null,{}),i=new Bn(r,n),s=new zy("",i),o=Z8(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,pe).pipe(Li(r=>{if(r instanceof Ky)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof wh?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=TD(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(H(s=>s instanceof Bn?[s]:[]))}processChildren(e,n,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return ve(i).pipe(Bs(s=>{let o=r.children[s],a=d7(n,s);return this.processSegmentGroup(e,a,o,s)}),Rr((s,o)=>(s.push(...o),s)),Vi(null),T_(),Dt(s=>{if(s===null)return nc(r);let o=a2(s);return G7(o),q(o)}))}processSegment(e,n,r,i,s,o){return ve(n).pipe(Bs(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(Li(u=>{if(u instanceof wh)return q(null);throw u}))),qn(a=>!!a),Li(a=>{if(s2(a))return $7(r,i,s)?q(new ID):nc(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return B7(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):nc(i):nc(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){let{matched:a,consumedSegments:u,positionalParamSegments:c,remainingSegments:l}=xD(n,i,s);if(!a)return nc(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>q7&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,c);return this.applyRedirects.lineralizeSegments(i,d).pipe(Dt(h=>this.processSegment(e,r,n,h.concat(l),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){let o=k7(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),o.pipe(Be(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Be(({routes:u})=>{let c=r._loadedInjector??e,{consumedSegments:l,remainingSegments:d,parameters:h}=a,f=new _h(l,h,Object.freeze(N({},this.urlTree.queryParams)),this.urlTree.fragment,W7(r),ui(r),r.component??r._loadedComponent??null,r,K7(r)),{segmentGroup:p,slicedSegments:m}=kV(n,l,d,u);if(m.length===0&&p.hasChildren())return this.processChildren(c,u,p).pipe(H(_=>_===null?null:new Bn(f,_)));if(u.length===0&&m.length===0)return q(new Bn(f,[]));let g=ui(r)===s;return this.processSegment(c,u,p,m,g?pe:s,!0).pipe(H(_=>new Bn(f,_ instanceof Bn?[_]:[])))}))):nc(n)))}getChildConfig(e,n,r){return n.children?q({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?q({routes:n._loadedRoutes,injector:n._loadedInjector}):M7(e,n,r,this.urlSerializer).pipe(Dt(i=>i?this.configLoader.loadChildren(e,n).pipe(vt(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):O7(n))):q({routes:[],injector:e})}};function G7(t){t.sort((e,n)=>e.value.outlet===pe?-1:n.value.outlet===pe?1:e.value.outlet.localeCompare(n.value.outlet))}function z7(t){let e=t.value.routeConfig;return e&&e.path===""}function a2(t){let e=[],n=new Set;for(let r of t){if(!z7(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=a2(r.children);e.push(new Bn(r.value,i))}return e.filter(r=>!n.has(r))}function W7(t){return t.data||{}}function K7(t){return t.resolve||{}}function Q7(t,e,n,r,i,s){return Dt(o=>H7(t,e,n,r,o.extractedUrl,i,s).pipe(H(({state:a,tree:u})=>Le(N({},o),{targetSnapshot:a,urlAfterRedirects:u}))))}function Y7(t,e){return Dt(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return q(n);let s=new Set(i.map(u=>u.route)),o=new Set;for(let u of s)if(!o.has(u))for(let c of u2(u))o.add(c);let a=0;return ve(o).pipe(Bs(u=>s.has(u)?Z7(u,r,t,e):(u.data=TD(u,u.parent,t).resolve,q(void 0))),vt(()=>a++),ga(1),Dt(u=>a===o.size?q(n):Dn))})}function u2(t){let e=t.children.map(n=>u2(n)).flat();return[t,...e]}function Z7(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!e2(i)&&(s[Eh]=i.title),X7(s,t,e,r).pipe(H(o=>(t._resolvedData=o,t.data=TD(t,t.parent,n).resolve,null)))}function X7(t,e,n,r){let i=eD(t);if(i.length===0)return q({});let s={};return ve(i).pipe(Dt(o=>J7(t[o],e,n,r).pipe(qn(),vt(a=>{s[o]=a}))),ga(1),b_(s),Li(o=>s2(o)?Dn:fa(o)))}function J7(t,e,n,r){let i=bh(e)??r,s=lc(t,i),o=s.resolve?s.resolve(e,n):zi(i,()=>s(e,n));return Fs(o)}function XT(t){return Be(e=>{let n=t(e);return n?ve(n).pipe(H(()=>e)):q(e)})}var c2=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===pe);return i}getResolvedTitleForRoute(r){return r.data[Eh]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:()=>(()=>$(eK))(),providedIn:"root"});let t=e;return t})(),eK=(()=>{let e=class e extends c2{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(C(kw))},e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Dh=new j("",{providedIn:"root",factory:()=>({})}),Qy=new j("ROUTES"),RD=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=$(pp)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return q(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Fs(r.loadComponent()).pipe(H(l2),vt(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),_c(()=>{this.componentLoaders.delete(r)})),s=new ua(i,()=>new Tt).pipe(aa());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return q({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=tK(i,this.compiler,r,this.onLoadEndListener).pipe(_c(()=>{this.childrenLoaders.delete(i)})),a=new ua(o,()=>new Tt).pipe(aa());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function tK(t,e,n,r){return Fs(t.loadChildren()).pipe(H(l2),Dt(i=>i instanceof Oc||Array.isArray(i)?q(i):ve(e.compileModuleAsync(i))),H(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(Qy,[],{optional:!0,self:!0}).flat()),{routes:o.map(AD),injector:s}}))}function nK(t){return t&&typeof t=="object"&&"default"in t}function l2(t){return nK(t)?t.default:t}var MD=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:()=>(()=>$(rK))(),providedIn:"root"});let t=e;return t})(),rK=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),d2=new j(""),h2=new j("");function iK(t,e,n){let r=t.get(h2),i=t.get(fn);return t.get(ge).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,Promise.resolve();let s,o=new Promise(c=>{s=c}),a=i.startViewTransition(()=>(s(),sK(t))),{onViewTransitionCreated:u}=r;return u&&zi(t,()=>u({transition:a,from:e,to:n})),o})}function sK(t){return new Promise(e=>{cw(e,{injector:t})})}var PD=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Tt,this.transitionAbortSubject=new Tt,this.configLoader=$(RD),this.environmentInjector=$(Mn),this.urlSerializer=$(Ih),this.rootContexts=$(Ch),this.location=$(Fa),this.inputBindingEnabled=$(Zy,{optional:!0})!==null,this.titleStrategy=$(c2),this.options=$(Dh,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=$(MD),this.createViewTransition=$(d2,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>q(void 0),this.rootComponentType=null;let r=s=>this.events.next(new uD(s)),i=s=>this.events.next(new cD(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(Le(N(N({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new zt({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:dh,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Wt(o=>o.id!==0),H(o=>Le(N({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Be(o=>{this.currentTransition=o;let a=!1,u=!1;return q(o).pipe(vt(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?Le(N({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Be(c=>{let l=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=c.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!l&&d!=="reload"){let h="";return this.events.next(new ks(c.id,this.urlSerializer.serialize(c.rawUrl),h,0)),c.resolve(null),Dn}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return q(c).pipe(Be(h=>{let f=this.transitions?.getValue();return this.events.next(new uc(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?Dn:Promise.resolve(h)}),Q7(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),vt(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=Le(N({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new $y(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:h,extractedUrl:f,source:p,restoredState:m,extras:g}=c,_=new uc(h,this.urlSerializer.serialize(f),p,m);this.events.next(_);let y=XV(f,this.rootComponentType).snapshot;return this.currentTransition=o=Le(N({},c),{targetSnapshot:y,urlAfterRedirects:f,extras:Le(N({},g),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,q(o)}else{let h="";return this.events.next(new ks(c.id,this.urlSerializer.serialize(c.extractedUrl),h,1)),c.resolve(null),Dn}}),vt(c=>{let l=new iD(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),H(c=>(this.currentTransition=o=Le(N({},c),{guards:f7(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),o)),C7(this.environmentInjector,c=>this.events.next(c)),vt(c=>{if(o.guardsResult=c.guardsResult,ac(c.guardsResult))throw n2(this.urlSerializer,c.guardsResult);let l=new sD(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(l)}),Wt(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",3),!1)),XT(c=>{if(c.guards.canActivateChecks.length)return q(c).pipe(vt(l=>{let d=new oD(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Be(l=>{let d=!1;return q(l).pipe(Y7(this.paramsInheritanceStrategy,this.environmentInjector),vt({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",2)}}))}),vt(l=>{let d=new aD(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),XT(c=>{let l=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(vt(f=>{d.component=f}),H(()=>{})));for(let f of d.children)h.push(...l(f));return h};return yc(l(c.targetSnapshot.root)).pipe(Vi(),pi(1))}),XT(()=>this.afterPreactivation()),Be(()=>{let{currentSnapshot:c,targetSnapshot:l}=o,d=this.createViewTransition?.(this.environmentInjector,c.root,l.root);return d?ve(d).pipe(H(()=>o)):q(o)}),H(c=>{let l=s7(r.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o=Le(N({},c),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,o}),vt(()=>{this.events.next(new mh)}),h7(this.rootContexts,r.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),pi(1),vt({next:c=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new ai(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{a=!0}}),A_(this.transitionAbortSubject.pipe(vt(c=>{throw c}))),_c(()=>{if(!a&&!u){let c="";this.cancelNavigationTransition(o,c,1)}this.currentNavigation?.id===o.id&&(this.currentNavigation=null)}),Li(c=>{if(u=!0,i2(c))this.events.next(new Os(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),u7(c)?this.events.next(new yh(c.url)):o.resolve(!1);else{this.events.next(new gh(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(c))}catch(l){o.reject(l)}}return Dn}))}))}cancelNavigationTransition(r,i,s){let o=new Os(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function oK(t){return t!==dh}var aK=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:()=>(()=>$(uK))(),providedIn:"root"});let t=e;return t})(),bD=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},uK=(()=>{let e=class e extends bD{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Vc(e)))(s||e)}})(),e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),f2=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:()=>(()=>$(cK))(),providedIn:"root"});let t=e;return t})(),cK=(()=>{let e=class e extends f2{constructor(){super(...arguments),this.location=$(Fa),this.urlSerializer=$(Ih),this.options=$(Dh,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=$(MD),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Ns,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=XV(this.currentUrlTree,null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof uc)this.stateMemento=this.createStateMemento();else if(r instanceof ks)this.rawUrlTree=i.initialUrl;else if(r instanceof $y){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof mh?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof Os&&(r.code===3||r.code===2)?this.restoreHistory(i):r instanceof gh?this.restoreHistory(i,!0):r instanceof ai&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=N(N({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=N(N({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Vc(e)))(s||e)}})(),e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),ch=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(ch||{});function p2(t,e){t.events.pipe(Wt(n=>n instanceof ai||n instanceof Os||n instanceof gh||n instanceof ks),H(n=>n instanceof ai||n instanceof ks?ch.COMPLETE:(n instanceof Os?n.code===0||n.code===1:!1)?ch.REDIRECTING:ch.FAILED),Wt(n=>n!==ch.REDIRECTING),pi(1)).subscribe(()=>{e()})}function lK(t){throw t}var dK={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},hK={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},or=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=$(fp),this.stateManager=$(f2),this.options=$(Dh,{optional:!0})||{},this.pendingTasks=$(fw),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=$(PD),this.urlSerializer=$(Ih),this.location=$(Fa),this.urlHandlingStrategy=$(MD),this._events=new Tt,this.errorHandler=this.options.errorHandler||lK,this.navigated=!1,this.routeReuseStrategy=$(aK),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=$(Qy,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!$(Zy,{optional:!0}),this.eventsSubscription=new bt,this.isNgZoneEnabled=$(ge)instanceof ge&&ge.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Os&&i.code!==0&&i.code!==1)this.navigated=!0;else if(i instanceof ai)this.navigated=!0;else if(i instanceof yh){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),u={skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||oK(s.source)};this.scheduleNavigation(a,dh,null,u,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}pK(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),dh,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription||(this.nonRouterCurrentEntryChangeSubscription=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)}))}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let c=N({},s);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let u=this.parseUrl(r);this.scheduleNavigation(u,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(AD),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:u,preserveFragment:c}=i,l=c?this.currentUrlTree.fragment:a,d=null;switch(u){case"merge":d=N(N({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=s?s.snapshot:this.routerState.snapshot.root;h=KV(f)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),h=this.currentUrlTree.root}return QV(h,r,d,l??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=ac(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,dh,null,i)}navigate(r,i={skipLocationChange:!1}){return fK(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=N({},dK):i===!1?s=N({},hK):s=i,ac(r))return RV(this.currentUrlTree,r,s);let o=this.parseUrl(r);return RV(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.keys(r).reduce((i,s)=>{let o=r[s];return o!=null&&(i[s]=o),i},{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let u,c,l;a?(u=a.resolve,c=a.reject,l=a.promise):l=new Promise((h,f)=>{u=h,c=f});let d=this.pendingTasks.add();return p2(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:u,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(h=>Promise.reject(h))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function fK(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new z(4008,!1)}function pK(t){return!(t instanceof mh)&&!(t instanceof yh)}var ci=(()=>{let e=class e{constructor(r,i,s,o,a,u){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=u,this.href=null,this.commands=null,this.onChanges=new Tt,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let c=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area",this.isAnchorElement?this.subscription=r.events.subscribe(l=>{l instanceof ai&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){if(this.urlTree===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let u={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state};return this.router.navigateByUrl(this.urlTree,u),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=this.urlTree!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;let r=this.href===null?null:Dx(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",r)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(Y(or),Y(Xo),qv("tabindex"),Y(eo),Y(Wi),Y(vi))},e.\u0275dir=An({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&re("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&sp("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",io],skipLocationChange:["skipLocationChange","skipLocationChange",io],replaceUrl:["replaceUrl","replaceUrl",io],routerLink:"routerLink"},standalone:!0,features:[dw,gr]});let t=e;return t})();var Yy=class{};var gK=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(Wt(r=>r instanceof ai),Bs(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=hp(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,u=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(u,o.children??o._loadedRoutes))}return ve(s).pipe(ki())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=q(null);let o=s.pipe(Dt(a=>a===null?q(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return ve([o,a]).pipe(ki())}else return o})}};e.\u0275fac=function(i){return new(i||e)(C(or),C(pp),C(Mn),C(Yy),C(RD))},e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),g2=new j(""),mK=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration=a.scrollPositionRestoration||"disabled",a.anchorScrolling=a.anchorScrolling||"disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof uc?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof ai?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof ks&&r.code===0&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Hy&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Hy(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){Px()},e.\u0275prov=B({token:e,factory:e.\u0275fac});let t=e;return t})();function yK(t){return t.routerState.root}function Sh(t,e){return{\u0275kind:t,\u0275providers:e}}function _K(){let t=$(Yn);return e=>{let n=t.get(ka);if(e!==n.components[0])return;let r=t.get(or),i=t.get(m2);t.get(ND)===1&&r.initialNavigation(),t.get(y2,null,we.Optional)?.setUpPreloading(),t.get(g2,null,we.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var m2=new j("",{factory:()=>new Tt}),ND=new j("",{providedIn:"root",factory:()=>1});function vK(){return Sh(2,[{provide:ND,useValue:0},{provide:yp,multi:!0,deps:[Yn],useFactory:e=>{let n=e.get(ER,Promise.resolve());return()=>n.then(()=>new Promise(r=>{let i=e.get(or),s=e.get(m2);p2(i,()=>{r(!0)}),e.get(PD).afterPreactivation=()=>(r(!0),s.closed?q(void 0):s),i.initialNavigation()}))}}])}function wK(){return Sh(3,[{provide:yp,multi:!0,useFactory:()=>{let e=$(or);return()=>{e.setUpLocationChangeListener()}}},{provide:ND,useValue:2}])}var y2=new j("");function EK(t){return Sh(0,[{provide:y2,useExisting:gK},{provide:Yy,useExisting:t}])}function IK(){return Sh(8,[OV,{provide:Zy,useExisting:OV}])}function CK(t){let e=[{provide:d2,useValue:iK},{provide:h2,useValue:N({skipNextTransition:!!t?.skipInitialTransition},t)}];return Sh(9,e)}var FV=new j("ROUTER_FORROOT_GUARD"),bK=[Fa,{provide:Ih,useClass:fh},or,Ch,{provide:Xo,useFactory:yK,deps:[or]},RD,[]],OD=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[bK,[],{provide:Qy,multi:!0,useValue:r},{provide:FV,useFactory:AK,deps:[[or,new Uc,new ix]]},{provide:Dh,useValue:i||{}},i?.useHash?DK():SK(),TK(),i?.preloadingStrategy?EK(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?xK(i):[],i?.bindToComponentInputs?IK().\u0275providers:[],i?.enableViewTransitions?CK().\u0275providers:[],RK()]}}static forChild(r){return{ngModule:e,providers:[{provide:Qy,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(C(FV,8))},e.\u0275mod=Xe({type:e}),e.\u0275inj=Ze({});let t=e;return t})();function TK(){return{provide:g2,useFactory:()=>{let t=$(SR),e=$(ge),n=$(Dh),r=$(PD),i=$(Ih);return n.scrollOffset&&t.setOffset(n.scrollOffset),new mK(i,r,t,e,n)}}}function DK(){return{provide:vi,useClass:CR}}function SK(){return{provide:vi,useClass:Tw}}function AK(t){return"guarded"}function xK(t){return[t.initialNavigation==="disabled"?wK().\u0275providers:[],t.initialNavigation==="enabledBlocking"?vK().\u0275providers:[]]}var LV=new j("");function RK(){return[{provide:LV,useFactory:_K},{provide:mw,multi:!0,useExisting:LV}]}var Jy=(()=>{let e=class e{constructor(r){this.db=r,this.dbPath="/produit",this.productsRef=r.list(this.dbPath)}getAll(){return this.productsRef}create(r){return this.productsRef.push(r)}update(r,i){return this.productsRef.update(r,i)}delete(r){return this.productsRef.remove(r)}deleteAll(){return this.productsRef.remove()}};e.\u0275fac=function(i){return new(i||e)(C(oh))},e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function MK(t,e){if(t&1){let n=tn();b(0,"div",1)(1,"h4"),O(2,"Product"),T(),b(3,"form")(4,"div",2)(5,"label",3),O(6,"Combinaison"),T(),b(7,"input",4),re("ngModelChange",function(i){xe(n);let s=Me();return Re(s.currentProduct.Combinaison=i)}),T()(),b(8,"div",2)(9,"label",5),O(10,"Cas"),T(),b(11,"input",6),re("ngModelChange",function(i){xe(n);let s=Me();return Re(s.currentProduct.Cas=i)}),T()(),b(12,"div",2)(13,"label",7),O(14,"Marque"),T(),b(15,"input",8),re("ngModelChange",function(i){xe(n);let s=Me();return Re(s.currentProduct.Marque=i)}),T()(),b(16,"div",2)(17,"label",9),O(18,"Duree de vie"),T(),b(19,"input",10),re("ngModelChange",function(i){xe(n);let s=Me();return Re(s.currentProduct.Duree_de_vie=i)}),T()(),b(20,"div",2)(21,"label",11),O(22,"Efficacite lumineuse"),T(),b(23,"input",12),re("ngModelChange",function(i){xe(n);let s=Me();return Re(s.currentProduct.Efficacite_Lumineuse=i)}),T()(),b(24,"div",2)(25,"label",13),O(26,"Flux Lumineux"),T(),b(27,"input",14),re("ngModelChange",function(i){xe(n);let s=Me();return Re(s.currentProduct.Flux_lumineux=i)}),T()(),b(28,"div",2)(29,"label",15),O(30,"Puissance"),T(),b(31,"input",16),re("ngModelChange",function(i){xe(n);let s=Me();return Re(s.currentProduct.Puissance=i)}),T()(),b(32,"div",2)(33,"label",17),O(34,"Temperature de couleur"),T(),b(35,"input",18),re("ngModelChange",function(i){xe(n);let s=Me();return Re(s.currentProduct.Temperature_de_couleur=i)}),T()()()()}if(t&2){let n=Me();oe(7),Ve("ngModel",n.currentProduct.Combinaison),oe(4),Ve("ngModel",n.currentProduct.Cas),oe(4),Ve("ngModel",n.currentProduct.Marque),oe(4),Ve("ngModel",n.currentProduct.Duree_de_vie),oe(4),Ve("ngModel",n.currentProduct.Efficacite_Lumineuse),oe(4),Ve("ngModel",n.currentProduct.Flux_lumineux),oe(4),Ve("ngModel",n.currentProduct.Puissance),oe(4),Ve("ngModel",n.currentProduct.Temperature_de_couleur)}}function PK(t,e){t&1&&(b(0,"div"),je(1,"br"),b(2,"p"),O(3,"Cannot access this Product..."),T()())}var v2=(()=>{let e=class e{constructor(r){this.productService=r,this.refreshList=new it,this.currentProduct={Cas:0,Combinaison:0,Marque:"",Duree_de_vie:"",Efficacite_Lumineuse:"",Flux_lumineux:"",Puissance:0,Temperature_de_couleur:""},this.message=""}ngOnInit(){this.message=""}ngOnChanges(){this.message="",this.currentProduct=N({},this.product)}updatePublished(r){this.currentProduct.Cas&&this.productService.update(this.currentProduct.Cas.toString(),{published:r}).then(()=>{this.message="The status was updated successfully!"}).catch(i=>console.log(i))}updateProduct(){let r={title:this.currentProduct.Marque,description:this.currentProduct.Duree_de_vie};this.currentProduct.Cas&&this.productService.update(this.currentProduct.Cas.toString(),r).then(()=>this.message="The product was updated successfully!").catch(i=>console.log(i))}deleteProduct(){this.currentProduct.Cas&&this.productService.delete(this.currentProduct.Cas.toString()).then(()=>{this.refreshList.emit(),this.message="The product was updated successfully!"}).catch(r=>console.log(r))}};e.\u0275fac=function(i){return new(i||e)(Y(Jy))},e.\u0275cmp=st({type:e,selectors:[["app-product-details"]],inputs:{product:"product"},outputs:{refreshList:"refreshList"},features:[gr],decls:2,vars:1,consts:[["class","edit-form"],[1,"edit-form"],[1,"form-group"],["for","combinaison"],["type","text","id","combinaison","name","combinaison",1,"form-control",3,"ngModel","ngModelChange"],["for","cas"],["type","text","id","cas","name","cas",1,"form-control",3,"ngModel","ngModelChange"],["for","title"],["type","text","id","title","name","title",1,"form-control",3,"ngModel","ngModelChange"],["for","description"],["type","text","id","description","name","description",1,"form-control",3,"ngModel","ngModelChange"],["for","effLumineuse"],["type","text","id","effLumineuse","name","effLumineuse",1,"form-control",3,"ngModel","ngModelChange"],["for","fluxLumi"],["type","text","id","fluxLumi","name","fluxLumi",1,"form-control",3,"ngModel","ngModelChange"],["for","puiss"],["type","text","id","puiss","name","puiss",1,"form-control",3,"ngModel","ngModelChange"],["for","TempCoul"],["type","text","id","TempCoul","name","TempCoul",1,"form-control",3,"ngModel","ngModelChange"]],template:function(i,s){i&1&&hn(0,MK,36,8,"div",0)(1,PK,4,0),i&2&&Yi(0,s.currentProduct?0:1)},dependencies:[Pp,ja,xp,Rp,tl,el],styles:[".edit-form[_ngcontent-%COMP%]{max-width:300px;margin:auto}"]});let t=e;return t})();var OK=(t,e)=>e.Cas;function kK(t,e){if(t&1){let n=tn();b(0,"li",4),re("click",function(){let i=xe(n),s=i.$implicit,o=i.$index,a=Me();return Re(a.setActiveProduct(s,o))}),O(1),T()}if(t&2){let n=e.$implicit,r=e.$index,i=Me();Qi("active",r==i.currentIndex),oe(1),Oa(" ",n.Marque," ")}}function FK(t,e){if(t&1){let n=tn();b(0,"div")(1,"app-product-details",5),re("refreshList",function(){xe(n);let i=Me();return Re(i.refreshList())}),T()()}if(t&2){let n=Me();oe(1),Ve("product",n.currentProduct)}}function LK(t,e){t&1&&(b(0,"div"),je(1,"br"),b(2,"p"),O(3,"Please click on a Product..."),T()())}var w2=(()=>{let e=class e{constructor(r){this.productService=r,this.currentIndex=-1}ngOnInit(){this.retrieveProducts()}refreshList(){this.currentProduct=void 0,this.currentIndex=-1,this.retrieveProducts()}retrieveProducts(){this.productService.getAll().snapshotChanges().pipe(H(r=>r.map(i=>N({key:i.payload.key},i.payload.val())))).subscribe(r=>{this.products=r})}setActiveProduct(r,i){this.currentProduct=r,this.currentIndex=i}removeAllProducts(){this.productService.deleteAll().then(()=>this.refreshList()).catch(r=>console.log(r))}};e.\u0275fac=function(i){return new(i||e)(Y(Jy))},e.\u0275cmp=st({type:e,selectors:[["app-product-list"]],decls:12,vars:1,consts:[[1,"list","row"],[1,"col-md-6"],[1,"list-group"],[1,"m-3","btn","btn-sm","btn-danger",3,"click"],[1,"list-group-item",3,"click"],[3,"product","refreshList"],["class","list-group-item",3,"active"]],template:function(i,s){i&1&&(b(0,"div",0)(1,"div",1)(2,"h4"),O(3,"Products List"),T(),b(4,"ul",2),up(5,kK,2,3,"li",6,OK),T(),b(7,"button",3),re("click",function(){return s.removeAllProducts()}),O(8," Remove All "),T()(),b(9,"div",1),hn(10,FK,2,1,"div")(11,LK,4,0),T()()),i&2&&(oe(5),cp(s.products),oe(5),Yi(10,s.currentProduct?10:11))},dependencies:[v2],styles:[".list[_ngcontent-%COMP%]{text-align:left;max-width:750px;margin:auto}"]});let t=e;return t})();var e_=(()=>{let e=class e{constructor(r){this.db=r,this.dbPath="/RepQuest",this.responsesRef=r.list(this.dbPath)}getAll(){return this.responsesRef}create(r){return this.responsesRef.push(r)}update(r,i){return this.responsesRef.update(r,i)}delete(r){return this.responsesRef.remove(r)}deleteAll(){return this.responsesRef.remove()}};e.\u0275fac=function(i){return new(i||e)(C(oh))},e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function VK(t,e){if(t&1){let n=tn();b(0,"div",1)(1,"h4"),O(2,"Response"),T(),b(3,"form")(4,"div",2)(5,"label",3),O(6,"Cas"),T(),b(7,"input",4),re("ngModelChange",function(i){xe(n);let s=Me();return Re(s.currentResponse.Cas=i)}),T()(),b(8,"div",2)(9,"label",5),O(10,"Espace a traiter"),T(),b(11,"input",6),re("ngModelChange",function(i){xe(n);let s=Me();return Re(s.currentResponse.Espace_a_traiter=i)}),T()(),b(12,"div",2)(13,"label",7),O(14,"Finition"),T(),b(15,"input",8),re("ngModelChange",function(i){xe(n);let s=Me();return Re(s.currentResponse.Finition=i)}),T()(),b(16,"div",2)(17,"label",9),O(18,"Forme"),T(),b(19,"input",10),re("ngModelChange",function(i){xe(n);let s=Me();return Re(s.currentResponse.Forme=i)}),T()(),b(20,"div",2)(21,"label",11),O(22,"Materiaux de surface de pose"),T(),b(23,"input",12),re("ngModelChange",function(i){xe(n);let s=Me();return Re(s.currentResponse.Materiaux_de_surface_de_pose=i)}),T()(),b(24,"div",2)(25,"label",13),O(26,"Mode de pose"),T(),b(27,"input",14),re("ngModelChange",function(i){xe(n);let s=Me();return Re(s.currentResponse.Mode_de_pose=i)}),T()(),b(28,"div",2)(29,"label",15),O(30,"Segment"),T(),b(31,"input",16),re("ngModelChange",function(i){xe(n);let s=Me();return Re(s.currentResponse.Segment=i)}),T()(),b(32,"div",2)(33,"label",17),O(34,"Standing"),T(),b(35,"input",18),re("ngModelChange",function(i){xe(n);let s=Me();return Re(s.currentResponse.Standing=i)}),T()(),b(36,"div",2)(37,"label",19),O(38,"Style"),T(),b(39,"input",20),re("ngModelChange",function(i){xe(n);let s=Me();return Re(s.currentResponse.Style=i)}),T()(),b(40,"div",2)(41,"label",21),O(42,"Surface de pose"),T(),b(43,"input",22),re("ngModelChange",function(i){xe(n);let s=Me();return Re(s.currentResponse.Surface_de_pose=i)}),T()(),b(44,"div",2)(45,"label",23),O(46,"Type"),T(),b(47,"input",24),re("ngModelChange",function(i){xe(n);let s=Me();return Re(s.currentResponse.Type_de_projet=i)}),T()()()()}if(t&2){let n=Me();oe(7),Ve("ngModel",n.currentResponse.Cas),oe(4),Ve("ngModel",n.currentResponse.Espace_a_traiter),oe(4),Ve("ngModel",n.currentResponse.Finition),oe(4),Ve("ngModel",n.currentResponse.Forme),oe(4),Ve("ngModel",n.currentResponse.Materiaux_de_surface_de_pose),oe(4),Ve("ngModel",n.currentResponse.Mode_de_pose),oe(4),Ve("ngModel",n.currentResponse.Segment),oe(4),Ve("ngModel",n.currentResponse.Standing),oe(4),Ve("ngModel",n.currentResponse.Style),oe(4),Ve("ngModel",n.currentResponse.Surface_de_pose),oe(4),Ve("ngModel",n.currentResponse.Type_de_projet)}}function jK(t,e){t&1&&(b(0,"div"),je(1,"br"),b(2,"p"),O(3,"Cannot access this Response..."),T()())}var I2=(()=>{let e=class e{constructor(r){this.responseService=r,this.refreshList=new it,this.currentResponse={Espace_a_traiter:"",Finition:"",Forme:"",Materiaux_de_surface_de_pose:"",Mode_de_pose:"",Segment:"",Standing:"",Style:"",Surface_de_pose:"",Type_de_projet:""},this.message=""}ngOnInit(){this.message=""}ngOnChanges(){this.message="",this.currentResponse=N({},this.response)}updatePublished(r){this.currentResponse.Cas&&this.responseService.update(this.currentResponse.Cas.toString(),{published:r}).then(()=>{this.message="The status was updated successfully!"}).catch(i=>console.log(i))}updateResponse(){let r={title:this.currentResponse.Espace_a_traiter,description:this.currentResponse.Forme};this.currentResponse.Cas&&this.responseService.update(this.currentResponse.Cas.toString(),r).then(()=>this.message="The response was updated successfully!").catch(i=>console.log(i))}deleteResponse(){this.currentResponse.Cas&&this.responseService.delete(this.currentResponse.Cas.toString()).then(()=>{this.refreshList.emit(),this.message="The response was updated successfully!"}).catch(r=>console.log(r))}};e.\u0275fac=function(i){return new(i||e)(Y(e_))},e.\u0275cmp=st({type:e,selectors:[["app-response-details"]],inputs:{response:"response"},outputs:{refreshList:"refreshList"},features:[gr],decls:2,vars:1,consts:[["class","edit-form"],[1,"edit-form"],[1,"form-group"],["for","cas"],["type","text","id","cas","name","cas",1,"form-control",3,"ngModel","ngModelChange"],["for","espace"],["type","text","id","esppace","name","espace",1,"form-control",3,"ngModel","ngModelChange"],["for","finition"],["type","text","id","finition","name","finition",1,"form-control",3,"ngModel","ngModelChange"],["for","forme"],["type","text","id","forme","name","forme",1,"form-control",3,"ngModel","ngModelChange"],["for","mater"],["type","text","id","mater","name","mater",1,"form-control",3,"ngModel","ngModelChange"],["for","mode"],["type","text","id","mode","name","mode",1,"form-control",3,"ngModel","ngModelChange"],["for","Segment"],["type","text","id","Segment","name","Segment",1,"form-control",3,"ngModel","ngModelChange"],["for","Standing"],["type","text","id","Standing","name","Standing",1,"form-control",3,"ngModel","ngModelChange"],["for","Style"],["type","text","id","Style","name","Style",1,"form-control",3,"ngModel","ngModelChange"],["for","Surface"],["type","text","id","Surface","name","Surface",1,"form-control",3,"ngModel","ngModelChange"],["for","Type"],["type","text","id","Type","name","Type",1,"form-control",3,"ngModel","ngModelChange"]],template:function(i,s){i&1&&hn(0,VK,48,11,"div",0)(1,jK,4,0),i&2&&Yi(0,s.currentResponse?0:1)},dependencies:[Pp,ja,xp,Rp,tl,el],styles:[".edit-form[_ngcontent-%COMP%]{max-width:300px;margin:auto}"]});let t=e;return t})();var BK=(t,e)=>e.Cas;function $K(t,e){if(t&1){let n=tn();b(0,"li",4),re("click",function(){let i=xe(n),s=i.$implicit,o=i.$index,a=Me();return Re(a.setActiveResponse(s,o))}),O(1),T()}if(t&2){let n=e.$implicit,r=e.$index,i=Me();Qi("active",r==i.currentIndex),oe(1),Oa(" ",n.Espace_a_traiter," ")}}function HK(t,e){if(t&1){let n=tn();b(0,"div")(1,"app-response-details",5),re("refreshList",function(){xe(n);let i=Me();return Re(i.refreshList())}),T()()}if(t&2){let n=Me();oe(1),Ve("response",n.currentResponse)}}function qK(t,e){t&1&&(b(0,"div"),je(1,"br"),b(2,"p"),O(3,"Please click on a Response..."),T()())}var C2=(()=>{let e=class e{constructor(r){this.responseService=r,this.currentIndex=-1}ngOnInit(){this.retrieveResponses()}refreshList(){this.currentResponse=void 0,this.currentIndex=-1,this.retrieveResponses()}retrieveResponses(){this.responseService.getAll().snapshotChanges().pipe(H(r=>r.map(i=>N({key:i.payload.key},i.payload.val())))).subscribe(r=>{this.responses=r})}setActiveResponse(r,i){this.currentResponse=r,this.currentIndex=i}removeAllResponses(){this.responseService.deleteAll().then(()=>this.refreshList()).catch(r=>console.log(r))}};e.\u0275fac=function(i){return new(i||e)(Y(e_))},e.\u0275cmp=st({type:e,selectors:[["app-response-list"]],decls:12,vars:1,consts:[[1,"list","row"],[1,"col-md-6"],[1,"list-group"],[1,"m-3","btn","btn-sm","btn-danger",3,"click"],[1,"list-group-item",3,"click"],[3,"response","refreshList"],["class","list-group-item",3,"active"]],template:function(i,s){i&1&&(b(0,"div",0)(1,"div",1)(2,"h4"),O(3,"Responses List"),T(),b(4,"ul",2),up(5,$K,2,3,"li",6,BK),T(),b(7,"button",3),re("click",function(){return s.removeAllResponses()}),O(8," Remove All "),T()(),b(9,"div",1),hn(10,HK,2,1,"div")(11,qK,4,0),T()()),i&2&&(oe(5),cp(s.responses),oe(5),Yi(10,s.currentResponse?10:11))},dependencies:[I2],styles:[".list[_ngcontent-%COMP%]{text-align:left;max-width:750px;margin:auto}"]});let t=e;return t})();var ar=(()=>{let e=class e{constructor(r,i,s,o){this.afs=r,this.afAuth=i,this.router=s,this.ngZone=o,this.afAuth.authState.subscribe(a=>{a?(this.userData=a,localStorage.setItem("user",JSON.stringify(this.userData)),JSON.parse(localStorage.getItem("user"))):(localStorage.setItem("user","null"),JSON.parse(localStorage.getItem("user")))})}SignIn(r,i){return this.afAuth.signInWithEmailAndPassword(r,i).then(s=>{this.SetUserData(s.user),this.afAuth.authState.subscribe(o=>{o&&this.router.navigate(["dashboard"])})}).catch(s=>{window.alert(s.message)})}SignUp(r,i){return this.afAuth.createUserWithEmailAndPassword(r,i).then(s=>{this.SendVerificationMail(),this.SetUserData(s.user)}).catch(s=>{window.alert(s.message)})}SendVerificationMail(){return this.afAuth.currentUser.then(r=>r.sendEmailVerification()).then(()=>{this.router.navigate(["verify-email-address"])})}ForgotPassword(r){return this.afAuth.sendPasswordResetEmail(r).then(()=>{window.alert("Password reset email sent, check your inbox.")}).catch(i=>{window.alert(i)})}get isLoggedIn(){let r=JSON.parse(localStorage.getItem("user"));return r!==null&&r.emailVerified!==!1}GoogleAuth(){return this.AuthLogin(new s_).then(r=>{this.router.navigate(["dashboard"])})}AuthLogin(r){return this.afAuth.signInWithPopup(r).then(i=>{this.router.navigate(["dashboard"]),this.SetUserData(i.user)}).catch(i=>{window.alert(i)})}SetUserData(r){let i=this.afs.doc(`users/${r.uid}`),s={uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,emailVerified:r.emailVerified};return i.set(s,{merge:!0})}SignOut(){return this.afAuth.signOut().then(()=>{localStorage.removeItem("user"),this.router.navigate(["sign-in"])})}};e.\u0275fac=function(i){return new(i||e)(C(eb),C(oo),C(or),C(ge))},e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var b2=(()=>{let e=class e{constructor(r){this.authService=r}ngOnInit(){}};e.\u0275fac=function(i){return new(i||e)(Y(ar))},e.\u0275cmp=st({type:e,selectors:[["app-sign-in"]],decls:25,vars:0,consts:[[1,"displayTable"],[1,"displayTableCell"],[1,"authBlock"],[1,"formGroup"],["type","text","placeholder","Username","required","",1,"formControl"],["userName",""],["type","password","placeholder","Password","required","",1,"formControl"],["userPassword",""],["type","button","value","Log in",1,"btn","btnPrimary",3,"click"],[1,"or"],[1,"orInner"],[1,"forgotPassword"],["routerLink","/forgot-password"],[1,"redirectToLogin"],["routerLink","/register-user",1,"redirect"]],template:function(i,s){if(i&1){let o=tn();b(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),O(4,"Sign In"),T(),b(5,"div",3),je(6,"input",4,5),T(),b(8,"div",3),je(9,"input",6,7),T(),b(11,"div",3)(12,"input",8),re("click",function(){xe(o);let u=Zi(7),c=Zi(10);return Re(s.authService.SignIn(u.value,c.value))}),T()(),b(13,"div",3)(14,"span",9)(15,"span",10),O(16,"Or"),T()()(),b(17,"div",11)(18,"span",12),O(19,"Forgot Password?"),T()()(),b(20,"div",13)(21,"span"),O(22,"Don't have an account?"),b(23,"span",14),O(24," Sign Up"),T()()()()()}},dependencies:[ci],styles:[".displayTable[_ngcontent-%COMP%]{display:table;width:100%;height:100vh}.displayTableCell[_ngcontent-%COMP%]{display:table-cell;vertical-align:middle;text-align:center}.authBlock[_ngcontent-%COMP%]{max-width:400px;margin:0 auto;padding:20px;background-color:#f2f2f2;border-radius:5px}.authBlock[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0}.formGroup[_ngcontent-%COMP%]{margin-bottom:10px}.formControl[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ccc;border-radius:5px}.btn[_ngcontent-%COMP%]{display:inline-block;padding:10px 20px;background-color:#007bff;color:#fff;border:none;border-radius:5px;cursor:pointer}.btnPrimary[_ngcontent-%COMP%]{background-color:#007bff}.or[_ngcontent-%COMP%]{display:block;margin-bottom:10px}.orInner[_ngcontent-%COMP%]{display:inline-block;padding:0 10px;background-color:#f2f2f2;color:#999}.forgotPassword[_ngcontent-%COMP%]{margin-bottom:10px}.redirectToLogin[_ngcontent-%COMP%]{margin-top:10px}.redirect[_ngcontent-%COMP%]{color:#007bff;cursor:pointer}"]});let t=e;return t})();var T2=(()=>{let e=class e{constructor(r){this.authService=r}ngOnInit(){}};e.\u0275fac=function(i){return new(i||e)(Y(ar))},e.\u0275cmp=st({type:e,selectors:[["app-sign-up"]],decls:22,vars:0,consts:[[1,"displayTable"],[1,"displayTableCell"],[1,"authBlock"],[1,"formGroup"],["type","email","placeholder","Email Address","required","",1,"formControl"],["userEmail",""],["type","password","placeholder","Password","required","",1,"formControl"],["userPwd",""],["type","button","value","Sign Up",1,"btn","btnPrimary",3,"click"],[1,"or"],[1,"orInner"],[1,"redirectToLogin"],["routerLink","/sign-in",1,"redirect"]],template:function(i,s){if(i&1){let o=tn();b(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),O(4,"Sign Up"),T(),b(5,"div",3),je(6,"input",4,5),T(),b(8,"div",3),je(9,"input",6,7),T(),b(11,"div",3)(12,"input",8),re("click",function(){xe(o);let u=Zi(7),c=Zi(10);return Re(s.authService.SignUp(u.value,c.value))}),T()(),b(13,"div",3)(14,"span",9)(15,"span",10),O(16,"Or"),T()()(),b(17,"div",11)(18,"span"),O(19,"Already have an account? "),b(20,"span",12),O(21,"Log In"),T()()()()()()}},dependencies:[ci],styles:[".displayTable[_ngcontent-%COMP%]{display:table;width:100%;height:100vh}.displayTableCell[_ngcontent-%COMP%]{display:table-cell;vertical-align:middle;text-align:center}.authBlock[_ngcontent-%COMP%]{width:300px;margin:0 auto;padding:20px;background-color:#f2f2f2;border-radius:5px;box-shadow:0 2px 4px #0000001a}.authBlock[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0}.formGroup[_ngcontent-%COMP%]{margin-bottom:10px}.formControl[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ccc;border-radius:3px}.btn[_ngcontent-%COMP%]{display:inline-block;padding:10px 20px;background-color:#007bff;color:#fff;border:none;border-radius:3px;cursor:pointer}.btnPrimary[_ngcontent-%COMP%]{background-color:#007bff}.or[_ngcontent-%COMP%]{display:block;margin-bottom:10px}.orInner[_ngcontent-%COMP%]{display:inline-block;padding:0 10px;background-color:#f2f2f2;color:#999}.redirectToLogin[_ngcontent-%COMP%]{margin-top:20px}.redirect[_ngcontent-%COMP%]{color:#007bff;cursor:pointer}"]});let t=e;return t})();function zK(t,e){if(t&1&&(b(0,"div",4)(1,"div",18)(2,"div",19),je(3,"img",20),b(4,"div",21)(5,"h1"),O(6,"Hello: "),b(7,"strong"),O(8),T()(),b(9,"p"),O(10,"User ID: "),b(11,"strong"),O(12),T()(),b(13,"p"),O(14,"Email: "),b(15,"strong"),O(16),T()(),b(17,"p"),O(18,"Email Verified: "),b(19,"strong"),O(20),T()()()()()()),t&2){let n=e.ngIf;oe(3),lp("src",n.photoURL?n.photoURL:"/assets/dummy-user.png",nw),lp("alt",n.displayName),oe(5),Fr(n.displayName?n.displayName:"User"),oe(4),Fr(n.uid),oe(4),Fr(n.email),oe(4),Fr(n.emailVerified)}}var D2=(()=>{let e=class e{constructor(r){this.authService=r}ngOnInit(){}};e.\u0275fac=function(i){return new(i||e)(Y(ar))},e.\u0275cmp=st({type:e,selectors:[["app-dashboard"]],decls:22,vars:1,consts:[[1,"navbar","navbar-dark","fixed-top","bg-dark","flex-md-nowrap","p-0","shadow"],[1,"navbar-brand","col-sm-3","col-md-2","mr-0"],["src","assets/logo-positronx-white.svg","alt","positronX.io Logo",1,"brand-logo"],[1,"container-fluid"],[1,"row"],[1,"col-md-2","d-md-block","bg-light","sidebar"],[1,"sidebar-sticky"],[1,"nav","flex-column"],[1,"nav-item"],[1,"nav-link","active"],[1,"fas","fa-user"],[1,"nav-link",3,"click"],[1,"fas","fa-sign-out-alt"],["role","main",1,"col-md-9","ml-sm-auto","col-lg-10","px-4"],[1,"inner-adjust"],[1,"pt-3","pb-2","mb-3","border-bottom"],[1,"h2"],["class","row",4,"ngIf"],[1,"col-md-12"],[1,"media"],[1,"align-self-start","mr-5","img-thumbnail","rounded-circle",3,"src","alt"],[1,"media-body"]],template:function(i,s){i&1&&(b(0,"nav",0)(1,"a",1),je(2,"img",2),T()(),b(3,"div",3)(4,"div",4)(5,"nav",5)(6,"div",6)(7,"ul",7)(8,"li",8)(9,"a",9),je(10,"i",10),O(11,"User Profile "),T()(),b(12,"li",8)(13,"a",11),re("click",function(){return s.authService.SignOut()}),je(14,"i",12),O(15,"Log out "),T()()()()(),b(16,"main",13)(17,"div",14)(18,"div",15)(19,"h1",16),O(20,"User Profile"),T()(),hn(21,zK,21,6,"div",17),T()()()()),i&2&&(oe(21),Ve("ngIf",s.authService.userData))},dependencies:[wp],styles:[".navbar[_ngcontent-%COMP%]{height:60px;display:flex;align-items:center;justify-content:space-between;background-color:#343a40;padding:0 20px;position:fixed;top:0;left:0;right:0;z-index:999}.navbar-brand[_ngcontent-%COMP%]{display:flex;align-items:center;color:#fff;text-decoration:none}.brand-logo[_ngcontent-%COMP%]{width:40px;height:40px;margin-right:10px}.sidebar[_ngcontent-%COMP%]{height:100vh;position:fixed;top:60px;left:0;width:200px;background-color:#f8f9fa;padding:20px}.sidebar-sticky[_ngcontent-%COMP%]{position:sticky;top:0}.nav-link[_ngcontent-%COMP%]{display:flex;align-items:center;color:#000;text-decoration:none;margin-bottom:10px}.nav-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:10px}main[_ngcontent-%COMP%]{margin-top:60px;margin-left:200px;padding:20px}.inner-adjust[_ngcontent-%COMP%]{padding:20px}.border-bottom[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6;margin-bottom:20px}.h2[_ngcontent-%COMP%]{font-size:24px;font-weight:700;margin-bottom:10px}.media[_ngcontent-%COMP%]{display:flex;align-items:flex-start}.img-thumbnail[_ngcontent-%COMP%]{width:100px;height:100px;margin-right:20px;border-radius:50%}.media-body[_ngcontent-%COMP%]{flex:1}h1[_ngcontent-%COMP%]{font-size:20px;margin-bottom:10px}strong[_ngcontent-%COMP%]{font-weight:700}p[_ngcontent-%COMP%]{margin-bottom:5px}"]});let t=e;return t})();var S2=(()=>{let e=class e{constructor(r){this.authService=r}ngOnInit(){}};e.\u0275fac=function(i){return new(i||e)(Y(ar))},e.\u0275cmp=st({type:e,selectors:[["app-forgot-password"]],decls:17,vars:0,consts:[[1,"displayTable"],[1,"displayTableCell"],[1,"authBlock"],[1,"text-center"],[1,"formGroup"],["type","email","placeholder","Email Address","required","",1,"formControl"],["passwordResetEmail",""],["type","submit","value","Reset Password",1,"btn","btnPrimary",3,"click"],[1,"redirectToLogin"],["routerLink","/sign-in",1,"redirect"]],template:function(i,s){if(i&1){let o=tn();b(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),O(4,"Reset Password"),T(),b(5,"p",3),O(6,"Please enter your email address to request a password reset."),T(),b(7,"div",4),je(8,"input",5,6),T(),b(10,"div",4)(11,"input",7),re("click",function(){xe(o);let u=Zi(9);return Re(s.authService.ForgotPassword(u.value))}),T()()(),b(12,"div",8)(13,"span"),O(14,"Go back to ? "),b(15,"span",9),O(16,"Log In"),T()()()()()}},dependencies:[ci]});let t=e;return t})();function WK(t,e){if(t&1&&(b(0,"div",4)(1,"p",9),O(2,"We have sent a confirmation email to "),b(3,"strong"),O(4),T(),O(5,"."),T(),b(6,"p",9),O(7,"Please check your email and click on the link to verfiy your email address."),T()()),t&2){let n=e.ngIf;oe(4),Fr(n.email)}}var A2=(()=>{let e=class e{constructor(r){this.authService=r}ngOnInit(){}};e.\u0275fac=function(i){return new(i||e)(Y(ar))},e.\u0275cmp=st({type:e,selectors:[["app-verify-email"]],decls:15,vars:1,consts:[[1,"displayTable"],[1,"displayTableCell"],[1,"authBlock"],["class","formGroup",4,"ngIf"],[1,"formGroup"],["type","button",1,"btn","btnPrimary",3,"click"],[1,"fas","fa-redo-alt"],[1,"redirectToLogin"],["routerLink","/sign-in",1,"redirect"],[1,"text-center"]],template:function(i,s){i&1&&(b(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),O(4,"Thank You for Registering"),T(),hn(5,WK,8,1,"div",3),b(6,"div",4)(7,"button",5),re("click",function(){return s.authService.SendVerificationMail()}),je(8,"i",6),O(9," Resend Verification Email "),T()()(),b(10,"div",7)(11,"span"),O(12,"Go back to?"),b(13,"span",8),O(14," Sign in"),T()()()()()),i&2&&(oe(5),Ve("ngIf",s.authService.userData))},dependencies:[wp,ci]});let t=e;return t})();var x2=(()=>{let e=class e{constructor(r,i){this.authService=r,this.router=i}canActivate(r,i){return this.authService.isLoggedIn!==!0&&this.router.navigate(["sign-in"]),!0}};e.\u0275fac=function(i){return new(i||e)(C(ar),C(or))},e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var M2=j2(R2());var P2=(()=>{let e=class e{ngOnInit(){let r=document.querySelector("#form");r&&(0,M2.createWidget)("aTEW5zeJ",{container:r})}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=st({type:e,selectors:[["app-form"]],decls:1,vars:0,consts:[["id","form",2,"width","95%","height","600px","border","2px #ccc solid"]],template:function(i,s){i&1&&je(0,"div",0)}});let t=e;return t})();var KK=[{path:"",redirectTo:"/sign-in",pathMatch:"full"},{path:"form",component:P2},{path:"products",component:w2},{path:"responses",component:C2},{path:"sign-in",component:b2},{path:"register-user",component:T2},{path:"dashboard",component:D2,canActivate:[x2]},{path:"forgot-password",component:S2},{path:"verify-email-address",component:A2}],N2=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Xe({type:e}),e.\u0275inj=Ze({imports:[OD.forRoot(KK),OD]});let t=e;return t})();var O2=(()=>{let e=class e{constructor(){this.title="Supernova"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=st({type:e,selectors:[["app-root"]],decls:18,vars:1,consts:[[1,"navbar","navbar-expand","navbar-dark","bg-dark"],["href","#",1,"navbar-brand"],[1,"navbar-nav","mr-auto"],[1,"nav-item"],["routerLink","tutorials",1,"nav-link"],["routerLink","products",1,"nav-link"],["routerLink","responses",1,"nav-link"],[1,"container","mt-3"]],template:function(i,s){i&1&&(b(0,"div")(1,"nav",0)(2,"a",1),O(3,"Supernova"),T(),b(4,"div",2)(5,"li",3)(6,"a",4),O(7,"Home"),T()(),b(8,"li",3)(9,"a",5),O(10,"Products"),T()(),b(11,"li",3)(12,"a",6),O(13,"Responses"),T()()()(),b(14,"div",7)(15,"h3"),O(16),T(),je(17,"router-outlet"),T()()),i&2&&(oe(16),Fr(s.title))},dependencies:[SD,ci],styles:[".container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;margin:25px auto}"]});let t=e;return t})();var k2=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Xe({type:e,bootstrap:[O2]}),e.\u0275inj=Ze({imports:[FR,N2,sM,lM.initializeApp(xV.firebase),IM,iF,uP,SV]});let t=e;return t})();kR().bootstrapModule(k2).catch(t=>console.error(t));
