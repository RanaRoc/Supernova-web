import{A as QT,B as Mn,C as Ri,D as Rh,E as yc,F as ry,G as YT,H as JT,I as re,J as hn,K as bt,L as iy,M as ZT,N as vc,O as se,P as Ut,Q as Nh,R as sy,S as Pn,T as Ni,U as si,V as ea,W as XT,X as fn,Y as et,a as j,b as Pe,c as ey,d as C,e as BT,f as Dh,g as $T,h as HT,i as O,j as Zo,k as Sh,l as qT,m as zT,n as Pt,o as Xo,p as _c,q as ty,r as GT,s as wr,t as ny,u as Ah,v as Mh,w as WT,x as Ph,y as gt,z as KT}from"./chunk-QY6DX5KU.js";var eD=null;var oy=1;function en(t){let e=eD;return eD=t,e}var tD={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function aj(t){if(!(cy(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===oy)){if(!t.producerMustRecompute(t)&&!ay(t)){t.dirty=!1,t.lastCleanEpoch=oy;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=oy}}function nD(t){return t&&(t.nextProducerIndex=0),en(t)}function rD(t,e){if(en(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(cy(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)ly(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function ay(t){kh(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(aj(n),r!==n.version))return!0}return!1}function iD(t){if(kh(t),cy(t))for(let e=0;e<t.producerNode.length;e++)ly(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function ly(t,e){if(lj(t),kh(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)ly(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];kh(i),i.producerIndexOfThis[r]=e}}function cy(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function kh(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function lj(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function cj(){throw new Error}var uj=cj;function sD(t){uj=t}function le(t){return typeof t=="function"}function ta(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Oh=ta(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function Ls(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var mt=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(le(r))try{r()}catch(s){e=s instanceof Oh?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{oD(s)}catch(o){e=e??[],o instanceof Oh?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Oh(e)}}add(e){var n;if(e&&e!==this)if(this.closed)oD(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&Ls(n,e)}remove(e){let{_finalizers:n}=this;n&&Ls(n,e),e instanceof t&&e._removeParent(this)}};mt.EMPTY=(()=>{let t=new mt;return t.closed=!0,t})();var uy=mt.EMPTY;function Fh(t){return t instanceof mt||t&&"closed"in t&&le(t.remove)&&le(t.add)&&le(t.unsubscribe)}function oD(t){le(t)?t():t.unsubscribe()}var Jn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var na={setTimeout(t,e,...n){let{delegate:r}=na;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=na;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Vh(t){na.setTimeout(()=>{let{onUnhandledError:e}=Jn;if(e)e(t);else throw t})}function js(){}var aD=(()=>dy("C",void 0,void 0))();function lD(t){return dy("E",void 0,t)}function cD(t){return dy("N",t,void 0)}function dy(t,e,n){return{kind:t,value:e,error:n}}var Us=null;function ra(t){if(Jn.useDeprecatedSynchronousErrorHandling){let e=!Us;if(e&&(Us={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=Us;if(Us=null,n)throw r}}else t()}function uD(t){Jn.useDeprecatedSynchronousErrorHandling&&Us&&(Us.errorThrown=!0,Us.error=t)}var Bs=class extends mt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Fh(e)&&e.add(this)):this.destination=fj}static create(e,n,r){return new oi(e,n,r)}next(e){this.isStopped?fy(cD(e),this):this._next(e)}error(e){this.isStopped?fy(lD(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?fy(aD,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},dj=Function.prototype.bind;function hy(t,e){return dj.call(t,e)}var py=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){Lh(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){Lh(r)}else Lh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){Lh(n)}}},oi=class extends Bs{constructor(e,n,r){super();let i;if(le(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&Jn.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&hy(e.next,s),error:e.error&&hy(e.error,s),complete:e.complete&&hy(e.complete,s)}):i=e}this.destination=new py(i)}};function Lh(t){Jn.useDeprecatedSynchronousErrorHandling?uD(t):Vh(t)}function hj(t){throw t}function fy(t,e){let{onStoppedNotification:n}=Jn;n&&na.setTimeout(()=>n(t,e))}var fj={closed:!0,next:js,error:hj,complete:js};var ia=(()=>typeof Symbol=="function"&&Symbol.observable||"@@observable")();function Bt(t){return t}function gy(...t){return my(t)}function my(t){return t.length===0?Bt:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var oe=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=gj(n)?n:new oi(n,r,i);return ra(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=dD(r),new r((i,s)=>{let o=new oi({next:a=>{try{n(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[ia](){return this}pipe(...n){return my(n)(this)}toPromise(n){return n=dD(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function dD(t){var e;return(e=t??Jn.Promise)!==null&&e!==void 0?e:Promise}function pj(t){return t&&le(t.next)&&le(t.error)&&le(t.complete)}function gj(t){return t&&t instanceof Bs||pj(t)&&Fh(t)}function _y(t){return le(t?.lift)}function ae(t){return e=>{if(_y(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ie(t,e,n,r,i){return new yy(t,e,n,r,i)}var yy=class extends Bs{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(l){e.error(l)}}:super._next,this._error=i?function(a){try{i(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function sa(){return ae((t,e)=>{let n=null;t._refCount++;let r=ie(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var oa=class extends oe{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,_y(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new mt;let n=this.getSubject();e.add(this.source.subscribe(ie(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=mt.EMPTY)}return e}refCount(){return sa()(this)}};var hD=ta(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ut=(()=>{class t extends oe{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new jh(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new hD}next(n){ra(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){ra(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){ra(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?uy:(this.currentObservers=null,s.push(n),new mt(()=>{this.currentObservers=null,Ls(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new oe;return n.source=this,n}}return t.create=(e,n)=>new jh(e,n),t})(),jh=class extends ut{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:uy}};var It=class extends ut{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var wc={now(){return(wc.delegate||Date).now()},delegate:void 0};var Uh=class extends ut{constructor(e=1/0,n=1/0,r=wc){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=n.now(),a=0;for(let l=1;l<r.length&&r[l]<=o;l+=2)a=l;a&&r.splice(0,a+1)}}};var Bh=class extends mt{constructor(e,n){super()}schedule(e,n=0){return this}};var Ec={setInterval(t,e,...n){let{delegate:r}=Ec;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=Ec;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var aa=class extends Bh{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return Ec.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&Ec.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,Ls(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var la=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};la.now=wc.now;var ca=class extends la{constructor(e,n=la.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var ai=new ca(aa);var $h=class extends aa{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var Hh=class extends ca{};var vy=new Hh($h);var pn=new oe(t=>t.complete());function fD(t){return t&&le(t.schedule)}function wy(t){return t[t.length-1]}function ua(t){return le(wy(t))?t.pop():void 0}function Er(t){return fD(wy(t))?t.pop():void 0}function pD(t,e){return typeof wy(t)=="number"?t.pop():e}var qh=t=>t&&typeof t.length=="number"&&typeof t!="function";function zh(t){return le(t?.then)}function Gh(t){return le(t[ia])}function Wh(t){return Symbol.asyncIterator&&le(t?.[Symbol.asyncIterator])}function Kh(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function mj(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Qh=mj();function Yh(t){return le(t?.[Qh])}function Jh(t){return $T(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield Dh(n.read());if(i)return yield Dh(void 0);yield yield Dh(r)}}finally{n.releaseLock()}})}function Zh(t){return le(t?.getReader)}function je(t){if(t instanceof oe)return t;if(t!=null){if(Gh(t))return _j(t);if(qh(t))return yj(t);if(zh(t))return vj(t);if(Wh(t))return gD(t);if(Yh(t))return wj(t);if(Zh(t))return Ej(t)}throw Kh(t)}function _j(t){return new oe(e=>{let n=t[ia]();if(le(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function yj(t){return new oe(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function vj(t){return new oe(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,Vh)})}function wj(t){return new oe(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function gD(t){return new oe(e=>{Cj(t,e).catch(n=>e.error(n))})}function Ej(t){return gD(Jh(t))}function Cj(t,e){var n,r,i,s;return BT(this,void 0,void 0,function*(){try{for(n=HT(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function gn(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function yn(t,e=0){return ae((n,r)=>{n.subscribe(ie(r,i=>gn(r,t,()=>r.next(i),e),()=>gn(r,t,()=>r.complete(),e),i=>gn(r,t,()=>r.error(i),e)))})}function Zn(t,e=0){return ae((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function mD(t,e){return je(t).pipe(Zn(e),yn(e))}function _D(t,e){return je(t).pipe(Zn(e),yn(e))}function yD(t,e){return new oe(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function vD(t,e){return new oe(n=>{let r;return gn(n,e,()=>{r=t[Qh](),gn(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>le(r?.return)&&r.return()})}function Xh(t,e){if(!t)throw new Error("Iterable cannot be null");return new oe(n=>{gn(n,e,()=>{let r=t[Symbol.asyncIterator]();gn(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function wD(t,e){return Xh(Jh(t),e)}function ED(t,e){if(t!=null){if(Gh(t))return mD(t,e);if(qh(t))return yD(t,e);if(zh(t))return _D(t,e);if(Wh(t))return Xh(t,e);if(Yh(t))return vD(t,e);if(Zh(t))return wD(t,e)}throw Kh(t)}function ge(t,e){return e?ED(t,e):je(t)}function K(...t){let e=Er(t);return ge(t,e)}function da(t,e){let n=le(t)?t:()=>t,r=i=>i.error(n());return new oe(e?i=>e.schedule(r,0,i):r)}function Ey(t){return!!t&&(t instanceof oe||le(t.lift)&&le(t.subscribe))}var li=ta(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function B(t,e){return ae((n,r)=>{let i=0;n.subscribe(ie(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:bj}=Array;function Ij(t,e){return bj(e)?t(...e):t(e)}function ef(t){return B(e=>Ij(t,e))}var{isArray:xj}=Array,{getPrototypeOf:Tj,prototype:Dj,keys:Sj}=Object;function tf(t){if(t.length===1){let e=t[0];if(xj(e))return{args:e,keys:null};if(Aj(e)){let n=Sj(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function Aj(t){return t&&typeof t=="object"&&Tj(t)===Dj}function nf(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function Cc(...t){let e=Er(t),n=ua(t),{args:r,keys:i}=tf(t);if(r.length===0)return ge([],e);let s=new oe(Mj(r,e,i?o=>nf(i,o):Bt));return n?s.pipe(ef(n)):s}function Mj(t,e,n=Bt){return r=>{CD(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let l=0;l<i;l++)CD(e,()=>{let c=ge(t[l],e),u=!1;c.subscribe(ie(r,d=>{s[l]=d,u||(u=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function CD(t,e,n){t?gn(n,t,e):e()}function bD(t,e,n,r,i,s,o,a){let l=[],c=0,u=0,d=!1,h=()=>{d&&!l.length&&!c&&e.complete()},g=w=>c<r?y(w):l.push(w),y=w=>{s&&e.next(w),c++;let v=!1;je(n(w,u++)).subscribe(ie(e,T=>{i?.(T),s?g(T):e.next(T)},()=>{v=!0},void 0,()=>{if(v)try{for(c--;l.length&&c<r;){let T=l.shift();o?gn(e,o,()=>y(T)):y(T)}h()}catch(T){e.error(T)}}))};return t.subscribe(ie(e,g,()=>{d=!0,h()})),()=>{a?.()}}function _t(t,e,n=1/0){return le(e)?_t((r,i)=>B((s,o)=>e(r,s,i,o))(je(t(r,i))),n):(typeof e=="number"&&(n=e),ae((r,i)=>bD(r,i,t,n)))}function ki(t=1/0){return _t(Bt,t)}function ID(){return ki(1)}function ha(...t){return ID()(ge(t,Er(t)))}function rf(t){return new oe(e=>{je(t()).subscribe(e)})}function Cy(...t){let e=ua(t),{args:n,keys:r}=tf(t),i=new oe(s=>{let{length:o}=n;if(!o){s.complete();return}let a=new Array(o),l=o,c=o;for(let u=0;u<o;u++){let d=!1;je(n[u]).subscribe(ie(s,h=>{d||(d=!0,c--),a[u]=h},()=>l--,void 0,()=>{(!l||!d)&&(c||s.next(r?nf(r,a):a),s.complete())}))}});return e?i.pipe(ef(e)):i}function Oi(...t){let e=Er(t),n=pD(t,1/0),r=t;return r.length?r.length===1?je(r[0]):ki(n)(ge(r,e)):pn}function xt(t,e){return ae((n,r)=>{let i=0;n.subscribe(ie(r,s=>t.call(e,s,i++)&&r.next(s)))})}function Fi(t){return ae((e,n)=>{let r=null,i=!1,s;r=e.subscribe(ie(n,void 0,void 0,o=>{s=je(t(o,Fi(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function xD(t,e,n,r,i){return(s,o)=>{let a=n,l=e,c=0;s.subscribe(ie(o,u=>{let d=c++;l=a?t(l,u,d):(a=!0,u),r&&o.next(l)},i&&(()=>{a&&o.next(l),o.complete()})))}}function ci(t,e){return le(e)?_t(t,e,1):_t(t,1)}function by(t,e=ai){return ae((n,r)=>{let i=null,s=null,o=null,a=()=>{if(i){i.unsubscribe(),i=null;let c=s;s=null,r.next(c)}};function l(){let c=o+t,u=e.now();if(u<c){i=this.schedule(void 0,c-u),r.add(i);return}a()}n.subscribe(ie(r,c=>{s=c,o=e.now(),i||(i=e.schedule(l,t),r.add(i))},()=>{a(),r.complete()},void 0,()=>{s=i=null}))})}function Vi(t){return ae((e,n)=>{let r=!1;e.subscribe(ie(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function Rn(t){return t<=0?()=>pn:ae((e,n)=>{let r=0;e.subscribe(ie(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function Iy(t){return B(()=>t)}function $s(t,e=Bt){return t=t??Pj,ae((n,r)=>{let i,s=!0;n.subscribe(ie(r,o=>{let a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function Pj(t,e){return t===e}function sf(t=Rj){return ae((e,n)=>{let r=!1;e.subscribe(ie(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function Rj(){return new li}function Li(t){return ae((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function Nn(t,e){let n=arguments.length>=2;return r=>r.pipe(t?xt((i,s)=>t(i,s,r)):Bt,Rn(1),n?Vi(e):sf(()=>new li))}function fa(t){return t<=0?()=>pn:ae((e,n)=>{let r=[];e.subscribe(ie(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function xy(t,e){let n=arguments.length>=2;return r=>r.pipe(t?xt((i,s)=>t(i,s,r)):Bt,fa(1),n?Vi(e):sf(()=>new li))}function bc(){return ae((t,e)=>{let n,r=!1;t.subscribe(ie(e,i=>{let s=n;n=i,r&&e.next([s,i]),r=!0}))})}function Cr(t,e){return ae(xD(t,e,arguments.length>=2,!0))}function Hs(t={}){let{connector:e=()=>new ut,resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,l,c=0,u=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},g=()=>{h(),o=l=void 0,u=d=!1},y=()=>{let w=o;g(),w?.unsubscribe()};return ae((w,v)=>{c++,!d&&!u&&h();let T=l=l??e();v.add(()=>{c--,c===0&&!d&&!u&&(a=Ty(y,i))}),T.subscribe(v),!o&&c>0&&(o=new oi({next:V=>T.next(V),error:V=>{d=!0,h(),a=Ty(g,n,V),T.error(V)},complete:()=>{u=!0,h(),a=Ty(g,r),T.complete()}}),je(w).subscribe(o))})(s)}}function Ty(t,e,...n){if(e===!0){t();return}if(e===!1)return;let r=new oi({next:()=>{r.unsubscribe(),t()}});return je(e(...n)).subscribe(r)}function of(t,e,n){let r,i=!1;return t&&typeof t=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t:r=t??1/0,Hs({connector:()=>new Uh(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function Dy(t){return ae((e,n)=>{let r=!1,i=0;e.subscribe(ie(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}function qs(...t){let e=Er(t);return ae((n,r)=>{(e?ha(t,n,e):ha(t,n)).subscribe(r)})}function Re(t,e){return ae((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(ie(r,l=>{i?.unsubscribe();let c=0,u=s++;je(t(l,u)).subscribe(i=ie(r,d=>r.next(e?e(l,d,u,c++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function af(t,e){return le(e)?Re(()=>t,e):Re(()=>t)}function Sy(t){return ae((e,n)=>{je(t).subscribe(ie(n,()=>n.complete(),js)),!n.closed&&e.subscribe(n)})}function it(t,e,n){let r=le(t)||e||n?{next:t,error:e,complete:n}:t;return r?ae((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(ie(s,l=>{var c;(c=r.next)===null||c===void 0||c.call(r,l),s.next(l)},()=>{var l;a=!1,(l=r.complete)===null||l===void 0||l.call(r),s.complete()},l=>{var c;a=!1,(c=r.error)===null||c===void 0||c.call(r,l),s.error(l)},()=>{var l,c;a&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(c=r.finalize)===null||c===void 0||c.call(r)}))}):Bt}function Ay(...t){let e=ua(t);return ae((n,r)=>{let i=t.length,s=new Array(i),o=t.map(()=>!1),a=!1;for(let l=0;l<i;l++)je(t[l]).subscribe(ie(r,c=>{s[l]=c,!a&&!o[l]&&(o[l]=!0,(a=o.every(Bt))&&(o=null))},js));n.subscribe(ie(r,l=>{if(a){let c=[l,...s];r.next(e?e(...c):c)}}))})}function Ue(t){for(let e in t)if(t[e]===Ue)return e;throw Error("Could not find renamed property on target object.")}function lf(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function Wt(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(Wt).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function qy(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var Nj=Ue({__forward_ref__:Ue});function zi(t){return t.__forward_ref__=zi,t.toString=function(){return Wt(this())},t}function tn(t){return oS(t)?t():t}function oS(t){return typeof t=="function"&&t.hasOwnProperty(Nj)&&t.__forward_ref__===zi}function aS(t){return t&&!!t.\u0275providers}var lS="https://g.co/ng/security#xss",Q=class extends Error{constructor(e,n){super(Bf(e,n)),this.code=e}};function Bf(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}var kj=Ue({\u0275cmp:Ue}),Oj=Ue({\u0275dir:Ue}),Fj=Ue({\u0275pipe:Ue}),Vj=Ue({\u0275mod:Ue}),yf=Ue({\u0275fac:Ue}),Ic=Ue({__NG_ELEMENT_ID__:Ue}),TD=Ue({__NG_ENV_ID__:Ue});function Tc(t){return typeof t=="string"?t:t==null?"":String(t)}function Lj(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():Tc(t)}function jj(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new Q(-200,`Circular dependency in DI detected for ${t}${n}`)}function Rv(t,e){let n=e?` in ${e}`:"";throw new Q(-201,!1)}function Uj(t,e){t==null&&Bj(e,t,null,"!=")}function Bj(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t}`+(r==null?"":` [Expected=> ${n} ${r} ${e} <=Actual]`))}function z(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Fe(t){return{providers:t.providers||[],imports:t.imports||[]}}function $f(t){return DD(t,uS)||DD(t,dS)}function cS(t){return $f(t)!==null}function DD(t,e){return t.hasOwnProperty(e)?t[e]:null}function $j(t){let e=t&&(t[uS]||t[dS]);return e||null}function SD(t){return t&&(t.hasOwnProperty(AD)||t.hasOwnProperty(Hj))?t[AD]:null}var uS=Ue({\u0275prov:Ue}),AD=Ue({\u0275inj:Ue}),dS=Ue({ngInjectableDef:Ue}),Hj=Ue({ngInjectorDef:Ue}),ve=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(ve||{}),zy;function hS(){return zy}function kn(t){let e=zy;return zy=t,e}function fS(t,e,n){let r=$f(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&ve.Optional)return null;if(e!==void 0)return e;Rv(Wt(t),"Injector")}var vn=globalThis;var L=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=z({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};var qj={},Dc=qj,Gy="__NG_DI_FLAG__",vf="ngTempTokenPath",zj="ngTokenPath",Gj=/\n/gm,Wj="\u0275",MD="__source",ya;function Kj(){return ya}function ji(t){let e=ya;return ya=t,e}function Qj(t,e=ve.Default){if(ya===void 0)throw new Q(-203,!1);return ya===null?fS(t,void 0,e):ya.get(t,e&ve.Optional?null:void 0,e)}function x(t,e=ve.Default){return(hS()||Qj)(tn(t),e)}function q(t,e=ve.Default){return x(t,Hf(e))}function Hf(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function Wy(t){let e=[];for(let n=0;n<t.length;n++){let r=tn(t[n]);if(Array.isArray(r)){if(r.length===0)throw new Q(900,!1);let i,s=ve.Default;for(let o=0;o<r.length;o++){let a=r[o],l=Yj(a);typeof l=="number"?l===-1?i=a.token:s|=l:i=a}e.push(x(i,s))}else e.push(x(r))}return e}function pS(t,e){return t[Gy]=e,t.prototype[Gy]=e,t}function Yj(t){return t[Gy]}function Jj(t,e,n,r){let i=t[vf];throw e[MD]&&i.unshift(e[MD]),t.message=Zj(`
`+t.message,i,n,r),t[zj]=i,t[vf]=null,t}function Zj(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==Wj?t.slice(2):t;let i=Wt(e);if(Array.isArray(e))i=e.map(Wt).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Wt(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(Gj,`
  `)}`}function Fc(t){return{toString:t}.toString()}var gS=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(gS||{}),xr=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(xr||{}),wa={},mn=[];function mS(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function Ky(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];eU(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function Xj(t){return t===3||t===4||t===6}function eU(t){return t.charCodeAt(0)===64}function Sc(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?PD(t,n,i,null,e[++r]):PD(t,n,i,null,null))}}return t}function PD(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var _S="ng-template";function tU(t,e,n){let r=0,i=!0;for(;r<t.length;){let s=t[r++];if(typeof s=="string"&&i){let o=t[r++];if(n&&s==="class"&&mS(o.toLowerCase(),e,0)!==-1)return!0}else if(s===1){for(;r<t.length&&typeof(s=t[r++])=="string";)if(s.toLowerCase()===e)return!0;return!1}else typeof s=="number"&&(i=!1)}return!1}function yS(t){return t.type===4&&t.value!==_S}function nU(t,e,n){let r=t.type===4&&!n?_S:t.value;return e===r}function rU(t,e,n){let r=4,i=t.attrs||[],s=oU(i),o=!1;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="number"){if(!o&&!Xn(r)&&!Xn(l))return!1;if(o&&Xn(l))continue;o=!1,r=l|r&1;continue}if(!o)if(r&4){if(r=2|r&1,l!==""&&!nU(t,l,n)||l===""&&e.length===1){if(Xn(r))return!1;o=!0}}else{let c=r&8?l:e[++a];if(r&8&&t.attrs!==null){if(!tU(t.attrs,c,n)){if(Xn(r))return!1;o=!0}continue}let u=r&8?"class":l,d=iU(u,i,yS(t),n);if(d===-1){if(Xn(r))return!1;o=!0;continue}if(c!==""){let h;d>s?h="":h=i[d+1].toLowerCase();let g=r&8?h:null;if(g&&mS(g,c,0)!==-1||r&2&&c!==h){if(Xn(r))return!1;o=!0}}}}return Xn(r)||o}function Xn(t){return(t&1)===0}function iU(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return aU(e,t)}function sU(t,e,n=!1){for(let r=0;r<e.length;r++)if(rU(t,e[r],n))return!0;return!1}function oU(t){for(let e=0;e<t.length;e++){let n=t[e];if(Xj(n))return e}return t.length}function aU(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function RD(t,e){return t?":not("+e.trim()+")":e}function lU(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Xn(o)&&(e+=RD(s,i),i=""),r=o,s=s||!Xn(r);n++}return i!==""&&(e+=RD(s,i)),e}function cU(t){return t.map(lU).join(",")}function uU(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!Xn(i))break;i=s}r++}return{attrs:e,classes:n}}function ot(t){return Fc(()=>{let e=bS(t),n=Pe(j({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===gS.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||xr.Emulated,styles:t.styles||mn,_:null,schemas:t.schemas||null,tView:null,id:""});IS(n);let r=t.dependencies;return n.directiveDefs=kD(r,!1),n.pipeDefs=kD(r,!0),n.id=fU(n),n})}function dU(t){return $i(t)||vS(t)}function hU(t){return t!==null}function Ve(t){return Fc(()=>({type:t.type,bootstrap:t.bootstrap||mn,declarations:t.declarations||mn,imports:t.imports||mn,exports:t.exports||mn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function ND(t,e){if(t==null)return wa;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),n[i]=r,e&&(e[i]=s)}return n}function Rt(t){return Fc(()=>{let e=bS(t);return IS(e),e})}function $i(t){return t[kj]||null}function vS(t){return t[Oj]||null}function wS(t){return t[Fj]||null}function ES(t){let e=$i(t)||vS(t)||wS(t);return e!==null?e.standalone:!1}function CS(t,e){let n=t[Vj]||null;if(!n&&e===!0)throw new Error(`Type ${Wt(t)} does not have '\u0275mod' property.`);return n}function bS(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||wa,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||mn,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:ND(t.inputs,e),outputs:ND(t.outputs),debugInfo:null}}function IS(t){t.features?.forEach(e=>e(t))}function kD(t,e){if(!t)return null;let n=e?wS:dU;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(hU)}function fU(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483647+1,"c"+e}var hi=0,Ce=1,ce=2,Tt=3,tr=4,ir=5,wf=6,Ac=7,On=8,Ea=9,Ca=10,Dt=11,Mc=12,OD=13,Aa=14,Tr=15,qf=16,pa=17,Pc=18,zf=19,xS=20,Ui=21,My=22,Gs=23,nr=25,TS=1;var Ws=7,Ef=8,Cf=9,wn=10,ba=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t[t.HasChildViewsToRefresh=4]="HasChildViewsToRefresh",t}(ba||{});function Bi(t){return Array.isArray(t)&&typeof t[TS]=="object"}function rr(t){return Array.isArray(t)&&t[TS]===!0}function DS(t){return(t.flags&4)!==0}function Gf(t){return t.componentOffset>-1}function Nv(t){return(t.flags&1)===1}function Hi(t){return!!t.template}function pU(t){return(t[ce]&512)!==0}function Ia(t,e){let n=t.hasOwnProperty(yf);return n?t[yf]:null}var Qy=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function Gi(){return SS}function SS(t){return t.type.prototype.ngOnChanges&&(t.setInput=mU),gU}Gi.ngInherit=!0;function gU(){let t=MS(this),e=t?.current;if(e){let n=t.previous;if(n===wa)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function mU(t,e,n,r){let i=this.declaredInputs[n],s=MS(t)||_U(t,{previous:wa,current:null}),o=s.current||(s.current={}),a=s.previous,l=a[i];o[i]=new Qy(l&&l.currentValue,e,a===wa),t[r]=e}var AS="__ngSimpleChanges__";function MS(t){return t[AS]||null}function _U(t,e){return t[AS]=e}var FD=null;var br=function(t,e,n){FD?.(t,e,n)},yU="svg",vU="math";function Dr(t){for(;Array.isArray(t);)t=t[hi];return t}function PS(t,e){return Dr(e[t])}function sr(t,e){return Dr(e[t.index])}function kv(t,e){return t.data[e]}function wU(t,e){return t[e]}function Wi(t,e){let n=e[t];return Bi(n)?n:n[hi]}function Ov(t){return(t[ce]&128)===128}function EU(t){return rr(t[Tt])}function bf(t,e){return e==null?null:t[e]}function RS(t){t[pa]=0}function CU(t){t[ce]&1024||(t[ce]|=1024,Ov(t)&&Wf(t))}function bU(t,e){for(;t>0;)e=e[Aa],t--;return e}function NS(t){return t[ce]&9216||t[Gs]?.dirty}function kS(t){NS(t)&&Wf(t)}function Wf(t){let e=t[Tt];for(;e!==null&&!(rr(e)&&e[ce]&ba.HasChildViewsToRefresh||Bi(e)&&e[ce]&8192);){if(rr(e))e[ce]|=ba.HasChildViewsToRefresh;else if(e[ce]|=8192,!Ov(e))break;e=e[Tt]}}function OS(t,e){if((t[ce]&256)===256)throw new Q(911,!1);t[Ui]===null&&(t[Ui]=[]),t[Ui].push(e)}function IU(t,e){if(t[Ui]===null)return;let n=t[Ui].indexOf(e);n!==-1&&t[Ui].splice(n,1)}var we={lFrame:$S(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function xU(){return we.lFrame.elementDepthCount}function TU(){we.lFrame.elementDepthCount++}function DU(){we.lFrame.elementDepthCount--}function FS(){return we.bindingsEnabled}function SU(){return we.skipHydrationRootTNode!==null}function AU(t){return we.skipHydrationRootTNode===t}function MU(){we.skipHydrationRootTNode=null}function Be(){return we.lFrame.lView}function Fn(){return we.lFrame.tView}function N(t){return we.lFrame.contextLView=t,t[On]}function k(t){return we.lFrame.contextLView=null,t}function Vn(){let t=VS();for(;t!==null&&t.type===64;)t=t.parent;return t}function VS(){return we.lFrame.currentTNode}function PU(){let t=we.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function Vc(t,e){let n=we.lFrame;n.currentTNode=t,n.isParent=e}function LS(){return we.lFrame.isParent}function RU(){we.lFrame.isParent=!1}function NU(){return we.lFrame.contextLView}function kU(){return we.lFrame.bindingIndex}function OU(t){return we.lFrame.bindingIndex=t}function Fv(){return we.lFrame.bindingIndex++}function Vv(t){let e=we.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function FU(){return we.lFrame.inI18n}function VU(t,e){let n=we.lFrame;n.bindingIndex=n.bindingRootIndex=t,Yy(e)}function LU(){return we.lFrame.currentDirectiveIndex}function Yy(t){we.lFrame.currentDirectiveIndex=t}function jU(t){let e=we.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function jS(t){we.lFrame.currentQueryIndex=t}function UU(t){let e=t[Ce];return e.type===2?e.declTNode:e.type===1?t[ir]:null}function US(t,e,n){if(n&ve.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&ve.Host);)if(i=UU(s),i===null||(s=s[Aa],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=we.lFrame=BS();return r.currentTNode=e,r.lView=t,!0}function Lv(t){let e=BS(),n=t[Ce];we.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function BS(){let t=we.lFrame,e=t===null?null:t.child;return e===null?$S(t):e}function $S(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function HS(){let t=we.lFrame;return we.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var qS=HS;function jv(){let t=HS();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function BU(t){return(we.lFrame.contextLView=bU(t,we.lFrame.contextLView))[On]}function Ki(){return we.lFrame.selectedIndex}function Ks(t){we.lFrame.selectedIndex=t}function zS(){let t=we.lFrame;return kv(t.tView,t.selectedIndex)}function $U(){return we.lFrame.currentNamespace}var GS=!0;function Uv(){return GS}function Bv(t){GS=t}function HU(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=SS(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function $v(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),l&&(t.viewHooks??=[]).push(-n,l),c&&((t.viewHooks??=[]).push(n,c),(t.viewCheckHooks??=[]).push(n,c)),u!=null&&(t.destroyHooks??=[]).push(n,u)}}function ff(t,e,n){WS(t,e,3,n)}function pf(t,e,n,r){(t[ce]&3)===n&&WS(t,e,n,r)}function Py(t,e){let n=t[ce];(n&3)===e&&(n&=16383,n+=1,t[ce]=n)}function WS(t,e,n,r){let i=r!==void 0?t[pa]&65535:0,s=r??-1,o=e.length-1,a=0;for(let l=i;l<o;l++)if(typeof e[l+1]=="number"){if(a=e[l],r!=null&&a>=r)break}else e[l]<0&&(t[pa]+=65536),(a<s||s==-1)&&(qU(t,n,e,l),t[pa]=(t[pa]&4294901760)+l+2),l++}function VD(t,e){br(4,t,e);let n=en(null);try{e.call(t)}finally{en(n),br(5,t,e)}}function qU(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[ce]>>14<t[pa]>>16&&(t[ce]&3)===e&&(t[ce]+=16384,VD(a,s)):VD(a,s)}var va=-1,Qs=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function zU(t){return t instanceof Qs}function GU(t){return(t.flags&8)!==0}function WU(t){return(t.flags&16)!==0}function KS(t){return t!==va}function If(t){let e=t&32767;return t&32767}function KU(t){return t>>16}function xf(t,e){let n=KU(t),r=e;for(;n>0;)r=r[Aa],n--;return r}var Jy=!0;function LD(t){let e=Jy;return Jy=t,e}var QU=256,QS=QU-1,YS=5,YU=0,Ir={};function JU(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(Ic)&&(r=n[Ic]),r==null&&(r=n[Ic]=YU++);let i=r&QS,s=1<<i;e.data[t+(i>>YS)]|=s}function Tf(t,e){let n=JS(t,e);if(n!==-1)return n;let r=e[Ce];r.firstCreatePass&&(t.injectorIndex=e.length,Ry(r.data,t),Ry(e,null),Ry(r.blueprint,null));let i=Hv(t,e),s=t.injectorIndex;if(KS(i)){let o=If(i),a=xf(i,e),l=a[Ce].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=i,s}function Ry(t,e){t.push(0,0,0,0,0,0,0,0,e)}function JS(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function Hv(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=nA(i),r===null)return va;if(n++,i=i[Aa],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return va}function Zy(t,e,n){JU(t,e,n)}function ZS(t,e,n){if(n&ve.Optional||t!==void 0)return t;Rv(e,"NodeInjector")}function XS(t,e,n,r){if(n&ve.Optional&&r===void 0&&(r=null),!(n&(ve.Self|ve.Host))){let i=t[Ea],s=kn(void 0);try{return i?i.get(e,r,n&ve.Optional):fS(e,r,n&ve.Optional)}finally{kn(s)}}return ZS(r,e,n)}function eA(t,e,n,r=ve.Default,i){if(t!==null){if(e[ce]&2048&&!(r&ve.Self)){let o=nB(t,e,n,r,Ir);if(o!==Ir)return o}let s=tA(t,e,n,r,Ir);if(s!==Ir)return s}return XS(e,n,r,i)}function tA(t,e,n,r,i){let s=eB(n);if(typeof s=="function"){if(!US(e,t,r))return r&ve.Host?ZS(i,n,r):XS(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&ve.Optional))Rv(n);else return o}finally{qS()}}else if(typeof s=="number"){let o=null,a=JS(t,e),l=va,c=r&ve.Host?e[Tr][ir]:null;for((a===-1||r&ve.SkipSelf)&&(l=a===-1?Hv(t,e):e[a+8],l===va||!UD(r,!1)?a=-1:(o=e[Ce],a=If(l),e=xf(l,e)));a!==-1;){let u=e[Ce];if(jD(s,a,u.data)){let d=ZU(a,e,n,o,r,c);if(d!==Ir)return d}l=e[a+8],l!==va&&UD(r,e[Ce].data[a+8]===c)&&jD(s,a,e)?(o=u,a=If(l),e=xf(l,e)):a=-1}}return i}function ZU(t,e,n,r,i,s){let o=e[Ce],a=o.data[t+8],l=r==null?Gf(a)&&Jy:r!=o&&(a.type&3)!==0,c=i&ve.Host&&s===a,u=XU(a,o,n,l,c);return u!==null?xa(e,o,u,a):Ir}function XU(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,l=t.directiveStart,c=t.directiveEnd,u=s>>20,d=r?a:a+u,h=i?a+u:c;for(let g=d;g<h;g++){let y=o[g];if(g<l&&n===y||g>=l&&y.type===n)return g}if(i){let g=o[l];if(g&&Hi(g)&&g.type===n)return l}return null}function xa(t,e,n,r){let i=t[n],s=e.data;if(zU(i)){let o=i;o.resolving&&jj(Lj(s[n]));let a=LD(o.canSeeViewProviders);o.resolving=!0;let l,c=o.injectImpl?kn(o.injectImpl):null,u=US(t,r,ve.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&HU(n,s[n],e)}finally{c!==null&&kn(c),LD(a),o.resolving=!1,qS()}}return i}function eB(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(Ic)?t[Ic]:void 0;return typeof e=="number"?e>=0?e&QS:tB:e}function jD(t,e,n){let r=1<<t;return!!(n[e+(t>>YS)]&r)}function UD(t,e){return!(t&ve.Self)&&!(t&ve.Host&&e)}var zs=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return eA(this._tNode,this._lView,e,Hf(r),n)}};function tB(){return new zs(Vn(),Be())}function eo(t){return Fc(()=>{let e=t.prototype.constructor,n=e[yf]||Xy(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[yf]||Xy(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Xy(t){return oS(t)?()=>{let e=Xy(tn(t));return e&&e()}:Ia(t)}function nB(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[ce]&2048&&!(o[ce]&512);){let a=tA(s,o,n,r|ve.Self,Ir);if(a!==Ir)return a;let l=s.parent;if(!l){let c=o[xS];if(c){let u=c.get(n,Ir,r);if(u!==Ir)return u}l=nA(o),o=o[Aa]}s=l}return i}function nA(t){let e=t[Ce],n=e.type;return n===2?e.declTNode:n===1?t[ir]:null}var cf="__parameters__";function rB(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function rA(t,e,n){return Fc(()=>{let r=rB(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(l,c,u){let d=l.hasOwnProperty(cf)?l[cf]:Object.defineProperty(l,cf,{value:[]})[cf];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),l}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}function iB(t){let e=vn.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function sB(t){return typeof t=="function"}function qv(t,e){t.forEach(n=>Array.isArray(n)?qv(n,e):e(n))}function iA(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Df(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function oB(t,e){let n=[];for(let r=0;r<t;r++)n.push(e);return n}function aB(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let s=i-2;t[i]=t[s],i--}t[e]=n,t[e+1]=r}}function zv(t,e,n){let r=Lc(t,e);return r>=0?t[r|1]=n:(r=~r,aB(t,r,e,n)),r}function Ny(t,e){let n=Lc(t,e);if(n>=0)return t[n|1]}function Lc(t,e){return lB(t,e,1)}function lB(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}var Ma=pS(rA("Optional"),8);var Gv=pS(rA("SkipSelf"),4);function cB(t){let e=[],n=new Map;function r(i){let s=n.get(i);if(!s){let o=t(i);n.set(i,s=o.then(fB))}return s}return Sf.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(c=>{i.template=c}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let c=i.styles.length,u=i.styleUrls;i.styleUrls.forEach((d,h)=>{a.push(""),o.push(r(d).then(g=>{a[c+h]=g,u.splice(u.indexOf(d),1),u.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(c=>{a.push(c),i.styleUrl=void 0}));let l=Promise.all(o).then(()=>pB(s));e.push(l)}),dB(),Promise.all(e).then(()=>{})}var Sf=new Map,uB=new Set;function dB(){let t=Sf;return Sf=new Map,t}function hB(){return Sf.size===0}function fB(t){return typeof t=="string"?t:t.text()}function pB(t){uB.delete(t)}var jc=new L("ENVIRONMENT_INITIALIZER"),sA=new L("INJECTOR",-1),oA=new L("INJECTOR_DEF_TYPES"),Af=class{get(e,n=Dc){if(n===Dc){let r=new Error(`NullInjectorError: No provider for ${Wt(e)}!`);throw r.name="NullInjectorError",r}return n}};function Kf(t){return{\u0275providers:t}}function gB(...t){return{\u0275providers:aA(!0,t),\u0275fromNgModule:!0}}function aA(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return qv(e,o=>{let a=o;ev(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&lA(i,s),n}function lA(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];Wv(i,s=>{e(s,r)})}}function ev(t,e,n,r){if(t=tn(t),!t)return!1;let i=null,s=SD(t),o=!s&&$i(t);if(!s&&!o){let l=t.ngModule;if(s=SD(l),s)i=l;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let l=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let c of l)ev(c,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let c;try{qv(s.imports,u=>{ev(u,e,n,r)&&(c||=[],c.push(u))})}finally{}c!==void 0&&lA(c,e)}if(!a){let c=Ia(i)||(()=>new i);e({provide:i,useFactory:c,deps:mn},i),e({provide:oA,useValue:i,multi:!0},i),e({provide:jc,useValue:()=>x(i),multi:!0},i)}let l=s.providers;if(l!=null&&!a){let c=t;Wv(l,u=>{e(u,c)})}}else return!1;return i!==t&&t.providers!==void 0}function Wv(t,e){for(let n of t)aS(n)&&(n=n.\u0275providers),Array.isArray(n)?Wv(n,e):e(n)}var mB=Ue({provide:String,useValue:Ue});function cA(t){return t!==null&&typeof t=="object"&&mB in t}function _B(t){return!!(t&&t.useExisting)}function yB(t){return!!(t&&t.useFactory)}function Ta(t){return typeof t=="function"}function vB(t){return!!t.useClass}var Qf=new L("Set Injector scope."),gf={},wB={},ky;function Kv(){return ky===void 0&&(ky=new Af),ky}var nn=class{},Rc=class extends nn{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,nv(e,o=>this.processProvider(o)),this.records.set(sA,ga(void 0,this)),i.has("environment")&&this.records.set(nn,ga(void 0,this));let s=this.records.get(Qf);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(oA,mn,ve.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(let n of this._ngOnDestroyHooks)n.ngOnDestroy();let e=this._onDestroyHooks;this._onDestroyHooks=[];for(let n of e)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=ji(this),r=kn(void 0),i;try{return e()}finally{ji(n),kn(r)}}get(e,n=Dc,r=ve.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(TD))return e[TD](this);r=Hf(r);let i,s=ji(this),o=kn(void 0);try{if(!(r&ve.SkipSelf)){let l=this.records.get(e);if(l===void 0){let c=xB(e)&&$f(e);c&&this.injectableDefInScope(c)?l=ga(tv(e),gf):l=null,this.records.set(e,l)}if(l!=null)return this.hydrate(e,l)}let a=r&ve.Self?Kv():this.parent;return n=r&ve.Optional&&n===Dc?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[vf]=a[vf]||[]).unshift(Wt(e)),s)throw a;return Jj(a,e,"R3InjectorError",this.source)}else throw a}finally{kn(o),ji(s)}}resolveInjectorInitializers(){let e=ji(this),n=kn(void 0),r;try{let i=this.get(jc,mn,ve.Self);for(let s of i)s()}finally{ji(e),kn(n)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(Wt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Q(205,!1)}processProvider(e){e=tn(e);let n=Ta(e)?e:tn(e&&e.provide),r=CB(e);if(!Ta(e)&&e.multi===!0){let i=this.records.get(n);i||(i=ga(void 0,gf,!0),i.factory=()=>Wy(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}else{let i=this.records.get(n)}this.records.set(n,r)}hydrate(e,n){return n.value===gf&&(n.value=wB,n.value=n.factory()),typeof n.value=="object"&&n.value&&IB(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;let n=tn(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function tv(t){let e=$f(t),n=e!==null?e.factory:Ia(t);if(n!==null)return n;if(t instanceof L)throw new Q(204,!1);if(t instanceof Function)return EB(t);throw new Q(204,!1)}function EB(t){let e=t.length;if(e>0){let r=oB(e,"?");throw new Q(204,!1)}let n=$j(t);return n!==null?()=>n.factory(t):()=>new t}function CB(t){if(cA(t))return ga(void 0,t.useValue);{let e=uA(t);return ga(e,gf)}}function uA(t,e,n){let r;if(Ta(t)){let i=tn(t);return Ia(i)||tv(i)}else if(cA(t))r=()=>tn(t.useValue);else if(yB(t))r=()=>t.useFactory(...Wy(t.deps||[]));else if(_B(t))r=()=>x(tn(t.useExisting));else{let i=tn(t&&(t.useClass||t.provide));if(bB(t))r=()=>new i(...Wy(t.deps));else return Ia(i)||tv(i)}return r}function ga(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function bB(t){return!!t.deps}function IB(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function xB(t){return typeof t=="function"||typeof t=="object"&&t instanceof L}function nv(t,e){for(let n of t)Array.isArray(n)?nv(n,e):n&&aS(n)?nv(n.\u0275providers,e):e(n)}function Ar(t,e){t instanceof Rc&&t.assertNotDestroyed();let n,r=ji(t),i=kn(void 0);try{return e()}finally{ji(r),kn(i)}}function TB(t){if(!hS()&&!Kj())throw new Q(-203,!1)}function BD(t,e=null,n=null,r){let i=dA(t,e,n,r);return i.resolveInjectorInitializers(),i}function dA(t,e=null,n=null,r,i=new Set){let s=[n||mn,gB(t)];return r=r||(typeof t=="object"?void 0:Wt(t)),new Rc(s,e||Kv(),r||null,i)}var Ln=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return BD({name:""},i,r,"");{let s=r.name??"";return BD({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=Dc,e.NULL=new Af,e.\u0275prov=z({token:e,providedIn:"any",factory:()=>x(sA)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})();var rv;function hA(t){rv=t}function DB(){if(rv!==void 0)return rv;if(typeof document<"u")return document;throw new Q(210,!1)}var Yf=new L("AppId",{providedIn:"root",factory:()=>SB}),SB="ng",Qv=new L("Platform Initializer"),St=new L("Platform ID",{providedIn:"platform",factory:()=>"unknown"});var Yv=new L("CSP nonce",{providedIn:"root",factory:()=>DB().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function fA(t){return t instanceof Function?t():t}function AB(t){return(t??q(Ln)).get(St)==="browser"}function pA(t){return(t.flags&128)===128}var ui=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(ui||{});var gA=new Map,MB=0;function PB(){return MB++}function RB(t){gA.set(t[zf],t)}function NB(t){gA.delete(t[zf])}var $D="__ngContext__";function Ys(t,e){Bi(e)?(t[$D]=e[zf],RB(e)):t[$D]=e}var kB;function Jv(t,e){return kB(t,e)}function Zv(t){let e=t[Tt];return rr(e)?e[Tt]:e}function mA(t){return yA(t[Mc])}function _A(t){return yA(t[tr])}function yA(t){for(;t!==null&&!rr(t);)t=t[tr];return t}function ma(t,e,n,r,i){if(r!=null){let s,o=!1;rr(r)?s=r:Bi(r)&&(o=!0,r=r[hi]);let a=Dr(r);t===0&&n!==null?i==null?EA(e,n,a):Pf(e,n,a,i||null,!0):t===1&&n!==null?Pf(e,n,a,i||null,!0):t===2?ZB(e,a,o):t===3&&e.destroyNode(a),s!=null&&e4(e,t,s,n,i)}}function OB(t,e){return t.createText(e)}function FB(t,e,n){t.setValue(e,n)}function vA(t,e,n){return t.createElement(e,n)}function VB(t,e){let n=e[Dt];Uc(t,e,n,2,null,null),e[hi]=null,e[ir]=null}function LB(t,e,n,r,i,s){r[hi]=i,r[ir]=e,Uc(t,r,n,1,i,s)}function jB(t,e){Uc(t,e,e[Dt],2,null,null)}function UB(t){let e=t[Mc];if(!e)return Oy(t[Ce],t);for(;e;){let n=null;if(Bi(e))n=e[Mc];else{let r=e[wn];r&&(n=r)}if(!n){for(;e&&!e[tr]&&e!==t;)Bi(e)&&Oy(e[Ce],e),e=e[Tt];e===null&&(e=t),Bi(e)&&Oy(e[Ce],e),n=e&&e[tr]}e=n}}function BB(t,e,n,r){let i=wn+r,s=n.length;r>0&&(n[i-1][tr]=e),r<s-wn?(e[tr]=n[i],iA(n,wn+r,e)):(n.push(e),e[tr]=null),e[Tt]=n;let o=e[qf];o!==null&&n!==o&&$B(o,e);let a=e[Pc];a!==null&&a.insertView(t),kS(e),e[ce]|=128}function $B(t,e){let n=t[Cf],i=e[Tt][Tt][Tr];e[Tr]!==i&&(t[ce]|=ba.HasTransplantedViews),n===null?t[Cf]=[e]:n.push(e)}function wA(t,e){let n=t[Cf],r=n.indexOf(e),i=e[Tt];n.splice(r,1)}function Mf(t,e){if(t.length<=wn)return;let n=wn+e,r=t[n];if(r){let i=r[qf];i!==null&&i!==t&&wA(i,r),e>0&&(t[n-1][tr]=r[tr]);let s=Df(t,wn+e);VB(r[Ce],r);let o=s[Pc];o!==null&&o.detachView(s[Ce]),r[Tt]=null,r[tr]=null,r[ce]&=-129}return r}function Xv(t,e){if(!(e[ce]&256)){let n=e[Dt];n.destroyNode&&Uc(t,e,n,3,null,null),UB(e)}}function Oy(t,e){if(!(e[ce]&256)){e[ce]&=-129,e[ce]|=256,e[Gs]&&iD(e[Gs]),qB(t,e),HB(t,e),e[Ce].type===1&&e[Dt].destroy();let n=e[qf];if(n!==null&&rr(e[Tt])){n!==e[Tt]&&wA(n,e);let r=e[Pc];r!==null&&r.detachView(t)}NB(e)}}function HB(t,e){let n=t.cleanup,r=e[Ac];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[Ac]=null);let i=e[Ui];if(i!==null){e[Ui]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function qB(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof Qs)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],l=s[o+1];br(4,a,l);try{l.call(a)}finally{br(5,a,l)}}else{br(4,i,s);try{s.call(i)}finally{br(5,i,s)}}}}}function zB(t,e,n){return GB(t,e.parent,n)}function GB(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[hi];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===xr.None||s===xr.Emulated)return null}return sr(r,n)}}function Pf(t,e,n,r,i){t.insertBefore(e,n,r,i)}function EA(t,e,n){t.appendChild(e,n)}function HD(t,e,n,r,i){r!==null?Pf(t,e,n,r,i):EA(t,e,n)}function WB(t,e,n,r){t.removeChild(e,n,r)}function e0(t,e){return t.parentNode(e)}function KB(t,e){return t.nextSibling(e)}function QB(t,e,n){return JB(t,e,n)}function YB(t,e,n){return t.type&40?sr(t,n):null}var JB=YB,qD;function t0(t,e,n,r){let i=zB(t,r,e),s=e[Dt],o=r.parent||e[ir],a=QB(o,r,e);if(i!=null)if(Array.isArray(n))for(let l=0;l<n.length;l++)HD(s,i,n[l],a,!1);else HD(s,i,n,a,!1);qD!==void 0&&qD(s,r,e,n,i)}function mf(t,e){if(e!==null){let n=e.type;if(n&3)return sr(e,t);if(n&4)return iv(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return mf(t,r);{let i=t[e.index];return rr(i)?iv(-1,i):Dr(i)}}else{if(n&32)return Jv(e,t)()||Dr(t[e.index]);{let r=CA(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Zv(t[Tr]);return mf(i,r)}else return mf(t,e.next)}}}return null}function CA(t,e){if(e!==null){let r=t[Tr][ir],i=e.projection;return r.projection[i]}return null}function iv(t,e){let n=wn+t+1;if(n<e.length){let r=e[n],i=r[Ce].firstChild;if(i!==null)return mf(r,i)}return e[Ws]}function ZB(t,e,n){let r=e0(t,e);r&&WB(t,r,e,n)}function n0(t,e,n,r,i,s,o){for(;n!=null;){let a=r[n.index],l=n.type;if(o&&e===0&&(a&&Ys(Dr(a),r),n.flags|=2),(n.flags&32)!==32)if(l&8)n0(t,e,n.child,r,i,s,!1),ma(e,t,i,a,s);else if(l&32){let c=Jv(n,r),u;for(;u=c();)ma(e,t,i,u,s);ma(e,t,i,a,s)}else l&16?XB(t,e,r,n,i,s):ma(e,t,i,a,s);n=o?n.projectionNext:n.next}}function Uc(t,e,n,r,i,s){n0(n,r,t.firstChild,e,i,s,!1)}function XB(t,e,n,r,i,s){let o=n[Tr],l=o[ir].projection[r.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++){let u=l[c];ma(e,t,i,u,s)}else{let c=l,u=o[Tt];pA(r)&&(c.flags|=128),n0(t,e,c,u,i,s,!0)}}function e4(t,e,n,r,i){let s=n[Ws],o=Dr(n);s!==o&&ma(e,t,r,s,i);for(let a=wn;a<n.length;a++){let l=n[a];Uc(l[Ce],l,t,e,r,s)}}function t4(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=r.indexOf("-")===-1?void 0:ui.DashCase;i==null?t.removeStyle(n,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=ui.Important),t.setStyle(n,r,i,s))}}function n4(t,e,n){t.setAttribute(e,"style",n)}function bA(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function IA(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&Ky(t,e,r),i!==null&&bA(t,e,i),s!==null&&n4(t,e,s)}var Rf=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${lS})`}};function Bc(t){return t instanceof Rf?t.changingThisBreaksApplicationSecurity:t}function xA(t,e){let n=r4(t);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${lS})`)}return n===e}function r4(t){return t instanceof Rf&&t.getTypeName()||null}var i4=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function TA(t){return t=String(t),t.match(i4)?t:"unsafe:"+t}var r0=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(r0||{});function Qe(t){let e=s4();return e?e.sanitize(r0.URL,t)||"":xA(t,"URL")?Bc(t):TA(Tc(t))}function s4(){let t=Be();return t&&t[Ca].sanitizer}var o4="h",a4="b";var l4=(t,e,n)=>null;function i0(t,e,n=!1){return l4(t,e,n)}var sv=class{},Nf=class{};function c4(t){let e=Error(`No component factory found for ${Wt(t)}.`);return e[u4]=t,e}var u4="ngComponent";var ov=class{resolveComponentFactory(e){throw c4(e)}},Jf=(()=>{let e=class e{};e.NULL=new ov;let t=e;return t})();function d4(){return Zf(Vn(),Be())}function Zf(t,e){return new fi(sr(t,e))}var fi=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=d4;let t=e;return t})();var Nc=class{},Qi=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>h4();let t=e;return t})();function h4(){let t=Be(),e=Vn(),n=Wi(e.index,t);return(Bi(n)?n:t)[Dt]}var f4=(()=>{let e=class e{};e.\u0275prov=z({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),di=class{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}},s0=new di("17.0.7"),Fy={};function DA(t){return g4(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function p4(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{let n=t[Symbol.iterator](),r;for(;!(r=n.next()).done;)e(r.value)}}function g4(t){return t!==null&&(typeof t=="function"||typeof t=="object")}var av=class{constructor(){}supports(e){return DA(e)}create(e){return new lv(e)}},m4=(t,e)=>e,lv=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||m4}forEachItem(e){let n;for(n=this._itHead;n!==null;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,s=null;for(;n||r;){let o=!r||n&&n.currentIndex<zD(r,i,s)?n:r,a=zD(o,i,s),l=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(n=n._next,o.previousIndex==null)i++;else{s||(s=[]);let c=a-i,u=l-i;if(c!=u){for(let h=0;h<c;h++){let g=h<s.length?s[h]:s[h]=0,y=g+h;u<=y&&y<c&&(s[h]=g+1)}let d=o.previousIndex;s[d]=u-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)e(n)}diff(e){if(e==null&&(e=[]),!DA(e))throw new Q(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,s,o,a),r=!0):(r&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)),n=n._next}else i=0,p4(e,a=>{o=this._trackByFn(i,a),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,a,o,i),r=!0):(r&&(n=this._verifyReinsertion(n,a,o,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,i)):e=this._addAfter(new cv(n,r),s,i)),e}_verifyReinsertion(e,n,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let n=e._next;this._addToRemovals(this._unlink(e)),e=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){let i=n===null?this._itHead:n._next;return e._next=i,e._prev=n,i===null?this._itTail=e:i._prev=e,n===null?this._itHead=e:n._next=e,this._linkedRecords===null&&(this._linkedRecords=new kf),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let n=e._prev,r=e._next;return n===null?this._itHead=r:n._next=r,r===null?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new kf),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},cv=class{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},uv=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;r!==null;r=r._nextDup)if((n===null||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let n=e._prevDup,r=e._nextDup;return n===null?this._head=r:n._nextDup=r,r===null?this._tail=n:r._prevDup=n,this._head===null}},kf=class{constructor(){this.map=new Map}put(e){let n=e.trackById,r=this.map.get(n);r||(r=new uv,this.map.set(n,r)),r.add(e)}get(e,n){let r=e,i=this.map.get(r);return i?i.get(e,n):null}remove(e){let n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function zD(t,e,n){let r=t.previousIndex;if(r===null)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}function GD(){return new o0([new av])}var o0=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||GD()),deps:[[e,new Gv,new Ma]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new Q(901,!1)}};e.\u0275prov=z({token:e,providedIn:"root",factory:GD});let t=e;return t})();function Of(t,e,n,r,i=!1){for(;n!==null;){let s=e[n.index];s!==null&&r.push(Dr(s)),rr(s)&&_4(s,r);let o=n.type;if(o&8)Of(t,e,n.child,r);else if(o&32){let a=Jv(n,e),l;for(;l=a();)r.push(l)}else if(o&16){let a=CA(e,n);if(Array.isArray(a))r.push(...a);else{let l=Zv(e[Tr]);Of(l[Ce],l,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function _4(t,e){for(let n=wn;n<t.length;n++){let r=t[n],i=r[Ce].firstChild;i!==null&&Of(r[Ce],r,i,e)}t[Ws]!==t[hi]&&e.push(t[Ws])}var SA=[];function y4(t){return t[Gs]??v4(t)}function v4(t){let e=SA.pop()??Object.create(E4);return e.lView=t,e}function w4(t){t.lView[Gs]!==t&&(t.lView=null,SA.push(t))}var E4=Pe(j({},tD),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{Wf(t.lView)},consumerOnSignalRead(){this.lView[Gs]=this}}),C4="ngOriginalError";function Vy(t){return t[C4]}var Sr=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&Vy(e);for(;n&&Vy(n);)n=Vy(n);return n||null}},AA=new L("",{providedIn:"root",factory:()=>q(Sr).handleError.bind(void 0)});var MA=!1,b4=new L("",{providedIn:"root",factory:()=>MA});var or={};function _(t){PA(Fn(),Be(),Ki()+t,!1)}function PA(t,e,n,r){if(!r)if((e[ce]&3)===3){let s=t.preOrderCheckHooks;s!==null&&ff(e,s,n)}else{let s=t.preOrderHooks;s!==null&&pf(e,s,0,n)}Ks(n)}function W(t,e=ve.Default){let n=Be();if(n===null)return x(t,e);let r=Vn();return eA(r,n,tn(t),e)}function RA(){let t="invalid";throw new Error(t)}function I4(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)Ks(~i);else{let s=i,o=n[++r],a=n[++r];VU(o,s);let l=e[s];a(2,l)}}}finally{Ks(-1)}}function Xf(t,e,n,r,i,s,o,a,l,c,u){let d=e.blueprint.slice();return d[hi]=i,d[ce]=r|4|128|8,(c!==null||t&&t[ce]&2048)&&(d[ce]|=2048),RS(d),d[Tt]=d[Aa]=t,d[On]=n,d[Ca]=o||t&&t[Ca],d[Dt]=a||t&&t[Dt],d[Ea]=l||t&&t[Ea]||null,d[ir]=s,d[zf]=PB(),d[wf]=u,d[xS]=c,d[Tr]=e.type==2?t[Tr]:d,d}function ep(t,e,n,r,i){let s=t.data[e];if(s===null)s=x4(t,e,n,r,i),FU()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=PU();s.injectorIndex=o===null?-1:o.injectorIndex}return Vc(s,!0),s}function x4(t,e,n,r,i){let s=VS(),o=LS(),a=o?s:s&&s.parent,l=t.data[e]=M4(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=l),s!==null&&(o?s.child==null&&l.parent!==null&&(s.child=l):s.next===null&&(s.next=l,l.prev=s)),l}function NA(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function kA(t,e,n,r,i){let s=Ki(),o=r&2;try{Ks(-1),o&&e.length>nr&&PA(t,e,nr,!1),br(o?2:0,i),n(r,i)}finally{Ks(s),br(o?3:1,i)}}function OA(t,e,n){if(DS(e)){let r=en(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];a.contentQueries&&a.contentQueries(1,n[o],o)}}finally{en(r)}}}function FA(t,e,n){FS()&&(F4(t,e,n,sr(n,e)),(n.flags&64)===64&&$A(t,e,n))}function VA(t,e,n=sr){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function LA(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=a0(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function a0(t,e,n,r,i,s,o,a,l,c,u){let d=nr+r,h=d+i,g=T4(d,h),y=typeof c=="function"?c():c;return g[Ce]={type:t,blueprint:g,template:n,queries:null,viewQuery:a,declTNode:e,data:g.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:l,consts:y,incompleteFirstPass:!1,ssrId:u}}function T4(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:or);return n}function D4(t,e,n,r){let s=r.get(b4,MA)||n===xr.ShadowDom,o=t.selectRootElement(e,s);return S4(o),o}function S4(t){A4(t)}var A4=t=>null;function M4(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return SU()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function WD(t,e,n,r){for(let i in t)if(t.hasOwnProperty(i)){n=n===null?{}:n;let s=t[i];r===null?KD(n,e,i,s):r.hasOwnProperty(i)&&KD(n,e,r[i],s)}return n}function KD(t,e,n,r){t.hasOwnProperty(n)?t[n].push(e,r):t[n]=[e,r]}function P4(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],l=null,c=null;for(let u=r;u<i;u++){let d=s[u],h=n?n.get(d):null,g=h?h.inputs:null,y=h?h.outputs:null;l=WD(d.inputs,u,l,g),c=WD(d.outputs,u,c,y);let w=l!==null&&o!==null&&!yS(e)?z4(l,u,o):null;a.push(w)}l!==null&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}function R4(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function jA(t,e,n,r,i,s,o,a){let l=sr(e,n),c=e.inputs,u;!a&&c!=null&&(u=c[r])?(l0(t,n,u,r,i),Gf(e)&&N4(n,e.index)):e.type&3?(r=R4(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(l,r,i)):e.type&12}function N4(t,e){let n=Wi(e,t);n[ce]&16||(n[ce]|=64)}function UA(t,e,n,r){if(FS()){let i=r===null?null:{"":-1},s=L4(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&BA(t,e,n,o,i,a),i&&j4(n,r,i)}n.mergedAttrs=Sc(n.mergedAttrs,n.attrs)}function BA(t,e,n,r,i,s){for(let c=0;c<r.length;c++)Zy(Tf(n,e),t,r[c].type);B4(n,t.data.length,r.length);for(let c=0;c<r.length;c++){let u=r[c];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,l=NA(t,e,r.length,null);for(let c=0;c<r.length;c++){let u=r[c];n.mergedAttrs=Sc(n.mergedAttrs,u.hostAttrs),$4(t,n,e,l,u),U4(l,u,i),u.contentQueries!==null&&(n.flags|=4),(u.hostBindings!==null||u.hostAttrs!==null||u.hostVars!==0)&&(n.flags|=64);let d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),l++}P4(t,n,s)}function k4(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;O4(o)!=a&&o.push(a),o.push(n,r,s)}}function O4(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function F4(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;Gf(n)&&H4(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||Tf(n,e),Ys(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let l=t.data[a],c=xa(e,t,a,n);if(Ys(c,e),o!==null&&q4(e,a-i,c,l,n,o),Hi(l)){let u=Wi(n.index,e);u[On]=xa(e,t,a,n)}}}function $A(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=LU();try{Ks(s);for(let a=r;a<i;a++){let l=t.data[a],c=e[a];Yy(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&V4(l,c)}}finally{Ks(-1),Yy(o)}}function V4(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function L4(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(sU(e,o.selectors,!1))if(r||(r=[]),Hi(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let l=a.length;dv(t,e,l)}else r.unshift(o),dv(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function dv(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function j4(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new Q(-301,!1);r.push(e[i],s)}}}function U4(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;Hi(e)&&(n[""]=t)}}function B4(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function $4(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=Ia(i.type,!0)),o=new Qs(s,Hi(i),W);t.blueprint[r]=o,n[r]=o,k4(t,e,r,NA(t,n,i.hostVars,or),i)}function H4(t,e,n){let r=sr(e,t),i=LA(n),s=t[Ca].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=tp(t,Xf(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function q4(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let l=o[a++],c=o[a++],u=o[a++];HA(r,n,l,c,u)}}function HA(t,e,n,r,i){let s=en(null);try{let o=t.inputTransforms;o!==null&&o.hasOwnProperty(r)&&(i=o[r].call(e,i)),t.setInput!==null?t.setInput(e,i,n,r):e[r]=i}finally{en(s)}}function z4(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){r.push(s,o[a+1],n[i+1]);break}}i+=2}return r}function qA(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function zA(t,e){let n=t.contentQueries;if(n!==null){let r=en(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];jS(s),a.contentQueries(2,e[o],o)}}}finally{en(r)}}}function tp(t,e){return t[Mc]?t[OD][tr]=e:t[Mc]=e,t[OD]=e,e}function hv(t,e,n){jS(0);let r=en(null);try{e(t,n)}finally{en(r)}}function G4(t){return t[Ac]||(t[Ac]=[])}function W4(t){return t.cleanup||(t.cleanup=[])}function GA(t,e){let n=t[Ea],r=n?n.get(Sr,null):null;r&&r.handleError(e)}function l0(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],l=e[o],c=t.data[o];HA(c,l,r,a,i)}}function WA(t,e,n){let r=PS(e,t);FB(t[Dt],r,n)}var K4=100;function Q4(t,e=!0){let n=t[Ca],r=n.rendererFactory,i=n.afterRenderEventManager,s=!1;s||(r.begin?.(),i?.begin());try{Y4(t)}catch(o){throw e&&GA(t,o),o}finally{s||(r.end?.(),n.inlineEffectRunner?.flush(),i?.end())}}function Y4(t){fv(t,0);let e=0;for(;NS(t);){if(e===K4)throw new Q(103,!1);e++,fv(t,1)}}function J4(t,e,n,r){let i=e[ce];if((i&256)===256)return;let s=!1;!s&&e[Ca].inlineEffectRunner?.flush(),Lv(e);let o=null,a=null;!s&&Z4(t)&&(a=y4(e),o=nD(a));try{RS(e),OU(t.bindingStartIndex),n!==null&&kA(t,e,n,2,r);let l=(i&3)===3;if(!s)if(l){let d=t.preOrderCheckHooks;d!==null&&ff(e,d,null)}else{let d=t.preOrderHooks;d!==null&&pf(e,d,0,null),Py(e,0)}if(X4(e),KA(e,0),t.contentQueries!==null&&zA(t,e),!s)if(l){let d=t.contentCheckHooks;d!==null&&ff(e,d)}else{let d=t.contentHooks;d!==null&&pf(e,d,1),Py(e,1)}I4(t,e);let c=t.components;c!==null&&YA(e,c,0);let u=t.viewQuery;if(u!==null&&hv(2,u,r),!s)if(l){let d=t.viewCheckHooks;d!==null&&ff(e,d)}else{let d=t.viewHooks;d!==null&&pf(e,d,2),Py(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[My]){for(let d of e[My])d();e[My]=null}s||(e[ce]&=-73)}catch(l){throw Wf(e),l}finally{a!==null&&(rD(a,o),w4(a)),jv()}}function Z4(t){return t.type!==2}function KA(t,e){for(let n=mA(t);n!==null;n=_A(n)){n[ce]&=~ba.HasChildViewsToRefresh;for(let r=wn;r<n.length;r++){let i=n[r];QA(i,e)}}}function X4(t){for(let e=mA(t);e!==null;e=_A(e)){if(!(e[ce]&ba.HasTransplantedViews))continue;let n=e[Cf];for(let r=0;r<n.length;r++){let i=n[r],s=i[Tt];CU(i)}}}function e3(t,e,n){let r=Wi(e,t);QA(r,n)}function QA(t,e){Ov(t)&&fv(t,e)}function fv(t,e){let r=t[Ce],i=t[ce],s=t[Gs],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&ay(s)),s&&(s.dirty=!1),t[ce]&=-9217,o)J4(r,t,r.template,t[On]);else if(i&8192){KA(t,1);let a=r.components;a!==null&&YA(t,a,1)}}function YA(t,e,n){for(let r=0;r<e.length;r++)e3(t,e[r],n)}function c0(t){for(;t;){t[ce]|=64;let e=Zv(t);if(pU(t)&&!e)return t;t=e}return null}var Js=class{get rootNodes(){let e=this._lView,n=e[Ce];return Of(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[On]}set context(e){this._lView[On]=e}get destroyed(){return(this._lView[ce]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Tt];if(rr(e)){let n=e[Ef],r=n?n.indexOf(this):-1;r>-1&&(Mf(e,r),Df(n,r))}this._attachedToViewContainer=!1}Xv(this._lView[Ce],this._lView)}onDestroy(e){OS(this._lView,e)}markForCheck(){c0(this._cdRefInjectingView||this._lView)}detach(){this._lView[ce]&=-129}reattach(){kS(this._lView),this._lView[ce]|=128}detectChanges(){this._lView[ce]|=1024,Q4(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Q(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,jB(this._lView[Ce],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Q(902,!1);this._appRef=e}},to=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=t3;let t=e;return t})();function t3(t){return n3(Vn(),Be(),(t&16)===16)}function n3(t,e,n){if(Gf(t)&&!n){let r=Wi(t.index,e);return new Js(r,r)}else if(t.type&47){let r=e[Tr];return new Js(r,e)}return null}var JA=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=r3,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),pv=class extends JA{constructor(e){super(),this._lView=e}onDestroy(e){return OS(this._lView,e),()=>IU(this._lView,e)}};function r3(){return new pv(Be())}var QD=new Set;function $c(t){QD.has(t)||(QD.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}var gv=class extends ut{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let l=e;i=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=Ly(s),i&&(i=Ly(i)),o&&(o=Ly(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof mt&&e.add(a),a}};function Ly(t){return e=>{setTimeout(t,void 0,e)}}var st=gv;function YD(...t){}function i3(){let t=typeof vn.requestAnimationFrame=="function",e=vn[t?"requestAnimationFrame":"setTimeout"],n=vn[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var me=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new st(!1),this.onMicrotaskEmpty=new st(!1),this.onStable=new st(!1),this.onError=new st(!1),typeof Zone>"u")throw new Q(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=i3().nativeRequestAnimationFrame,a3(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new Q(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new Q(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,s3,YD,YD);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},s3={};function u0(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function o3(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(vn,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,mv(t),t.isCheckStableRunning=!0,u0(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),mv(t))}function a3(t){let e=()=>{o3(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(l3(a))return n.invokeTask(i,s,o,a);try{return JD(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),ZD(t)}},onInvoke:(n,r,i,s,o,a,l)=>{try{return JD(t),n.invoke(i,s,o,a,l)}finally{t.shouldCoalesceRunChangeDetection&&e(),ZD(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,mv(t),u0(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function mv(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function JD(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function ZD(t){t._nesting--,u0(t)}var _v=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new st,this.onMicrotaskEmpty=new st,this.onStable=new st,this.onError=new st}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}},ZA=new L("",{providedIn:"root",factory:XA});function XA(){let t=q(me),e=!0,n=new oe(i=>{e=t.isStable&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks,t.runOutsideAngular(()=>{i.next(e),i.complete()})}),r=new oe(i=>{let s;t.runOutsideAngular(()=>{s=t.onStable.subscribe(()=>{me.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks&&(e=!0,i.next(!0))})})});let o=t.onUnstable.subscribe(()=>{me.assertInAngularZone(),e&&(e=!1,t.runOutsideAngular(()=>{i.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}});return Oi(n,r.pipe(Hs()))}function l3(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}function c3(t="zone.js",e){return t==="noop"?new _v:t==="zone.js"?new me(e):t}var _a=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(_a||{}),u3={destroy(){}};function d0(t,e){!e&&TB(d0);let n=e?.injector??q(Ln);if(!AB(n))return u3;$c("NgAfterNextRender");let r=n.get(e1),i=r.handler??=new vv,s=e?.phase??_a.MixedReadWrite,o=()=>{i.unregister(l),a()},a=n.get(JA).onDestroy(o),l=new yv(n,s,()=>{o(),t()});return i.register(l),{destroy:o}}var yv=class{constructor(e,n,r){this.phase=n,this.callbackFn=r,this.zone=e.get(me),this.errorHandler=e.get(Sr,null,{optional:!0})}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},vv=class{constructor(){this.executingCallbacks=!1,this.buckets={[_a.EarlyRead]:new Set,[_a.Write]:new Set,[_a.MixedReadWrite]:new Set,[_a.Read]:new Set},this.deferredCallbacks=new Set}validateBegin(){if(this.executingCallbacks)throw new Q(102,!1)}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let n of e)n.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},e1=(()=>{let e=class e{constructor(){this.renderDepth=0,this.handler=null,this.internalCallbacks=[]}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){if(this.renderDepth--,this.renderDepth===0){for(let r of this.internalCallbacks)r();this.internalCallbacks.length=0,this.handler?.execute()}}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=z({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function d3(t,e){let n=Wi(e,t),r=n[Ce];h3(r,n);let i=n[hi];i!==null&&n[wf]===null&&(n[wf]=i0(i,n[Ea])),h0(r,n,n[On])}function h3(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function h0(t,e,n){Lv(e);try{let r=t.viewQuery;r!==null&&hv(1,r,n);let i=t.template;i!==null&&kA(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&zA(t,e),t.staticViewQueries&&hv(2,t.viewQuery,n);let s=t.components;s!==null&&f3(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[ce]&=-5,jv()}}function f3(t,e){for(let n=0;n<e.length;n++)d3(t,e[n])}function wv(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=qy(i,a);else if(s==2){let l=a,c=e[++o];r=qy(r,l+": "+c+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var Ff=class extends Jf{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=$i(e);return new Da(n,this.ngModule)}};function XD(t){let e=[];for(let n in t)if(t.hasOwnProperty(n)){let r=t[n];e.push({propName:r,templateName:n})}return e}function p3(t){let e=t.toLowerCase();return e==="svg"?yU:e==="math"?vU:null}var Ev=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=Hf(r);let i=this.injector.get(e,Fy,r);return i!==Fy||n===Fy?i:this.parentInjector.get(e,n,r)}},Da=class extends Nf{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=XD(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return XD(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=cU(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){i=i||this.ngModule;let s=i instanceof nn?i:i?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let o=s?new Ev(e,s):e,a=o.get(Nc,null);if(a===null)throw new Q(407,!1);let l=o.get(f4,null),c=o.get(e1,null),u={rendererFactory:a,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:c},d=a.createRenderer(null,this.componentDef),h=this.componentDef.selectors[0][0]||"div",g=r?D4(d,r,this.componentDef.encapsulation,o):vA(d,h,p3(h)),y=4608,w=this.componentDef.onPush?576:528,v=this.componentDef.signals?y:w,T=null;g!==null&&(T=i0(g,o,!0));let V=a0(0,null,null,1,0,null,null,null,null,null,null),P=Xf(null,V,null,v,null,null,u,d,o,null,T);Lv(P);let F,X;try{let ne=this.componentDef,De,pt=null;ne.findHostDirectiveDefs?(De=[],pt=new Map,ne.findHostDirectiveDefs(ne,De,pt),De.push(ne)):De=[ne];let Vs=g3(P,g),Th=m3(Vs,g,ne,De,P,u,d);X=kv(V,nr),g&&v3(d,ne,g,r),n!==void 0&&w3(X,this.ngContentSelectors,n),F=y3(Th,ne,De,pt,P,[E3]),h0(V,P,null)}finally{jv()}return new Cv(this.componentType,F,Zf(X,P),P,X)}},Cv=class extends sv{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new Js(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;l0(s[Ce],s,i,e,n),this.previousInputValues.set(e,n);let o=Wi(this._tNode.index,s);c0(o)}}get injector(){return new zs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function g3(t,e){let n=t[Ce],r=nr;return t[r]=e,ep(n,r,2,"#host",null)}function m3(t,e,n,r,i,s,o){let a=i[Ce];_3(r,t,e,o);let l=null;e!==null&&(l=i0(e,i[Ea]));let c=s.rendererFactory.createRenderer(e,n),u=16;n.signals?u=4096:n.onPush&&(u=64);let d=Xf(i,LA(n),null,u,i[t.index],t,s,c,null,null,l);return a.firstCreatePass&&dv(a,t,r.length-1),tp(i,d),i[t.index]=d}function _3(t,e,n,r){for(let i of t)e.mergedAttrs=Sc(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(wv(e,e.mergedAttrs,!0),n!==null&&IA(r,n,e))}function y3(t,e,n,r,i,s){let o=Vn(),a=i[Ce],l=sr(o,i);BA(a,i,o,n,null,r);for(let u=0;u<n.length;u++){let d=o.directiveStart+u,h=xa(i,a,d,o);Ys(h,i)}$A(a,i,o),l&&Ys(l,i);let c=xa(i,a,o.directiveStart+o.componentOffset,o);if(t[On]=i[On]=c,s!==null)for(let u of s)u(c,e);return OA(a,o,t),c}function v3(t,e,n,r){if(r)Ky(t,n,["ng-version",s0.full]);else{let{attrs:i,classes:s}=uU(e.selectors[0]);i&&Ky(t,n,i),s&&s.length>0&&bA(t,n,s.join(" "))}}function w3(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function E3(){let t=Vn();$v(Be()[Ce],t)}function C3(t){return Object.getPrototypeOf(t.prototype).constructor}function Mr(t){let e=C3(t.type),n=!0,r=[t];for(;e;){let i;if(Hi(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Q(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let o=t;o.inputs=uf(t.inputs),o.inputTransforms=uf(t.inputTransforms),o.declaredInputs=uf(t.declaredInputs),o.outputs=uf(t.outputs);let a=i.hostBindings;a&&T3(t,a);let l=i.viewQuery,c=i.contentQueries;if(l&&I3(t,l),c&&x3(t,c),lf(t.inputs,i.inputs),lf(t.declaredInputs,i.declaredInputs),lf(t.outputs,i.outputs),i.inputTransforms!==null&&(o.inputTransforms===null&&(o.inputTransforms={}),lf(o.inputTransforms,i.inputTransforms)),Hi(i)&&i.data.animation){let u=t.data;u.animation=(u.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(t),a===Mr&&(n=!1)}}e=Object.getPrototypeOf(e)}b3(r)}function b3(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Sc(i.hostAttrs,n=Sc(n,i.hostAttrs))}}function uf(t){return t===wa?{}:t===mn?[]:t}function I3(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function x3(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,s)=>{e(r,i,s),n(r,i,s)}:t.contentQueries=e}function T3(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}function Zs(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function D3(t,e,n,r){let i=Zs(t,e,n);return Zs(t,e+1,r)||i}function f0(t,e,n,r){return Zs(t,Fv(),n)?e+Tc(n)+r:or}function S3(t,e,n,r,i,s){let o=kU(),a=D3(t,o,n,i);return Vv(2),a?e+Tc(n)+r+Tc(i)+s:or}function df(t,e){return t<<17|e<<2}function Xs(t){return t>>17&32767}function A3(t){return(t&2)==2}function M3(t,e){return t&131071|e<<17}function bv(t){return t|2}function Sa(t){return(t&131068)>>2}function jy(t,e){return t&-131069|e<<2}function P3(t){return(t&1)===1}function Iv(t){return t|1}function R3(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=Xs(o),l=Sa(o);t[r]=n;let c=!1,u;if(Array.isArray(n)){let d=n;u=d[1],(u===null||Lc(d,u)>0)&&(c=!0)}else u=n;if(i)if(l!==0){let h=Xs(t[a+1]);t[r+1]=df(h,a),h!==0&&(t[h+1]=jy(t[h+1],r)),t[a+1]=M3(t[a+1],r)}else t[r+1]=df(a,0),a!==0&&(t[a+1]=jy(t[a+1],r)),a=r;else t[r+1]=df(l,0),a===0?a=r:t[l+1]=jy(t[l+1],r),l=r;c&&(t[r+1]=bv(t[r+1])),eS(t,u,r,!0,s),eS(t,u,r,!1,s),N3(e,u,t,r,s),o=df(a,l),s?e.classBindings=o:e.styleBindings=o}function N3(t,e,n,r,i){let s=i?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&Lc(s,e)>=0&&(n[r+1]=Iv(n[r+1]))}function eS(t,e,n,r,i){let s=t[n+1],o=e===null,a=r?Xs(s):Sa(s),l=!1;for(;a!==0&&(l===!1||o);){let c=t[a],u=t[a+1];k3(c,e)&&(l=!0,t[a+1]=r?Iv(u):bv(u)),a=r?Xs(u):Sa(u)}l&&(t[n+1]=r?bv(s):Iv(s))}function k3(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?Lc(t,e)>=0:!1}var er={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function O3(t){return t.substring(er.key,er.keyEnd)}function F3(t){return V3(t),t1(t,n1(t,0,er.textEnd))}function t1(t,e){let n=er.textEnd;return n===e?-1:(e=er.keyEnd=L3(t,er.key=e,n),n1(t,e,n))}function V3(t){er.key=0,er.keyEnd=0,er.value=0,er.valueEnd=0,er.textEnd=t.length}function n1(t,e,n){for(;e<n&&t.charCodeAt(e)<=32;)e++;return e}function L3(t,e,n){for(;e<n&&t.charCodeAt(e)>32;)e++;return e}function S(t,e,n){let r=Be(),i=Fv();if(Zs(r,i,e)){let s=Fn(),o=zS();jA(s,o,r,t,e,r[Dt],n,!1)}return S}function xv(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";l0(t,n,s[o],o,r)}function np(t,e,n){return r1(t,e,n,!1),np}function Se(t,e){return r1(t,e,null,!0),Se}function j3(t,e){for(let n=F3(e);n>=0;n=t1(e,n))zv(t,O3(e),!0)}function r1(t,e,n,r){let i=Be(),s=Fn(),o=Vv(2);if(s.firstUpdatePass&&s1(s,t,o,r),e!==or&&Zs(i,o,e)){let a=s.data[Ki()];o1(s,a,i,i[Dt],t,i[o+1]=W3(e,n),r,o)}}function U3(t,e,n,r){let i=Fn(),s=Vv(2);i.firstUpdatePass&&s1(i,null,s,r);let o=Be();if(n!==or&&Zs(o,s,n)){let a=i.data[Ki()];if(a1(a,r)&&!i1(i,s)){let l=r?a.classesWithoutHost:a.stylesWithoutHost;l!==null&&(n=qy(l,n||"")),xv(i,a,o,n,r)}else G3(i,a,o,o[Dt],o[s+1],o[s+1]=z3(t,e,n),r,s)}}function i1(t,e){return e>=t.expandoStartIndex}function s1(t,e,n,r){let i=t.data;if(i[n+1]===null){let s=i[Ki()],o=i1(t,n);a1(s,r)&&e===null&&!o&&(e=!1),e=B3(i,s,e,r),R3(i,s,e,n,o,r)}}function B3(t,e,n,r){let i=jU(t),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=Uy(null,t,e,n,r),n=kc(n,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==i)if(n=Uy(i,t,e,n,r),s===null){let l=$3(t,e,r);l!==void 0&&Array.isArray(l)&&(l=Uy(null,t,e,l[1],r),l=kc(l,e.attrs,r),H3(t,e,r,l))}else s=q3(t,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),n}function $3(t,e,n){let r=n?e.classBindings:e.styleBindings;if(Sa(r)!==0)return t[Xs(r)]}function H3(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[Xs(i)]=r}function q3(t,e,n){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=t[s].hostAttrs;r=kc(r,o,n)}return kc(r,e.attrs,n)}function Uy(t,e,n,r,i){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],r=kc(r,s.hostAttrs,i),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function kc(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),zv(t,o,n?!0:e[++s]))}return t===void 0?null:t}function z3(t,e,n){if(n==null||n==="")return mn;let r=[],i=Bc(n);if(Array.isArray(i))for(let s=0;s<i.length;s++)t(r,i[s],!0);else if(typeof i=="object")for(let s in i)i.hasOwnProperty(s)&&t(r,s,i[s]);else typeof i=="string"&&e(r,i);return r}function G3(t,e,n,r,i,s,o,a){i===or&&(i=mn);let l=0,c=0,u=0<i.length?i[0]:null,d=0<s.length?s[0]:null;for(;u!==null||d!==null;){let h=l<i.length?i[l+1]:void 0,g=c<s.length?s[c+1]:void 0,y=null,w;u===d?(l+=2,c+=2,h!==g&&(y=d,w=g)):d===null||u!==null&&u<d?(l+=2,y=u):(c+=2,y=d,w=g),y!==null&&o1(t,e,n,r,y,w,o,a),u=l<i.length?i[l]:null,d=c<s.length?s[c]:null}}function o1(t,e,n,r,i,s,o,a){if(!(e.type&3))return;let l=t.data,c=l[a+1],u=P3(c)?tS(l,e,n,i,Sa(c),o):void 0;if(!Vf(u)){Vf(s)||A3(c)&&(s=tS(l,null,n,i,a,o));let d=PS(Ki(),n);t4(r,o,d,i,s)}}function tS(t,e,n,r,i,s){let o=e===null,a;for(;i>0;){let l=t[i],c=Array.isArray(l),u=c?l[1]:l,d=u===null,h=n[i+1];h===or&&(h=d?mn:void 0);let g=d?Ny(h,r):u===r?h:void 0;if(c&&!Vf(g)&&(g=Ny(l,r)),Vf(g)&&(a=g,o))return a;let y=t[i+1];i=o?Xs(y):Sa(y)}if(e!==null){let l=s?e.residualClasses:e.residualStyles;l!=null&&(a=Ny(l,r))}return a}function Vf(t){return t!==void 0}function W3(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=Wt(Bc(t)))),t}function a1(t,e){return(t.flags&(e?8:16))!==0}function l1(t,e,n){let r=Be(),i=f0(r,t,e,n);U3(zv,j3,i,!0)}var Oie=new RegExp(`^(\\d+)*(${a4}|${o4})*(.*)`);var K3=(t,e)=>null;function Tv(t,e){return K3(t,e)}function c1(t,e,n,r){let i=e.tView,o=t[ce]&4096?4096:16,a=Xf(t,i,n,o,null,e,null,null,null,r?.injector??null,r?.dehydratedView??null),l=t[e.index];a[qf]=l;let c=t[Pc];return c!==null&&(a[Pc]=c.createEmbeddedView(i)),h0(i,a,n),a}function Q3(t,e){let n=wn+e;if(n<t.length)return t[n]}function Dv(t,e){return!e||e.firstChild===null||pA(t)}function u1(t,e,n,r=!0){let i=e[Ce];if(BB(i,e,t,n),r){let o=iv(n,t),a=e[Dt],l=e0(a,t[Ws]);l!==null&&LB(i,t[ir],a,e,l,o)}let s=e[wf];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function Y3(t,e){let n=Mf(t,e);return n!==void 0&&Xv(n[Ce],n),n}var Pa=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=J3;let t=e;return t})();function J3(){let t=Vn();return X3(t,Be())}var Z3=Pa,d1=class extends Z3{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return Zf(this._hostTNode,this._hostLView)}get injector(){return new zs(this._hostTNode,this._hostLView)}get parentInjector(){let e=Hv(this._hostTNode,this._hostLView);if(KS(e)){let n=xf(e,this._hostLView),r=If(e),i=n[Ce].data[r+8];return new zs(i,n)}else return new zs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=nS(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-wn}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=Tv(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,Dv(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!sB(e),a;if(o)a=n;else{let y=n||{};a=y.index,r=y.injector,i=y.projectableNodes,s=y.environmentInjector||y.ngModuleRef}let l=o?e:new Da($i(e)),c=r||this.parentInjector;if(!s&&l.ngModule==null){let w=(o?c:this.parentInjector).get(nn,null);w&&(s=w)}let u=$i(l.componentType??{}),d=Tv(this._lContainer,u?.id??null),h=d?.firstChild??null,g=l.create(c,i,h,s);return this.insertImpl(g.hostView,a,Dv(this._hostTNode,d)),g}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(EU(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let l=i[Tt],c=new d1(l,l[ir],l[Tt]);c.detach(c.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return u1(o,i,s,r),e.attachToViewContainerRef(),iA(By(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=nS(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=Mf(this._lContainer,n);r&&(Df(By(this._lContainer),n),Xv(r[Ce],r))}detach(e){let n=this._adjustIndex(e,-1),r=Mf(this._lContainer,n);return r&&Df(By(this._lContainer),n)!=null?new Js(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function nS(t){return t[Ef]}function By(t){return t[Ef]||(t[Ef]=[])}function X3(t,e){let n,r=e[t.index];return rr(r)?n=r:(n=qA(r,e,null,t),e[t.index]=n,tp(e,n)),t$(n,e,t,r),new d1(n,t,e)}function e$(t,e){let n=t[Dt],r=n.createComment(""),i=sr(e,t),s=e0(n,i);return Pf(n,s,r,KB(n,i),!1),r}var t$=i$,n$=(t,e,n)=>!1;function r$(t,e,n){return n$(t,e,n)}function i$(t,e,n,r){if(t[Ws])return;let i;n.type&8?i=Dr(r):i=e$(e,n),t[Ws]=i}function s$(t,e,n,r,i,s,o,a,l){let c=e.consts,u=ep(e,t,4,o||null,bf(c,a));UA(e,n,u,bf(c,l)),$v(e,u);let d=u.tView=a0(2,u,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return e.queries!==null&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}function Z(t,e,n,r,i,s,o,a){let l=Be(),c=Fn(),u=t+nr,d=c.firstCreatePass?s$(u,c,l,e,n,r,i,s,o):c.data[u];Vc(d,!1);let h=o$(c,l,d,t);Uv()&&t0(c,l,h,d),Ys(h,l);let g=qA(h,l,h,d);return l[u]=g,tp(l,g),r$(g,d,l),Nv(d)&&FA(c,l,d),o!=null&&VA(l,d,a),Z}var o$=a$;function a$(t,e,n,r){return Bv(!0),e[Dt].createComment("")}function h1(t,e,n){$c("NgControlFlow");let r=Be(),i=Fv(),s=l$(r,nr+t),o=0;if(Zs(r,i,e)){let a=en(null);try{if(Y3(s,o),e!==-1){let l=c$(r[Ce],nr+e),c=Tv(s,l.tView.ssrId),u=c1(r,l,n,{dehydratedView:c});u1(s,u,o,Dv(l,c))}}finally{en(a)}}else{let a=Q3(s,o);a!==void 0&&(a[On]=n)}}function l$(t,e){return t[e]}function c$(t,e){return kv(t,e)}function u$(t,e,n,r,i,s){let o=e.consts,a=bf(o,i),l=ep(e,t,2,r,a);return UA(e,n,l,bf(o,s)),l.attrs!==null&&wv(l,l.attrs,!1),l.mergedAttrs!==null&&wv(l,l.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,l),l}function f(t,e,n,r){let i=Be(),s=Fn(),o=nr+t,a=i[Dt],l=s.firstCreatePass?u$(o,s,i,e,n,r):s.data[o],c=d$(s,i,l,a,e,t);i[o]=c;let u=Nv(l);return Vc(l,!0),IA(a,c,l),(l.flags&32)!==32&&Uv()&&t0(s,i,c,l),xU()===0&&Ys(c,i),TU(),u&&(FA(s,i,l),OA(s,l,i)),r!==null&&VA(i,l),f}function p(){let t=Vn();LS()?RU():(t=t.parent,Vc(t,!1));let e=t;AU(e)&&MU(),DU();let n=Fn();return n.firstCreatePass&&($v(n,t),DS(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&GU(e)&&xv(n,e,Be(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&WU(e)&&xv(n,e,Be(),e.stylesWithoutHost,!1),p}function D(t,e,n,r){return f(t,e,n,r),p(),D}var d$=(t,e,n,r,i,s)=>(Bv(!0),vA(r,i,$U()));function Y(){return Be()}var Lf="en-US";var h$=Lf;function f$(t){Uj(t,"Expected localeId to be defined"),typeof t=="string"&&(h$=t.toLowerCase().replace(/_/g,"-"))}function no(t){return!!t&&typeof t.then=="function"}function f1(t){return!!t&&typeof t.subscribe=="function"}function A(t,e,n,r){let i=Be(),s=Fn(),o=Vn();return g$(s,i,i[Dt],o,t,e,r),A}function p$(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[Ac],l=i[s+2];return a.length>l?a[l]:null}typeof o=="string"&&(s+=2)}return null}function g$(t,e,n,r,i,s,o){let a=Nv(r),c=t.firstCreatePass&&W4(t),u=e[On],d=G4(e),h=!0;if(r.type&3||o){let w=sr(r,e),v=o?o(w):w,T=d.length,V=o?F=>o(Dr(F[r.index])):r.index,P=null;if(!o&&a&&(P=p$(t,e,i,r.index)),P!==null){let F=P.__ngLastListenerFn__||P;F.__ngNextListenerFn__=s,P.__ngLastListenerFn__=s,h=!1}else{s=iS(r,e,u,s,!1);let F=n.listen(v,i,s);d.push(s,F),c&&c.push(i,V,T,T+1)}}else s=iS(r,e,u,s,!1);let g=r.outputs,y;if(h&&g!==null&&(y=g[i])){let w=y.length;if(w)for(let v=0;v<w;v+=2){let T=y[v],V=y[v+1],X=e[T][V].subscribe(s),ne=d.length;d.push(s,X),c&&c.push(i,r.index,ne,-(ne+1))}}}function rS(t,e,n,r){try{return br(6,e,n),n(r)!==!1}catch(i){return GA(t,i),!1}finally{br(7,e,n)}}function iS(t,e,n,r,i){return function s(o){if(o===Function)return r;let a=t.componentOffset>-1?Wi(t.index,e):e;c0(a);let l=rS(e,n,r,o),c=s.__ngNextListenerFn__;for(;c;)l=rS(e,n,c,o)&&l,c=c.__ngNextListenerFn__;return i&&l===!1&&o.preventDefault(),l}}function E(t=1){return BU(t)}function Nt(t,e,n){return Ra(t,"",e,"",n),Nt}function Ra(t,e,n,r,i){let s=Be(),o=f0(s,e,n,r);if(o!==or){let a=Fn(),l=zS();jA(a,l,s,t,o,s[Dt],i,!1)}return Ra}function Na(t){let e=NU();return wU(e,nr+t)}function m(t,e=""){let n=Be(),r=Fn(),i=t+nr,s=r.firstCreatePass?ep(r,i,1,e,null):r.data[i],o=m$(r,n,s,e,t);n[i]=o,Uv()&&t0(r,n,o,s),Vc(s,!1)}var m$=(t,e,n,r,i)=>(Bv(!0),OB(e[Dt],r));function ee(t){return Le("",t,""),ee}function Le(t,e,n){let r=Be(),i=f0(r,t,e,n);return i!==or&&WA(r,Ki(),i),Le}function ka(t,e,n,r,i){let s=Be(),o=S3(s,t,e,n,r,i);return o!==or&&WA(s,Ki(),o),ka}function _$(t,e,n){let r=Fn();if(r.firstCreatePass){let i=Hi(t);Sv(n,r.data,r.blueprint,i,!0),Sv(e,r.data,r.blueprint,i,!1)}}function Sv(t,e,n,r,i){if(t=tn(t),Array.isArray(t))for(let s=0;s<t.length;s++)Sv(t[s],e,n,r,i);else{let s=Fn(),o=Be(),a=Vn(),l=Ta(t)?t:tn(t.provide),c=uA(t),u=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(Ta(t)||!t.multi){let g=new Qs(c,i,W),y=Hy(l,e,i?u:u+h,d);y===-1?(Zy(Tf(a,o),s,l),$y(s,t,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(g),o.push(g)):(n[y]=g,o[y]=g)}else{let g=Hy(l,e,u+h,d),y=Hy(l,e,u,u+h),w=g>=0&&n[g],v=y>=0&&n[y];if(i&&!v||!i&&!w){Zy(Tf(a,o),s,l);let T=w$(i?v$:y$,n.length,i,r,c);!i&&v&&(n[y].providerFactory=T),$y(s,t,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(T),o.push(T)}else{let T=p1(n[i?y:g],c,!i&&r);$y(s,t,g>-1?g:y,T)}!i&&r&&v&&n[y].componentProviders++}}}function $y(t,e,n,r){let i=Ta(e),s=vB(e);if(i||s){let l=(s?tn(e.useClass):e).prototype.ngOnDestroy;if(l){let c=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let u=c.indexOf(n);u===-1?c.push(n,[r,l]):c[u+1].push(r,l)}else c.push(n,l)}}}function p1(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function Hy(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function y$(t,e,n,r){return Av(this.multi,[])}function v$(t,e,n,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=xa(n,n[Ce],this.providerFactory.index,r);s=a.slice(0,o),Av(i,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],Av(i,s);return s}function Av(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function w$(t,e,n,r,i){let s=new Qs(t,n,W);return s.multi=[],s.index=e,s.componentProviders=0,p1(s,i,r&&!n),s}function Oa(t,e=[]){return n=>{n.providersResolver=(r,i)=>_$(r,i?i(t):t,e)}}var qi=class{},Oc=class{};var jf=class extends qi{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Ff(this);let i=CS(e);this._bootstrapComponents=fA(i.bootstrap),this._r3Injector=dA(e,n,[{provide:qi,useValue:this},{provide:Jf,useValue:this.componentFactoryResolver},...r],Wt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Uf=class extends Oc{constructor(e){super(),this.moduleType=e}create(e){return new jf(this.moduleType,e,[])}};function E$(t,e,n){return new jf(t,e,n)}var Mv=class extends qi{constructor(e){super(),this.componentFactoryResolver=new Ff(this),this.instance=null;let n=new Rc([...e.providers,{provide:qi,useValue:this},{provide:Jf,useValue:this.componentFactoryResolver}],e.parent||Kv(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function rp(t,e,n=null){return new Mv({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var C$=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=aA(!1,r.type),s=i.length>0?rp([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=z({token:e,providedIn:"environment",factory:()=>new e(x(nn))});let t=e;return t})();function g1(t){$c("NgStandalone"),t.getStandaloneInjector=e=>e.get(C$).getOrCreateStandaloneInjector(t)}var ip=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=x$;let t=e;return t})(),b$=ip,I$=class extends b${constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=c1(this._declarationLView,this._declarationTContainer,e,{injector:n,dehydratedView:r});return new Js(i)}};function x$(){return m1(Vn(),Be())}function m1(t,e){return t.type&4?new I$(e,t,Zf(t,e)):null}function Yi(t,e){return m1(t,e)}var hf=null;function T$(t){hf!==null&&(t.defaultEncapsulation!==hf.defaultEncapsulation||t.preserveWhitespaces!==hf.preserveWhitespaces)||(hf=t)}var sp=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),Fa=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new It(!1)}add(){this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Pv=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},op=(()=>{let e=class e{compileModuleSync(r){return new Uf(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=CS(r),o=fA(s.declarations).reduce((a,l)=>{let c=$i(l);return c&&a.push(new Da(c)),a},[]);return new Pv(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),D$=new L("compilerOptions");var p0=new L(""),Hc=new L(""),ap=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,g0||(S$(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{me.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb(this._didWork)}this._didWork=!1});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(x(me),x(lp),x(Hc))},e.\u0275prov=z({token:e,factory:e.\u0275fac});let t=e;return t})(),lp=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return g0?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();function S$(t){g0=t}var g0,cp=new L("Application Initializer"),_1=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=q(cp,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(no(o))r.push(o);else if(f1(o)){let a=new Promise((l,c)=>{o.subscribe({complete:l,error:c})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),up=new L("appBootstrapListener");function A$(t,e,n){let r=new Uf(n);return Promise.resolve(r)}function M$(){sD(()=>{throw new Q(600,!1)})}function P$(t){return t.isBoundToModule}function R$(t,e,n){try{let r=n();return no(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}function y1(t,e){return Array.isArray(e)?e.reduce(y1,t):j(j({},t),e)}var ro=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=q(AA),this.zoneIsStable=q(ZA),this.componentTypes=[],this.components=[],this.isStable=q(Fa).hasPendingTasks.pipe(Re(r=>r?K(!1):this.zoneIsStable),$s()),this._injector=q(nn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof Nf;if(!this._injector.get(_1).done){let y="Cannot bootstrap as there are still asynchronous initializers running."+(!s&&ES(r)?"":" Bootstrap components in the `ngDoBootstrap` method of the root module.");throw new Q(405,!1)}let a;s?a=r:a=this._injector.get(Jf).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let l=P$(a)?void 0:this._injector.get(qi),c=i||a.selector,u=a.create(Ln.NULL,[],c,l),d=u.location.nativeElement,h=u.injector.get(p0,null);return h?.registerApplication(d),u.onDestroy(()=>{this.detachView(u.hostView),_f(this.components,u),h?.unregisterApplication(d)}),this._loadComponent(u),u}tick(){if(this._runningTick)throw new Q(101,!1);try{this._runningTick=!0;for(let r of this._views)r.detectChanges()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;_f(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(up,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>_f(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new Q(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function _f(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function sS(t){for(let e=t.length-1;e>=0;e--)if(t[e]!==void 0)return t[e]}var N$=(()=>{let e=class e{constructor(){this.zone=q(me),this.applicationRef=q(ro)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function k$(t){return[{provide:me,useFactory:t},{provide:jc,multi:!0,useFactory:()=>{let e=q(N$,{optional:!0});return()=>e.initialize()}},{provide:AA,useFactory:O$},{provide:ZA,useFactory:XA}]}function O$(){let t=q(me),e=q(Sr);return n=>t.runOutsideAngular(()=>e.handleError(n))}function F$(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}function V$(){return typeof $localize<"u"&&$localize.locale||Lf}var m0=new L("LocaleId",{providedIn:"root",factory:()=>q(m0,ve.Optional|ve.SkipSelf)||V$()});var v1=new L("PlatformDestroyListeners"),w1=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=c3(i?.ngZone,F$({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=E$(r.moduleType,this.injector,k$(()=>s)),a=o.injector.get(Sr,null);return s.runOutsideAngular(()=>{let l=s.onError.subscribe({next:c=>{a.handleError(c)}});o.onDestroy(()=>{_f(this._modules,o),l.unsubscribe()})}),R$(a,s,()=>{let l=o.injector.get(_1);return l.runInitializers(),l.donePromise.then(()=>{let c=o.injector.get(m0,Lf);return f$(c||Lf),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=y1({},i);return A$(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(ro);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new Q(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Q(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(v1,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(x(Ln))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),xc=null,E1=new L("AllowMultipleToken");function L$(t){if(xc&&!xc.get(E1,!1))throw new Q(400,!1);M$(),xc=t;let e=t.get(w1);return B$(t),e}function _0(t,e,n=[]){let r=`Platform: ${e}`,i=new L(r);return(s=[])=>{let o=C1();if(!o||o.injector.get(E1,!1)){let a=[...n,...s,{provide:i,useValue:!0}];t?t(a):L$(j$(a,r))}return U$(i)}}function j$(t=[],e){return Ln.create({name:e,providers:[{provide:Qf,useValue:"platform"},{provide:v1,useValue:new Set([()=>xc=null])},...t]})}function U$(t){let e=C1();if(!e)throw new Q(401,!1);return e}function C1(){return xc?.get(w1)??null}function B$(t){t.get(Qv,null)?.forEach(n=>n())}function y0(){return!1}var b1=_0(null,"core",[]),I1=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(x(ro))},e.\u0275mod=Ve({type:e}),e.\u0275inj=Fe({});let t=e;return t})();function dp(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function x1(t){let e=$i(t);if(!e)return null;let n=new Da(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var v0=null;function Pr(){return v0}function M1(t){v0||(v0=t)}var hp=class{},$t=new L("DocumentToken"),b0=(()=>{let e=class e{historyGo(r){throw new Error("Not implemented")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:()=>(()=>q(z$))(),providedIn:"platform"});let t=e;return t})(),P1=new L("Location Initialized"),z$=(()=>{let e=class e extends b0{constructor(){super(),this._doc=q($t),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Pr().getBaseHref(this._doc)}onPopState(r){let i=Pr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=Pr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:()=>(()=>new e)(),providedIn:"platform"});let t=e;return t})();function I0(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function T1(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function pi(t){return t&&t[0]!=="?"?"?"+t:t}var gi=(()=>{let e=class e{historyGo(r){throw new Error("Not implemented")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:()=>(()=>q(x0))(),providedIn:"root"});let t=e;return t})(),R1=new L("appBaseHref"),x0=(()=>{let e=class e extends gi{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??q($t).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return I0(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+pi(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+pi(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+pi(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(x(b0),x(R1,8))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),fp=(()=>{let e=class e extends gi{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash;return i==null&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=I0(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+pi(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+pi(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(x(b0),x(R1,8))},e.\u0275prov=z({token:e,factory:e.\u0275fac});let t=e;return t})(),La=(()=>{let e=class e{constructor(r){this._subject=new st,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=K$(T1(D1(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+pi(i))}normalize(r){return e.stripTrailingSlash(W$(this._basePath,D1(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+pi(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+pi(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=pi,e.joinWithSlash=I0,e.stripTrailingSlash=T1,e.\u0275fac=function(i){return new(i||e)(x(gi))},e.\u0275prov=z({token:e,factory:()=>G$(),providedIn:"root"});let t=e;return t})();function G$(){return new La(x(gi))}function W$(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function D1(t){return t.replace(/\/index.html$/,"")}function K$(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function pp(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var w0=class{constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},jn=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(!1)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new w0(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let l=i.get(o);i.move(l,a),S1(l,s)}});for(let s=0,o=i.length;s<o;s++){let l=i.get(s).context;l.index=s,l.count=o,l.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);S1(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(W(Pa),W(ip),W(o0))},e.\u0275dir=Rt({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let t=e;return t})();function S1(t,e){t.context.$implicit=e.item}var Un=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new E0,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){A1("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){A1("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(W(Pa),W(ip))},e.\u0275dir=Rt({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let t=e;return t})(),E0=class{constructor(){this.$implicit=null,this.ngIf=null}};function A1(t,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${t} must be a TemplateRef, but received '${Wt(e)}'.`)}var N1=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ve({type:e}),e.\u0275inj=Fe({});let t=e;return t})(),k1="browser",Q$="server";function io(t){return t===Q$}var O1=(()=>{let e=class e{};e.\u0275prov=z({token:e,providedIn:"root",factory:()=>new C0(x($t),window)});let t=e;return t})(),C0=class{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;let n=Y$(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){let n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}};function Y$(t,e){let n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var Va=class{};var zc=class{},mp=class{},so=class t{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(n=>{let r=n.indexOf(":");if(r>0){let i=n.slice(0,r),s=i.toLowerCase(),o=n.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((n,r)=>{this.setHeaderEntries(r,n)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([n,r])=>{this.setHeaderEntries(n,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let n=this.headers.get(e.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,n){return this.clone({name:e,value:n,op:"a"})}set(e,n){return this.clone({name:e,value:n,op:"s"})}delete(e,n){return this.clone({name:e,value:n,op:"d"})}maybeSetNormalizedName(e,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,e)}init(){this.lazyInit&&(this.lazyInit instanceof t?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(n=>{this.headers.set(n,e.headers.get(n)),this.normalizedNames.set(n,e.normalizedNames.get(n))})}clone(e){let n=new t;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof t?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([e]),n}applyUpdate(e){let n=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,n);let i=(e.op==="a"?this.headers.get(n):void 0)||[];i.push(...r),this.headers.set(n,i);break;case"d":let s=e.value;if(!s)this.headers.delete(n),this.normalizedNames.delete(n);else{let o=this.headers.get(n);if(!o)return;o=o.filter(a=>s.indexOf(a)===-1),o.length===0?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,o)}break}}setHeaderEntries(e,n){let r=(Array.isArray(n)?n:[n]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>e(this.normalizedNames.get(n),this.headers.get(n)))}};var D0=class{encodeKey(e){return F1(e)}encodeValue(e){return F1(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function X$(t,e){let n=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[o,a]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],l=n.get(o)||[];l.push(a),n.set(o,l)}),n}var e5=/%(\d[a-f0-9])/gi,t5={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function F1(t){return encodeURIComponent(t).replace(e5,(e,n)=>t5[n]??e)}function gp(t){return`${t}`}var Zi=class t{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new D0,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=X$(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(n=>{let r=e.fromObject[n],i=Array.isArray(r)?r.map(gp):[gp(r)];this.map.set(n,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let n=this.map.get(e);return n?n[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,n){return this.clone({param:e,value:n,op:"a"})}appendAll(e){let n=[];return Object.keys(e).forEach(r=>{let i=e[r];Array.isArray(i)?i.forEach(s=>{n.push({param:r,value:s,op:"a"})}):n.push({param:r,value:i,op:"a"})}),this.clone(n)}set(e,n){return this.clone({param:e,value:n,op:"s"})}delete(e,n){return this.clone({param:e,value:n,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let n=this.encoder.encodeKey(e);return this.map.get(e).map(r=>n+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let n=new t({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(e),n}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let n=(e.op==="a"?this.map.get(e.param):void 0)||[];n.push(gp(e.value)),this.map.set(e.param,n);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],i=r.indexOf(gp(e.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var S0=class{constructor(){this.map=new Map}set(e,n){return this.map.set(e,n),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function n5(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function V1(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function L1(t){return typeof Blob<"u"&&t instanceof Blob}function j1(t){return typeof FormData<"u"&&t instanceof FormData}function r5(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}var qc=class t{constructor(e,n,r,i){this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(n5(this.method)||i?(this.body=r!==void 0?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers||(this.headers=new so),this.context||(this.context=new S0),!this.params)this.params=new Zi,this.urlWithParams=n;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=n;else{let a=n.indexOf("?"),l=a===-1?"?":a<n.length-1?"&":"";this.urlWithParams=n+l+o}}}serializeBody(){return this.body===null?null:V1(this.body)||L1(this.body)||j1(this.body)||r5(this.body)||typeof this.body=="string"?this.body:this.body instanceof Zi?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||j1(this.body)?null:L1(this.body)?this.body.type||null:V1(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof Zi?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let n=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=e.body!==void 0?e.body:this.body,o=e.withCredentials!==void 0?e.withCredentials:this.withCredentials,a=e.reportProgress!==void 0?e.reportProgress:this.reportProgress,l=e.headers||this.headers,c=e.params||this.params,u=e.context??this.context;return e.setHeaders!==void 0&&(l=Object.keys(e.setHeaders).reduce((d,h)=>d.set(h,e.setHeaders[h]),l)),e.setParams&&(c=Object.keys(e.setParams).reduce((d,h)=>d.set(h,e.setParams[h]),c)),new t(n,r,s,{params:c,headers:l,context:u,reportProgress:a,responseType:i,withCredentials:o})}},ja=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}(ja||{}),Gc=class{constructor(e,n=200,r="OK"){this.headers=e.headers||new so,this.status=e.status!==void 0?e.status:n,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},A0=class t extends Gc{constructor(e={}){super(e),this.type=ja.ResponseHeader}clone(e={}){return new t({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},_p=class t extends Gc{constructor(e={}){super(e),this.type=ja.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new t({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},yp=class extends Gc{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}};function T0(t,e){return{body:e,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials,transferCache:t.transferCache}}var i5=(()=>{let e=class e{constructor(r){this.handler=r}request(r,i,s={}){let o;if(r instanceof qc)o=r;else{let c;s.headers instanceof so?c=s.headers:c=new so(s.headers);let u;s.params&&(s.params instanceof Zi?u=s.params:u=new Zi({fromObject:s.params})),o=new qc(r,i,s.body!==void 0?s.body:null,{headers:c,context:s.context,params:u,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache})}let a=K(o).pipe(ci(c=>this.handler.handle(c)));if(r instanceof qc||s.observe==="events")return a;let l=a.pipe(xt(c=>c instanceof _p));switch(s.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return l.pipe(B(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return c.body}));case"blob":return l.pipe(B(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new Error("Response is not a Blob.");return c.body}));case"text":return l.pipe(B(c=>{if(c.body!==null&&typeof c.body!="string")throw new Error("Response is not a string.");return c.body}));case"json":default:return l.pipe(B(c=>c.body))}case"response":return l;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(r,i={}){return this.request("DELETE",r,i)}get(r,i={}){return this.request("GET",r,i)}head(r,i={}){return this.request("HEAD",r,i)}jsonp(r,i){return this.request("JSONP",r,{params:new Zi().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(r,i={}){return this.request("OPTIONS",r,i)}patch(r,i,s={}){return this.request("PATCH",r,T0(s,i))}post(r,i,s={}){return this.request("POST",r,T0(s,i))}put(r,i,s={}){return this.request("PUT",r,T0(s,i))}};e.\u0275fac=function(i){return new(i||e)(x(zc))},e.\u0275prov=z({token:e,factory:e.\u0275fac});let t=e;return t})();function H1(t,e){return e(t)}function s5(t,e){return(n,r)=>e.intercept(n,{handle:i=>t(i,r)})}function o5(t,e,n){return(r,i)=>Ar(n,()=>e(r,s=>t(s,i)))}var a5=new L(""),M0=new L(""),l5=new L(""),c5=new L("");function u5(){let t=null;return(e,n)=>{t===null&&(t=(q(a5,{optional:!0})??[]).reduceRight(s5,H1));let r=q(Fa),i=r.add();return t(e,n).pipe(Li(()=>r.remove(i)))}}var U1=(()=>{let e=class e extends zc{constructor(r,i){super(),this.backend=r,this.injector=i,this.chain=null,this.pendingTasks=q(Fa);let s=q(c5,{optional:!0});this.backend=s??r}handle(r){if(this.chain===null){let s=Array.from(new Set([...this.injector.get(M0),...this.injector.get(l5,[])]));this.chain=s.reduceRight((o,a)=>o5(o,a,this.injector),H1)}let i=this.pendingTasks.add();return this.chain(r,s=>this.backend.handle(s)).pipe(Li(()=>this.pendingTasks.remove(i)))}};e.\u0275fac=function(i){return new(i||e)(x(mp),x(nn))},e.\u0275prov=z({token:e,factory:e.\u0275fac});let t=e;return t})();var d5=/^\)\]\}',?\n/;function h5(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}var B1=(()=>{let e=class e{constructor(r){this.xhrFactory=r}handle(r){if(r.method==="JSONP")throw new Q(-2800,!1);let i=this.xhrFactory;return(i.\u0275loadImpl?ge(i.\u0275loadImpl()):K(null)).pipe(Re(()=>new oe(o=>{let a=i.build();if(a.open(r.method,r.urlWithParams),r.withCredentials&&(a.withCredentials=!0),r.headers.forEach((v,T)=>a.setRequestHeader(v,T.join(","))),r.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!r.headers.has("Content-Type")){let v=r.detectContentTypeHeader();v!==null&&a.setRequestHeader("Content-Type",v)}if(r.responseType){let v=r.responseType.toLowerCase();a.responseType=v!=="json"?v:"text"}let l=r.serializeBody(),c=null,u=()=>{if(c!==null)return c;let v=a.statusText||"OK",T=new so(a.getAllResponseHeaders()),V=h5(a)||r.url;return c=new A0({headers:T,status:a.status,statusText:v,url:V}),c},d=()=>{let{headers:v,status:T,statusText:V,url:P}=u(),F=null;T!==204&&(F=typeof a.response>"u"?a.responseText:a.response),T===0&&(T=F?200:0);let X=T>=200&&T<300;if(r.responseType==="json"&&typeof F=="string"){let ne=F;F=F.replace(d5,"");try{F=F!==""?JSON.parse(F):null}catch(De){F=ne,X&&(X=!1,F={error:De,text:F})}}X?(o.next(new _p({body:F,headers:v,status:T,statusText:V,url:P||void 0})),o.complete()):o.error(new yp({error:F,headers:v,status:T,statusText:V,url:P||void 0}))},h=v=>{let{url:T}=u(),V=new yp({error:v,status:a.status||0,statusText:a.statusText||"Unknown Error",url:T||void 0});o.error(V)},g=!1,y=v=>{g||(o.next(u()),g=!0);let T={type:ja.DownloadProgress,loaded:v.loaded};v.lengthComputable&&(T.total=v.total),r.responseType==="text"&&a.responseText&&(T.partialText=a.responseText),o.next(T)},w=v=>{let T={type:ja.UploadProgress,loaded:v.loaded};v.lengthComputable&&(T.total=v.total),o.next(T)};return a.addEventListener("load",d),a.addEventListener("error",h),a.addEventListener("timeout",h),a.addEventListener("abort",h),r.reportProgress&&(a.addEventListener("progress",y),l!==null&&a.upload&&a.upload.addEventListener("progress",w)),a.send(l),o.next({type:ja.Sent}),()=>{a.removeEventListener("error",h),a.removeEventListener("abort",h),a.removeEventListener("load",d),a.removeEventListener("timeout",h),r.reportProgress&&(a.removeEventListener("progress",y),l!==null&&a.upload&&a.upload.removeEventListener("progress",w)),a.readyState!==a.DONE&&a.abort()}})))}};e.\u0275fac=function(i){return new(i||e)(x(Va))},e.\u0275prov=z({token:e,factory:e.\u0275fac});let t=e;return t})(),q1=new L("XSRF_ENABLED"),f5="XSRF-TOKEN",p5=new L("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>f5}),g5="X-XSRF-TOKEN",m5=new L("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>g5}),vp=class{},_5=(()=>{let e=class e{constructor(r,i,s){this.doc=r,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let r=this.doc.cookie||"";return r!==this.lastCookieString&&(this.parseCount++,this.lastToken=pp(r,this.cookieName),this.lastCookieString=r),this.lastToken}};e.\u0275fac=function(i){return new(i||e)(x($t),x(St),x(p5))},e.\u0275prov=z({token:e,factory:e.\u0275fac});let t=e;return t})();function y5(t,e){let n=t.url.toLowerCase();if(!q(q1)||t.method==="GET"||t.method==="HEAD"||n.startsWith("http://")||n.startsWith("https://"))return e(t);let r=q(vp).getToken(),i=q(m5);return r!=null&&!t.headers.has(i)&&(t=t.clone({headers:t.headers.set(i,r)})),e(t)}var z1=function(t){return t[t.Interceptors=0]="Interceptors",t[t.LegacyInterceptors=1]="LegacyInterceptors",t[t.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",t[t.NoXsrfProtection=3]="NoXsrfProtection",t[t.JsonpSupport=4]="JsonpSupport",t[t.RequestsMadeViaParent=5]="RequestsMadeViaParent",t[t.Fetch=6]="Fetch",t}(z1||{});function v5(t,e){return{\u0275kind:t,\u0275providers:e}}function w5(...t){let e=[i5,B1,U1,{provide:zc,useExisting:U1},{provide:mp,useExisting:B1},{provide:M0,useValue:y5,multi:!0},{provide:q1,useValue:!0},{provide:vp,useClass:_5}];for(let n of t)e.push(...n.\u0275providers);return Kf(e)}var $1=new L("LEGACY_INTERCEPTOR_FN");function E5(){return v5(z1.LegacyInterceptors,[{provide:$1,useFactory:u5},{provide:M0,useExisting:$1,multi:!0}])}var G1=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ve({type:e}),e.\u0275inj=Fe({providers:[w5(E5())]});let t=e;return t})();var N0=class extends hp{constructor(){super(...arguments),this.supportsDOMEvents=!0}},k0=class t extends N0{static makeCurrent(){M1(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=C5();return n==null?null:b5(n)}resetBaseElement(){Wc=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return pp(document.cookie,e)}},Wc=null;function C5(){return Wc=Wc||document.querySelector("base"),Wc?Wc.getAttribute("href"):null}function b5(t){return new URL(t,document.baseURI).pathname}var O0=class{addToWindow(e){vn.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new Q(5103,!1);return s},vn.getAllAngularTestabilities=()=>e.getAllTestabilities(),vn.getAllAngularRootElements=()=>e.getAllRootElements();let n=r=>{let i=vn.getAllAngularTestabilities(),s=i.length,o=!1,a=function(l){o=o||l,s--,s==0&&r(o)};i.forEach(l=>{l.whenStable(a)})};vn.frameworkStabilizers||(vn.frameworkStabilizers=[]),vn.frameworkStabilizers.push(n)}findTestabilityInTree(e,n,r){if(n==null)return null;let i=e.getTestability(n);return i??(r?Pr().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},I5=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac});let t=e;return t})(),F0=new L("EventManagerPlugins"),Y1=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new Q(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(x(F0),x(me))},e.\u0275prov=z({token:e,factory:e.\u0275fac});let t=e;return t})(),wp=class{constructor(e){this._doc=e}},P0="ng-app-id",J1=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=io(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${P0}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(P0),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(P0,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(x($t),x(Yf),x(Yv,8),x(St))},e.\u0275prov=z({token:e,factory:e.\u0275fac});let t=e;return t})(),R0={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},L0=/%COMP%/g,Z1="%COMP%",x5=`_nghost-${Z1}`,T5=`_ngcontent-${Z1}`,D5=!0,S5=new L("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>D5});function A5(t){return T5.replace(L0,t)}function M5(t){return x5.replace(L0,t)}function X1(t,e){return e.map(n=>n.replace(L0,t))}var W1=(()=>{let e=class e{constructor(r,i,s,o,a,l,c,u=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=l,this.ngZone=c,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=io(l),this.defaultRenderer=new Kc(r,a,c,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===xr.ShadowDom&&(i=Pe(j({},i),{encapsulation:xr.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof Ep?s.applyToHost(r):s instanceof Qc&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,l=this.ngZone,c=this.eventManager,u=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case xr.Emulated:o=new Ep(c,u,i,this.appId,d,a,l,h);break;case xr.ShadowDom:return new V0(c,u,r,i,a,l,this.nonce,h);default:o=new Qc(c,u,i,d,a,l,h);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(x(Y1),x(J1),x(Yf),x(S5),x($t),x(St),x(me),x(Yv))},e.\u0275prov=z({token:e,factory:e.\u0275fac});let t=e;return t})(),Kc=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(R0[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(K1(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(K1(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new Q(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=R0[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=R0[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(ui.DashCase|ui.Important)?e.style.setProperty(n,r,i&ui.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&ui.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=Pr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function K1(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var V0=class extends Kc{constructor(e,n,r,i,s,o,a,l){super(e,s,o,l),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=X1(i.id,i.styles);for(let u of c){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=u,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Qc=class extends Kc{constructor(e,n,r,i,s,o,a,l){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=l?X1(l,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Ep=class extends Qc{constructor(e,n,r,i,s,o,a,l){let c=i+"-"+r.id;super(e,n,r,s,o,a,l,c),this.contentAttr=A5(c),this.hostAttr=M5(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},P5=(()=>{let e=class e extends wp{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(x($t))},e.\u0275prov=z({token:e,factory:e.\u0275fac});let t=e;return t})(),Q1=["alt","control","meta","shift"],R5={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},N5={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},k5=(()=>{let e=class e extends wp{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Pr().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",l=i.indexOf("code");if(l>-1&&(i.splice(l,1),a="code."),Q1.forEach(u=>{let d=i.indexOf(u);d>-1&&(i.splice(d,1),a+=u+".")}),a+=o,i.length!=0||o.length===0)return null;let c={};return c.domEventName=s,c.fullKey=a,c}static matchEventFullKeyCode(r,i){let s=R5[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),Q1.forEach(a=>{if(a!==s){let l=N5[a];l(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(x($t))},e.\u0275prov=z({token:e,factory:e.\u0275fac});let t=e;return t})();function O5(){k0.makeCurrent()}function F5(){return new Sr}function V5(){return hA(document),document}var L5=[{provide:St,useValue:k1},{provide:Qv,useValue:O5,multi:!0},{provide:$t,useFactory:V5,deps:[]}],eM=_0(b1,"browser",L5),j5=new L(""),U5=[{provide:Hc,useClass:O0,deps:[]},{provide:p0,useClass:ap,deps:[me,lp,Hc]},{provide:ap,useClass:ap,deps:[me,lp,Hc]}],B5=[{provide:Qf,useValue:"root"},{provide:Sr,useFactory:F5,deps:[]},{provide:F0,useClass:P5,multi:!0,deps:[$t,me,St]},{provide:F0,useClass:k5,multi:!0,deps:[$t]},W1,J1,Y1,{provide:Nc,useExisting:W1},{provide:Va,useClass:I5,deps:[]},[]],tM=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:Yf,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(x(j5,12))},e.\u0275mod=Ve({type:e}),e.\u0275inj=Fe({providers:[...B5,...U5],imports:[N1,I1]});let t=e;return t})();function $5(){return new j0(x($t))}var j0=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(x($t))},e.\u0275prov=z({token:e,factory:function(i){let s=null;return i?s=new i:s=$5(),s},providedIn:"root"});let t=e;return t})();var dM=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(W(Qi),W(fi))},e.\u0275dir=Rt({type:e});let t=e;return t})(),B0=(()=>{let e=class e extends dM{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=eo(e)))(s||e)}})(),e.\u0275dir=Rt({type:e,features:[Mr]});let t=e;return t})(),Sp=new L("NgValueAccessor");var q5={provide:Sp,useExisting:zi(()=>Ap),multi:!0};function z5(){let t=Pr()?Pr().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var G5=new L("CompositionEventMode"),Ap=(()=>{let e=class e extends dM{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!z5())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(W(Qi),W(fi),W(G5,8))},e.\u0275dir=Rt({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&A("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[Oa([q5]),Mr]});let t=e;return t})();var hM=new L("NgValidators"),fM=new L("NgAsyncValidators");function pM(t){return t!=null}function gM(t){return no(t)?ge(t):t}function mM(t){let e={};return t.forEach(n=>{e=n!=null?j(j({},e),n):e}),Object.keys(e).length===0?null:e}function _M(t,e){return e.map(n=>n(t))}function W5(t){return!t.validate}function yM(t){return t.map(e=>W5(e)?e:n=>e.validate(n))}function K5(t){if(!t)return null;let e=t.filter(pM);return e.length==0?null:function(n){return mM(_M(n,e))}}function $0(t){return t!=null?K5(yM(t)):null}function Q5(t){if(!t)return null;let e=t.filter(pM);return e.length==0?null:function(n){let r=_M(n,e).map(gM);return Cy(r).pipe(B(mM))}}function H0(t){return t!=null?Q5(yM(t)):null}function rM(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function Y5(t){return t._rawValidators}function J5(t){return t._rawAsyncValidators}function U0(t){return t?Array.isArray(t)?t:[t]:[]}function bp(t,e){return Array.isArray(t)?t.includes(e):t===e}function iM(t,e){let n=U0(e);return U0(t).forEach(i=>{bp(n,i)||n.push(i)}),n}function sM(t,e){return U0(e).filter(n=>!bp(t,n))}var Ip=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=$0(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=H0(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},Ba=class extends Ip{get formDirective(){return null}get path(){return null}},Xc=class extends Ip{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},xp=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},Z5={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},eoe=Pe(j({},Z5),{"[class.ng-submitted]":"isSubmitted"}),vM=(()=>{let e=class e extends xp{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(W(Xc,2))},e.\u0275dir=Rt({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&Se("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Mr]});let t=e;return t})(),Rr=(()=>{let e=class e extends xp{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(W(Ba,10))},e.\u0275dir=Rt({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,s){i&2&&Se("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[Mr]});let t=e;return t})();var Yc="VALID",Cp="INVALID",Ua="PENDING",Jc="DISABLED";function wM(t){return(Mp(t)?t.validators:t)||null}function X5(t){return Array.isArray(t)?$0(t):t||null}function EM(t,e){return(Mp(e)?e.asyncValidators:t)||null}function eH(t){return Array.isArray(t)?H0(t):t||null}function Mp(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function tH(t,e,n){let r=t.controls;if(!(e?Object.keys(r):r).length)throw new Q(1e3,"");if(!r[n])throw new Q(1001,"")}function nH(t,e,n){t._forEachChild((r,i)=>{if(n[i]===void 0)throw new Q(1002,"")})}var Tp=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Yc}get invalid(){return this.status===Cp}get pending(){return this.status==Ua}get disabled(){return this.status===Jc}get enabled(){return this.status!==Jc}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(iM(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(iM(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(sM(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(sM(e,this._rawAsyncValidators))}hasValidator(e){return bp(this._rawValidators,e)}hasAsyncValidator(e){return bp(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Ua,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Jc,this.errors=null,this._forEachChild(r=>{r.disable(Pe(j({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Pe(j({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Yc,this._forEachChild(r=>{r.enable(Pe(j({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Pe(j({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Yc||this.status===Ua)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Jc:Yc}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Ua,this._hasOwnPendingAsyncValidator=!0;let n=gM(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new st,this.statusChanges=new st}_calculateStatus(){return this._allControlsDisabled()?Jc:this.errors?Cp:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ua)?Ua:this._anyControlsHaveStatus(Cp)?Cp:Yc}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Mp(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=X5(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=eH(this._rawAsyncValidators)}},Dp=class extends Tp{constructor(e,n,r){super(wM(n),EM(r,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,n){return this.controls[e]?this.controls[e]:(this.controls[e]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(e,n,r={}){this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(e,n,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],n&&this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,n={}){nH(this,!0,e),Object.keys(e).forEach(r=>{tH(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e={},n={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(e,n,r)=>(e[r]=n.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(n,r)=>r._syncPendingControls()?!0:n);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(n=>{let r=this.controls[n];r&&e(r,n)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[n,r]of Object.entries(this.controls))if(this.contains(n)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(n,r,i)=>((r.enabled||this.disabled)&&(n[i]=r.value),n))}_reduceChildren(e,n){let r=e;return this._forEachChild((i,s)=>{r=n(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var q0=new L("CallSetDisabledState",{providedIn:"root",factory:()=>z0}),z0="always";function rH(t,e){return[...e.path,t]}function CM(t,e,n=z0){bM(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),sH(t,e),aH(t,e),oH(t,e),iH(t,e)}function oM(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function iH(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function bM(t,e){let n=Y5(t);e.validator!==null?t.setValidators(rM(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=J5(t);e.asyncValidator!==null?t.setAsyncValidators(rM(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();oM(e._rawValidators,i),oM(e._rawAsyncValidators,i)}function sH(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&IM(t,e)})}function oH(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&IM(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function IM(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function aH(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function lH(t,e){t==null,bM(t,e)}function cH(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function uH(t){return Object.getPrototypeOf(t.constructor)===B0}function dH(t,e){t._syncPendingControls(),e.forEach(n=>{let r=n.control;r.updateOn==="submit"&&r._pendingChange&&(n.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function hH(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(s=>{s.constructor===Ap?n=s:uH(s)?r=s:i=s}),i||r||n||null}var fH={provide:Ba,useExisting:zi(()=>ar)},Zc=(()=>Promise.resolve())(),ar=(()=>{let e=class e extends Ba{constructor(r,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._directives=new Set,this.ngSubmit=new st,this.form=new Dp({},$0(r),H0(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(r){Zc.then(()=>{let i=this._findContainer(r.path);r.control=i.registerControl(r.name,r.control),CM(r.control,r,this.callSetDisabledState),r.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(r)})}getControl(r){return this.form.get(r.path)}removeControl(r){Zc.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name),this._directives.delete(r)})}addFormGroup(r){Zc.then(()=>{let i=this._findContainer(r.path),s=new Dp({});lH(s,r),i.registerControl(r.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(r){Zc.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name)})}getFormGroup(r){return this.form.get(r.path)}updateModel(r,i){Zc.then(()=>{this.form.get(r.path).setValue(i)})}setValue(r){this.control.setValue(r)}onSubmit(r){return this.submitted=!0,dH(this.form,this._directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submitted=!1}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(r){return r.pop(),r.length?this.form.get(r):this.form}};e.\u0275fac=function(i){return new(i||e)(W(hM,10),W(fM,10),W(q0,8))},e.\u0275dir=Rt({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,s){i&1&&A("submit",function(a){return s.onSubmit(a)})("reset",function(){return s.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Oa([fH]),Mr]});let t=e;return t})();function aM(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function lM(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var pH=class extends Tp{constructor(e=null,n,r){super(wM(n),EM(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Mp(n)&&(n.nonNullable||n.initialValueIsDefault)&&(lM(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){aM(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){aM(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){lM(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var gH={provide:Xc,useExisting:zi(()=>G0)},cM=(()=>Promise.resolve())(),G0=(()=>{let e=class e extends Xc{constructor(r,i,s,o,a,l){super(),this._changeDetectorRef=a,this.callSetDisabledState=l,this.control=new pH,this._registered=!1,this.name="",this.update=new st,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=hH(this,o)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),cH(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){CM(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){cM.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,s=i!==0&&dp(i);cM.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?rH(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(W(Ba,9),W(hM,10),W(fM,10),W(Sp,10),W(to,8),W(q0,8))},e.\u0275dir=Rt({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Oa([gH]),Mr,Gi]});let t=e;return t})(),Nr=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Rt({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let t=e;return t})();var mH=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ve({type:e}),e.\u0275inj=Fe({});let t=e;return t})();var _H={provide:Sp,useExisting:zi(()=>TM),multi:!0};function xM(t,e){return t==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function yH(t){return t.split(":")[0]}var TM=(()=>{let e=class e extends B0{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i=this._getOptionId(r),s=xM(i,r);this.setProperty("value",s)}registerOnChange(r){this.onChange=i=>{this.value=this._getOptionValue(i),r(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),r))return i;return null}_getOptionValue(r){let i=yH(r);return this._optionMap.has(i)?this._optionMap.get(i):r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=eo(e)))(s||e)}})(),e.\u0275dir=Rt({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,s){i&1&&A("change",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[Oa([_H]),Mr]});let t=e;return t})(),DM=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(r){this._select!=null&&(this._select._optionMap.set(this.id,r),this._setElementValue(xM(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._setElementValue(r),this._select&&this._select.writeValue(this._select.value)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(W(fi),W(Qi),W(TM,9))},e.\u0275dir=Rt({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})(),vH={provide:Sp,useExisting:zi(()=>SM),multi:!0};function uM(t,e){return t==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function wH(t){return t.split(":")[0]}var SM=(()=>{let e=class e extends B0{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i;if(Array.isArray(r)){let s=r.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(r){this.onChange=i=>{let s=[],o=i.selectedOptions;if(o!==void 0){let a=o;for(let l=0;l<a.length;l++){let c=a[l],u=this._getOptionValue(c.value);s.push(u)}}else{let a=i.options;for(let l=0;l<a.length;l++){let c=a[l];if(c.selected){let u=this._getOptionValue(c.value);s.push(u)}}}this.value=s,r(s)}}_registerOption(r){let i=(this._idCounter++).toString();return this._optionMap.set(i,r),i}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,r))return i;return null}_getOptionValue(r){let i=wH(r);return this._optionMap.has(i)?this._optionMap.get(i)._value:r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=eo(e)))(s||e)}})(),e.\u0275dir=Rt({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,s){i&1&&A("change",function(a){return s.onChange(a.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[Oa([vH]),Mr]});let t=e;return t})(),AM=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(r){this._select!=null&&(this._value=r,this._setElementValue(uM(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._select?(this._value=r,this._setElementValue(uM(this.id,r)),this._select.writeValue(this._select.value)):this._setElementValue(r)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}_setSelected(r){this._renderer.setProperty(this._element.nativeElement,"selected",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(W(fi),W(Qi),W(SM,9))},e.\u0275dir=Rt({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})();var EH=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ve({type:e}),e.\u0275inj=Fe({imports:[mH]});let t=e;return t})();var MM=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:q0,useValue:r.callSetDisabledState??z0}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ve({type:e}),e.\u0275inj=Fe({imports:[EH]});let t=e;return t})();var CH="firebase",bH="10.11.1";fn(CH,bH,"app");var cr=new di("ANGULARFIRE2_VERSION");var IH=(t,e)=>{let n=e?[e]:XT(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},lr=class{constructor(){return IH(xH)}},xH="app-check";function W0(){}var Pp=class{zone;delegate;constructor(e,n=vy){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},K0=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",W0,{},W0,W0)),n.pipe(it({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Xi=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new Pp(Zone.current)),this.insideAngular=n.run(()=>new Pp(Zone.current,ai)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(x(me))};static \u0275prov=z({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function PM(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function Q0(t){return t.pipe(yn(PM().outsideAngular))}function Ye(t){return TH(PM())(t)}function TH(t){return function(n){return n=n.lift(new K0(t.ngZone)),n.pipe(Zn(t.outsideAngular),yn(t.insideAngular))}}var DH="firebase",SH="10.11.1";et.registerVersion(DH,SH,"app-compat");var AH=["ngOnDestroy"],NM=(t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(AH.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let l=a?.[s];return typeof l=="function"?l.bind(a):l?.then?l.then(c=>n.run(()=>c)):n.run(()=>l)});return new Proxy(()=>{},{get:(a,l)=>o[l],apply:(a,l,c)=>o.then(u=>{let d=u?.(...c);return r?.spy?.apply&&r.spy.apply(s,c,d),d})})})});var Np=class{constructor(e){return e}},kr=new L("angularfire2.app.options"),Or=new L("angularfire2.app.name");function mi(t,e,n){let r=typeof n=="string"&&n||"[DEFAULT]",i=typeof n=="object"&&n||{};i.name=i.name||r;let o=et.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>et.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let a=!!module.hot;MH("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Np(o)}var MH=(t,...e)=>{y0()&&typeof console<"u"&&console[t](...e)},PH={provide:Np,useFactory:mi,deps:[kr,me,[new Ma,Or]]},kM=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:kr,useValue:n},{provide:Or,useValue:r}]}}constructor(n){et.registerVersion("angularfire",cr.full,"core"),et.registerVersion("angularfire",cr.full,"app-compat"),et.registerVersion("angular",s0.full,n.toString())}static \u0275fac=function(r){return new(r||t)(x(St))};static \u0275mod=Ve({type:t});static \u0275inj=Fe({providers:[PH]})}return t})();function es(t,e,n,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return RH(i,o)||(RM("error",`${e} was already initialized on the ${n} Firebase App with different settings.${NH?" You may need to reload as Firebase is not HMR aware.":""}`),RM("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}function RH(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var NH=typeof module<"u"&&!!module.hot,RM=(t,...e)=>{y0()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var kH=new Map,OH={activated:!1,tokenObservers:[]},FH={initialized:!1,enabled:!1};function ur(t){return kH.get(t)||Object.assign({},OH)}function jM(){return FH}var VH="https://content-firebaseappcheck.googleapis.com/v1";var LH="exchangeDebugToken",OM={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},Soe=24*60*60*1e3;var J0=class{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return C(this,null,function*(){this.stop();try{this.pending=new Pt,this.pending.promise.catch(n=>{}),yield jH(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new Pt,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function jH(t){return new Promise(e=>{setTimeout(e,t)})}var UH={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},ts=new WT("appCheck","AppCheck",UH);function UM(t){if(!ur(t).activated)throw ts.create("use-before-activation",{appName:t.name})}function BM(r,i){return C(this,arguments,function*({url:t,body:e},n){let s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let g=yield o.getHeartbeatsHeader();g&&(s["X-Firebase-Client"]=g)}let a={method:"POST",body:JSON.stringify(e),headers:s},l;try{l=yield fetch(t,a)}catch(g){throw ts.create("fetch-network-error",{originalErrorMessage:g?.message})}if(l.status!==200)throw ts.create("fetch-status-error",{httpStatus:l.status});let c;try{c=yield l.json()}catch(g){throw ts.create("fetch-parse-error",{originalErrorMessage:g?.message})}let u=c.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw ts.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});let d=Number(u[1])*1e3,h=Date.now();return{token:c.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function $M(t,e){let{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${VH}/projects/${n}/apps/${r}:${LH}?key=${i}`,body:{debug_token:e}}}var BH="firebase-app-check-database",$H=1,Z0="firebase-app-check-store";var kp=null;function HH(){return kp||(kp=new Promise((t,e)=>{try{let n=indexedDB.open(BH,$H);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var i;e(ts.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Z0,{keyPath:"compositeKey"})}}}catch(n){e(ts.create("storage-open",{originalErrorMessage:n?.message}))}}),kp)}function qH(t,e){return zH(GH(t),e)}function zH(t,e){return C(this,null,function*(){let r=(yield HH()).transaction(Z0,"readwrite"),s=r.objectStore(Z0).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=l=>{o()},r.onerror=l=>{var c;a(ts.create("storage-set",{originalErrorMessage:(c=l.target.error)===null||c===void 0?void 0:c.message}))}})})}function GH(t){return`${t.options.appId}-${t.name}`}var X0=new Ni("@firebase/app-check");function Y0(t,e){return Ah()?qH(t,e).catch(n=>{X0.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function HM(){return jM().enabled}function qM(){return C(this,null,function*(){let t=jM();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var WH={error:"UNKNOWN_ERROR"};function KH(t){return Sh.encodeString(JSON.stringify(t),!1)}function ew(t,e=!1){return C(this,null,function*(){let n=t.app;UM(n);let r=ur(n),i=r.token,s;if(i&&!tu(i)&&(r.token=void 0,i=void 0),!i){let l=yield r.cachedTokenPromise;l&&(tu(l)?i=l:yield Y0(n,void 0))}if(!e&&i&&tu(i))return{token:i.token};let o=!1;if(HM()){r.exchangeTokenPromise||(r.exchangeTokenPromise=BM($M(n,yield qM()),t.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let l=yield r.exchangeTokenPromise;return yield Y0(n,l),r.token=l,{token:l.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield ur(n).exchangeTokenPromise}catch(l){l.code==="appCheck/throttled"?X0.warn(l.message):X0.error(l),s=l}let a;return i?s?tu(i)?a={token:i.token,internalError:s}:a=VM(s):(a={token:i.token},r.token=i,yield Y0(n,i)):a=VM(s),o&&ZH(n,a),a})}function QH(t){return C(this,null,function*(){let e=t.app;UM(e);let{provider:n}=ur(e);if(HM()){let r=yield qM(),{token:i}=yield BM($M(e,r),t.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield n.getToken();return{token:r}}})}function YH(t,e,n,r){let{app:i}=t,s=ur(i),o={next:n,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&tu(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),FM(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>FM(t))}function zM(t,e){let n=ur(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function FM(t){let{app:e}=t,n=ur(e),r=n.tokenRefresher;r||(r=JH(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function JH(t){let{app:e}=t;return new J0(()=>C(this,null,function*(){let n=ur(e),r;if(n.token?r=yield ew(t,!0):r=yield ew(t),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=ur(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,i=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},OM.RETRIAL_MIN_WAIT,OM.RETRIAL_MAX_WAIT)}function ZH(t,e){let n=ur(t).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function tu(t){return t.expireTimeMillis-Date.now()>0}function VM(t){return{token:KH(WH),error:t}}var tw=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=ur(this.app);for(let n of e)zM(this.app,n.next);return Promise.resolve()}};function XH(t,e){return new tw(t,e)}function e6(t){return{getToken:e=>ew(t,e),getLimitedUseToken:()=>QH(t),addTokenListener:e=>YH(t,"INTERNAL",e),removeTokenListener:e=>zM(t.app,e)}}var t6="@firebase/app-check",n6="0.8.3";var r6="app-check",LM="app-check-internal";function i6(){si(new Ut(r6,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return XH(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(LM).initialize()})),si(new Ut(LM,t=>{let e=t.getProvider("app-check").getImmediate();return e6(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),fn(t6,n6)}i6();var s6=["localhost","0.0.0.0","127.0.0.1"],Uoe=typeof window<"u"&&s6.includes(window.location.hostname);var nu=new L("angularfire2.auth.use-emulator"),ru=new L("angularfire2.auth.settings"),iu=new L("angularfire2.auth.tenant-id"),su=new L("angularfire2.auth.langugage-code"),ou=new L("angularfire2.auth.use-device-language"),au=new L("angularfire.auth.persistence"),lu=(t,e,n,r,i,s,o,a)=>es(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let l=e.runOutsideAngular(()=>t.auth());if(n&&l.useEmulator(...n),r&&(l.tenantId=r),l.languageCode=i,s&&l.useDeviceLanguage(),o)for(let[c,u]of Object.entries(o))l.settings[c]=u;return a&&l.setPersistence(a),l},[n,r,i,s,o,a]),cu=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,l,c,u,d,h,g){let y=new ut,w=K(void 0).pipe(yn(o.outsideAngular),Re(()=>s.runOutsideAngular(()=>import("./chunk-TTQNDQTG.js"))),B(()=>mi(n,s,r)),B(v=>lu(v,s,a,c,u,d,l,h)),of({bufferSize:1,refCount:!1}));if(io(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=K(null);else{w.pipe(Nn()).subscribe();let v=w.pipe(Re(P=>P.getRedirectResult().then(F=>F,()=>null)),Ye,of({bufferSize:1,refCount:!1})),T=w.pipe(Re(P=>new oe(F=>({unsubscribe:s.runOutsideAngular(()=>P.onAuthStateChanged(X=>F.next(X),X=>F.error(X),()=>F.complete()))})))),V=w.pipe(Re(P=>new oe(F=>({unsubscribe:s.runOutsideAngular(()=>P.onIdTokenChanged(X=>F.next(X),X=>F.error(X),()=>F.complete()))}))));this.authState=v.pipe(af(T),Zn(o.outsideAngular),yn(o.insideAngular)),this.user=v.pipe(af(V),Zn(o.outsideAngular),yn(o.insideAngular)),this.idToken=this.user.pipe(Re(P=>P?ge(P.getIdToken()):K(null))),this.idTokenResult=this.user.pipe(Re(P=>P?ge(P.getIdTokenResult()):K(null))),this.credential=Oi(v,y,this.authState.pipe(xt(P=>!P))).pipe(B(P=>P?.user?P:null),Zn(o.outsideAngular),yn(o.insideAngular))}return NM(this,w,s,{spy:{apply:(v,T,V)=>{(v.startsWith("signIn")||v.startsWith("createUser"))&&V.then(P=>y.next(P))}}})}static \u0275fac=function(r){return new(r||t)(x(kr),x(Or,8),x(St),x(me),x(Xi),x(nu,8),x(ru,8),x(iu,8),x(su,8),x(ou,8),x(au,8),x(lr,8))};static \u0275prov=z({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),GM=(()=>{class t{constructor(){et.registerVersion("angularfire",cr.full,"auth-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ve({type:t});static \u0275inj=Fe({providers:[cu]})}return t})();var rP="firebasestorage.googleapis.com",iP="storageBucket",o6=2*60*1e3,a6=10*60*1e3,l6=1e3;var tt=class t extends Mh{constructor(e,n,r=0){super(iw(e),`Firebase Storage: ${n} (${iw(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,t.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return iw(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Je=function(t){return t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment",t}(Je||{});function iw(t){return"storage/"+t}function hw(){let t="An unknown error occurred, please check the error payload for server response.";return new tt(Je.UNKNOWN,t)}function c6(t){return new tt(Je.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function u6(t){return new tt(Je.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function d6(){let t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new tt(Je.UNAUTHENTICATED,t)}function h6(){return new tt(Je.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function f6(t){return new tt(Je.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function sP(){return new tt(Je.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function oP(){return new tt(Je.CANCELED,"User canceled the upload/download.")}function p6(t){return new tt(Je.INVALID_URL,"Invalid URL '"+t+"'.")}function g6(t){return new tt(Je.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function m6(){return new tt(Je.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+iP+"' property when initializing the app?")}function aP(){return new tt(Je.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function _6(){return new tt(Je.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function y6(){return new tt(Je.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function v6(t){return new tt(Je.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function oo(t){return new tt(Je.INVALID_ARGUMENT,t)}function lP(){return new tt(Je.APP_DELETED,"The Firebase app was deleted.")}function fw(t){return new tt(Je.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function du(t,e){return new tt(Je.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function uu(t){throw new tt(Je.INTERNAL_ERROR,"Internal error: "+t)}var rn=class t{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=t.makeFromUrl(e,n)}catch{return new t(e,"")}if(r.path==="")return r;throw g6(e)}static makeFromUrl(e,n){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(F){F.path.charAt(F.path.length-1)==="/"&&(F.path_=F.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function c(F){F.path_=decodeURIComponent(F.path)}let u="v[A-Za-z0-9_]+",d=n.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",g=new RegExp(`^https?://${d}/${u}/b/${i}/o${h}`,"i"),y={bucket:1,path:3},w=n===rP?"(?:storage.googleapis.com|storage.cloud.google.com)":n,v="([^?#]*)",T=new RegExp(`^https?://${w}/${i}/${v}`,"i"),P=[{regex:a,indices:l,postModify:s},{regex:g,indices:y,postModify:c},{regex:T,indices:{bucket:1,path:2},postModify:c}];for(let F=0;F<P.length;F++){let X=P[F],ne=X.regex.exec(e);if(ne){let De=ne[X.indices.bucket],pt=ne[X.indices.path];pt||(pt=""),r=new t(De,pt),X.postModify(r);break}}if(r==null)throw p6(e);return r}},ow=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function w6(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...v){c||(c=!0,e.apply(null,v))}function d(v){i=setTimeout(()=>{i=null,t(g,l())},v)}function h(){s&&clearTimeout(s)}function g(v,...T){if(c){h();return}if(v){h(),u.call(null,v,...T);return}if(l()||o){h(),u.call(null,v,...T);return}r<64&&(r*=2);let P;a===1?(a=2,P=0):P=(r+Math.random())*1e3,d(P)}let y=!1;function w(v){y||(y=!0,h(),!c&&(i!==null?(v||(a=2),clearTimeout(i),d(0)):v||(a=1)))}return d(0),s=setTimeout(()=>{o=!0,w(!0)},n),w}function E6(t){t(!1)}function C6(t){return t!==void 0}function b6(t){return typeof t=="function"}function I6(t){return typeof t=="object"&&!Array.isArray(t)}function Lp(t){return typeof t=="string"||t instanceof String}function KM(t){return pw()&&t instanceof Blob}function pw(){return typeof Blob<"u"}function aw(t,e,n,r){if(r<e)throw oo(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw oo(`Invalid value for '${t}'. Expected ${n} or less.`)}function ns(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function cP(t){let e=encodeURIComponent,n="?";for(let r in t)if(t.hasOwnProperty(r)){let i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var qa=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}(qa||{});function uP(t,e){let n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}var lw=class{constructor(e,n,r,i,s,o,a,l,c,u,d,h=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=d,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((g,y)=>{this.resolve_=g,this.reject_=y,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new Ha(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===qa.NO_ERROR,l=s.getStatus();if(!a||uP(l,this.additionalRetryCodes_)&&this.retry){let u=s.getErrorCode()===qa.ABORT;r(!1,new Ha(!1,null,u));return}let c=this.successCodes_.indexOf(l)!==-1;r(!0,new Ha(c,s))})},n=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let l=this.callback_(a,a.getResponse());C6(l)?s(l):s()}catch(l){o(l)}else if(a!==null){let l=hw();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){let l=this.appDelete_?lP():oP();o(l)}else{let l=sP();o(l)}};this.canceled_?n(!1,new Ha(!1,null,!0)):this.backoffId_=w6(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&E6(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Ha=class{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}};function x6(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function T6(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function D6(t,e){e&&(t["X-Firebase-GMPID"]=e)}function S6(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function A6(t,e,n,r,i,s,o=!0){let a=cP(t.urlParams),l=t.url+a,c=Object.assign({},t.headers);return D6(c,e),x6(c,n),T6(c,s),S6(c,r),new lw(l,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}function M6(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function P6(...t){let e=M6();if(e!==void 0){let n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(pw())return new Blob(t);throw new tt(Je.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function R6(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}function N6(t){if(typeof atob>"u")throw v6("base-64");return atob(t)}var En={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},hu=class{constructor(e,n){this.data=e,this.contentType=n||null}};function gw(t,e){switch(t){case En.RAW:return new hu(dP(e));case En.BASE64:case En.BASE64URL:return new hu(hP(t,e));case En.DATA_URL:return new hu(O6(e),F6(e))}throw hw()}function dP(t){let e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{let s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function k6(t){let e;try{e=decodeURIComponent(t)}catch{throw du(En.DATA_URL,"Malformed data URL.")}return dP(e)}function hP(t,e){switch(t){case En.BASE64:{let i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw du(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case En.BASE64URL:{let i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw du(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=N6(e)}catch(i){throw i.message.includes("polyfill")?i:du(t,"Invalid character found")}let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}var Vp=class{constructor(e){this.base64=!1,this.contentType=null;let n=e.match(/^data:([^,]+)?,/);if(n===null)throw du(En.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=n[1]||null;r!=null&&(this.base64=V6(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function O6(t){let e=new Vp(t);return e.base64?hP(En.BASE64,e.rest):k6(e.rest)}function F6(t){return new Vp(t).contentType}function V6(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}var za=class t{constructor(e,n){let r=0,i="";KM(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(KM(this.data_)){let r=this.data_,i=R6(r,e,n);return i===null?null:new t(i)}else{let r=new Uint8Array(this.data_.buffer,e,n-e);return new t(r,!0)}}static getBlob(...e){if(pw()){let n=e.map(r=>r instanceof t?r.data_:r);return new t(P6.apply(null,n))}else{let n=e.map(o=>Lp(o)?gw(En.RAW,o).data:o.data_),r=0;n.forEach(o=>{r+=o.byteLength});let i=new Uint8Array(r),s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new t(i,!0)}}uploadData(){return this.data_}};function mw(t){let e;try{e=JSON.parse(t)}catch{return null}return I6(e)?e:null}function L6(t){if(t.length===0)return null;let e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function j6(t,e){let n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function fP(t){let e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}function U6(t,e){return e}var Ht=class{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||U6}},Fp=null;function B6(t){return!Lp(t)||t.length<2?t:fP(t)}function jp(){if(Fp)return Fp;let t=[];t.push(new Ht("bucket")),t.push(new Ht("generation")),t.push(new Ht("metageneration")),t.push(new Ht("name","fullPath",!0));function e(s,o){return B6(o)}let n=new Ht("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}let i=new Ht("size");return i.xform=r,t.push(i),t.push(new Ht("timeCreated")),t.push(new Ht("updated")),t.push(new Ht("md5Hash",null,!0)),t.push(new Ht("cacheControl",null,!0)),t.push(new Ht("contentDisposition",null,!0)),t.push(new Ht("contentEncoding",null,!0)),t.push(new Ht("contentLanguage",null,!0)),t.push(new Ht("contentType",null,!0)),t.push(new Ht("metadata","customMetadata",!0)),Fp=t,Fp}function $6(t,e){function n(){let r=t.bucket,i=t.fullPath,s=new rn(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function H6(t,e,n){let r={};r.type="file";let i=n.length;for(let s=0;s<i;s++){let o=n[s];r[o.local]=o.xform(r,e[o.server])}return $6(r,t),r}function pP(t,e,n){let r=mw(e);return r===null?null:H6(t,r,n)}function q6(t,e,n,r){let i=mw(e);if(i===null||!Lp(i.downloadTokens))return null;let s=i.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(c=>{let u=t.bucket,d=t.fullPath,h="/b/"+o(u)+"/o/"+o(d),g=ns(h,n,r),y=cP({alt:"media",token:c});return g+y})[0]}function _w(t,e){let n={},r=e.length;for(let i=0;i<r;i++){let s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}var QM="prefixes",YM="items";function z6(t,e,n){let r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[QM])for(let i of n[QM]){let s=i.replace(/\/$/,""),o=t._makeStorageReference(new rn(e,s));r.prefixes.push(o)}if(n[YM])for(let i of n[YM]){let s=t._makeStorageReference(new rn(e,i.name));r.items.push(s)}return r}function G6(t,e,n){let r=mw(n);return r===null?null:z6(t,e,r)}var dr=class{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function Vr(t){if(!t)throw hw()}function Up(t,e){function n(r,i){let s=pP(t,i,e);return Vr(s!==null),s}return n}function W6(t,e){function n(r,i){let s=G6(t,e,i);return Vr(s!==null),s}return n}function K6(t,e){function n(r,i){let s=pP(t,i,e);return Vr(s!==null),q6(s,i,t.host,t._protocol)}return n}function Ka(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=h6():i=d6():n.getStatus()===402?i=u6(t.bucket):n.getStatus()===403?i=f6(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function Bp(t){let e=Ka(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=c6(t.path)),s.serverResponse=i.serverResponse,s}return n}function gP(t,e,n){let r=e.fullServerUrl(),i=ns(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new dr(i,s,Up(t,n),o);return a.errorHandler=Bp(e),a}function Q6(t,e,n,r,i){let s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",n&&n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);let o=e.bucketOnlyServerUrl(),a=ns(o,t.host,t._protocol),l="GET",c=t.maxOperationRetryTime,u=new dr(a,l,W6(t,e.bucket),c);return u.urlParams=s,u.errorHandler=Ka(e),u}function Y6(t,e,n){let r=e.fullServerUrl(),i=ns(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new dr(i,s,K6(t,n),o);return a.errorHandler=Bp(e),a}function J6(t,e,n,r){let i=e.fullServerUrl(),s=ns(i,t.host,t._protocol),o="PATCH",a=_w(n,r),l={"Content-Type":"application/json; charset=utf-8"},c=t.maxOperationRetryTime,u=new dr(s,o,Up(t,r),c);return u.headers=l,u.body=a,u.errorHandler=Bp(e),u}function Z6(t,e){let n=e.fullServerUrl(),r=ns(n,t.host,t._protocol),i="DELETE",s=t.maxOperationRetryTime;function o(l,c){}let a=new dr(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=Bp(e),a}function X6(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function mP(t,e,n){let r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=X6(null,e)),r}function e9(t,e,n,r,i){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let P="";for(let F=0;F<2;F++)P=P+Math.random().toString().slice(2);return P}let l=a();o["Content-Type"]="multipart/related; boundary="+l;let c=mP(e,r,i),u=_w(c,n),d="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,h=`\r
--`+l+"--",g=za.getBlob(d,r,h);if(g===null)throw aP();let y={name:c.fullPath},w=ns(s,t.host,t._protocol),v="POST",T=t.maxUploadRetryTime,V=new dr(w,v,Up(t,n),T);return V.urlParams=y,V.headers=o,V.body=g.uploadData(),V.errorHandler=Ka(e),V}var Ga=class{constructor(e,n,r,i){this.current=e,this.total=n,this.finalized=!!r,this.metadata=i||null}};function yw(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{Vr(!1)}return Vr(!!n&&(e||["active"]).indexOf(n)!==-1),n}function t9(t,e,n,r,i){let s=e.bucketOnlyServerUrl(),o=mP(e,r,i),a={name:o.fullPath},l=ns(s,t.host,t._protocol),c="POST",u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},d=_w(o,n),h=t.maxUploadRetryTime;function g(w){yw(w);let v;try{v=w.getResponseHeader("X-Goog-Upload-URL")}catch{Vr(!1)}return Vr(Lp(v)),v}let y=new dr(l,c,g,h);return y.urlParams=a,y.headers=u,y.body=d,y.errorHandler=Ka(e),y}function n9(t,e,n,r){let i={"X-Goog-Upload-Command":"query"};function s(c){let u=yw(c,["active","final"]),d=null;try{d=c.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Vr(!1)}d||Vr(!1);let h=Number(d);return Vr(!isNaN(h)),new Ga(h,r.size(),u==="final")}let o="POST",a=t.maxUploadRetryTime,l=new dr(n,o,s,a);return l.headers=i,l.errorHandler=Ka(e),l}var JM=256*1024;function r9(t,e,n,r,i,s,o,a){let l=new Ga(0,0);if(o?(l.current=o.current,l.total=o.total):(l.current=0,l.total=r.size()),r.size()!==l.total)throw _6();let c=l.total-l.current,u=c;i>0&&(u=Math.min(u,i));let d=l.current,h=d+u,g="";u===0?g="finalize":c===u?g="upload, finalize":g="upload";let y={"X-Goog-Upload-Command":g,"X-Goog-Upload-Offset":`${l.current}`},w=r.slice(d,h);if(w===null)throw aP();function v(F,X){let ne=yw(F,["active","final"]),De=l.current+u,pt=r.size(),Vs;return ne==="final"?Vs=Up(e,s)(F,X):Vs=null,new Ga(De,pt,ne==="final",Vs)}let T="POST",V=e.maxUploadRetryTime,P=new dr(n,T,v,V);return P.headers=y,P.body=w.uploadData(),P.progressCallback=a||null,P.errorHandler=Ka(t),P}var _P={STATE_CHANGED:"state_changed"},Kt={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function sw(t){switch(t){case"running":case"pausing":case"canceling":return Kt.RUNNING;case"paused":return Kt.PAUSED;case"success":return Kt.SUCCESS;case"canceled":return Kt.CANCELED;case"error":return Kt.ERROR;default:return Kt.ERROR}}var cw=class{constructor(e,n,r){if(b6(e)||n!=null||r!=null)this.next=e,this.error=n??void 0,this.complete=r??void 0;else{let s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}};function $a(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}var ZM=null,uw=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=qa.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=qa.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=qa.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw uu("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(let s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw uu("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw uu("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw uu("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw uu("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},dw=class extends uw{initXhr(){this.xhr_.responseType="text"}};function Fr(){return ZM?ZM():new dw}var fu=class{constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=jp(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(Je.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let s=this.isExponentialBackoffExpired();if(uP(i.status,[]))if(s)i=sP();else{this.sleepTime=Math.max(this.sleepTime*2,l6),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(Je.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){let e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{let r=t9(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Fr,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((n,r)=>{let i=n9(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,Fr,n,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=JM*this._chunkMultiplier,n=new Ga(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=r9(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(l){this._error=l,this._transition("error");return}let a=this._ref.storage._makeRequest(o,Fr,i,s,!1);this._request=a,a.getPromise().then(l=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(l.current),l.finalized?(this._metadata=l.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){JM*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{let r=gP(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Fr,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{let r=e9(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Fr,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=oP(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let e=sw(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,i){let s=new cw(n||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(sw(this._state)){case Kt.SUCCESS:$a(this._resolve.bind(null,this.snapshot))();break;case Kt.CANCELED:case Kt.ERROR:let n=this._reject;$a(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(sw(this._state)){case Kt.RUNNING:case Kt.PAUSED:e.next&&$a(e.next.bind(e,this.snapshot))();break;case Kt.SUCCESS:e.complete&&$a(e.complete.bind(e))();break;case Kt.CANCELED:case Kt.ERROR:e.error&&$a(e.error.bind(e,this._error))();break;default:e.error&&$a(e.error.bind(e,this._error))()}}resume(){let e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){let e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){let e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}};var Wa=class t{constructor(e,n){this._service=e,n instanceof rn?this._location=n:this._location=rn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new t(e,n)}get root(){let e=new rn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return fP(this._location.path)}get storage(){return this._service}get parent(){let e=L6(this._location.path);if(e===null)return null;let n=new rn(this._location.bucket,e);return new t(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw fw(e)}};function i9(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new fu(t,new za(e),n)}function s9(t){let e={prefixes:[],items:[]};return yP(t,e).then(()=>e)}function yP(t,e,n){return C(this,null,function*(){let i=yield vP(t,{pageToken:n});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&(yield yP(t,e,i.nextPageToken))})}function vP(t,e){e!=null&&typeof e.maxResults=="number"&&aw("options.maxResults",1,1e3,e.maxResults);let n=e||{},r=Q6(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,Fr)}function o9(t){t._throwIfRoot("getMetadata");let e=gP(t.storage,t._location,jp());return t.storage.makeRequestWithTokens(e,Fr)}function a9(t,e){t._throwIfRoot("updateMetadata");let n=J6(t.storage,t._location,e,jp());return t.storage.makeRequestWithTokens(n,Fr)}function l9(t){t._throwIfRoot("getDownloadURL");let e=Y6(t.storage,t._location,jp());return t.storage.makeRequestWithTokens(e,Fr).then(n=>{if(n===null)throw y6();return n})}function c9(t){t._throwIfRoot("deleteObject");let e=Z6(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Fr)}function wP(t,e){let n=j6(t._location.path,e),r=new rn(t._location.bucket,n);return new Wa(t.storage,r)}function u9(t){return/^[A-Za-z]+:\/\//.test(t)}function d9(t,e){return new Wa(t,e)}function EP(t,e){if(t instanceof pu){let n=t;if(n._bucket==null)throw m6();let r=new Wa(n,n._bucket);return e!=null?EP(r,e):r}else return e!==void 0?wP(t,e):t}function h9(t,e){if(e&&u9(e)){if(t instanceof pu)return d9(t,e);throw oo("To use ref(service, url), the first argument must be a Storage instance.")}else return EP(t,e)}function XM(t,e){let n=e?.[iP];return n==null?null:rn.makeFromBucketSpec(n,t)}function f9(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";let{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:Xo(i,t.app.options.projectId))}var pu=class{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=rP,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=o6,this._maxUploadRetryTime=a6,this._requests=new Set,i!=null?this._bucket=rn.makeFromBucketSpec(i,this._host):this._bucket=XM(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=rn.makeFromBucketSpec(this._url,e):this._bucket=XM(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){aw("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){aw("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return C(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let n=yield e.getToken();if(n!==null)return n.accessToken}return null})}_getAppCheckToken(){return C(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Wa(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new ow(lP());{let o=A6(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,n){return C(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()})}},eP="@firebase/storage",tP="0.12.4";var p9="storage";function CP(t,e,n){return t=se(t),i9(t,e,n)}function bP(t){return t=se(t),o9(t)}function IP(t,e){return t=se(t),a9(t,e)}function xP(t,e){return t=se(t),vP(t,e)}function TP(t){return t=se(t),s9(t)}function DP(t){return t=se(t),l9(t)}function SP(t){return t=se(t),c9(t)}function vw(t,e){return t=se(t),h9(t,e)}function AP(t,e){return wP(t,e)}function MP(t,e,n,r={}){f9(t,e,n,r)}function g9(t,{instanceIdentifier:e}){let n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new pu(n,r,i,e,ea)}function m9(){si(new Ut(p9,g9,"PUBLIC").setMultipleInstances(!0)),fn(eP,tP,""),fn(eP,tP,"esm2017")}m9();var Qa=class{constructor(e,n,r){this._delegate=e,this.task=n,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}};var $p=class{constructor(e,n){this._delegate=e,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new Qa(this._delegate.snapshot,this,this._ref)}then(e,n){return this._delegate.then(r=>{if(e)return e(new Qa(r,this,this._ref))},n)}on(e,n,r,i){let s;return n&&(typeof n=="function"?s=o=>n(new Qa(o,this,this._ref)):s={next:n.next?o=>n.next(new Qa(o,this,this._ref)):void 0,complete:n.complete||void 0,error:n.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}},Hp=class{constructor(e,n){this._delegate=e,this._service=n}get prefixes(){return this._delegate.prefixes.map(e=>new ao(e,this._service))}get items(){return this._delegate.items.map(e=>new ao(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}};var ao=class t{constructor(e,n){this._delegate=e,this.storage=n}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){let n=AP(this._delegate,e);return new t(n,this.storage)}get root(){return new t(this._delegate.root,this.storage)}get parent(){let e=this._delegate.parent;return e==null?null:new t(e,this.storage)}put(e,n){return this._throwIfRoot("put"),new $p(CP(this._delegate,e,n),this)}putString(e,n=En.RAW,r){this._throwIfRoot("putString");let i=gw(n,e),s=Object.assign({},r);return s.contentType==null&&i.contentType!=null&&(s.contentType=i.contentType),new $p(new fu(this._delegate,new za(i.data,!0),s),this)}listAll(){return TP(this._delegate).then(e=>new Hp(e,this.storage))}list(e){return xP(this._delegate,e||void 0).then(n=>new Hp(n,this.storage))}getMetadata(){return bP(this._delegate)}updateMetadata(e){return IP(this._delegate,e)}getDownloadURL(){return DP(this._delegate)}delete(){return this._throwIfRoot("delete"),SP(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw fw(e)}};var qp=class{constructor(e,n){this.app=e,this._delegate=n}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(PP(e))throw oo("ref() expected a child path but got a URL, use refFromURL instead.");return new ao(vw(this._delegate,e),this)}refFromURL(e){if(!PP(e))throw oo("refFromURL() expected a full URL but got a child path, use ref() instead.");try{rn.makeFromUrl(e,this._delegate.host)}catch{throw oo("refFromUrl() expected a valid full URL but got an invalid one.")}return new ao(vw(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,n,r={}){MP(this._delegate,e,n,r)}};function PP(t){return/^[A-Za-z]+:\/\//.test(t)}var _9="@firebase/storage-compat",y9="0.3.7";var v9="storage-compat";function w9(t,{instanceIdentifier:e}){let n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("storage").getImmediate({identifier:e});return new qp(n,r)}function E9(t){let e={TaskState:Kt,TaskEvent:_P,StringFormat:En,Storage:qp,Reference:ao};t.INTERNAL.registerComponent(new Ut(v9,w9,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion(_9,y9)}E9(et);function C9(t){return new oe(e=>{let n=o=>e.next(o),r=o=>e.error(o),i=()=>e.complete();n(t.snapshot);let s=t.on("state_changed",n);return t.then(o=>{n(o),i()},o=>{n(t.snapshot),r(o)}),function(){s()}}).pipe(by(0))}function RP(t){let e=C9(t);return{task:t,then:t.then.bind(t),catch:t.catch.bind(t),pause:t.pause.bind(t),cancel:t.cancel.bind(t),resume:t.resume.bind(t),snapshotChanges:()=>e,percentageChanges:()=>e.pipe(B(n=>n.bytesTransferred/n.totalBytes*100))}}function zp(t){return{getDownloadURL:()=>K(void 0).pipe(Q0,Re(()=>t.getDownloadURL()),Ye),getMetadata:()=>K(void 0).pipe(Q0,Re(()=>t.getMetadata()),Ye),delete:()=>ge(t.delete()),child:e=>zp(t.child(e)),updateMetadata:e=>ge(t.updateMetadata(e)),put:(e,n)=>{let r=t.put(e,n);return RP(r)},putString:(e,n,r)=>{let i=t.putString(e,n,r);return RP(i)},list:e=>ge(t.list(e)),listAll:()=>ge(t.listAll())}}var b9=new L("angularfire2.storageBucket"),I9=new L("angularfire2.storage.maxUploadRetryTime"),x9=new L("angularfire2.storage.maxOperationRetryTime"),T9=new L("angularfire2.storage.use-emulator"),D9=(()=>{class t{storage;constructor(n,r,i,s,o,a,l,c,u,d){let h=mi(n,o,r);this.storage=es(`${h.name}.storage.${i}`,"AngularFireStorage",h.name,()=>{let g=o.runOutsideAngular(()=>h.storage(i||void 0)),y=u;return y&&g.useEmulator(...y),l&&g.setMaxUploadRetryTime(l),c&&g.setMaxOperationRetryTime(c),g},[l,c])}ref(n){return zp(this.storage.ref(n))}refFromURL(n){return zp(this.storage.refFromURL(n))}upload(n,r,i){let s=this.storage.ref(n);return zp(s).put(r,i)}static \u0275fac=function(r){return new(r||t)(x(kr),x(Or,8),x(b9,8),x(St),x(me),x(Xi),x(I9,8),x(x9,8),x(T9,8),x(lr,8))};static \u0275prov=z({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var S9=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ve({type:t});static \u0275inj=Fe({})}return t})(),NP=(()=>{class t{constructor(){et.registerVersion("angularfire",cr.full,"gcs-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ve({type:t});static \u0275inj=Fe({providers:[D9],imports:[S9]})}return t})();var A9=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},fr={},H,Bw=Bw||{},ue=A9||self;function sg(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Su(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function M9(t){return Object.prototype.hasOwnProperty.call(t,ww)&&t[ww]||(t[ww]=++P9)}var ww="closure_uid_"+(1e9*Math.random()>>>0),P9=0;function R9(t,e,n){return t.call.apply(t.bind,arguments)}function N9(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Qt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Qt=R9:Qt=N9,Qt.apply(null,arguments)}function Gp(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Ot(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function rs(){this.s=this.s,this.o=this.o}var k9=0;rs.prototype.s=!1;rs.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),k9!=0)&&M9(this)};rs.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var GP=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function $w(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function kP(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(sg(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function Yt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Yt.prototype.h=function(){this.defaultPrevented=!0};var O9=function(){if(!ue.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};ue.addEventListener("test",n,e),ue.removeEventListener("test",n,e)}catch{}return t}();function wu(t){return/^[\s\xa0]*$/.test(t)}function og(){var t=ue.navigator;return t&&(t=t.userAgent)?t:""}function Lr(t){return og().indexOf(t)!=-1}function Hw(t){return Hw[" "](t),t}Hw[" "]=function(){};function F9(t,e){var n=Iq;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var V9=Lr("Opera"),Xa=Lr("Trident")||Lr("MSIE"),WP=Lr("Edge"),xw=WP||Xa,KP=Lr("Gecko")&&!(og().toLowerCase().indexOf("webkit")!=-1&&!Lr("Edge"))&&!(Lr("Trident")||Lr("MSIE"))&&!Lr("Edge"),L9=og().toLowerCase().indexOf("webkit")!=-1&&!Lr("Edge");function QP(){var t=ue.document;return t?t.documentMode:void 0}var Tw;e:{if(Wp="",Kp=function(){var t=og();if(KP)return/rv:([^\);]+)(\)|;)/.exec(t);if(WP)return/Edge\/([\d\.]+)/.exec(t);if(Xa)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(L9)return/WebKit\/(\S+)/.exec(t);if(V9)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),Kp&&(Wp=Kp?Kp[1]:""),Xa&&(Qp=QP(),Qp!=null&&Qp>parseFloat(Wp))){Tw=String(Qp);break e}Tw=Wp}var Wp,Kp,Qp,Dw;ue.document&&Xa?(Ew=QP(),Dw=Ew||parseInt(Tw,10)||void 0):Dw=void 0;var Ew,j9=Dw;function Eu(t,e){if(Yt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(KP){e:{try{Hw(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:U9[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Eu.$.h.call(this)}}Ot(Eu,Yt);var U9={2:"touch",3:"pen",4:"mouse"};Eu.prototype.h=function(){Eu.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Au="closure_listenable_"+(1e6*Math.random()|0),B9=0;function $9(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++B9,this.fa=this.ia=!1}function ag(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function qw(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function H9(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function YP(t){let e={};for(let n in t)e[n]=t[n];return e}var OP="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function JP(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<OP.length;s++)n=OP[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function lg(t){this.src=t,this.g={},this.h=0}lg.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=Aw(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new $9(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function Sw(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=GP(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(ag(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Aw(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var zw="closure_lm_"+(1e6*Math.random()|0),Cw={};function ZP(t,e,n,r,i){if(r&&r.once)return eR(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)ZP(t,e[s],n,r,i);return null}return n=Kw(n),t&&t[Au]?t.O(e,n,Su(r)?!!r.capture:!!r,i):XP(t,e,n,!1,r,i)}function XP(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=Su(i)?!!i.capture:!!i,a=Ww(t);if(a||(t[zw]=a=new lg(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=q9(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)O9||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(nR(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function q9(){function t(n){return e.call(t.src,t.listener,n)}let e=z9;return t}function eR(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)eR(t,e[s],n,r,i);return null}return n=Kw(n),t&&t[Au]?t.P(e,n,Su(r)?!!r.capture:!!r,i):XP(t,e,n,!0,r,i)}function tR(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)tR(t,e[s],n,r,i);else r=Su(r)?!!r.capture:!!r,n=Kw(n),t&&t[Au]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=Aw(s,n,r,i),-1<n&&(ag(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=Ww(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Aw(e,n,r,i)),(n=-1<t?e[t]:null)&&Gw(n))}function Gw(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Au])Sw(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(nR(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ww(e))?(Sw(n,t),n.h==0&&(n.src=null,e[zw]=null)):ag(t)}}}function nR(t){return t in Cw?Cw[t]:Cw[t]="on"+t}function z9(t,e){if(t.fa)t=!0;else{e=new Eu(e,this);var n=t.listener,r=t.la||t.src;t.ia&&Gw(t),t=n.call(r,e)}return t}function Ww(t){return t=t[zw],t instanceof lg?t:null}var bw="__closure_events_fn_"+(1e9*Math.random()>>>0);function Kw(t){return typeof t=="function"?t:(t[bw]||(t[bw]=function(e){return t.handleEvent(e)}),t[bw])}function kt(){rs.call(this),this.i=new lg(this),this.S=this,this.J=null}Ot(kt,rs);kt.prototype[Au]=!0;kt.prototype.removeEventListener=function(t,e,n,r){tR(this,t,e,n,r)};function zt(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new Yt(e,t);else if(e instanceof Yt)e.target=e.target||t;else{var i=e;e=new Yt(r,t),JP(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=Yp(o,r,!0,e)&&i}if(o=e.g=t,i=Yp(o,r,!0,e)&&i,i=Yp(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=Yp(o,r,!1,e)&&i}kt.prototype.N=function(){if(kt.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)ag(n[r]);delete t.g[e],t.h--}}this.J=null};kt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};kt.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function Yp(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,l=o.la||o.src;o.ia&&Sw(t.i,o),i=a.call(l,r)!==!1&&i}}return i&&!r.defaultPrevented}var Qw=ue.JSON.stringify,Mw=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function G9(){var t=Yw;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Pw=class{constructor(){this.h=this.g=null}add(e,n){let r=rR.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},rR=new Mw(()=>new Rw,t=>t.reset()),Rw=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function W9(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function K9(t){ue.setTimeout(()=>{throw t},0)}var Cu,bu=!1,Yw=new Pw,iR=()=>{let t=ue.Promise.resolve(void 0);Cu=()=>{t.then(Q9)}},Q9=()=>{for(var t;t=G9();){try{t.h.call(t.g)}catch(n){K9(n)}var e=rR;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}bu=!1};function cg(t,e){kt.call(this),this.h=t||1,this.g=e||ue,this.j=Qt(this.qb,this),this.l=Date.now()}Ot(cg,kt);H=cg.prototype;H.ga=!1;H.T=null;H.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),zt(this,"tick"),this.ga&&(Jw(this),this.start()))}};H.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Jw(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}H.N=function(){cg.$.N.call(this),Jw(this),delete this.g};function Zw(t,e,n){if(typeof t=="function")n&&(t=Qt(t,n));else if(t&&typeof t.handleEvent=="function")t=Qt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:ue.setTimeout(t,e||0)}function sR(t){t.g=Zw(()=>{t.g=null,t.i&&(t.i=!1,sR(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var Nw=class extends rs{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:sR(this)}N(){super.N(),this.g&&(ue.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function Iu(t){rs.call(this),this.h=t,this.g={}}Ot(Iu,rs);var FP=[];function oR(t,e,n,r){Array.isArray(n)||(n&&(FP[0]=n.toString()),n=FP);for(var i=0;i<n.length;i++){var s=ZP(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function aR(t){qw(t.g,function(e,n){this.g.hasOwnProperty(n)&&Gw(e)},t),t.g={}}Iu.prototype.N=function(){Iu.$.N.call(this),aR(this)};Iu.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function ug(){this.g=!0}ug.prototype.Ea=function(){this.g=!1};function Y9(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");o=2<=d.length&&d[1]=="type"?o+(u+"="+c+"&"):o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function J9(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function Ja(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+X9(t,n)+(r?" "+r:"")})}function Z9(t,e){t.info(function(){return"TIMEOUT: "+e})}ug.prototype.info=function(){};function X9(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return Qw(n)}catch{return e}}var ho={},VP=null;function dg(){return VP=VP||new kt}ho.Ta="serverreachability";function lR(t){Yt.call(this,ho.Ta,t)}Ot(lR,Yt);function xu(t){let e=dg();zt(e,new lR(e))}ho.STAT_EVENT="statevent";function cR(t,e){Yt.call(this,ho.STAT_EVENT,t),this.stat=e}Ot(cR,Yt);function sn(t){let e=dg();zt(e,new cR(e,t))}ho.Ua="timingevent";function uR(t,e){Yt.call(this,ho.Ua,t),this.size=e}Ot(uR,Yt);function Mu(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return ue.setTimeout(function(){t()},e)}var hg={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},dR={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Xw(){}Xw.prototype.h=null;function LP(t){return t.h||(t.h=t.i())}function hR(){}var Pu={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function eE(){Yt.call(this,"d")}Ot(eE,Yt);function tE(){Yt.call(this,"c")}Ot(tE,Yt);var kw;function fg(){}Ot(fg,Xw);fg.prototype.g=function(){return new XMLHttpRequest};fg.prototype.i=function(){return{}};kw=new fg;function Ru(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Iu(this),this.P=eq,t=xw?125:void 0,this.V=new cg(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new fR}function fR(){this.i=null,this.g="",this.h=!1}var eq=45e3,pR={},Ow={};H=Ru.prototype;H.setTimeout=function(t){this.P=t};function Fw(t,e,n){t.L=1,t.A=gg(yi(e)),t.u=n,t.S=!0,gR(t,null)}function gR(t,e){t.G=Date.now(),Nu(t),t.B=yi(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),bR(n.i,"t",r),t.o=0,n=t.l.J,t.h=new fR,t.g=qR(t.l,n?e:null,!t.u),0<t.O&&(t.M=new Nw(Qt(t.Pa,t,t.g),t.O)),oR(t.U,t.g,"readystatechange",t.nb),e=t.I?YP(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),xu(),Y9(t.j,t.v,t.B,t.m,t.W,t.u)}H.nb=function(t){t=t.target;let e=this.M;e&&jr(t)==3?e.l():this.Pa(t)};H.Pa=function(t){try{if(t==this.g)e:{let u=jr(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>u)&&(u!=3||xw||this.g&&(this.h.h||this.g.ja()||$P(this.g)))){this.J||u!=4||e==7||(e==8||0>=d?xu(3):xu(2)),pg(this);var n=this.g.da();this.ca=n;t:if(mR(this)){var r=$P(this.g);t="";var i=r.length,s=jr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){lo(this),vu(this);var o="";break t}this.h.i=new ue.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,J9(this.j,this.v,this.B,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!wu(a)){var c=a;break t}}c=null}if(n=c)Ja(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Vw(this,n);else{this.i=!1,this.s=3,sn(12),lo(this),vu(this);break e}}this.S?(_R(this,u,o),xw&&this.i&&u==3&&(oR(this.U,this.V,"tick",this.mb),this.V.start())):(Ja(this.j,this.m,o,null),Vw(this,o)),u==4&&lo(this),this.i&&!this.J&&(u==4?UR(this.l,this):(this.i=!1,Nu(this)))}else Eq(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,sn(12)):(this.s=0,sn(13)),lo(this),vu(this)}}}catch{}finally{}};function mR(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function _R(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=tq(t,n),i==Ow){e==4&&(t.s=4,sn(14),r=!1),Ja(t.j,t.m,null,"[Incomplete Response]");break}else if(i==pR){t.s=4,sn(15),Ja(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Ja(t.j,t.m,i,null),Vw(t,i);mR(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,sn(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),aE(e),e.M=!0,sn(11))):(Ja(t.j,t.m,n,"[Invalid Chunked Response]"),lo(t),vu(t))}H.mb=function(){if(this.g){var t=jr(this.g),e=this.g.ja();this.o<e.length&&(pg(this),_R(this,t,e),this.i&&t!=4&&Nu(this))}};function tq(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?Ow:(n=Number(e.substring(n,r)),isNaN(n)?pR:(r+=1,r+n>e.length?Ow:(e=e.slice(r,r+n),t.o=r+n,e)))}H.cancel=function(){this.J=!0,lo(this)};function Nu(t){t.Y=Date.now()+t.P,yR(t,t.P)}function yR(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=Mu(Qt(t.lb,t),e)}function pg(t){t.C&&(ue.clearTimeout(t.C),t.C=null)}H.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(Z9(this.j,this.B),this.L!=2&&(xu(),sn(17)),lo(this),this.s=2,vu(this)):yR(this,this.Y-t)};function vu(t){t.l.H==0||t.J||UR(t.l,t)}function lo(t){pg(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,Jw(t.V),aR(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Vw(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||Lw(n.i,t))){if(!t.K&&Lw(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)tg(n),yg(n);else break e;oE(n),sn(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=Mu(Qt(n.ib,n),6e3));if(1>=TR(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else co(n,11)}else if((t.K||n.g==t)&&tg(n),!wu(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let c=i[e];if(n.V=c[0],c=c[1],n.H==2)if(c[0]=="c"){n.K=c[1],n.pa=c[2];let u=c[3];u!=null&&(n.ra=u,n.l.info("VER="+n.ra));let d=c[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let h=c[5];h!=null&&typeof h=="number"&&0<h&&(r=1.5*h,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let g=t.g;if(g){let y=g.g?g.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(y){var s=r.i;s.g||y.indexOf("spdy")==-1&&y.indexOf("quic")==-1&&y.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(nE(s,s.h),s.h=null))}if(r.F){let w=g.g?g.g.getResponseHeader("X-HTTP-Session-Id"):null;w&&(r.Da=w,We(r.I,r.F,w))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=HR(r,r.J?r.pa:null,r.Y),o.K){DR(r.i,o);var a=o,l=r.L;l&&a.setTimeout(l),a.C&&(pg(a),Nu(a)),r.g=o}else LR(r);0<n.j.length&&vg(n)}else c[0]!="stop"&&c[0]!="close"||co(n,7);else n.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?co(n,7):sE(n):c[0]!="noop"&&n.h&&n.h.Aa(c),n.A=0)}}xu(4)}catch{}}function nq(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(sg(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function rq(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(sg(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function vR(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(sg(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=rq(t),r=nq(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var wR=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function iq(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function uo(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof uo){this.h=t.h,Xp(this,t.j),this.s=t.s,this.g=t.g,eg(this,t.m),this.l=t.l;var e=t.i,n=new Tu;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),jP(this,n),this.o=t.o}else t&&(e=String(t).match(wR))?(this.h=!1,Xp(this,e[1]||"",!0),this.s=_u(e[2]||""),this.g=_u(e[3]||"",!0),eg(this,e[4]),this.l=_u(e[5]||"",!0),jP(this,e[6]||"",!0),this.o=_u(e[7]||"")):(this.h=!1,this.i=new Tu(null,this.h))}uo.prototype.toString=function(){var t=[],e=this.j;e&&t.push(yu(e,UP,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(yu(e,UP,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(yu(n,n.charAt(0)=="/"?aq:oq,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",yu(n,cq)),t.join("")};function yi(t){return new uo(t)}function Xp(t,e,n){t.j=n?_u(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function eg(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function jP(t,e,n){e instanceof Tu?(t.i=e,uq(t.i,t.h)):(n||(e=yu(e,lq)),t.i=new Tu(e,t.h))}function We(t,e,n){t.i.set(e,n)}function gg(t){return We(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function _u(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function yu(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,sq),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sq(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var UP=/[#\/\?@]/g,oq=/[#\?:]/g,aq=/[#\?]/g,lq=/[#\?@]/g,cq=/#/g;function Tu(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function is(t){t.g||(t.g=new Map,t.h=0,t.i&&iq(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}H=Tu.prototype;H.add=function(t,e){is(this),this.i=null,t=el(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function ER(t,e){is(t),e=el(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function CR(t,e){return is(t),e=el(t,e),t.g.has(e)}H.forEach=function(t,e){is(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};H.ta=function(){is(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};H.Z=function(t){is(this);let e=[];if(typeof t=="string")CR(this,t)&&(e=e.concat(this.g.get(el(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};H.set=function(t,e){return is(this),this.i=null,t=el(this,t),CR(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};H.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function bR(t,e,n){ER(t,e),0<n.length&&(t.i=null,t.g.set(el(t,e),$w(n)),t.h+=n.length)}H.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function el(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function uq(t,e){e&&!t.j&&(is(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(ER(this,r),bR(this,i,n))},t)),t.j=e}var dq=class{constructor(t,e){this.g=t,this.map=e}};function IR(t){this.l=t||hq,ue.PerformanceNavigationTiming?(t=ue.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(ue.g&&ue.g.Ka&&ue.g.Ka()&&ue.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var hq=10;function xR(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function TR(t){return t.h?1:t.g?t.g.size:0}function Lw(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function nE(t,e){t.g?t.g.add(e):t.h=e}function DR(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}IR.prototype.cancel=function(){if(this.i=SR(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function SR(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return $w(t.i)}var fq=class{stringify(t){return ue.JSON.stringify(t,void 0)}parse(t){return ue.JSON.parse(t,void 0)}};function pq(){this.g=new fq}function gq(t,e,n){let r=n||"";try{vR(t,function(i,s){let o=i;Su(i)&&(o=Qw(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function mq(t,e){let n=new ug;if(ue.Image){let r=new Image;r.onload=Gp(Jp,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Gp(Jp,n,r,"TestLoadImage: error",!1,e),r.onabort=Gp(Jp,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Gp(Jp,n,r,"TestLoadImage: timeout",!1,e),ue.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function Jp(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function ku(t){this.l=t.ec||null,this.j=t.ob||!1}Ot(ku,Xw);ku.prototype.g=function(){return new mg(this.l,this.j)};ku.prototype.i=function(t){return function(){return t}}({});function mg(t,e){kt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=rE,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ot(mg,kt);var rE=0;H=mg.prototype;H.open=function(t,e){if(this.readyState!=rE)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Du(this)};H.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||ue).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};H.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ou(this)),this.readyState=rE};H.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Du(this)),this.g&&(this.readyState=3,Du(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof ue.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;AR(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function AR(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}H.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Ou(this):Du(this),this.readyState==3&&AR(this)}};H.Za=function(t){this.g&&(this.response=this.responseText=t,Ou(this))};H.Ya=function(t){this.g&&(this.response=t,Ou(this))};H.ka=function(){this.g&&Ou(this)};function Ou(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Du(t)}H.setRequestHeader=function(t,e){this.v.append(t,e)};H.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};H.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Du(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(mg.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var _q=ue.JSON.parse;function at(t){kt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=MR,this.L=this.M=!1}Ot(at,kt);var MR="",yq=/^https?$/i,vq=["POST","PUT"];H=at.prototype;H.Oa=function(t){this.M=t};H.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():kw.g(),this.C=this.u?LP(this.u):LP(kw),this.g.onreadystatechange=Qt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){BP(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=ue.FormData&&t instanceof ue.FormData,!(0<=GP(vq,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{NR(this),0<this.B&&((this.L=wq(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Qt(this.ua,this)):this.A=Zw(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){BP(this,s)}};function wq(t){return Xa&&typeof t.timeout=="number"&&t.ontimeout!==void 0}H.ua=function(){typeof Bw<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,zt(this,"timeout"),this.abort(8))};function BP(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,PR(t),_g(t)}function PR(t){t.F||(t.F=!0,zt(t,"complete"),zt(t,"error"))}H.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,zt(this,"complete"),zt(this,"abort"),_g(this))};H.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),_g(this,!0)),at.$.N.call(this)};H.La=function(){this.s||(this.G||this.v||this.l?RR(this):this.kb())};H.kb=function(){RR(this)};function RR(t){if(t.h&&typeof Bw<"u"&&(!t.C[1]||jr(t)!=4||t.da()!=2)){if(t.v&&jr(t)==4)Zw(t.La,0,t);else if(zt(t,"readystatechange"),jr(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(wR)[1]||null;!i&&ue.self&&ue.self.location&&(i=ue.self.location.protocol.slice(0,-1)),r=!yq.test(i?i.toLowerCase():"")}n=r}if(n)zt(t,"complete"),zt(t,"success");else{t.m=6;try{var s=2<jr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",PR(t)}}finally{_g(t)}}}}function _g(t,e){if(t.g){NR(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||zt(t,"ready");try{n.onreadystatechange=r}catch{}}}function NR(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(ue.clearTimeout(t.A),t.A=null)}H.isActive=function(){return!!this.g};function jr(t){return t.g?t.g.readyState:0}H.da=function(){try{return 2<jr(this)?this.g.status:-1}catch{return-1}};H.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};H.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),_q(e)}};function $P(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case MR:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function Eq(t){let e={};t=(t.g&&2<=jr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(wu(t[r]))continue;var n=W9(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}H9(e,function(r){return r.join(", ")})}H.Ia=function(){return this.m};H.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function kR(t){let e="";return qw(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function iE(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=kR(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):We(t,e,n))}function gu(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function OR(t){this.Ga=0,this.j=[],this.l=new ug,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=gu("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=gu("baseRetryDelayMs",5e3,t),this.hb=gu("retryDelaySeedMs",1e4,t),this.eb=gu("forwardChannelMaxRetries",2,t),this.xa=gu("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new IR(t&&t.concurrentRequestLimit),this.Ja=new pq,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}H=OR.prototype;H.ra=8;H.H=1;function sE(t){if(FR(t),t.H==3){var e=t.W++,n=yi(t.I);if(We(n,"SID",t.K),We(n,"RID",e),We(n,"TYPE","terminate"),Fu(t,n),e=new Ru(t,t.l,e),e.L=2,e.A=gg(yi(n)),n=!1,ue.navigator&&ue.navigator.sendBeacon)try{n=ue.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&ue.Image&&(new Image().src=e.A,n=!0),n||(e.g=qR(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Nu(e)}$R(t)}function yg(t){t.g&&(aE(t),t.g.cancel(),t.g=null)}function FR(t){yg(t),t.u&&(ue.clearTimeout(t.u),t.u=null),tg(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&ue.clearTimeout(t.m),t.m=null)}function vg(t){if(!xR(t.i)&&!t.m){t.m=!0;var e=t.Na;Cu||iR(),bu||(Cu(),bu=!0),Yw.add(e,t),t.C=0}}function Cq(t,e){return TR(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Mu(Qt(t.Na,t,e),BR(t,t.C)),t.C++,!0)}H.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new Ru(this,this.l,t),s=this.s;if(this.U&&(s?(s=YP(s),JP(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=VR(this,i,e),n=yi(this.I),We(n,"RID",t),We(n,"CVER",22),this.F&&We(n,"X-HTTP-Session-Id",this.F),Fu(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(kR(s)))+"&"+e:this.o&&iE(n,this.o,s)),nE(this.i,i),this.bb&&We(n,"TYPE","init"),this.P?(We(n,"$req",e),We(n,"SID","null"),i.aa=!0,Fw(i,n,null)):Fw(i,n,e),this.H=2}}else this.H==3&&(t?HP(this,t):this.j.length==0||xR(this.i)||HP(this))};function HP(t,e){var n;e?n=e.m:n=t.W++;let r=yi(t.I);We(r,"SID",t.K),We(r,"RID",n),We(r,"AID",t.V),Fu(t,r),t.o&&t.s&&iE(r,t.o,t.s),n=new Ru(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=VR(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),nE(t.i,n),Fw(n,r,e)}function Fu(t,e){t.na&&qw(t.na,function(n,r){We(e,r,n)}),t.h&&vR({},function(n,r){We(e,r,n)})}function VR(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Qt(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let l=0;l<n;l++){let c=i[l].g,u=i[l].map;if(c-=s,0>c)s=Math.max(0,i[l].g-100),a=!1;else try{gq(u,o,"req"+c+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function LR(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Cu||iR(),bu||(Cu(),bu=!0),Yw.add(e,t),t.A=0}}function oE(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Mu(Qt(t.Ma,t),BR(t,t.A)),t.A++,!0)}H.Ma=function(){if(this.u=null,jR(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Mu(Qt(this.jb,this),t)}};H.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,sn(10),yg(this),jR(this))};function aE(t){t.B!=null&&(ue.clearTimeout(t.B),t.B=null)}function jR(t){t.g=new Ru(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=yi(t.wa);We(e,"RID","rpc"),We(e,"SID",t.K),We(e,"AID",t.V),We(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&We(e,"TO",t.qa),We(e,"TYPE","xmlhttp"),Fu(t,e),t.o&&t.s&&iE(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=gg(yi(e)),n.u=null,n.S=!0,gR(n,t)}H.ib=function(){this.v!=null&&(this.v=null,yg(this),oE(this),sn(19))};function tg(t){t.v!=null&&(ue.clearTimeout(t.v),t.v=null)}function UR(t,e){var n=null;if(t.g==e){tg(t),aE(t),t.g=null;var r=2}else if(Lw(t.i,e))n=e.F,DR(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=dg(),zt(r,new uR(r,n)),vg(t)}else LR(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&Cq(t,e)||r==2&&oE(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:co(t,5);break;case 4:co(t,10);break;case 3:co(t,6);break;default:co(t,2)}}}function BR(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function co(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Qt(t.pb,t);n||(n=new uo("//www.google.com/images/cleardot.gif"),ue.location&&ue.location.protocol=="http"||Xp(n,"https"),gg(n)),mq(n.toString(),r)}else sn(2);t.H=0,t.h&&t.h.za(e),$R(t),FR(t)}H.pb=function(t){t?(this.l.info("Successfully pinged google.com"),sn(2)):(this.l.info("Failed to ping google.com"),sn(1))};function $R(t){if(t.H=0,t.ma=[],t.h){let e=SR(t.i);(e.length!=0||t.j.length!=0)&&(kP(t.ma,e),kP(t.ma,t.j),t.i.i.length=0,$w(t.j),t.j.length=0),t.h.ya()}}function HR(t,e,n){var r=n instanceof uo?yi(n):new uo(n);if(r.g!="")e&&(r.g=e+"."+r.g),eg(r,r.m);else{var i=ue.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new uo(null);r&&Xp(s,r),e&&(s.g=e),i&&eg(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&We(r,n,e),We(r,"VER",t.ra),Fu(t,r),r}function qR(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new at(new ku({ob:n})):new at(t.va),e.Oa(t.J),e}H.isActive=function(){return!!this.h&&this.h.isActive(this)};function zR(){}H=zR.prototype;H.Ba=function(){};H.Aa=function(){};H.za=function(){};H.ya=function(){};H.isActive=function(){return!0};H.Va=function(){};function ng(){if(Xa&&!(10<=Number(j9)))throw Error("Environmental error: no available transport.")}ng.prototype.g=function(t,e){return new Cn(t,e)};function Cn(t,e){kt.call(this),this.g=new OR(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!wu(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!wu(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new tl(this)}Ot(Cn,kt);Cn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;sn(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=HR(t,null,t.Y),vg(t)};Cn.prototype.close=function(){sE(this.g)};Cn.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=Qw(t),t=n);e.j.push(new dq(e.fb++,t)),e.H==3&&vg(e)};Cn.prototype.N=function(){this.g.h=null,delete this.j,sE(this.g),delete this.g,Cn.$.N.call(this)};function GR(t){eE.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Ot(GR,eE);function WR(){tE.call(this),this.status=1}Ot(WR,tE);function tl(t){this.g=t}Ot(tl,zR);tl.prototype.Ba=function(){zt(this.g,"a")};tl.prototype.Aa=function(t){zt(this.g,new GR(t))};tl.prototype.za=function(t){zt(this.g,new WR)};tl.prototype.ya=function(){zt(this.g,"b")};function bq(){this.blockSize=-1}function hr(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Ot(hr,bq);hr.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Iw(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}hr.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)Iw(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){Iw(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){Iw(this,r),i=0;break}}this.h=i,this.i+=e};hr.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function ke(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var Iq={};function lE(t){return-128<=t&&128>t?F9(t,function(e){return new ke([e|0],0>e?-1:0)}):new ke([t|0],0>t?-1:0)}function Ur(t){if(isNaN(t)||!isFinite(t))return Za;if(0>t)return qt(Ur(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=jw;return new ke(e,0)}function KR(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return qt(KR(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Ur(Math.pow(e,8)),r=Za,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=Ur(Math.pow(e,s)),r=r.R(s).add(Ur(o))):(r=r.R(n),r=r.add(Ur(o)))}return r}var jw=4294967296,Za=lE(0),Uw=lE(1),qP=lE(16777216);H=ke.prototype;H.ea=function(){if(Bn(this))return-qt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:jw+r)*e,e*=jw}return t};H.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(_i(this))return"0";if(Bn(this))return"-"+qt(this).toString(t);for(var e=Ur(Math.pow(t,6)),n=this,r="";;){var i=ig(n,e).g;n=rg(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,_i(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};H.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function _i(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Bn(t){return t.h==-1}H.X=function(t){return t=rg(this,t),Bn(t)?-1:_i(t)?0:1};function qt(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new ke(n,~t.h).add(Uw)}H.abs=function(){return Bn(this)?qt(this):this};H.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new ke(n,n[n.length-1]&-2147483648?-1:0)};function rg(t,e){return t.add(qt(e))}H.R=function(t){if(_i(this)||_i(t))return Za;if(Bn(this))return Bn(t)?qt(this).R(qt(t)):qt(qt(this).R(t));if(Bn(t))return qt(this.R(qt(t)));if(0>this.X(qP)&&0>t.X(qP))return Ur(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,l=t.D(i)&65535;n[2*r+2*i]+=o*l,Zp(n,2*r+2*i),n[2*r+2*i+1]+=s*l,Zp(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,Zp(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,Zp(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new ke(n,0)};function Zp(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function mu(t,e){this.g=t,this.h=e}function ig(t,e){if(_i(e))throw Error("division by zero");if(_i(t))return new mu(Za,Za);if(Bn(t))return e=ig(qt(t),e),new mu(qt(e.g),qt(e.h));if(Bn(e))return e=ig(t,qt(e)),new mu(qt(e.g),e.h);if(30<t.g.length){if(Bn(t)||Bn(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Uw,r=e;0>=r.X(t);)n=zP(n),r=zP(r);var i=Ya(n,1),s=Ya(r,1);for(r=Ya(r,2),n=Ya(n,2);!_i(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=Ya(r,1),n=Ya(n,1)}return e=rg(t,i.R(e)),new mu(i,e)}for(i=Za;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Ur(n),o=s.R(e);Bn(o)||0<o.X(t);)n-=r,s=Ur(n),o=s.R(e);_i(s)&&(s=Uw),i=i.add(s),t=rg(t,o)}return new mu(i,t)}H.gb=function(t){return ig(this,t).h};H.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new ke(n,this.h&t.h)};H.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new ke(n,this.h|t.h)};H.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new ke(n,this.h^t.h)};function zP(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new ke(n,t.h)}function Ya(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new ke(i,t.h)}ng.prototype.createWebChannel=ng.prototype.g;Cn.prototype.send=Cn.prototype.u;Cn.prototype.open=Cn.prototype.m;Cn.prototype.close=Cn.prototype.close;hg.NO_ERROR=0;hg.TIMEOUT=8;hg.HTTP_ERROR=6;dR.COMPLETE="complete";hR.EventType=Pu;Pu.OPEN="a";Pu.CLOSE="b";Pu.ERROR="c";Pu.MESSAGE="d";kt.prototype.listen=kt.prototype.O;at.prototype.listenOnce=at.prototype.P;at.prototype.getLastError=at.prototype.Sa;at.prototype.getLastErrorCode=at.prototype.Ia;at.prototype.getStatus=at.prototype.da;at.prototype.getResponseJson=at.prototype.Wa;at.prototype.getResponseText=at.prototype.ja;at.prototype.send=at.prototype.ha;at.prototype.setWithCredentials=at.prototype.Oa;hr.prototype.digest=hr.prototype.l;hr.prototype.reset=hr.prototype.reset;hr.prototype.update=hr.prototype.j;ke.prototype.add=ke.prototype.add;ke.prototype.multiply=ke.prototype.R;ke.prototype.modulo=ke.prototype.gb;ke.prototype.compare=ke.prototype.X;ke.prototype.toNumber=ke.prototype.ea;ke.prototype.toString=ke.prototype.toString;ke.prototype.getBits=ke.prototype.D;ke.fromNumber=Ur;ke.fromString=KR;var QR=fr.createWebChannelTransport=function(){return new ng},YR=fr.getStatEventTarget=function(){return dg()},wg=fr.ErrorCode=hg,JR=fr.EventType=dR,ZR=fr.Event=ho,cE=fr.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},XR=fr.FetchXmlHttpFactory=ku,Vu=fr.WebChannel=hR,eN=fr.XhrIo=at,tN=fr.Md5=hr,fo=fr.Integer=ke;var nN="@firebase/firestore";var wt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};wt.UNAUTHENTICATED=new wt(null),wt.GOOGLE_CREDENTIALS=new wt("google-credentials-uid"),wt.FIRST_PARTY=new wt("first-party-uid"),wt.MOCK_USER=new wt("mock-user");var Rl="10.11.1";var ds=new Ni("@firebase/firestore");function ol(){return ds.logLevel}function nk(t){ds.setLogLevel(t)}function R(t,...e){if(ds.logLevel<=Pn.DEBUG){let n=e.map(hb);ds.debug(`Firestore (${Rl}): ${t}`,...n)}}function dt(t,...e){if(ds.logLevel<=Pn.ERROR){let n=e.map(hb);ds.error(`Firestore (${Rl}): ${t}`,...n)}}function Hn(t,...e){if(ds.logLevel<=Pn.WARN){let n=e.map(hb);ds.warn(`Firestore (${Rl}): ${t}`,...n)}}function hb(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function G(t="Unexpected state"){let e=`FIRESTORE (${Rl}) INTERNAL ASSERTION FAILED: `+t;throw dt(e),new Error(e)}function J(t,e){t||G()}function rk(t,e){t||G()}function $(t,e){return t}var I={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},M=class extends Mh{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Et=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var Pg=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},pE=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(wt.UNAUTHENTICATED))}shutdown(){}},gE=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},mE=class{constructor(e){this.t=e,this.currentUser=wt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve(),s=new Et;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Et,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let l=s;e.enqueueRetryable(()=>C(this,null,function*(){yield l.promise,yield i(this.currentUser)}))},a=l=>{R("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?a(l):(R("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Et)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(R("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(J(typeof r.accessToken=="string"),new Pg(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return J(e===null||typeof e=="string"),new wt(e)}},_E=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=wt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},yE=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new _E(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(wt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},vE=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},wE=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&R("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,R("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{R("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):R("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(J(typeof n.token=="string"),this.R=n.token,new vE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function xq(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Rg=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=xq(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function de(t,e){return t<e?-1:t>e?1:0}function gl(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function ik(t){return t+"\0"}var nt=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new M(I.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new M(I.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new M(I.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new M(I.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?de(this.nanoseconds,e.nanoseconds):de(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var te=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new nt(0,0))}static max(){return new t(new nt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Ng=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&G(),r===void 0?r=e.length-n:r>e.length-n&&G(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},xe=class t extends Ng{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new M(I.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},Tq=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ht=class t extends Ng{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return Tq.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new M(I.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new M(I.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new M(I.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new M(I.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var U=class t{constructor(e){this.path=e}static fromPath(e){return new t(xe.fromString(e))}static fromName(e){return new t(xe.fromString(e).popFirst(5))}static empty(){return new t(xe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&xe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return xe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new xe(e.slice()))}};var ml=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};function EE(t){return t.fields.find(e=>e.kind===2)}function go(t){return t.fields.filter(e=>e.kind!==2)}ml.UNKNOWN_ID=-1;var hl=class{constructor(e,n){this.fieldPath=e,this.kind=n}};var Qu=class t{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new t(0,qn.min())}};function sk(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=te.fromTimestamp(r===1e9?new nt(n+1,0):new nt(n,r));return new qn(i,U.empty(),e)}function ok(t){return new qn(t.readTime,t.key,-1)}var qn=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(te.min(),U.empty(),-1)}static max(){return new t(te.max(),U.empty(),-1)}};function fb(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=U.comparator(t.documentKey,e.documentKey),n!==0?n:de(t.largestBatchId,e.largestBatchId))}var ak="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",kg=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Es(t){return C(this,null,function*(){if(t.code!==I.FAILED_PRECONDITION||t.message!==ak)throw t;R("LocalStore","Unexpectedly lost primary lease")})}var b=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&G(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let l=0;l<s;l++){let c=l;n(e[c]).next(u=>{o[c]=u,++a,a===s&&r(o)},u=>i(u))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};var Og=class t{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new Et,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Eo(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=pb(r.target.error);this.V.reject(new Eo(e,i))}}static open(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(s){throw new Eo(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(R("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let n=this.transaction.objectStore(e);return new bE(n)}},hs=class t{constructor(e,n,r){this.name=e,this.version=n,this.p=r,t.S(_c())===12.2&&dt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return R("SimpleDb","Removing database:",e),mo(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Ah())return!1;if(t.C())return!0;let e=_c(),n=t.S(e),r=0<n&&n<10,i=lk(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static F(e,n){return e.store(n)}static S(e){let n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return C(this,null,function*(){return this.db||(R("SimpleDb","Opening database:",this.name),this.db=yield new Promise((n,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;n(o)},i.onblocked=()=>{r(new Eo(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new M(I.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new M(I.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Eo(e,o))},i.onupgradeneeded=s=>{R("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{R("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){return C(this,null,function*(){let s=n==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let a=Og.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),b.reject(c))).toPromise();return l.catch(()=>{}),yield a.m,l}catch(a){let l=a,c=l.name!=="FirebaseError"&&o<3;if(R("SimpleDb","Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function lk(t){let e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}var CE=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return mo(this.B.delete())}},Eo=class extends M{constructor(e,n){super(I.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}};function Cs(t){return t.name==="IndexedDbTransactionError"}var bE=class{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(R("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(R("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),mo(r)}add(e){return R("SimpleDb","ADD",this.store.name,e,e),mo(this.store.add(e))}get(e){return mo(this.store.get(e)).next(n=>(n===void 0&&(n=null),R("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return R("SimpleDb","DELETE",this.store.name,e),mo(this.store.delete(e))}count(){return R("SimpleDb","COUNT",this.store.name),mo(this.store.count())}U(e,n){let r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new b((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{let s=this.cursor(r),o=[];return this.W(s,(a,l)=>{o.push(l)}).next(()=>o)}}G(e,n){let r=this.store.getAll(e,n===null?void 0:n);return new b((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,n){R("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,n);r.H=!1;let i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,n){let r;n?r=e:(r={},n=e);let i=this.cursor(r);return this.W(i,n)}Y(e){let n=this.cursor({});return new b((r,i)=>{n.onerror=s=>{let o=pb(s.target.error);i(o)},n.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,n){let r=[];return new b((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let l=new CE(a),c=n(a.primaryKey,a.value,l);if(c instanceof b){let u=c.catch(d=>(l.done(),b.reject(d)));r.push(u)}l.isDone?i():l.K===null?a.continue():a.continue(l.K)}}).next(()=>b.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}};function mo(t){return new b((e,n)=>{t.onsuccess=r=>{let i=r.target.result;e(i)},t.onerror=r=>{let i=pb(r.target.error);n(i)}})}var rN=!1;function pb(t){let e=hs.S(_c());if(e>=12.2&&e<13){let n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){let r=new M("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return rN||(rN=!0,setTimeout(()=>{throw r},0)),r}}return t}var IE=class{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){R("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>C(this,null,function*(){this.task=null;try{R("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(n){Cs(n)?R("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):yield Es(n)}yield this.X(6e4)}))}},xE=class{constructor(e,n){this.localStore=e,this.persistence=n}ee(e=50){return C(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))})}te(e,n){let r=new Set,i=n,s=!0;return b.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return R("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(R("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}re(e,n){let r=e;return n.changes.forEach((i,s)=>{let o=ok(s);fb(o,r)>0&&(r=o)}),new qn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}};var bn=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.se&&this.se(n),n}}return t.oe=-1,t})();function _d(t){return t==null}function Yu(t){return t===0&&1/t==-1/0}function ck(t){return typeof t=="number"&&Number.isInteger(t)&&!Yu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function on(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=iN(e)),e=Dq(t.get(n),e);return iN(e)}function Dq(t,e){let n=e,r=t.length;for(let i=0;i<r;i++){let s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function iN(t){return t+""}function Br(t){let e=t.length;if(J(e>=2),e===2)return J(t.charAt(0)===""&&t.charAt(1)===""),xe.emptyPath();let n=e-2,r=[],i="";for(let s=0;s<e;){let o=t.indexOf("",s);switch((o<0||o>n)&&G(),t.charAt(o+1)){case"":let a=t.substring(s,o),l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:G()}s=o+2}return new xe(r)}var sN=["userId","batchId"];function xg(t,e){return[t,on(e)]}function uk(t,e,n){return[t,on(e),n]}var Sq={},Aq=["prefixPath","collectionGroup","readTime","documentId"],Mq=["prefixPath","collectionGroup","documentId"],Pq=["collectionGroup","readTime","prefixPath","documentId"],Rq=["canonicalId","targetId"],Nq=["targetId","path"],kq=["path","targetId"],Oq=["collectionId","parent"],Fq=["indexId","uid"],Vq=["uid","sequenceNumber"],Lq=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],jq=["indexId","uid","orderedDocumentKey"],Uq=["userId","collectionPath","documentId"],Bq=["userId","collectionPath","largestBatchId"],$q=["userId","collectionGroup","largestBatchId"],dk=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Hq=[...dk,"documentOverlays"],hk=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],fk=hk,pk=[...fk,"indexConfiguration","indexState","indexEntries"],qq=pk;var Ju=class extends kg{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}};function Vt(t,e){let n=$(t);return hs.F(n._e,e)}function oN(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function No(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function gk(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ke=class t{constructor(e,n){this.comparator=e,this.root=n||Hr.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Hr.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Hr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new dl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new dl(this.root,e,this.comparator,!1)}getReverseIterator(){return new dl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new dl(this.root,e,this.comparator,!0)}},dl=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Hr=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw G();let e=this.left.check();if(e!==this.right.check())throw G();return e+(this.isRed()?0:1)}};Hr.EMPTY=null,Hr.RED=!0,Hr.BLACK=!1;Hr.EMPTY=new class{constructor(){this.size=0}get key(){throw G()}get value(){throw G()}get color(){throw G()}get left(){throw G()}get right(){throw G()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Hr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var He=class t{constructor(e){this.comparator=e,this.data=new Ke(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Fg(this.data.getIterator())}getIteratorFrom(e){return new Fg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},Fg=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function nl(t){return t.hasNext()?t.getNext():void 0}var In=class t{constructor(e){this.fields=e,e.sort(ht.comparator)}static empty(){return new t([])}unionWith(e){let n=new He(ht.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return gl(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var Vg=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function mk(){return typeof atob<"u"}var Ft=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Vg("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return de(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ft.EMPTY_BYTE_STRING=new Ft("");var zq=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ei(t){if(J(!!t),typeof t=="string"){let e=0,n=zq.exec(t);if(J(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:lt(t.seconds),nanos:lt(t.nanos)}}function lt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function fs(t){return typeof t=="string"?Ft.fromBase64String(t):Ft.fromUint8Array(t)}function Dm(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function gb(t){let e=t.mapValue.fields.__previous_value__;return Dm(e)?gb(e):e}function Zu(t){let e=Ei(t.mapValue.fields.__local_write_time__.timestampValue);return new nt(e.seconds,e.nanos)}var TE=class{constructor(e,n,r,i,s,o,a,l,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}},ps=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var cs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Tg={nullValue:"NULL_VALUE"};function Co(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Dm(t)?4:_k(t)?9007199254740991:10:G()}function Gr(t,e){if(t===e)return!0;let n=Co(t);if(n!==Co(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Zu(t).isEqual(Zu(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Ei(i.timestampValue),a=Ei(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return fs(i.bytesValue).isEqual(fs(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return lt(i.geoPointValue.latitude)===lt(s.geoPointValue.latitude)&&lt(i.geoPointValue.longitude)===lt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return lt(i.integerValue)===lt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=lt(i.doubleValue),a=lt(s.doubleValue);return o===a?Yu(o)===Yu(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return gl(t.arrayValue.values||[],e.arrayValue.values||[],Gr);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(oN(o)!==oN(a))return!1;for(let l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Gr(o[l],a[l])))return!1;return!0}(t,e);default:return G()}}function Xu(t,e){return(t.values||[]).find(n=>Gr(n,e))!==void 0}function gs(t,e){if(t===e)return 0;let n=Co(t),r=Co(e);if(n!==r)return de(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return de(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=lt(s.integerValue||s.doubleValue),l=lt(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return aN(t.timestampValue,e.timestampValue);case 4:return aN(Zu(t),Zu(e));case 5:return de(t.stringValue,e.stringValue);case 6:return function(s,o){let a=fs(s),l=fs(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){let u=de(a[c],l[c]);if(u!==0)return u}return de(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=de(lt(s.latitude),lt(o.latitude));return a!==0?a:de(lt(s.longitude),lt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],l=o.values||[];for(let c=0;c<a.length&&c<l.length;++c){let u=gs(a[c],l[c]);if(u)return u}return de(a.length,l.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===cs.mapValue&&o===cs.mapValue)return 0;if(s===cs.mapValue)return 1;if(o===cs.mapValue)return-1;let a=s.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let d=0;d<l.length&&d<u.length;++d){let h=de(l[d],u[d]);if(h!==0)return h;let g=gs(a[l[d]],c[u[d]]);if(g!==0)return g}return de(l.length,u.length)}(t.mapValue,e.mapValue);default:throw G()}}function aN(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return de(t,e);let n=Ei(t),r=Ei(e),i=de(n.seconds,r.seconds);return i!==0?i:de(n.nanos,r.nanos)}function _l(t){return DE(t)}function DE(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=Ei(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return fs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return U.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=DE(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${DE(n.fields[o])}`;return i+"}"}(t.mapValue):G()}function bo(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function SE(t){return!!t&&"integerValue"in t}function ed(t){return!!t&&"arrayValue"in t}function lN(t){return!!t&&"nullValue"in t}function cN(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Dg(t){return!!t&&"mapValue"in t}function qu(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return No(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=qu(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=qu(t.arrayValue.values[n]);return e}return Object.assign({},t)}function _k(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function Gq(t){return"nullValue"in t?Tg:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?bo(ps.empty(),U.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:G()}function Wq(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?bo(ps.empty(),U.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?cs:G()}function uN(t,e){let n=gs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function dN(t,e){let n=gs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}var Zt=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Dg(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=qu(n)}setAll(e){let n=ht.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=qu(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());Dg(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Gr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Dg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){No(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(qu(this.value))}};function yk(t){let e=[];return No(t.fields,(n,r)=>{let i=new ht([n]);if(Dg(r)){let s=yk(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new In(e)}var Ct=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,te.min(),te.min(),te.min(),Zt.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,te.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,te.min(),te.min(),Zt.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,te.min(),te.min(),Zt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(te.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Zt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Zt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Wr=class{constructor(e,n){this.position=e,this.inclusive=n}};function hN(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=U.comparator(U.fromName(o.referenceValue),n.key):r=gs(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function fN(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Gr(t.position[n],e.position[n]))return!1;return!0}var Io=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function Kq(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Lg=class{},be=class t extends Lg{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new PE(e,n,r):n==="array-contains"?new kE(e,r):n==="in"?new jg(e,r):n==="not-in"?new OE(e,r):n==="array-contains-any"?new FE(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new RE(e,r):new NE(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(gs(n,this.value)):n!==null&&Co(this.value)===Co(n)&&this.matchesComparison(gs(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return G()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Oe=class t extends Lg{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new t(e,n)}matches(e){return yl(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function yl(t){return t.op==="and"}function AE(t){return t.op==="or"}function mb(t){return vk(t)&&yl(t)}function vk(t){for(let e of t.filters)if(e instanceof Oe)return!1;return!0}function ME(t){if(t instanceof be)return t.field.canonicalString()+t.op.toString()+_l(t.value);if(mb(t))return t.filters.map(e=>ME(e)).join(",");{let e=t.filters.map(n=>ME(n)).join(",");return`${t.op}(${e})`}}function wk(t,e){return t instanceof be?function(r,i){return i instanceof be&&r.op===i.op&&r.field.isEqual(i.field)&&Gr(r.value,i.value)}(t,e):t instanceof Oe?function(r,i){return i instanceof Oe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&wk(o,i.filters[a]),!0):!1}(t,e):void G()}function Ek(t,e){let n=t.filters.concat(e);return Oe.create(n,t.op)}function Ck(t){return t instanceof be?function(n){return`${n.field.canonicalString()} ${n.op} ${_l(n.value)}`}(t):t instanceof Oe?function(n){return n.op.toString()+" {"+n.getFilters().map(Ck).join(" ,")+"}"}(t):"Filter"}var PE=class extends be{constructor(e,n,r){super(e,n,r),this.key=U.fromName(r.referenceValue)}matches(e){let n=U.comparator(e.key,this.key);return this.matchesComparison(n)}},RE=class extends be{constructor(e,n){super(e,"in",n),this.keys=bk("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},NE=class extends be{constructor(e,n){super(e,"not-in",n),this.keys=bk("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function bk(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>U.fromName(r.referenceValue))}var kE=class extends be{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return ed(n)&&Xu(n.arrayValue,this.value)}},jg=class extends be{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&Xu(this.value.arrayValue,n)}},OE=class extends be{constructor(e,n){super(e,"not-in",n)}matches(e){if(Xu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!Xu(this.value.arrayValue,n)}},FE=class extends be{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!ed(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Xu(this.value.arrayValue,r))}};var VE=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function LE(t,e=null,n=[],r=[],i=null,s=null,o=null){return new VE(t,e,n,r,i,s,o)}function xo(t){let e=$(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>ME(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),_d(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>_l(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>_l(r)).join(",")),e.ue=n}return e.ue}function yd(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Kq(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!wk(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!fN(t.startAt,e.startAt)&&fN(t.endAt,e.endAt)}function Ug(t){return U.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Bg(t,e){return t.filters.filter(n=>n instanceof be&&n.field.isEqual(e))}function pN(t,e,n){let r=Tg,i=!0;for(let s of Bg(t,e)){let o=Tg,a=!0;switch(s.op){case"<":case"<=":o=Gq(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Tg}uN({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];uN({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function gN(t,e,n){let r=cs,i=!0;for(let s of Bg(t,e)){let o=cs,a=!0;switch(s.op){case">=":case">":o=Wq(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=cs}dN({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];dN({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}var pr=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function Ik(t,e,n,r,i,s,o,a){return new pr(t,e,n,r,i,s,o,a)}function Nl(t){return new pr(t)}function mN(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function _b(t){return t.collectionGroup!==null}function fl(t){let e=$(t);if(e.ce===null){e.ce=[];let n=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new He(ht.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Io(s,r))}),n.has(ht.keyField().canonicalString())||e.ce.push(new Io(ht.keyField(),r))}return e.ce}function an(t){let e=$(t);return e.le||(e.le=Qq(e,fl(t))),e.le}function Qq(t,e){if(t.limitType==="F")return LE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Io(i.field,s)});let n=t.endAt?new Wr(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Wr(t.startAt.position,t.startAt.inclusive):null;return LE(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function jE(t,e){let n=t.filters.concat([e]);return new pr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function $g(t,e,n){return new pr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function vd(t,e){return yd(an(t),an(e))&&t.limitType===e.limitType}function xk(t){return`${xo(an(t))}|lt:${t.limitType}`}function al(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>Ck(i)).join(", ")}]`),_d(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>_l(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>_l(i)).join(",")),`Target(${r})`}(an(t))}; limitType=${t.limitType})`}function wd(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):U.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of fl(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){let c=hN(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,fl(r),i)||r.endAt&&!function(o,a,l){let c=hN(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,fl(r),i))}(t,e)}function Tk(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Dk(t){return(e,n)=>{let r=!1;for(let i of fl(t)){let s=Yq(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Yq(t,e,n){let r=t.field.isKeyField()?U.comparator(e.key,n.key):function(s,o,a){let l=o.data.field(s),c=a.data.field(s);return l!==null&&c!==null?gs(l,c):G()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return G()}}var Kr=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){No(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return gk(this.inner)}size(){return this.innerSize}};var Jq=new Ke(U.comparator);function _n(){return Jq}var Sk=new Ke(U.comparator);function $u(...t){let e=Sk;for(let n of t)e=e.insert(n.key,n);return e}function Ak(t){let e=Sk;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function $r(){return zu()}function Mk(){return zu()}function zu(){return new Kr(t=>t.toString(),(t,e)=>t.isEqual(e))}var Zq=new Ke(U.comparator),Xq=new He(U.comparator);function fe(...t){let e=Xq;for(let n of t)e=e.add(n);return e}var ez=new He(de);function yb(){return ez}function Pk(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Yu(e)?"-0":e}}function Rk(t){return{integerValue:""+t}}function Nk(t,e){return ck(e)?Rk(e):Pk(t,e)}var vl=class{constructor(){this._=void 0}};function tz(t,e,n){return t instanceof ms?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Dm(s)&&(s=gb(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Ci?Ok(t,e):t instanceof bi?Fk(t,e):function(i,s){let o=kk(i,s),a=_N(o)+_N(i.Pe);return SE(o)&&SE(i.Pe)?Rk(a):Pk(i.serializer,a)}(t,e)}function nz(t,e,n){return t instanceof Ci?Ok(t,e):t instanceof bi?Fk(t,e):n}function kk(t,e){return t instanceof _s?function(r){return SE(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var ms=class extends vl{},Ci=class extends vl{constructor(e){super(),this.elements=e}};function Ok(t,e){let n=Vk(e);for(let r of t.elements)n.some(i=>Gr(i,r))||n.push(r);return{arrayValue:{values:n}}}var bi=class extends vl{constructor(e){super(),this.elements=e}};function Fk(t,e){let n=Vk(e);for(let r of t.elements)n=n.filter(i=>!Gr(i,r));return{arrayValue:{values:n}}}var _s=class extends vl{constructor(e,n){super(),this.serializer=e,this.Pe=n}};function _N(t){return lt(t.integerValue||t.doubleValue)}function Vk(t){return ed(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var To=class{constructor(e,n){this.field=e,this.transform=n}};function rz(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Ci&&i instanceof Ci||r instanceof bi&&i instanceof bi?gl(r.elements,i.elements,Gr):r instanceof _s&&i instanceof _s?Gr(r.Pe,i.Pe):r instanceof ms&&i instanceof ms}(t.transform,e.transform)}var UE=class{constructor(e,n){this.version=e,this.transformResults=n}},ct=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Sg(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var wl=class{};function Lk(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new vs(t.key,ct.none()):new ys(t.key,t.data,ct.none());{let n=t.data,r=Zt.empty(),i=new He(ht.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new gr(t.key,r,new In(i.toArray()),ct.none())}}function iz(t,e,n){t instanceof ys?function(i,s,o){let a=i.value.clone(),l=vN(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof gr?function(i,s,o){if(!Sg(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=vN(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(jk(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Gu(t,e,n,r){return t instanceof ys?function(s,o,a,l){if(!Sg(s.precondition,o))return a;let c=s.value.clone(),u=wN(s.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof gr?function(s,o,a,l){if(!Sg(s.precondition,o))return a;let c=wN(s.fieldTransforms,l,o),u=o.data;return u.setAll(jk(s)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,o,a){return Sg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function sz(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=kk(r.transform,i||null);s!=null&&(n===null&&(n=Zt.empty()),n.set(r.field,s))}return n||null}function yN(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&gl(r,i,(s,o)=>rz(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var ys=class extends wl{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},gr=class extends wl{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function jk(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function vN(t,e,n){let r=new Map;J(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,nz(o,a,n[i]))}return r}function wN(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,tz(s,o,e))}return r}var vs=class extends wl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},td=class extends wl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var nd=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&iz(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=Gu(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=Gu(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=Mk();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let l=Lk(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(te.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),fe())}isEqual(e){return this.batchId===e.batchId&&gl(this.mutations,e.mutations,(n,r)=>yN(n,r))&&gl(this.baseMutations,e.baseMutations,(n,r)=>yN(n,r))}},BE=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){J(e.mutations.length===r.length);let i=function(){return Zq}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var rd=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var $E=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var yt,Ie;function Uk(t){switch(t){default:return G();case I.CANCELLED:case I.UNKNOWN:case I.DEADLINE_EXCEEDED:case I.RESOURCE_EXHAUSTED:case I.INTERNAL:case I.UNAVAILABLE:case I.UNAUTHENTICATED:return!1;case I.INVALID_ARGUMENT:case I.NOT_FOUND:case I.ALREADY_EXISTS:case I.PERMISSION_DENIED:case I.FAILED_PRECONDITION:case I.ABORTED:case I.OUT_OF_RANGE:case I.UNIMPLEMENTED:case I.DATA_LOSS:return!0}}function Bk(t){if(t===void 0)return dt("GRPC error has no .code"),I.UNKNOWN;switch(t){case yt.OK:return I.OK;case yt.CANCELLED:return I.CANCELLED;case yt.UNKNOWN:return I.UNKNOWN;case yt.DEADLINE_EXCEEDED:return I.DEADLINE_EXCEEDED;case yt.RESOURCE_EXHAUSTED:return I.RESOURCE_EXHAUSTED;case yt.INTERNAL:return I.INTERNAL;case yt.UNAVAILABLE:return I.UNAVAILABLE;case yt.UNAUTHENTICATED:return I.UNAUTHENTICATED;case yt.INVALID_ARGUMENT:return I.INVALID_ARGUMENT;case yt.NOT_FOUND:return I.NOT_FOUND;case yt.ALREADY_EXISTS:return I.ALREADY_EXISTS;case yt.PERMISSION_DENIED:return I.PERMISSION_DENIED;case yt.FAILED_PRECONDITION:return I.FAILED_PRECONDITION;case yt.ABORTED:return I.ABORTED;case yt.OUT_OF_RANGE:return I.OUT_OF_RANGE;case yt.UNIMPLEMENTED:return I.UNIMPLEMENTED;case yt.DATA_LOSS:return I.DATA_LOSS;default:return G()}}(Ie=yt||(yt={}))[Ie.OK=0]="OK",Ie[Ie.CANCELLED=1]="CANCELLED",Ie[Ie.UNKNOWN=2]="UNKNOWN",Ie[Ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ie[Ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ie[Ie.NOT_FOUND=5]="NOT_FOUND",Ie[Ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ie[Ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ie[Ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ie[Ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ie[Ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ie[Ie.ABORTED=10]="ABORTED",Ie[Ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ie[Ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ie[Ie.INTERNAL=13]="INTERNAL",Ie[Ie.UNAVAILABLE=14]="UNAVAILABLE",Ie[Ie.DATA_LOSS=15]="DATA_LOSS";var EN=null;function $k(){return new TextEncoder}var oz=new fo([4294967295,4294967295],0);function CN(t){let e=$k().encode(t),n=new tN;return n.update(e),new Uint8Array(n.digest())}function bN(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new fo([n,r],0),new fo([i,s],0)]}var HE=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new wo(`Invalid padding: ${n}`);if(r<0)throw new wo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new wo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new wo(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=fo.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(fo.fromNumber(r)));return i.compare(oz)===1&&(i=new fo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let n=CN(e),[r,i]=bN(n);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let n=CN(e),[r,i]=bN(n);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},wo=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var id=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,sd.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(te.min(),i,new Ke(de),_n(),fe())}},sd=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,fe(),fe(),fe())}};var pl=class{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}},Hg=class{constructor(e,n){this.targetId=e,this.me=n}},qg=class{constructor(e,n,r=Ft.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},zg=class{constructor(){this.fe=0,this.ge=xN(),this.pe=Ft.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=fe(),n=fe(),r=fe();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:G()}}),new sd(this.pe,this.ye,e,n,r)}ve(){this.we=!1,this.ge=xN()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,J(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},qE=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=_n(),this.qe=IN(),this.Qe=new Ke(de)}Ke(e){for(let n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(let n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{let r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:G()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){let n=e.targetId,r=e.me.count,i=this.Je(n);if(i){let s=i.target;if(Ug(s))if(r===0){let o=new U(s.path);this.Ue(n,o,Ct.newNoDocument(o,te.min()))}else J(r===1);else{let o=this.Ye(n);if(o!==r){let a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(n);let c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,c)}EN?.et(function(u,d,h,g,y){var w,v,T,V,P,F;let X={localCacheCount:u,existenceFilterCount:d.count,databaseId:h.database,projectId:h.projectId},ne=d.unchangedNames;return ne&&(X.bloomFilter={applied:y===0,hashCount:(w=ne?.hashCount)!==null&&w!==void 0?w:0,bitmapLength:(V=(T=(v=ne?.bits)===null||v===void 0?void 0:v.bitmap)===null||T===void 0?void 0:T.length)!==null&&V!==void 0?V:0,padding:(F=(P=ne?.bits)===null||P===void 0?void 0:P.padding)!==null&&F!==void 0?F:0,mightContain:De=>{var pt;return(pt=g?.mightContain(De))!==null&&pt!==void 0&&pt}}),X}(o,e.me,this.Le.tt(),a,l))}}}}Ze(e){let n=e.me.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=fs(r).toUint8Array()}catch(l){if(l instanceof Vg)return Hn("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new HE(o,i,s)}catch(l){return Hn(l instanceof wo?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){let r=this.Le.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(n,s,null),i++)}),i}rt(e){let n=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&Ug(a.target)){let l=new U(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,Ct.newNoDocument(l,e))}s.be&&(n.set(o,s.Ce()),s.ve())}});let r=fe();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{let c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new id(e,n,this.Qe,this.ke,r);return this.ke=_n(),this.qe=IN(),this.Qe=new Ke(de),i}$e(e,n){if(!this.ze(e))return;let r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let n=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new zg,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new He(de),this.qe=this.qe.insert(e,n)),n}ze(e){let n=this.Je(e)!==null;return n||R("WatchChangeAggregator","Detected inactive target",e),n}Je(e){let n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new zg),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}};function IN(){return new Ke(U.comparator)}function xN(){return new Ke(U.comparator)}var az=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),lz=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),cz=(()=>({and:"AND",or:"OR"}))(),zE=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function GE(t,e){return t.useProto3Json||_d(e)?e:{value:e}}function El(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Hk(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function uz(t,e){return El(t,e.toTimestamp())}function ft(t){return J(!!t),te.fromTimestamp(function(n){let r=Ei(n);return new nt(r.seconds,r.nanos)}(t))}function vb(t,e){return WE(t,e).canonicalString()}function WE(t,e){let n=function(i){return new xe(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function qk(t){let e=xe.fromString(t);return J(eO(e)),e}function od(t,e){return vb(t.databaseId,e.path)}function qr(t,e){let n=qk(e);if(n.get(1)!==t.databaseId.projectId)throw new M(I.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new M(I.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new U(Wk(n))}function zk(t,e){return vb(t.databaseId,e)}function Gk(t){let e=qk(t);return e.length===4?xe.emptyPath():Wk(e)}function KE(t){return new xe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Wk(t){return J(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function TN(t,e,n){return{name:od(t,e),fields:n.value.mapValue.fields}}function Kk(t,e,n){let r=qr(t,e.name),i=ft(e.updateTime),s=e.createTime?ft(e.createTime):te.min(),o=new Zt({mapValue:{fields:e.fields}}),a=Ct.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function dz(t,e){return"found"in e?function(r,i){J(!!i.found),i.found.name,i.found.updateTime;let s=qr(r,i.found.name),o=ft(i.found.updateTime),a=i.found.createTime?ft(i.found.createTime):te.min(),l=new Zt({mapValue:{fields:i.found.fields}});return Ct.newFoundDocument(s,o,a,l)}(t,e):"missing"in e?function(r,i){J(!!i.missing),J(!!i.readTime);let s=qr(r,i.missing),o=ft(i.readTime);return Ct.newNoDocument(s,o)}(t,e):G()}function hz(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:G()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,u){return c.useProto3Json?(J(u===void 0||typeof u=="string"),Ft.fromBase64String(u||"")):(J(u===void 0||u instanceof Buffer||u instanceof Uint8Array),Ft.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){let u=c.code===void 0?I.UNKNOWN:Bk(c.code);return new M(u,c.message||"")}(o);n=new qg(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=qr(t,r.document.name),s=ft(r.document.updateTime),o=r.document.createTime?ft(r.document.createTime):te.min(),a=new Zt({mapValue:{fields:r.document.fields}}),l=Ct.newFoundDocument(i,s,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new pl(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=qr(t,r.document),s=r.readTime?ft(r.readTime):te.min(),o=Ct.newNoDocument(i,s),a=r.removedTargetIds||[];n=new pl([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=qr(t,r.document),s=r.removedTargetIds||[];n=new pl([],s,i,null)}else{if(!("filter"in e))return G();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new $E(i,s),a=r.targetId;n=new Hg(a,o)}}return n}function ad(t,e){let n;if(e instanceof ys)n={update:TN(t,e.key,e.value)};else if(e instanceof vs)n={delete:od(t,e.key)};else if(e instanceof gr)n={update:TN(t,e.key,e.data),updateMask:yz(e.fieldMask)};else{if(!(e instanceof td))return G();n={verify:od(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof ms)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ci)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof bi)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof _s)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw G()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:uz(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:G()}(t,e.precondition)),n}function QE(t,e){let n=e.currentDocument?function(s){return s.updateTime!==void 0?ct.updateTime(ft(s.updateTime)):s.exists!==void 0?ct.exists(s.exists):ct.none()}(e.currentDocument):ct.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)J(a.setToServerValue==="REQUEST_TIME"),l=new ms;else if("appendMissingElements"in a){let u=a.appendMissingElements.values||[];l=new Ci(u)}else if("removeAllFromArray"in a){let u=a.removeAllFromArray.values||[];l=new bi(u)}else"increment"in a?l=new _s(o,a.increment):G();let c=ht.fromServerFormat(a.fieldPath);return new To(c,l)}(t,i)):[];if(e.update){e.update.name;let i=qr(t,e.update.name),s=new Zt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(l){let c=l.fieldPaths||[];return new In(c.map(u=>ht.fromServerFormat(u)))}(e.updateMask);return new gr(i,s,o,n,r)}return new ys(i,s,n,r)}if(e.delete){let i=qr(t,e.delete);return new vs(i,n)}if(e.verify){let i=qr(t,e.verify);return new td(i,n)}return G()}function fz(t,e){return t&&t.length>0?(J(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?ft(i.updateTime):ft(s);return o.isEqual(te.min())&&(o=ft(s)),new UE(o,i.transformResults||[])}(n,e))):[]}function Qk(t,e){return{documents:[zk(t,e.path)]}}function Yk(t,e){let n={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=zk(t,i);let s=function(c){if(c.length!==0)return Xk(Oe.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);let o=function(c){if(c.length!==0)return c.map(u=>function(h){return{field:ll(h.field),direction:gz(h.dir)}}(u))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);let a=GE(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:n,parent:i}}function Jk(t){let e=Gk(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){J(r===1);let u=n.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];n.where&&(s=function(d){let h=Zk(d);return h instanceof Oe&&mb(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(h=>function(y){return new Io(cl(y.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,_d(h)?null:h}(n.limit));let l=null;n.startAt&&(l=function(d){let h=!!d.before,g=d.values||[];return new Wr(g,h)}(n.startAt));let c=null;return n.endAt&&(c=function(d){let h=!d.before,g=d.values||[];return new Wr(g,h)}(n.endAt)),Ik(e,i,o,s,a,"F",l,c)}function pz(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return G()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Zk(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=cl(n.unaryFilter.field);return be.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=cl(n.unaryFilter.field);return be.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=cl(n.unaryFilter.field);return be.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=cl(n.unaryFilter.field);return be.create(o,"!=",{nullValue:"NULL_VALUE"});default:return G()}}(t):t.fieldFilter!==void 0?function(n){return be.create(cl(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return G()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Oe.create(n.compositeFilter.filters.map(r=>Zk(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return G()}}(n.compositeFilter.op))}(t):G()}function gz(t){return az[t]}function mz(t){return lz[t]}function _z(t){return cz[t]}function ll(t){return{fieldPath:t.canonicalString()}}function cl(t){return ht.fromServerFormat(t.fieldPath)}function Xk(t){return t instanceof be?function(n){if(n.op==="=="){if(cN(n.value))return{unaryFilter:{field:ll(n.field),op:"IS_NAN"}};if(lN(n.value))return{unaryFilter:{field:ll(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(cN(n.value))return{unaryFilter:{field:ll(n.field),op:"IS_NOT_NAN"}};if(lN(n.value))return{unaryFilter:{field:ll(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ll(n.field),op:mz(n.op),value:n.value}}}(t):t instanceof Oe?function(n){let r=n.getFilters().map(i=>Xk(i));return r.length===1?r[0]:{compositeFilter:{op:_z(n.op),filters:r}}}(t):G()}function yz(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function eO(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var Cl=class t{constructor(e,n,r,i,s=te.min(),o=te.min(),a=Ft.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Gg=class{constructor(e){this.ut=e}};function vz(t,e){let n;if(e.document)n=Kk(t.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=U.fromSegments(e.noDocument.path),i=So(e.noDocument.readTime);n=Ct.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return G();{let r=U.fromSegments(e.unknownDocument.path),i=So(e.unknownDocument.version);n=Ct.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){let s=new nt(i[0],i[1]);return te.fromTimestamp(s)}(e.readTime)),n}function DN(t,e){let n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Wg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:od(s,o.key),fields:o.data.value.mapValue.fields,updateTime:El(s,o.version.toTimestamp()),createTime:El(s,o.createTime.toTimestamp())}}(t.ut,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Do(e.version)};else{if(!e.isUnknownDocument())return G();r.unknownDocument={path:n.path.toArray(),version:Do(e.version)}}return r}function Wg(t){let e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Do(t){let e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function So(t){let e=new nt(t.seconds,t.nanoseconds);return te.fromTimestamp(e)}function _o(t,e){let n=(e.baseMutations||[]).map(s=>QE(t.ut,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>QE(t.ut,s)),i=nt.fromMillis(e.localWriteTimeMs);return new nd(e.batchId,i,n,r)}function Hu(t){let e=So(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?So(t.lastLimboFreeSnapshotVersion):te.min(),r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return J(s.documents.length===1),an(Nl(Gk(s.documents[0])))}(t.query):function(s){return an(Jk(s))}(t.query),new Cl(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Ft.fromBase64String(t.resumeToken))}function tO(t,e){let n=Do(e.snapshotVersion),r=Do(e.lastLimboFreeSnapshotVersion),i;i=Ug(e.target)?Qk(t.ut,e.target):Yk(t.ut,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:xo(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function wb(t){let e=Jk({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?$g(e,e.limit,"L"):e}function uE(t,e){return new rd(e.largestBatchId,QE(t.ut,e.overlayMutation))}function SN(t,e){let n=e.path.lastSegment();return[t,on(e.path.popLast()),n]}function AN(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Do(r.readTime),documentKey:on(r.documentKey.path),largestBatchId:r.largestBatchId}}var YE=class{getBundleMetadata(e,n){return MN(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:So(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return MN(e).put(function(i){return{bundleId:i.id,createTime:Do(ft(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return PN(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:wb(s.bundledQuery),readTime:So(s.readTime)}}(r)})}saveNamedQuery(e,n){return PN(e).put(function(i){return{name:i.name,readTime:Do(ft(i.readTime)),bundledQuery:i.bundledQuery}}(n))}};function MN(t){return Vt(t,"bundles")}function PN(t){return Vt(t,"namedQueries")}var Kg=class t{constructor(e,n){this.serializer=e,this.userId=n}static ct(e,n){let r=n.uid||"";return new t(e,r)}getOverlay(e,n){return Lu(e).get(SN(this.userId,n)).next(r=>r?uE(this.serializer,r):null)}getOverlays(e,n){let r=$r();return b.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){let i=[];return r.forEach((s,o)=>{let a=new rd(n,o);i.push(this.lt(e,a))}),b.waitFor(i)}removeOverlaysForBatchId(e,n,r){let i=new Set;n.forEach(o=>i.add(on(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Lu(e).j("collectionPathOverlayIndex",a))}),b.waitFor(s)}getOverlaysForCollection(e,n,r){let i=$r(),s=on(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Lu(e).U("collectionPathOverlayIndex",o).next(a=>{for(let l of a){let c=uE(this.serializer,l);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,n,r,i){let s=$r(),o,a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Lu(e).J({index:"collectionGroupOverlayIndex",range:a},(l,c,u)=>{let d=uE(this.serializer,c);s.size()<i||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):u.done()}).next(()=>s)}lt(e,n){return Lu(e).put(function(i,s,o){let[a,l,c]=SN(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:ad(i.ut,o.mutation)}}(this.serializer,this.userId,n))}};function Lu(t){return Vt(t,"documentOverlays")}var vi=class{constructor(){}ht(e,n){this.Pt(e,n),n.It()}Pt(e,n){if("nullValue"in e)this.Tt(n,5);else if("booleanValue"in e)this.Tt(n,10),n.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(n,15),n.Et(lt(e.integerValue));else if("doubleValue"in e){let r=lt(e.doubleValue);isNaN(r)?this.Tt(n,13):(this.Tt(n,15),Yu(r)?n.Et(0):n.Et(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Tt(n,20),typeof r=="string"&&(r=Ei(r)),n.dt(`${r.seconds||""}`),n.Et(r.nanos||0)}else if("stringValue"in e)this.At(e.stringValue,n),this.Rt(n);else if("bytesValue"in e)this.Tt(n,30),n.Vt(fs(e.bytesValue)),this.Rt(n);else if("referenceValue"in e)this.ft(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Tt(n,45),n.Et(r.latitude||0),n.Et(r.longitude||0)}else"mapValue"in e?_k(e)?this.Tt(n,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,n),this.Rt(n)):"arrayValue"in e?(this.yt(e.arrayValue,n),this.Rt(n)):G()}At(e,n){this.Tt(n,25),this.wt(e,n)}wt(e,n){n.dt(e)}gt(e,n){let r=e.fields||{};this.Tt(n,55);for(let i of Object.keys(r))this.At(i,n),this.Pt(r[i],n)}yt(e,n){let r=e.values||[];this.Tt(n,50);for(let i of r)this.Pt(i,n)}ft(e,n){this.Tt(n,37),U.fromName(e).path.forEach(r=>{this.Tt(n,60),this.wt(r,n)})}Tt(e,n){e.Et(n)}Rt(e){e.Et(2)}};vi.St=new vi;function wz(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function RN(t){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=wz(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}var JE=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Dt(r.value),r=n.next();this.Ct()}vt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{let i=n.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{let i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){let n=this.Lt(e),r=RN(n);this.Bt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}kt(e){let n=this.Lt(e),r=RN(n);this.Bt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Bt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Lt(e){let n=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Dt(e){let n=255&e;n===0?(this.Qt(0),this.Qt(255)):n===255?(this.Qt(255),this.Qt(0)):this.Qt(n)}Ft(e){let n=255&e;n===0?(this.$t(0),this.$t(255)):n===255?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Bt(1),this.buffer[this.position++]=e}$t(e){this.Bt(1),this.buffer[this.position++]=~e}Bt(e){let n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},ZE=class{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}},XE=class{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}},yo=class{constructor(){this.Wt=new JE,this.Gt=new ZE(this.Wt),this.zt=new XE(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return e===0?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}};var vo=class t{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Ht(){let e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}};function ss(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=NN(t.arrayValue,e.arrayValue),n!==0?n:(n=NN(t.directionalValue,e.directionalValue),n!==0?n:U.comparator(t.documentKey,e.documentKey)))}function NN(t,e){for(let n=0;n<t.length&&n<e.length;++n){let r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}var Qg=class{constructor(e){this.Jt=new He((n,r)=>ht.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(let n of e.filters){let r=n;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(J(e.collectionGroup===this.collectionId),this.Xt)return!1;let n=EE(e);if(n!==void 0&&!this.tn(n))return!1;let r=go(e),i=new Set,s=0,o=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){let a=this.Jt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let l=r[s];if(!this.nn(a,l)||!this.rn(this.Yt[o++],l))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Yt.length||!this.rn(this.Yt[o++],a))return!1}return!0}sn(){if(this.Xt)return null;let e=new He(ht.comparator),n=[];for(let r of this.Zt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new hl(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new hl(r.field,0))}for(let r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new hl(r.field,r.dir==="asc"?0:1)));return new ml(ml.UNKNOWN_ID,this.collectionId,n,Qu.empty())}tn(e){for(let n of this.Zt)if(this.nn(n,e))return!0;return!1}nn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}rn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}};function nO(t){var e,n;if(J(t instanceof be||t instanceof Oe),t instanceof be){if(t instanceof jg){let i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>be.create(t.field,"==",s)))||[];return Oe.create(i,"or")}return t}let r=t.filters.map(i=>nO(i));return Oe.create(r,t.op)}function Ez(t){if(t.getFilters().length===0)return[];let e=nC(nO(t));return J(rO(e)),eC(e)||tC(e)?[e]:e.getFilters()}function eC(t){return t instanceof be}function tC(t){return t instanceof Oe&&mb(t)}function rO(t){return eC(t)||tC(t)||function(n){if(n instanceof Oe&&AE(n)){for(let r of n.getFilters())if(!eC(r)&&!tC(r))return!1;return!0}return!1}(t)}function nC(t){if(J(t instanceof be||t instanceof Oe),t instanceof be)return t;if(t.filters.length===1)return nC(t.filters[0]);let e=t.filters.map(r=>nC(r)),n=Oe.create(e,t.op);return n=Yg(n),rO(n)?n:(J(n instanceof Oe),J(yl(n)),J(n.filters.length>1),n.filters.reduce((r,i)=>Eb(r,i)))}function Eb(t,e){let n;return J(t instanceof be||t instanceof Oe),J(e instanceof be||e instanceof Oe),n=t instanceof be?e instanceof be?function(i,s){return Oe.create([i,s],"and")}(t,e):kN(t,e):e instanceof be?kN(e,t):function(i,s){if(J(i.filters.length>0&&s.filters.length>0),yl(i)&&yl(s))return Ek(i,s.getFilters());let o=AE(i)?i:s,a=AE(i)?s:i,l=o.filters.map(c=>Eb(c,a));return Oe.create(l,"or")}(t,e),Yg(n)}function kN(t,e){if(yl(e))return Ek(e,t.getFilters());{let n=e.filters.map(r=>Eb(t,r));return Oe.create(n,"or")}}function Yg(t){if(J(t instanceof be||t instanceof Oe),t instanceof be)return t;let e=t.getFilters();if(e.length===1)return Yg(e[0]);if(vk(t))return t;let n=e.map(i=>Yg(i)),r=[];return n.forEach(i=>{i instanceof be?r.push(i):i instanceof Oe&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Oe.create(r,t.op)}var rC=class{constructor(){this.on=new ld}addToCollectionParentIndex(e,n){return this.on.add(n),b.resolve()}getCollectionParents(e,n){return b.resolve(this.on.getEntries(n))}addFieldIndex(e,n){return b.resolve()}deleteFieldIndex(e,n){return b.resolve()}deleteAllFieldIndexes(e){return b.resolve()}createTargetIndexes(e,n){return b.resolve()}getDocumentsMatchingTarget(e,n){return b.resolve(null)}getIndexType(e,n){return b.resolve(0)}getFieldIndexes(e,n){return b.resolve([])}getNextCollectionGroupToUpdate(e){return b.resolve(null)}getMinOffset(e,n){return b.resolve(qn.min())}getMinOffsetFromCollectionGroup(e,n){return b.resolve(qn.min())}updateCollectionGroup(e,n,r){return b.resolve()}updateIndexEntries(e,n){return b.resolve()}},ld=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new He(xe.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new He(xe.comparator)).toArray()}};var Eg=new Uint8Array(0),iC=class{constructor(e,n){this.databaseId=n,this._n=new ld,this.an=new Kr(r=>xo(r),(r,i)=>yd(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this._n.has(n)){let r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this._n.add(n)});let s={collectionId:r,parent:on(i)};return ON(e).put(s)}return b.resolve()}getCollectionParents(e,n){let r=[],i=IDBKeyRange.bound([n,""],[ik(n),""],!1,!0);return ON(e).U(i).next(s=>{for(let o of s){if(o.collectionId!==n)break;r.push(Br(o.parent))}return r})}addFieldIndex(e,n){let r=ju(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;let s=r.add(i);if(n.indexState){let o=il(e);return s.next(a=>{o.put(AN(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){let r=ju(e),i=il(e),s=rl(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let n=ju(e),r=rl(e),i=il(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return b.forEach(this.un(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new Qg(r).sn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){let r=rl(e),i=!0,s=new Map;return b.forEach(this.un(n),o=>this.cn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=fe(),a=[];return b.forEach(s,(l,c)=>{R("IndexedDbIndexManager",`Using index ${function(P){return`id=${P.indexId}|cg=${P.collectionGroup}|f=${P.fields.map(F=>`${F.fieldPath}:${F.kind}`).join(",")}`}(l)} to execute ${xo(n)}`);let u=function(P,F){let X=EE(F);if(X===void 0)return null;for(let ne of Bg(P,X.fieldPath))switch(ne.op){case"array-contains-any":return ne.value.arrayValue.values||[];case"array-contains":return[ne.value]}return null}(c,l),d=function(P,F){let X=new Map;for(let ne of go(F))for(let De of Bg(P,ne.fieldPath))switch(De.op){case"==":case"in":X.set(ne.fieldPath.canonicalString(),De.value);break;case"not-in":case"!=":return X.set(ne.fieldPath.canonicalString(),De.value),Array.from(X.values())}return null}(c,l),h=function(P,F){let X=[],ne=!0;for(let De of go(F)){let pt=De.kind===0?pN(P,De.fieldPath,P.startAt):gN(P,De.fieldPath,P.startAt);X.push(pt.value),ne&&(ne=pt.inclusive)}return new Wr(X,ne)}(c,l),g=function(P,F){let X=[],ne=!0;for(let De of go(F)){let pt=De.kind===0?gN(P,De.fieldPath,P.endAt):pN(P,De.fieldPath,P.endAt);X.push(pt.value),ne&&(ne=pt.inclusive)}return new Wr(X,ne)}(c,l),y=this.ln(l,c,h),w=this.ln(l,c,g),v=this.hn(l,c,d),T=this.Pn(l.indexId,u,y,h.inclusive,w,g.inclusive,v);return b.forEach(T,V=>r.G(V,n.limit).next(P=>{P.forEach(F=>{let X=U.fromSegments(F.documentKey);o.has(X)||(o=o.add(X),a.push(X))})}))}).next(()=>a)}return b.resolve(null)})}un(e){let n=this.an.get(e);return n||(e.filters.length===0?n=[e]:n=Ez(Oe.create(e.filters,"and")).map(r=>LE(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,n),n)}Pn(e,n,r,i,s,o,a){let l=(n!=null?n.length:1)*Math.max(r.length,s.length),c=l/(n!=null?n.length:1),u=[];for(let d=0;d<l;++d){let h=n?this.In(n[d/c]):Eg,g=this.Tn(e,h,r[d%c],i),y=this.En(e,h,s[d%c],o),w=a.map(v=>this.Tn(e,h,v,!0));u.push(...this.createRange(g,y,w))}return u}Tn(e,n,r,i){let s=new vo(e,U.empty(),n,r);return i?s:s.Ht()}En(e,n,r,i){let s=new vo(e,U.empty(),n,r);return i?s.Ht():s}cn(e,n){let r=new Qg(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.en(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2,i=this.un(n);return b.forEach(i,s=>this.cn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let c=new He(ht.comparator),u=!1;for(let d of l.filters)for(let h of d.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?u=!0:c=c.add(h.field));for(let d of l.orderBy)d.field.isKeyField()||(c=c.add(d.field));return c.size+(u?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}dn(e,n){let r=new yo;for(let i of go(e)){let s=n.data.field(i.fieldPath);if(s==null)return null;let o=r.jt(i.kind);vi.St.ht(s,o)}return r.Ut()}In(e){let n=new yo;return vi.St.ht(e,n.jt(0)),n.Ut()}An(e,n){let r=new yo;return vi.St.ht(bo(this.databaseId,n),r.jt(function(s){let o=go(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Ut()}hn(e,n,r){if(r===null)return[];let i=[];i.push(new yo);let s=0;for(let o of go(e)){let a=r[s++];for(let l of i)if(this.Rn(n,o.fieldPath)&&ed(a))i=this.Vn(i,o,a);else{let c=l.jt(o.kind);vi.St.ht(a,c)}}return this.mn(i)}ln(e,n,r){return this.hn(e,n,r.position)}mn(e){let n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Ut();return n}Vn(e,n,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let l=new yo;l.seed(a.Ut()),vi.St.ht(o,l.jt(n.kind)),s.push(l)}return s}Rn(e,n){return!!e.filters.find(r=>r instanceof be&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){let r=ju(e),i=il(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(s=>{let o=[];return b.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(u,d){let h=d?new Qu(d.sequenceNumber,new qn(So(d.readTime),new U(Br(d.documentKey)),d.largestBatchId)):Qu.empty(),g=u.fields.map(([y,w])=>new hl(ht.fromServerFormat(y),w));return new ml(u.indexId,u.collectionGroup,g,h)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:de(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){let i=ju(e),s=il(e);return this.fn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>b.forEach(a,l=>s.put(AN(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){let r=new Map;return b.forEach(n,(i,s)=>{let o=r.get(i.collectionGroup);return(o?b.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),b.forEach(a,l=>this.gn(e,i,l).next(c=>{let u=this.pn(s,l);return c.isEqual(u)?b.resolve():this.yn(e,s,l,c,u)}))))})}wn(e,n,r,i){return rl(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,n.key),documentKey:n.key.path.toArray()})}Sn(e,n,r,i){return rl(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,n.key),n.key.path.toArray()])}gn(e,n,r){let i=rl(e),s=new He(ss);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,n)])},(o,a)=>{s=s.add(new vo(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}pn(e,n){let r=new He(ss),i=this.dn(n,e);if(i==null)return r;let s=EE(n);if(s!=null){let o=e.data.field(s.fieldPath);if(ed(o))for(let a of o.arrayValue.values||[])r=r.add(new vo(n.indexId,e.key,this.In(a),i))}else r=r.add(new vo(n.indexId,e.key,Eg,i));return r}yn(e,n,r,i,s){R("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);let o=[];return function(l,c,u,d,h){let g=l.getIterator(),y=c.getIterator(),w=nl(g),v=nl(y);for(;w||v;){let T=!1,V=!1;if(w&&v){let P=u(w,v);P<0?V=!0:P>0&&(T=!0)}else w!=null?V=!0:T=!0;T?(d(v),v=nl(y)):V?(h(w),w=nl(g)):(w=nl(g),v=nl(y))}}(i,s,ss,a=>{o.push(this.wn(e,n,r,a))},a=>{o.push(this.Sn(e,n,r,a))}),b.waitFor(o)}fn(e){let n=1;return il(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>ss(o,a)).filter((o,a,l)=>!a||ss(o,l[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=ss(o,e),l=ss(o,n);if(a===0)i[0]=e.Ht();else if(a>0&&l<0)i.push(o),i.push(o.Ht());else if(l>0)break}i.push(n);let s=[];for(let o=0;o<i.length;o+=2){if(this.bn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Eg,[]],l=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Eg,[]];s.push(IDBKeyRange.bound(a,l))}return s}bn(e,n){return ss(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(FN)}getMinOffset(e,n){return b.mapArray(this.un(n),r=>this.cn(e,r).next(i=>i||G())).next(FN)}};function ON(t){return Vt(t,"collectionParents")}function rl(t){return Vt(t,"indexEntries")}function ju(t){return Vt(t,"indexConfiguration")}function il(t){return Vt(t,"indexState")}function FN(t){J(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){let i=t[r].indexState.offset;fb(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new qn(e.readTime,e.documentKey,n)}var VN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},$n=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function iO(t,e,n){let r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId),a=0,l=r.J({range:o},(u,d,h)=>(a++,h.delete()));s.push(l.next(()=>{J(a===1)}));let c=[];for(let u of n.mutations){let d=uk(e,u.key.path,n.batchId);s.push(i.delete(d)),c.push(u.key)}return b.waitFor(s).next(()=>c)}function Jg(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw G();e=t.noDocument}return JSON.stringify(e).length}$n.DEFAULT_COLLECTION_PERCENTILE=10,$n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,$n.DEFAULT=new $n(41943040,$n.DEFAULT_COLLECTION_PERCENTILE,$n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),$n.DISABLED=new $n(-1,0,0);var Zg=class t{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,n,r,i){J(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new t(s,n,r,i)}checkEmpty(e){let n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return os(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){let s=ul(e),o=os(e);return o.add({}).next(a=>{J(typeof a=="number");let l=new nd(a,n,r,i),c=function(g,y,w){let v=w.baseMutations.map(V=>ad(g.ut,V)),T=w.mutations.map(V=>ad(g.ut,V));return{userId:y,batchId:w.batchId,localWriteTimeMs:w.localWriteTime.toMillis(),baseMutations:v,mutations:T}}(this.serializer,this.userId,l),u=[],d=new He((h,g)=>de(h.canonicalString(),g.canonicalString()));for(let h of i){let g=uk(this.userId,h.key.path,a);d=d.add(h.key.path.popLast()),u.push(o.put(c)),u.push(s.put(g,Sq))}return d.forEach(h=>{u.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Dn[a]=l.keys()}),b.waitFor(u).next(()=>l)})}lookupMutationBatch(e,n){return os(e).get(n).next(r=>r?(J(r.userId===this.userId),_o(this.serializer,r)):null)}Cn(e,n){return this.Dn[n]?b.resolve(this.Dn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){let i=r.keys();return this.Dn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return os(e).J({index:"userMutationsIndex",range:i},(o,a,l)=>{a.userId===this.userId&&(J(a.batchId>=r),s=_o(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return os(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return os(e).U("userMutationsIndex",n).next(r=>r.map(i=>_o(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){let r=xg(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return ul(e).J({range:i},(o,a,l)=>{let[c,u,d]=o,h=Br(u);if(c===this.userId&&n.path.isEqual(h))return os(e).get(d).next(g=>{if(!g)throw G();J(g.userId===this.userId),s.push(_o(this.serializer,g))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new He(de),i=[];return n.forEach(s=>{let o=xg(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=ul(e).J({range:a},(c,u,d)=>{let[h,g,y]=c,w=Br(g);h===this.userId&&s.path.isEqual(w)?r=r.add(y):d.done()});i.push(l)}),b.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=xg(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new He(de);return ul(e).J({range:o},(l,c,u)=>{let[d,h,g]=l,y=Br(h);d===this.userId&&r.isPrefixOf(y)?y.length===i&&(a=a.add(g)):u.done()}).next(()=>this.vn(e,a))}vn(e,n){let r=[],i=[];return n.forEach(s=>{i.push(os(e).get(s).next(o=>{if(o===null)throw G();J(o.userId===this.userId),r.push(_o(this.serializer,o))}))}),b.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return iO(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Fn(n.batchId)}),b.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return b.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return ul(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){let l=Br(s[1]);i.push(l)}else a.done()}).next(()=>{J(i.length===0)})})}containsKey(e,n){return sO(e,this.userId,n)}Mn(e){return oO(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function sO(t,e,n){let r=xg(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return ul(t).J({range:s,H:!0},(a,l,c)=>{let[u,d,h]=a;u===e&&d===i&&(o=!0),c.done()}).next(()=>o)}function os(t){return Vt(t,"mutations")}function ul(t){return Vt(t,"documentMutations")}function oO(t){return Vt(t,"mutationQueues")}var bl=class t{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new t(0)}static Nn(){return new t(-1)}};var sC=class{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Ln(e).next(n=>{let r=new bl(n.highestTargetId);return n.highestTargetId=r.next(),this.Bn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Ln(e).next(n=>te.fromTimestamp(new nt(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Ln(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Ln(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Bn(e,i)))}addTargetData(e,n){return this.kn(e,n).next(()=>this.Ln(e).next(r=>(r.targetCount+=1,this.qn(n,r),this.Bn(e,r))))}updateTargetData(e,n){return this.kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>sl(e).delete(n.targetId)).next(()=>this.Ln(e)).next(r=>(J(r.targetCount>0),r.targetCount-=1,this.Bn(e,r)))}removeTargets(e,n,r){let i=0,s=[];return sl(e).J((o,a)=>{let l=Hu(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>b.waitFor(s)).next(()=>i)}forEachTarget(e,n){return sl(e).J((r,i)=>{let s=Hu(i);n(s)})}Ln(e){return LN(e).get("targetGlobalKey").next(n=>(J(n!==null),n))}Bn(e,n){return LN(e).put("targetGlobalKey",n)}kn(e,n){return sl(e).put(tO(this.serializer,n))}qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Ln(e).next(n=>n.targetCount)}getTargetData(e,n){let r=xo(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return sl(e).J({range:i,index:"queryTargetsIndex"},(o,a,l)=>{let c=Hu(a);yd(n,c.target)&&(s=c,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){let i=[],s=as(e);return n.forEach(o=>{let a=on(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),b.waitFor(i)}removeMatchingKeys(e,n,r){let i=as(e);return b.forEach(n,s=>{let o=on(s.path);return b.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){let r=as(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){let r=IDBKeyRange.bound([n],[n+1],!1,!0),i=as(e),s=fe();return i.J({range:r,H:!0},(o,a,l)=>{let c=Br(o[1]),u=new U(c);s=s.add(u)}).next(()=>s)}containsKey(e,n){let r=on(n.path),i=IDBKeyRange.bound([r],[ik(r)],!1,!0),s=0;return as(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],l,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}ot(e,n){return sl(e).get(n).next(r=>r?Hu(r):null)}};function sl(t){return Vt(t,"targets")}function LN(t){return Vt(t,"targetGlobal")}function as(t){return Vt(t,"targetDocuments")}function jN([t,e],[n,r]){let i=de(t,n);return i===0?de(e,r):i}var oC=class{constructor(e){this.Qn=e,this.buffer=new He(jN),this.Kn=0}$n(){return++this.Kn}Un(e){let n=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();jN(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},aC=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Wn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return this.Wn!==null}Gn(e){R("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>C(this,null,function*(){this.Wn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(n){Cs(n)?R("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield Es(n)}yield this.Gn(3e5)}))}},lC=class{constructor(e,n){this.zn=e,this.params=n}calculateTargetCount(e,n){return this.zn.jn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return b.resolve(bn.oe);let r=new oC(n);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.zn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.zn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(R("LruGarbageCollector","Garbage collection skipped; disabled"),b.resolve(VN)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(R("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),VN):this.Jn(e,n))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,n){let r,i,s,o,a,l,c,u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(R("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(c=Date.now(),ol()<=Pn.DEBUG&&R("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${d} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),b.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}};function Cz(t,e){return new lC(t,e)}var cC=class{constructor(e,n){this.db=e,this.garbageCollector=Cz(this,n)}jn(e){let n=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Yn(e){let n=0;return this.Hn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Hn(e,n){return this.Zn(e,(r,i)=>n(i))}addReference(e,n,r){return Cg(e,r)}removeReference(e,n,r){return Cg(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Cg(e,n)}Xn(e,n){return function(i,s){let o=!1;return oO(i).Y(a=>sO(i,a,s).next(l=>(l&&(o=!0),b.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Zn(e,(o,a)=>{if(a<=n){let l=this.Xn(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,te.min()),as(e).delete(function(d){return[0,on(d.path)]}(o))))});i.push(l)}}).next(()=>b.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Cg(e,n)}Zn(e,n){let r=as(e),i,s=bn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:c})=>{o===0?(s!==bn.oe&&n(new U(Br(i)),s),s=c,i=l):s=bn.oe}).next(()=>{s!==bn.oe&&n(new U(Br(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Cg(t,e){return as(t).put(function(r,i){return{targetId:0,path:on(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}var Xg=class{constructor(){this.changes=new Kr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ct.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?b.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var uC=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return po(e).put(r)}removeEntry(e,n,r){return po(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Wg(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.er(e,r)))}getEntry(e,n){let r=Ct.newInvalidDocument(n);return po(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Uu(n))},(i,s)=>{r=this.tr(n,s)}).next(()=>r)}nr(e,n){let r={size:0,document:Ct.newInvalidDocument(n)};return po(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Uu(n))},(i,s)=>{r={document:this.tr(n,s),size:Jg(s)}}).next(()=>r)}getEntries(e,n){let r=_n();return this.rr(e,n,(i,s)=>{let o=this.tr(i,s);r=r.insert(i,o)}).next(()=>r)}ir(e,n){let r=_n(),i=new Ke(U.comparator);return this.rr(e,n,(s,o)=>{let a=this.tr(s,o);r=r.insert(s,a),i=i.insert(s,Jg(o))}).next(()=>({documents:r,sr:i}))}rr(e,n,r){if(n.isEmpty())return b.resolve();let i=new He($N);n.forEach(l=>i=i.add(l));let s=IDBKeyRange.bound(Uu(i.first()),Uu(i.last())),o=i.getIterator(),a=o.getNext();return po(e).J({index:"documentKeyIndex",range:s},(l,c,u)=>{let d=U.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&$N(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?u.$(Uu(a)):u.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){let o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Wg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return po(e).U(IDBKeyRange.bound(a,l,!0)).next(c=>{s?.incrementDocumentReadCount(c.length);let u=_n();for(let d of c){let h=this.tr(U.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);h.isFoundDocument()&&(wd(n,h)||i.has(h.key))&&(u=u.insert(h.key,h))}return u})}getAllFromCollectionGroup(e,n,r,i){let s=_n(),o=BN(n,r),a=BN(n,qn.max());return po(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,c,u)=>{let d=this.tr(U.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(d.key,d),s.size===i&&u.done()}).next(()=>s)}newChangeBuffer(e){return new dC(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return UN(e).get("remoteDocumentGlobalKey").next(n=>(J(!!n),n))}er(e,n){return UN(e).put("remoteDocumentGlobalKey",n)}tr(e,n){if(n){let r=vz(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(te.min())))return r}return Ct.newInvalidDocument(e)}};function aO(t){return new uC(t)}var dC=class extends Xg{constructor(e,n){super(),this._r=e,this.trackRemovals=n,this.ar=new Kr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let n=[],r=0,i=new He((s,o)=>de(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ar.get(s);if(n.push(this._r.removeEntry(e,s,a.readTime)),o.isValidDocument()){let l=DN(this._r.serializer,o);i=i.add(s.path.popLast());let c=Jg(l);r+=c-a.size,n.push(this._r.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){let l=DN(this._r.serializer,o.convertToNoDocument(te.min()));n.push(this._r.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),n.push(this._r.updateMetadata(e,r)),b.waitFor(n)}getFromCache(e,n){return this._r.nr(e,n).next(r=>(this.ar.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this._r.ir(e,n).next(({documents:r,sr:i})=>(i.forEach((s,o)=>{this.ar.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function UN(t){return Vt(t,"remoteDocumentGlobal")}function po(t){return Vt(t,"remoteDocumentsV14")}function Uu(t){let e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function BN(t,e){let n=e.documentKey.path.toArray();return[t,Wg(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function $N(t,e){let n=t.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=de(n[s],r[s]),i)return i;return i=de(n.length,r.length),i||(i=de(n[n.length-2],r[r.length-2]),i||de(n[n.length-1],r[r.length-1]))}var hC=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var em=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Gu(r.mutation,i,In.empty(),nt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,fe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=fe()){let i=$r();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=$u();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=$r();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,fe()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=_n(),o=zu(),a=function(){return zu()}();return n.forEach((l,c)=>{let u=r.get(c.key);i.has(c.key)&&(u===void 0||u.mutation instanceof gr)?s=s.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),Gu(u.mutation,c,u.mutation.getFieldMask(),nt.now())):o.set(c.key,In.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,u)=>o.set(c,u)),n.forEach((c,u)=>{var d;return a.set(c,new hC(u,(d=o.get(c))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){let r=zu(),i=new Ke((o,a)=>o-a),s=fe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(l=>{let c=n.get(l);if(c===null)return;let u=r.get(l)||In.empty();u=a.applyToLocalView(c,u),r.set(l,u);let d=(i.get(a.batchId)||fe()).add(l);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let l=a.getNext(),c=l.key,u=l.value,d=Mk();u.forEach(h=>{if(!s.has(h)){let g=Lk(n.get(h),r.get(h));g!==null&&d.set(h,g),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,d))}return b.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return U.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):_b(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):b.resolve($r()),a=-1,l=s;return o.next(c=>b.forEach(c,(u,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(u)?b.resolve():this.remoteDocumentCache.getEntry(e,u).next(h=>{l=l.insert(u,h)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,fe())).next(u=>({batchId:a,changes:Ak(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new U(n)).next(r=>{let i=$u();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=$u();return this.indexManager.getCollectionParents(e,s).next(a=>b.forEach(a,l=>{let c=function(d,h){return new pr(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(u=>{u.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,c)=>{let u=c.getKey();o.get(u)===null&&(o=o.insert(u,Ct.newInvalidDocument(u)))});let a=$u();return o.forEach((l,c)=>{let u=s.get(l);u!==void 0&&Gu(u.mutation,c,In.empty(),nt.now()),wd(n,c)&&(a=a.insert(l,c))}),a})}};var fC=class{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,n){return b.resolve(this.ur.get(n))}saveBundleMetadata(e,n){return this.ur.set(n.id,function(i){return{id:i.id,version:i.version,createTime:ft(i.createTime)}}(n)),b.resolve()}getNamedQuery(e,n){return b.resolve(this.cr.get(n))}saveNamedQuery(e,n){return this.cr.set(n.name,function(i){return{name:i.name,query:wb(i.bundledQuery),readTime:ft(i.readTime)}}(n)),b.resolve()}};var pC=class{constructor(){this.overlays=new Ke(U.comparator),this.lr=new Map}getOverlay(e,n){return b.resolve(this.overlays.get(n))}getOverlays(e,n){let r=$r();return b.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.lt(e,n,s)}),b.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),b.resolve()}getOverlaysForCollection(e,n,r){let i=$r(),s=n.length+1,o=new U(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return b.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Ke((c,u)=>c-u),o=this.overlays.getIterator();for(;o.hasNext();){let c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let u=s.get(c.largestBatchId);u===null&&(u=$r(),s=s.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}let a=$r(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=i)););return b.resolve(a)}lt(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new rd(n,r));let s=this.lr.get(n);s===void 0&&(s=fe(),this.lr.set(n,s)),this.lr.set(n,s.add(r.key))}};var cd=class{constructor(){this.hr=new He(vt.Pr),this.Ir=new He(vt.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,n){let r=new vt(e,n);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.dr(new vt(e,n))}Ar(e,n){e.forEach(r=>this.removeReference(r,n))}Rr(e){let n=new U(new xe([])),r=new vt(n,e),i=new vt(n,e+1),s=[];return this.Ir.forEachInRange([r,i],o=>{this.dr(o),s.push(o.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){let n=new U(new xe([])),r=new vt(n,e),i=new vt(n,e+1),s=fe();return this.Ir.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new vt(e,0),r=this.hr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},vt=class{constructor(e,n){this.key=e,this.gr=n}static Pr(e,n){return U.comparator(e.key,n.key)||de(e.gr,n.gr)}static Tr(e,n){return de(e.gr,n.gr)||U.comparator(e.key,n.key)}};var gC=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.pr=1,this.yr=new He(vt.Pr)}checkEmpty(e){return b.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new nd(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.yr=this.yr.add(new vt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return b.resolve(o)}lookupMutationBatch(e,n){return b.resolve(this.wr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.Sr(r),s=i<0?0:i;return b.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return b.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(e){return b.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new vt(n,0),i=new vt(n,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],o=>{let a=this.wr(o.gr);s.push(a)}),b.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new He(de);return n.forEach(i=>{let s=new vt(i,0),o=new vt(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,o],a=>{r=r.add(a.gr)})}),b.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;U.isDocumentKey(s)||(s=s.child(""));let o=new vt(new U(s),0),a=new He(de);return this.yr.forEachWhile(l=>{let c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.gr)),!0)},o),b.resolve(this.br(a))}br(e){let n=[];return e.forEach(r=>{let i=this.wr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){J(this.Dr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.yr;return b.forEach(n.mutations,i=>{let s=new vt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,n){let r=new vt(n,0),i=this.yr.firstAfterOrEqual(r);return b.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,b.resolve()}Dr(e,n){return this.Sr(e)}Sr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}wr(e){let n=this.Sr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var mC=class{constructor(e){this.Cr=e,this.docs=function(){return new Ke(U.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return b.resolve(r?r.document.mutableCopy():Ct.newInvalidDocument(n))}getEntries(e,n){let r=_n();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ct.newInvalidDocument(i))}),b.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=_n(),o=n.path,a=new U(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){let{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||fb(ok(u),r)<=0||(i.has(u.key)||wd(n,u))&&(s=s.insert(u.key,u.mutableCopy()))}return b.resolve(s)}getAllFromCollectionGroup(e,n,r,i){G()}vr(e,n){return b.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new _C(this)}getSize(e){return b.resolve(this.size)}},_C=class extends Xg{constructor(e){super(),this._r=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),b.waitFor(n)}getFromCache(e,n){return this._r.getEntry(e,n)}getAllFromCache(e,n){return this._r.getEntries(e,n)}};var yC=class{constructor(e){this.persistence=e,this.Fr=new Kr(n=>xo(n),yd),this.lastRemoteSnapshotVersion=te.min(),this.highestTargetId=0,this.Mr=0,this.Or=new cd,this.targetCount=0,this.Nr=bl.On()}forEachTarget(e,n){return this.Fr.forEach((r,i)=>n(i)),b.resolve()}getLastRemoteSnapshotVersion(e){return b.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return b.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),b.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Mr&&(this.Mr=n),b.resolve()}kn(e){this.Fr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Nr=new bl(n),this.highestTargetId=n),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,n){return this.kn(n),this.targetCount+=1,b.resolve()}updateTargetData(e,n){return this.kn(n),b.resolve()}removeTargetData(e,n){return this.Fr.delete(n.target),this.Or.Rr(n.targetId),this.targetCount-=1,b.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Fr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Fr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),b.waitFor(s).next(()=>i)}getTargetCount(e){return b.resolve(this.targetCount)}getTargetData(e,n){let r=this.Fr.get(n)||null;return b.resolve(r)}addMatchingKeys(e,n,r){return this.Or.Er(n,r),b.resolve()}removeMatchingKeys(e,n,r){this.Or.Ar(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),b.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Or.Rr(n),b.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Or.mr(n);return b.resolve(r)}containsKey(e,n){return b.resolve(this.Or.containsKey(n))}};var tm=class{constructor(e,n){this.Lr={},this.overlays={},this.Br=new bn(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new yC(this),this.indexManager=new rC,this.remoteDocumentCache=function(i){return new mC(i)}(r=>this.referenceDelegate.Qr(r)),this.serializer=new Gg(n),this.Kr=new fC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new pC,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Lr[e.toKey()];return r||(r=new gC(n,this.referenceDelegate),this.Lr[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,n,r){R("MemoryPersistence","Starting transaction:",e);let i=new vC(this.Br.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,n){return b.or(Object.values(this.Lr).map(r=>()=>r.containsKey(e,n)))}},vC=class extends kg{constructor(e){super(),this.currentSequenceNumber=e}},nm=class t{constructor(e){this.persistence=e,this.Gr=new cd,this.zr=null}static jr(e){return new t(e)}get Hr(){if(this.zr)return this.zr;throw G()}addReference(e,n,r){return this.Gr.addReference(r,n),this.Hr.delete(r.toString()),b.resolve()}removeReference(e,n,r){return this.Gr.removeReference(r,n),this.Hr.add(r.toString()),b.resolve()}markPotentiallyOrphaned(e,n){return this.Hr.add(n.toString()),b.resolve()}removeTarget(e,n){this.Gr.Rr(n.targetId).forEach(i=>this.Hr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}$r(){this.zr=new Set}Ur(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return b.forEach(this.Hr,r=>{let i=U.fromPath(r);return this.Jr(e,i).next(s=>{s||n.removeEntry(i,te.min())})}).next(()=>(this.zr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Jr(e,n).next(r=>{r?this.Hr.delete(n.toString()):this.Hr.add(n.toString())})}Qr(e){return 0}Jr(e,n){return b.or([()=>b.resolve(this.Gr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Wr(e,n)])}};var wC=class{constructor(e){this.serializer=e}O(e,n,r,i){let s=new Og("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",sN,{unique:!0}),l.createObjectStore("documentMutations")}(e),HN(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=b.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),HN(e)),o=o.next(()=>function(l){let c=l.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:te.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",u)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,c){return c.store("mutations").U().next(u=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",sN,{unique:!0});let d=c.store("mutations"),h=u.map(g=>d.put(g));return b.waitFor(h)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Zr(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(o=o.next(()=>this.ei(s))),r<8&&i>=8&&(o=o.next(()=>this.ti(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ni(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){let c=l.createObjectStore("documentOverlays",{keyPath:Uq});c.createIndex("collectionPathOverlayIndex",Bq,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",$q,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){let c=l.createObjectStore("remoteDocumentsV14",{keyPath:Aq});c.createIndex("documentKeyIndex",Mq),c.createIndex("collectionGroupIndex",Pq)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ii(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:Fq}).createIndex("sequenceNumberIndex",Vq,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:Lq}).createIndex("documentKeyIndex",jq,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),o}Xr(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=Jg(i)}).next(()=>{let r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){let n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>b.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>b.forEach(a,l=>{J(l.userId===s.userId);let c=_o(this.serializer,l);return iO(e,s.userId,c).next(()=>{})}))}))}ei(e){let n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.J((o,a)=>{let l=new xe(o),c=function(d){return[0,on(d)]}(l);s.push(n.get(c).next(u=>u?b.resolve():(d=>n.put({targetId:0,path:on(d),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>b.waitFor(s))})}ti(e,n){e.createObjectStore("collectionParents",{keyPath:Oq});let r=n.store("collectionParents"),i=new ld,s=o=>{if(i.add(o)){let a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:on(l)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{let l=new xe(o);return s(l.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,l],c)=>{let u=Br(a);return s(u.popLast())}))}ni(e){let n=e.store("targets");return n.J((r,i)=>{let s=Hu(i),o=tO(this.serializer,s);return n.put(o)})}ri(e,n){let r=n.store("remoteDocuments"),i=[];return r.J((s,o)=>{let a=n.store("remoteDocumentsV14"),l=function(d){return d.document?new U(xe.fromString(d.document.name).popFirst(5)):d.noDocument?U.fromSegments(d.noDocument.path):d.unknownDocument?U.fromSegments(d.unknownDocument.path):G()}(o).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))}).next(()=>b.waitFor(i))}ii(e,n){let r=n.store("mutations"),i=aO(this.serializer),s=new tm(nm.jr,this.serializer.ut);return r.U().next(o=>{let a=new Map;return o.forEach(l=>{var c;let u=(c=a.get(l.userId))!==null&&c!==void 0?c:fe();_o(this.serializer,l).keys().forEach(d=>u=u.add(d)),a.set(l.userId,u)}),b.forEach(a,(l,c)=>{let u=new wt(c),d=Kg.ct(this.serializer,u),h=s.getIndexManager(u),g=Zg.ct(u,this.serializer,h,s.referenceDelegate);return new em(i,g,d,h).recalculateAndSaveOverlaysForDocumentKeys(new Ju(n,bn.oe),l).next()})})}};function HN(t){t.createObjectStore("targetDocuments",{keyPath:Nq}).createIndex("documentTargetsIndex",kq,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Rq,{unique:!0}),t.createObjectStore("targetGlobal")}var dE="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",EC=class t{constructor(e,n,r,i,s,o,a,l,c,u,d=16){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.si=s,this.window=o,this.document=a,this.oi=c,this._i=u,this.ai=d,this.Br=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=h=>Promise.resolve(),!t.D())throw new M(I.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new cC(this,i),this.Ii=n+"main",this.serializer=new Gg(l),this.Ti=new hs(this.Ii,this.ai,new wC(this.serializer)),this.qr=new sC(this.referenceDelegate,this.serializer),this.remoteDocumentCache=aO(this.serializer),this.Kr=new YE,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,u===!1&&dt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new M(I.FAILED_PRECONDITION,dE);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Br=new bn(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){return this.Pi=n=>C(this,null,function*(){if(this.started)return e(n)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(n=>C(this,null,function*(){n.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget(()=>C(this,null,function*(){this.started&&(yield this.di())})))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>bg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(n=>{n||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(n=>this.isPrimary&&!n?this.pi(e).next(()=>!1):!!n&&this.yi(e).next(()=>!0))).catch(e=>{if(Cs(e))return R("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return R("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return Bu(e).get("owner").next(n=>b.resolve(this.wi(n)))}Si(e){return bg(e).delete(this.clientId)}bi(){return C(this,null,function*(){if(this.isPrimary&&!this.Di(this.hi,18e5)){this.hi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{let r=Vt(n,"clientMetadata");return r.U().next(i=>{let s=this.Ci(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return b.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ei)for(let n of e)this.Ei.removeItem(this.vi(n.clientId))}})}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?b.resolve(!0):Bu(e).get("owner").next(n=>{if(n!==null&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)){if(this.wi(n)&&this.networkEnabled)return!0;if(!this.wi(n)){if(!n.allowTabSynchronization)throw new M(I.FAILED_PRECONDITION,dE);return!1}}return!(!this.networkEnabled||!this.inForeground)||bg(e).U().next(r=>this.Ci(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&R("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return C(this,null,function*(){this.kr=!1,this.Mi(),this.li&&(this.li.cancel(),this.li=null),this.xi(),this.Oi(),yield this.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let n=new Ju(e,bn.oe);return this.pi(n).next(()=>this.Si(n))}),this.Ti.close(),this.Ni()})}Ci(e,n){return e.filter(r=>this.Di(r.updateTimeMs,n)&&!this.Fi(r.clientId))}Li(){return this.runTransaction("getActiveClients","readonly",e=>bg(e).U().next(n=>this.Ci(n,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,n){return Zg.ct(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new iC(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return Kg.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,n,r){R("IndexedDbPersistence","Starting transaction:",e);let i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===16?qq:l===15?pk:l===14?fk:l===13?hk:l===12?Hq:l===11?dk:void G()}(this.ai),o;return this.Ti.runTransaction(e,i,s,a=>(o=new Ju(a,this.Br?this.Br.next():bn.oe),n==="readwrite-primary"?this.fi(o).next(l=>!!l||this.gi(o)).next(l=>{if(!l)throw dt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new M(I.FAILED_PRECONDITION,ak);return r(o)}).next(l=>this.yi(o).next(()=>l)):this.Bi(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Bi(e){return Bu(e).get("owner").next(n=>{if(n!==null&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)&&!this.wi(n)&&!(this._i||this.allowTabSynchronization&&n.allowTabSynchronization))throw new M(I.FAILED_PRECONDITION,dE)})}yi(e){let n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Bu(e).put("owner",n)}static D(){return hs.D()}pi(e){let n=Bu(e);return n.get("owner").next(r=>this.wi(r)?(R("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):b.resolve())}Di(e,n){let r=Date.now();return!(e<r-n)&&(!(e>r)||(dt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ai(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground=this.document.visibilityState==="visible")}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ui=()=>{this.Mi();let n=/(?:Version|Mobile)\/1[456]/;ny()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var n;try{let r=((n=this.Ei)===null||n===void 0?void 0:n.getItem(this.vi(e)))!==null;return R("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return dt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){dt("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Bu(t){return Vt(t,"owner")}function bg(t){return Vt(t,"clientMetadata")}function Cb(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var CC=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.ki=r,this.qi=i}static Qi(e,n){let r=fe(),i=fe();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var bC=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var rm=class{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=function(){return ny()?8:lk(_c())>0?6:4}()}initialize(e,n){this.Gi=e,this.indexManager=n,this.Ki=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.zi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ji(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new bC;return this.Hi(e,n,o).next(a=>{if(s.result=a,this.$i)return this.Ji(e,n,o,a.size)})}).next(()=>s.result)}Ji(e,n,r,i){return r.documentReadCount<this.Ui?(ol()<=Pn.DEBUG&&R("QueryEngine","SDK will not create cache indexes for query:",al(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),b.resolve()):(ol()<=Pn.DEBUG&&R("QueryEngine","Query:",al(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(ol()<=Pn.DEBUG&&R("QueryEngine","The SDK decides to create cache indexes for query:",al(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,an(n))):b.resolve())}zi(e,n){if(mN(n))return b.resolve(null);let r=an(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=$g(n,null,"F"),r=an(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=fe(...s);return this.Gi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{let c=this.Yi(n,a);return this.Zi(n,c,o,l.readTime)?this.zi(e,$g(n,null,"F")):this.Xi(e,c,n,l)}))})))}ji(e,n,r,i){return mN(n)||i.isEqual(te.min())?b.resolve(null):this.Gi.getDocuments(e,r).next(s=>{let o=this.Yi(n,s);return this.Zi(n,o,r,i)?b.resolve(null):(ol()<=Pn.DEBUG&&R("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),al(n)),this.Xi(e,o,n,sk(i,-1)).next(a=>a))})}Yi(e,n){let r=new He(Dk(e));return n.forEach((i,s)=>{wd(e,s)&&(r=r.add(s))}),r}Zi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,n,r){return ol()<=Pn.DEBUG&&R("QueryEngine","Using full collection scan to execute query:",al(n)),this.Gi.getDocumentsMatchingQuery(e,n,qn.min(),r)}Xi(e,n,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var IC=class{constructor(e,n,r,i){this.persistence=e,this.es=n,this.serializer=i,this.ts=new Ke(de),this.ns=new Kr(s=>xo(s),yd),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new em(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ts))}};function lO(t,e,n,r){return new IC(t,e,n,r)}function cO(t,e){return C(this,null,function*(){let n=$(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.os(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],l=fe();for(let c of i){o.push(c.batchId);for(let u of c.mutations)l=l.add(u.key)}for(let c of s){a.push(c.batchId);for(let u of c.mutations)l=l.add(u.key)}return n.localDocuments.getDocuments(r,l).next(c=>({_s:c,removedBatchIds:o,addedBatchIds:a}))})})})}function bz(t,e){let n=$(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.ss.newChangeBuffer({trackRemovals:!0});return function(a,l,c,u){let d=c.batch,h=d.keys(),g=b.resolve();return h.forEach(y=>{g=g.next(()=>u.getEntry(l,y)).next(w=>{let v=c.docVersions.get(y);J(v!==null),w.version.compareTo(v)<0&&(d.applyToRemoteDocument(w,c),w.isValidDocument()&&(w.setReadTime(c.commitVersion),u.addEntry(w)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(l,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=fe();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function uO(t){let e=$(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.qr.getLastRemoteSnapshotVersion(n))}function Iz(t,e){let n=$(t),r=e.snapshotVersion,i=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.ss.newChangeBuffer({trackRemovals:!0});i=n.ts;let a=[];e.targetChanges.forEach((u,d)=>{let h=i.get(d);if(!h)return;a.push(n.qr.removeMatchingKeys(s,u.removedDocuments,d).next(()=>n.qr.addMatchingKeys(s,u.addedDocuments,d)));let g=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?g=g.withResumeToken(Ft.EMPTY_BYTE_STRING,te.min()).withLastLimboFreeSnapshotVersion(te.min()):u.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(u.resumeToken,r)),i=i.insert(d,g),function(w,v,T){return w.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(h,g,u)&&a.push(n.qr.updateTargetData(s,g))});let l=_n(),c=fe();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(dO(s,o,e.documentUpdates).next(u=>{l=u.us,c=u.cs})),!r.isEqual(te.min())){let u=n.qr.getLastRemoteSnapshotVersion(s).next(d=>n.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(u)}return b.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(n.ts=i,s))}function dO(t,e,n){let r=fe(),i=fe();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=_n();return n.forEach((a,l)=>{let c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(te.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):R("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{us:o,cs:i}})}function xz(t,e){let n=$(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Il(t,e){let n=$(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.qr.getTargetData(r,e).next(s=>s?(i=s,b.resolve(i)):n.qr.allocateTargetId(r).next(o=>(i=new Cl(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ts.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ts=n.ts.insert(r.targetId,r),n.ns.set(e,r.targetId)),r})}function xl(t,e,n){return C(this,null,function*(){let r=$(t),i=r.ts.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Cs(o))throw o;R("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)})}function im(t,e,n){let r=$(t),i=te.min(),s=fe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,u){let d=$(l),h=d.ns.get(u);return h!==void 0?b.resolve(d.ts.get(h)):d.qr.getTargetData(c,u)}(r,o,an(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.es.getDocumentsMatchingQuery(o,e,n?i:te.min(),n?s:fe())).next(a=>(pO(r,Tk(e),a),{documents:a,ls:s})))}function hO(t,e){let n=$(t),r=$(n.qr),i=n.ts.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function fO(t,e){let n=$(t),r=n.rs.get(e)||te.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.ss.getAllFromCollectionGroup(i,e,sk(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(pO(n,e,i),i))}function pO(t,e,n){let r=t.rs.get(e)||te.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.rs.set(e,r)}function Tz(t,e,n,r){return C(this,null,function*(){let i=$(t),s=fe(),o=_n();for(let c of n){let u=e.hs(c.metadata.name);c.document&&(s=s.add(u));let d=e.Ps(c);d.setReadTime(e.Is(c.metadata.readTime)),o=o.insert(u,d)}let a=i.ss.newChangeBuffer({trackRemovals:!0}),l=yield Il(i,function(u){return an(Nl(xe.fromString(`__bundle__/docs/${u}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",c=>dO(c,a,o).next(u=>(a.apply(c),u)).next(u=>i.qr.removeMatchingKeysForTargetId(c,l.targetId).next(()=>i.qr.addMatchingKeys(c,s,l.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(c,u.us,u.cs)).next(()=>u.us)))})}function Dz(r,i){return C(this,arguments,function*(t,e,n=fe()){let s=yield Il(t,an(wb(e.bundledQuery))),o=$(t);return o.persistence.runTransaction("Save named query","readwrite",a=>{let l=ft(e.readTime);if(s.snapshotVersion.compareTo(l)>=0)return o.Kr.saveNamedQuery(a,e);let c=s.withResumeToken(Ft.EMPTY_BYTE_STRING,l);return o.ts=o.ts.insert(c.targetId,c),o.qr.updateTargetData(a,c).next(()=>o.qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.qr.addMatchingKeys(a,n,s.targetId)).next(()=>o.Kr.saveNamedQuery(a,e))})})}function qN(t,e){return`firestore_clients_${t}_${e}`}function zN(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function hE(t,e){return`firestore_targets_${t}_${e}`}var sm=class t{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Ts(e,n,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new M(i.error.code,i.error.message))),o?new t(e,n,i.state,s):(dt("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Es(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Wu=class t{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ts(e,n){let r=JSON.parse(n),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new M(r.error.code,r.error.message))),s?new t(e,r.state,i):(dt("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Es(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},om=class t{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ts(e,n){let r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=yb();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=ck(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new t(e,s):(dt("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}},xC=class t{constructor(e,n){this.clientId=e,this.onlineState=n}static Ts(e){let n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t(n.clientId,n.onlineState):(dt("SharedClientState",`Failed to parse online state: ${e}`),null)}},ud=class{constructor(){this.activeTargetIds=yb()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Ku=class{constructor(e,n,r,i,s){this.window=e,this.si=n,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new Ke(de),this.started=!1,this.ps=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=qN(this.persistenceKey,this.Rs),this.ws=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.gs=this.gs.insert(this.Rs,new ud),this.Ss=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.Cs=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this.vs=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}start(){return C(this,null,function*(){let e=yield this.syncEngine.Li();for(let r of e){if(r===this.Rs)continue;let i=this.getItem(qN(this.persistenceKey,r));if(i){let s=om.Ts(r,i);s&&(this.gs=this.gs.insert(s.clientId,s))}}this.Fs();let n=this.storage.getItem(this.Cs);if(n){let r=this.Ms(n);r&&this.xs(r)}for(let r of this.ps)this.fs(r);this.ps=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let n=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,n,r){this.Ns(e,n,r),this.Ls(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(hE(this.persistenceKey,e));if(r){let i=Wu.Ts(e,r);i&&(n=i.state)}}return this.Bs.ds(e),this.Fs(),n}removeLocalQueryTarget(e){this.Bs.As(e),this.Fs()}isLocalQueryTarget(e){return this.Bs.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(hE(this.persistenceKey,e))}updateQueryState(e,n,r){this.ks(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Ls(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){let n=this.storage.getItem(e);return R("SharedClientState","READ",e,n),n}setItem(e,n){R("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){R("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){let n=e;if(n.storageArea===this.storage){if(R("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ys)return void dt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable(()=>C(this,null,function*(){if(this.started){if(n.key!==null){if(this.Ss.test(n.key)){if(n.newValue==null){let r=this.Ks(n.key);return this.$s(r,null)}{let r=this.Us(n.key,n.newValue);if(r)return this.$s(r.clientId,r)}}else if(this.bs.test(n.key)){if(n.newValue!==null){let r=this.Ws(n.key,n.newValue);if(r)return this.Gs(r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){let r=this.zs(n.key,n.newValue);if(r)return this.js(r)}}else if(n.key===this.Cs){if(n.newValue!==null){let r=this.Ms(n.newValue);if(r)return this.xs(r)}}else if(n.key===this.ws){let r=function(s){let o=bn.oe;if(s!=null)try{let a=JSON.parse(s);J(typeof a=="number"),o=a}catch(a){dt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==bn.oe&&this.sequenceNumberHandler(r)}else if(n.key===this.vs){let r=this.Hs(n.newValue);yield Promise.all(r.map(i=>this.syncEngine.Js(i)))}}}else this.ps.push(n)}))}}get Bs(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Bs.Es())}Ns(e,n,r){let i=new sm(this.currentUser,e,n,r),s=zN(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Ls(e){let n=zN(this.persistenceKey,this.currentUser,e);this.removeItem(n)}qs(e){let n={clientId:this.Rs,onlineState:e};this.storage.setItem(this.Cs,JSON.stringify(n))}ks(e,n,r){let i=hE(this.persistenceKey,e),s=new Wu(e,n,r);this.setItem(i,s.Es())}Qs(e){let n=JSON.stringify(Array.from(e));this.setItem(this.vs,n)}Ks(e){let n=this.Ss.exec(e);return n?n[1]:null}Us(e,n){let r=this.Ks(e);return om.Ts(r,n)}Ws(e,n){let r=this.bs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return sm.Ts(new wt(s),i,n)}zs(e,n){let r=this.Ds.exec(e),i=Number(r[1]);return Wu.Ts(i,n)}Ms(e){return xC.Ts(e)}Hs(e){return JSON.parse(e)}Gs(e){return C(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Ys(e.batchId,e.state,e.error);R("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,n){let r=n?this.gs.insert(e,n):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),o=[],a=[];return s.forEach(l=>{i.has(l)||o.push(l)}),i.forEach(l=>{s.has(l)||a.push(l)}),this.syncEngine.Xs(o,a).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let n=yb();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}},am=class{constructor(){this.eo=new ud,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,n,r){this.no[e]=n}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new ud,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var TC=class{ro(e){}shutdown(){}};var lm=class{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){R("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ao)e(0)}_o(){R("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ao)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Ig=null;function fE(){return Ig===null?Ig=function(){return 268435456+Math.round(2147483648*Math.random())}():Ig++,"0x"+Ig.toString(16)}var Sz={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var DC=class{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}Eo(e){this.Ao=e}onMessage(e){this.Ro=e}close(){this.lo()}send(e){this.co(e)}Vo(){this.Po()}mo(){this.To()}fo(e){this.Ao(e)}po(e){this.Ro(e)}};var Jt="WebChannelConnection",SC=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.yo=r+"://"+n.host,this.wo=`projects/${i}/databases/${s}`,this.So=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get bo(){return!1}Do(n,r,i,s,o){let a=fE(),l=this.Co(n,r.toUriEncodedString());R("RestConnection",`Sending RPC '${n}' ${a}:`,l,i);let c={"google-cloud-resource-prefix":this.wo,"x-goog-request-params":this.So};return this.vo(c,s,o),this.Fo(n,l,c,i).then(u=>(R("RestConnection",`Received RPC '${n}' ${a}: `,u),u),u=>{throw Hn("RestConnection",`RPC '${n}' ${a} failed with error: `,u,"url: ",l,"request:",i),u})}Mo(n,r,i,s,o,a){return this.Do(n,r,i,s,o)}vo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Rl}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}Co(n,r){let i=Sz[n];return`${this.yo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Fo(e,n,r,i){let s=fE();return new Promise((o,a)=>{let l=new eN;l.setWithCredentials(!0),l.listenOnce(JR.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case wg.NO_ERROR:let u=l.getResponseJson();R(Jt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(u)),o(u);break;case wg.TIMEOUT:R(Jt,`RPC '${e}' ${s} timed out`),a(new M(I.DEADLINE_EXCEEDED,"Request time out"));break;case wg.HTTP_ERROR:let d=l.getStatus();if(R(Jt,`RPC '${e}' ${s} failed with status:`,d,"response text:",l.getResponseText()),d>0){let h=l.getResponseJson();Array.isArray(h)&&(h=h[0]);let g=h?.error;if(g&&g.status&&g.message){let y=function(v){let T=v.toLowerCase().replace(/_/g,"-");return Object.values(I).indexOf(T)>=0?T:I.UNKNOWN}(g.status);a(new M(y,g.message))}else a(new M(I.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new M(I.UNAVAILABLE,"Connection failed."));break;default:G()}}finally{R(Jt,`RPC '${e}' ${s} completed.`)}});let c=JSON.stringify(i);R(Jt,`RPC '${e}' ${s} sending request:`,i),l.send(n,"POST",c,r,15)})}xo(e,n,r){let i=fE(),s=[this.yo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=QR(),a=YR(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.xmlHttpFactory=new XR({})),this.vo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;let u=s.join("");R(Jt,`Creating RPC '${e}' stream ${i}: ${u}`,l);let d=o.createWebChannel(u,l),h=!1,g=!1,y=new DC({co:v=>{g?R(Jt,`Not sending because RPC '${e}' stream ${i} is closed:`,v):(h||(R(Jt,`Opening RPC '${e}' stream ${i} transport.`),d.open(),h=!0),R(Jt,`RPC '${e}' stream ${i} sending:`,v),d.send(v))},lo:()=>d.close()}),w=(v,T,V)=>{v.listen(T,P=>{try{V(P)}catch(F){setTimeout(()=>{throw F},0)}})};return w(d,Vu.EventType.OPEN,()=>{g||(R(Jt,`RPC '${e}' stream ${i} transport opened.`),y.Vo())}),w(d,Vu.EventType.CLOSE,()=>{g||(g=!0,R(Jt,`RPC '${e}' stream ${i} transport closed`),y.fo())}),w(d,Vu.EventType.ERROR,v=>{g||(g=!0,Hn(Jt,`RPC '${e}' stream ${i} transport errored:`,v),y.fo(new M(I.UNAVAILABLE,"The operation could not be completed")))}),w(d,Vu.EventType.MESSAGE,v=>{var T;if(!g){let V=v.data[0];J(!!V);let P=V,F=P.error||((T=P[0])===null||T===void 0?void 0:T.error);if(F){R(Jt,`RPC '${e}' stream ${i} received error:`,F);let X=F.status,ne=function(Vs){let Th=yt[Vs];if(Th!==void 0)return Bk(Th)}(X),De=F.message;ne===void 0&&(ne=I.INTERNAL,De="Unknown error status: "+X+" with message "+F.message),g=!0,y.fo(new M(ne,De)),d.close()}else R(Jt,`RPC '${e}' stream ${i} received:`,V),y.po(V)}}),w(a,ZR.STAT_EVENT,v=>{v.stat===cE.PROXY?R(Jt,`RPC '${e}' stream ${i} detected buffering proxy`):v.stat===cE.NOPROXY&&R(Jt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.mo()},0),y}};function gO(){return typeof window<"u"?window:null}function Ag(){return typeof document<"u"?document:null}function Ed(t){return new zE(t,!0)}var dd=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=n,this.Oo=r,this.No=i,this.Lo=s,this.Bo=0,this.ko=null,this.qo=Date.now(),this.reset()}reset(){this.Bo=0}Qo(){this.Bo=this.Lo}Ko(e){this.cancel();let n=Math.floor(this.Bo+this.$o()),r=Math.max(0,Date.now()-this.qo),i=Math.max(0,n-r);i>0&&R("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Bo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.ko=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.qo=Date.now(),e())),this.Bo*=this.No,this.Bo<this.Oo&&(this.Bo=this.Oo),this.Bo>this.Lo&&(this.Bo=this.Lo)}Uo(){this.ko!==null&&(this.ko.skipDelay(),this.ko=null)}cancel(){this.ko!==null&&(this.ko.cancel(),this.ko=null)}$o(){return(Math.random()-.5)*this.Bo}};var cm=class{constructor(e,n,r,i,s,o,a,l){this.si=e,this.Wo=r,this.Go=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.zo=0,this.jo=null,this.Ho=null,this.stream=null,this.Jo=new dd(e,n)}Yo(){return this.state===1||this.state===5||this.Zo()}Zo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Xo()}stop(){return C(this,null,function*(){this.Yo()&&(yield this.close(0))})}e_(){this.state=0,this.Jo.reset()}t_(){this.Zo()&&this.jo===null&&(this.jo=this.si.enqueueAfterDelay(this.Wo,6e4,()=>this.n_()))}r_(e){this.i_(),this.stream.send(e)}n_(){return C(this,null,function*(){if(this.Zo())return this.close(0)})}i_(){this.jo&&(this.jo.cancel(),this.jo=null)}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}close(e,n){return C(this,null,function*(){this.i_(),this.s_(),this.Jo.cancel(),this.zo++,e!==4?this.Jo.reset():n&&n.code===I.RESOURCE_EXHAUSTED?(dt(n.toString()),dt("Using maximum backoff delay to prevent overloading the backend."),this.Jo.Qo()):n&&n.code===I.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.o_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Eo(n)})}o_(){}auth(){this.state=1;let e=this.__(this.zo),n=this.zo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.zo===n&&this.a_(r,i)},r=>{e(()=>{let i=new M(I.UNKNOWN,"Fetching auth token failed: "+r.message);return this.u_(i)})})}a_(e,n){let r=this.__(this.zo);this.stream=this.c_(e,n),this.stream.ho(()=>{r(()=>this.listener.ho())}),this.stream.Io(()=>{r(()=>(this.state=2,this.Ho=this.si.enqueueAfterDelay(this.Go,1e4,()=>(this.Zo()&&(this.state=3),Promise.resolve())),this.listener.Io()))}),this.stream.Eo(i=>{r(()=>this.u_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Xo(){this.state=5,this.Jo.Ko(()=>C(this,null,function*(){this.state=0,this.start()}))}u_(e){return R("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}__(e){return n=>{this.si.enqueueAndForget(()=>this.zo===e?n():(R("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},AC=class extends cm{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}c_(e,n){return this.connection.xo("Listen",e,n)}onMessage(e){this.Jo.reset();let n=hz(this.serializer,e),r=function(s){if(!("targetChange"in s))return te.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?te.min():o.readTime?ft(o.readTime):te.min()}(e);return this.listener.l_(n,r)}h_(e){let n={};n.database=KE(this.serializer),n.addTarget=function(s,o){let a,l=o.target;if(a=Ug(l)?{documents:Qk(s,l)}:{query:Yk(s,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Hk(s,o.resumeToken);let c=GE(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(te.min())>0){a.readTime=El(s,o.snapshotVersion.toTimestamp());let c=GE(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);let r=pz(this.serializer,e);r&&(n.labels=r),this.r_(n)}P_(e){let n={};n.database=KE(this.serializer),n.removeTarget=e,this.r_(n)}},MC=class extends cm{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.I_=!1}get T_(){return this.I_}start(){this.I_=!1,this.lastStreamToken=void 0,super.start()}o_(){this.I_&&this.E_([])}c_(e,n){return this.connection.xo("Write",e,n)}onMessage(e){if(J(!!e.streamToken),this.lastStreamToken=e.streamToken,this.I_){this.Jo.reset();let n=fz(e.writeResults,e.commitTime),r=ft(e.commitTime);return this.listener.d_(r,n)}return J(!e.writeResults||e.writeResults.length===0),this.I_=!0,this.listener.A_()}R_(){let e={};e.database=KE(this.serializer),this.r_(e)}E_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>ad(this.serializer,r))};this.r_(n)}};var PC=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.V_=!1}m_(){if(this.V_)throw new M(I.FAILED_PRECONDITION,"The client has already been terminated.")}Do(e,n,r,i){return this.m_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Do(e,WE(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===I.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new M(I.UNKNOWN,s.toString())})}Mo(e,n,r,i,s){return this.m_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Mo(e,WE(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===I.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new M(I.UNKNOWN,o.toString())})}terminate(){this.V_=!0,this.connection.terminate()}};var RC=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(dt(n),this.y_=!1):R("OnlineStateTracker",n)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var NC=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.ro(o=>{r.enqueueAndForget(()=>C(this,null,function*(){bs(this)&&(R("RemoteStore","Restarting streams for network reachability change."),yield function(l){return C(this,null,function*(){let c=$(l);c.M_.add(4),yield kl(c),c.N_.set("Unknown"),c.M_.delete(4),yield Cd(c)})}(this))}))}),this.N_=new RC(r,i)}};function Cd(t){return C(this,null,function*(){if(bs(t))for(let e of t.x_)yield e(!0)})}function kl(t){return C(this,null,function*(){for(let e of t.x_)yield e(!1)})}function Sm(t,e){let n=$(t);n.F_.has(e.targetId)||(n.F_.set(e.targetId,e),xb(n)?Ib(n):Fl(n).Zo()&&bb(n,e))}function Tl(t,e){let n=$(t),r=Fl(n);n.F_.delete(e),r.Zo()&&mO(n,e),n.F_.size===0&&(r.Zo()?r.t_():bs(n)&&n.N_.set("Unknown"))}function bb(t,e){if(t.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(te.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Fl(t).h_(e)}function mO(t,e){t.L_.xe(e),Fl(t).P_(e)}function Ib(t){t.L_=new qE({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.F_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Fl(t).start(),t.N_.w_()}function xb(t){return bs(t)&&!Fl(t).Yo()&&t.F_.size>0}function bs(t){return $(t).M_.size===0}function _O(t){t.L_=void 0}function Az(t){return C(this,null,function*(){t.N_.set("Online")})}function Mz(t){return C(this,null,function*(){t.F_.forEach((e,n)=>{bb(t,e)})})}function Pz(t,e){return C(this,null,function*(){_O(t),xb(t)?(t.N_.D_(e),Ib(t)):t.N_.set("Unknown")})}function Rz(t,e,n){return C(this,null,function*(){if(t.N_.set("Online"),e instanceof qg&&e.state===2&&e.cause)try{yield function(i,s){return C(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.F_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.F_.delete(a),i.L_.removeTarget(a))})}(t,e)}catch(r){R("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield um(t,r)}else if(e instanceof pl?t.L_.Ke(e):e instanceof Hg?t.L_.He(e):t.L_.We(e),!n.isEqual(te.min()))try{let r=yield uO(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.L_.rt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){let u=s.F_.get(c);u&&s.F_.set(c,u.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{let u=s.F_.get(l);if(!u)return;s.F_.set(l,u.withResumeToken(Ft.EMPTY_BYTE_STRING,u.snapshotVersion)),mO(s,l);let d=new Cl(u.target,l,c,u.sequenceNumber);bb(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){R("RemoteStore","Failed to raise snapshot:",r),yield um(t,r)}})}function um(t,e,n){return C(this,null,function*(){if(!Cs(e))throw e;t.M_.add(1),yield kl(t),t.N_.set("Offline"),n||(n=()=>uO(t.localStore)),t.asyncQueue.enqueueRetryable(()=>C(this,null,function*(){R("RemoteStore","Retrying IndexedDB access"),yield n(),t.M_.delete(1),yield Cd(t)}))})}function yO(t,e){return e().catch(n=>um(t,n,e))}function Ol(t){return C(this,null,function*(){let e=$(t),n=ws(e),r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;Nz(e);)try{let i=yield xz(e.localStore,r);if(i===null){e.v_.length===0&&n.t_();break}r=i.batchId,kz(e,i)}catch(i){yield um(e,i)}vO(e)&&wO(e)})}function Nz(t){return bs(t)&&t.v_.length<10}function kz(t,e){t.v_.push(e);let n=ws(t);n.Zo()&&n.T_&&n.E_(e.mutations)}function vO(t){return bs(t)&&!ws(t).Yo()&&t.v_.length>0}function wO(t){ws(t).start()}function Oz(t){return C(this,null,function*(){ws(t).R_()})}function Fz(t){return C(this,null,function*(){let e=ws(t);for(let n of t.v_)e.E_(n.mutations)})}function Vz(t,e,n){return C(this,null,function*(){let r=t.v_.shift(),i=BE.from(r,e,n);yield yO(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield Ol(t)})}function Lz(t,e){return C(this,null,function*(){e&&ws(t).T_&&(yield function(r,i){return C(this,null,function*(){if(function(o){return Uk(o)&&o!==I.ABORTED}(i.code)){let s=r.v_.shift();ws(r).e_(),yield yO(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Ol(r)}})}(t,e)),vO(t)&&wO(t)})}function GN(t,e){return C(this,null,function*(){let n=$(t);n.asyncQueue.verifyOperationInProgress(),R("RemoteStore","RemoteStore received new credentials");let r=bs(n);n.M_.add(3),yield kl(n),r&&n.N_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.M_.delete(3),yield Cd(n)})}function kC(t,e){return C(this,null,function*(){let n=$(t);e?(n.M_.delete(2),yield Cd(n)):e||(n.M_.add(2),yield kl(n),n.N_.set("Unknown"))})}function Fl(t){return t.B_||(t.B_=function(n,r,i){let s=$(n);return s.m_(),new AC(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:Az.bind(null,t),Io:Mz.bind(null,t),Eo:Pz.bind(null,t),l_:Rz.bind(null,t)}),t.x_.push(e=>C(this,null,function*(){e?(t.B_.e_(),xb(t)?Ib(t):t.N_.set("Unknown")):(yield t.B_.stop(),_O(t))}))),t.B_}function ws(t){return t.k_||(t.k_=function(n,r,i){let s=$(n);return s.m_(),new MC(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:()=>Promise.resolve(),Io:Oz.bind(null,t),Eo:Lz.bind(null,t),A_:Fz.bind(null,t),d_:Vz.bind(null,t)}),t.x_.push(e=>C(this,null,function*(){e?(t.k_.e_(),yield Ol(t)):(yield t.k_.stop(),t.v_.length>0&&(R("RemoteStore",`Stopping write stream with ${t.v_.length} pending writes`),t.v_=[]))}))),t.k_}var OC=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Et,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new M(I.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Vl(t,e){if(dt("AsyncQueue",`${e}: ${t}`),Cs(t))return new M(I.UNAVAILABLE,`${e}: ${t}`);throw t}var dm=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||U.comparator(n.key,r.key):(n,r)=>U.comparator(n.key,r.key),this.keyedMap=$u(),this.sortedSet=new Ke(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var hm=class{constructor(){this.q_=new Ke(U.comparator)}track(e){let n=e.doc.key,r=this.q_.get(n);r?e.type!==0&&r.type===3?this.q_=this.q_.insert(n,e):e.type===3&&r.type!==1?this.q_=this.q_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.q_=this.q_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.q_=this.q_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.q_=this.q_.remove(n):e.type===1&&r.type===2?this.q_=this.q_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.q_=this.q_.insert(n,{type:2,doc:e.doc}):G():this.q_=this.q_.insert(n,e)}Q_(){let e=[];return this.q_.inorderTraversal((n,r)=>{e.push(r)}),e}},Dl=class t{constructor(e,n,r,i,s,o,a,l,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,dm.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&vd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var FC=class{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}},VC=class{constructor(){this.queries=new Kr(e=>xk(e),vd),this.onlineState="Unknown",this.z_=new Set}};function Tb(t,e){return C(this,null,function*(){let n=$(t),r=3,i=e.query,s=n.queries.get(i);s?!s.W_()&&e.G_()&&(r=2):(s=new FC,r=e.G_()?0:1);try{switch(r){case 0:s.K_=yield n.onListen(i,!0);break;case 1:s.K_=yield n.onListen(i,!1);break;case 2:yield n.onFirstRemoteStoreListen(i)}}catch(o){let a=Vl(o,`Initialization of query '${al(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.U_.push(e),e.j_(n.onlineState),s.K_&&e.H_(s.K_)&&Sb(n)})}function Db(t,e){return C(this,null,function*(){let n=$(t),r=e.query,i=3,s=n.queries.get(r);if(s){let o=s.U_.indexOf(e);o>=0&&(s.U_.splice(o,1),s.U_.length===0?i=e.G_()?0:1:!s.W_()&&e.G_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}})}function jz(t,e){let n=$(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.U_)a.H_(i)&&(r=!0);o.K_=i}}r&&Sb(n)}function Uz(t,e,n){let r=$(t),i=r.queries.get(e);if(i)for(let s of i.U_)s.onError(n);r.queries.delete(e)}function Sb(t){t.z_.forEach(e=>{e.next()})}var LC,WN;(WN=LC||(LC={})).J_="default",WN.Cache="cache";var hd=class{constructor(e,n,r){this.query=e,this.Y_=n,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=r||{}}H_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Dl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),n=!0):this.ta(e,this.onlineState)&&(this.na(e),n=!0),this.X_=e,n}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let n=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),n=!0),n}ta(e,n){if(!e.fromCache||!this.G_())return!0;let r=n!=="Offline";return(!this.options.ra||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ea(e){if(e.docChanges.length>0)return!0;let n=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}na(e){e=Dl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==LC.Cache}};var jC=class{constructor(e,n){this.ia=e,this.byteLength=n}sa(){return"metadata"in this.ia}};var fm=class{constructor(e){this.serializer=e}hs(e){return qr(this.serializer,e)}Ps(e){return e.metadata.exists?Kk(this.serializer,e.document,!1):Ct.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return ft(e)}},UC=class{constructor(e,n,r){this.oa=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=EO(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++n;let r=xe.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}aa(e){let n=new Map,r=new fm(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.hs(i.metadata.name);for(let o of i.metadata.queries){let a=(n.get(o)||fe()).add(s);n.set(o,a)}}return n}complete(){return C(this,null,function*(){let e=yield Tz(this.localStore,new fm(this.serializer),this.documents,this.oa.id),n=this.aa(this.documents);for(let r of this.queries)yield Dz(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ua:this.collectionGroups,ca:e}})}};function EO(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var pm=class{constructor(e){this.key=e}},gm=class{constructor(e){this.key=e}},mm=class{constructor(e,n){this.query=e,this.la=n,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=fe(),this.mutatedKeys=fe(),this.Ia=Dk(e),this.Ta=new dm(this.Ia)}get Ea(){return this.la}da(e,n){let r=n?n.Aa:new hm,i=n?n.Ta:this.Ta,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,d)=>{let h=i.get(u),g=wd(this.query,d)?d:null,y=!!h&&this.mutatedKeys.has(h.key),w=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations),v=!1;h&&g?h.data.isEqual(g.data)?y!==w&&(r.track({type:3,doc:g}),v=!0):this.Ra(h,g)||(r.track({type:2,doc:g}),v=!0,(l&&this.Ia(g,l)>0||c&&this.Ia(g,c)<0)&&(a=!0)):!h&&g?(r.track({type:0,doc:g}),v=!0):h&&!g&&(r.track({type:1,doc:h}),v=!0,(l||c)&&(a=!0)),v&&(g?(o=o.add(g),s=w?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),r.track({type:1,doc:u})}return{Ta:o,Aa:r,Zi:a,mutatedKeys:s}}Ra(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;let o=e.Aa.Q_();o.sort((u,d)=>function(g,y){let w=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return G()}};return w(g)-w(y)}(u.type,d.type)||this.Ia(u.doc,d.doc)),this.Va(r),i=i!=null&&i;let a=n&&!i?this.ma():[],l=this.Pa.size===0&&this.current&&!i?1:0,c=l!==this.ha;return this.ha=l,o.length!==0||c?{snapshot:new Dl(this.query,e.Ta,s,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),fa:a}:{fa:a}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new hm,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(n=>this.la=this.la.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.la=this.la.delete(n)),this.current=e.current)}ma(){if(!this.current)return[];let e=this.Pa;this.Pa=fe(),this.Ta.forEach(r=>{this.ga(r.key)&&(this.Pa=this.Pa.add(r.key))});let n=[];return e.forEach(r=>{this.Pa.has(r)||n.push(new gm(r))}),this.Pa.forEach(r=>{e.has(r)||n.push(new pm(r))}),n}pa(e){this.la=e.ls,this.Pa=fe();let n=this.da(e.documents);return this.applyChanges(n,!0)}ya(){return Dl.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}},BC=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},$C=class{constructor(e){this.key=e,this.wa=!1}},HC=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new Kr(a=>xk(a),vd),this.Da=new Map,this.Ca=new Set,this.va=new Ke(U.comparator),this.Fa=new Map,this.Ma=new cd,this.xa={},this.Oa=new Map,this.Na=bl.Nn(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function Bz(t,e,n=!0){return C(this,null,function*(){let r=Am(t),i,s=r.ba.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ya()):i=yield CO(r,e,n,!0),i})}function $z(t,e){return C(this,null,function*(){let n=Am(t);yield CO(n,e,!0,!1)})}function CO(t,e,n,r){return C(this,null,function*(){let i=yield Il(t.localStore,an(e)),s=i.targetId,o=n?t.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield Ab(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&Sm(t.remoteStore,i),a})}function Ab(t,e,n,r,i){return C(this,null,function*(){t.Ba=(d,h,g)=>function(w,v,T,V){return C(this,null,function*(){let P=v.view.da(T);P.Zi&&(P=yield im(w.localStore,v.query,!1).then(({documents:De})=>v.view.da(De,P)));let F=V&&V.targetChanges.get(v.targetId),X=V&&V.targetMismatches.get(v.targetId)!=null,ne=v.view.applyChanges(P,w.isPrimaryClient,F,X);return qC(w,v.targetId,ne.fa),ne.snapshot})}(t,d,h,g);let s=yield im(t.localStore,e,!0),o=new mm(e,s.ls),a=o.da(s.documents),l=sd.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(a,t.isPrimaryClient,l);qC(t,n,c.fa);let u=new BC(e,n,o);return t.ba.set(e,u),t.Da.has(n)?t.Da.get(n).push(e):t.Da.set(n,[e]),c.snapshot})}function Hz(t,e,n){return C(this,null,function*(){let r=$(t),i=r.ba.get(e),s=r.Da.get(i.targetId);if(s.length>1)return r.Da.set(i.targetId,s.filter(o=>!vd(o,e))),void r.ba.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield xl(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Tl(r.remoteStore,i.targetId),Sl(r,i.targetId)}).catch(Es))):(Sl(r,i.targetId),yield xl(r.localStore,i.targetId,!0))})}function qz(t,e){return C(this,null,function*(){let n=$(t),r=n.ba.get(e),i=n.Da.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Tl(n.remoteStore,r.targetId))})}function zz(t,e,n){return C(this,null,function*(){let r=Nb(t);try{let i=yield function(o,a){let l=$(o),c=nt.now(),u=a.reduce((g,y)=>g.add(y.key),fe()),d,h;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let y=_n(),w=fe();return l.ss.getEntries(g,u).next(v=>{y=v,y.forEach((T,V)=>{V.isValidDocument()||(w=w.add(T))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,y)).next(v=>{d=v;let T=[];for(let V of a){let P=sz(V,d.get(V.key).overlayedDocument);P!=null&&T.push(new gr(V.key,P,yk(P.value.mapValue),ct.exists(!0)))}return l.mutationQueue.addMutationBatch(g,c,T,a)}).next(v=>{h=v;let T=v.applyToLocalDocumentSet(d,w);return l.documentOverlayCache.saveOverlays(g,v.batchId,T)})}).then(()=>({batchId:h.batchId,changes:Ak(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let c=o.xa[o.currentUser.toKey()];c||(c=new Ke(de)),c=c.insert(a,l),o.xa[o.currentUser.toKey()]=c}(r,i.batchId,n),yield Ti(r,i.changes),yield Ol(r.remoteStore)}catch(i){let s=Vl(i,"Failed to persist write");n.reject(s)}})}function bO(t,e){return C(this,null,function*(){let n=$(t);try{let r=yield Iz(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.Fa.get(s);o&&(J(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.wa=!0:i.modifiedDocuments.size>0?J(o.wa):i.removedDocuments.size>0&&(J(o.wa),o.wa=!1))}),yield Ti(n,r,e)}catch(r){yield Es(r)}})}function KN(t,e,n){let r=$(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.ba.forEach((s,o)=>{let a=o.view.j_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let l=$(o);l.onlineState=a;let c=!1;l.queries.forEach((u,d)=>{for(let h of d.U_)h.j_(a)&&(c=!0)}),c&&Sb(l)}(r.eventManager,e),i.length&&r.Sa.l_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Gz(t,e,n){return C(this,null,function*(){let r=$(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.Fa.get(e),s=i&&i.key;if(s){let o=new Ke(U.comparator);o=o.insert(s,Ct.newNoDocument(s,te.min()));let a=fe().add(s),l=new id(te.min(),new Map,new Ke(de),o,a);yield bO(r,l),r.va=r.va.remove(s),r.Fa.delete(e),Rb(r)}else yield xl(r.localStore,e,!1).then(()=>Sl(r,e,n)).catch(Es)})}function Wz(t,e){return C(this,null,function*(){let n=$(t),r=e.batch.batchId;try{let i=yield bz(n.localStore,e);Pb(n,r,null),Mb(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield Ti(n,i)}catch(i){yield Es(i)}})}function Kz(t,e,n){return C(this,null,function*(){let r=$(t);try{let i=yield function(o,a){let l=$(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next(d=>(J(d!==null),u=d.keys(),l.mutationQueue.removeMutationBatch(c,d))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(r.localStore,e);Pb(r,e,n),Mb(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield Ti(r,i)}catch(i){yield Es(i)}})}function Qz(t,e){return C(this,null,function*(){let n=$(t);bs(n.remoteStore)||R("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=$(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l))}(n.localStore);if(r===-1)return void e.resolve();let i=n.Oa.get(r)||[];i.push(e),n.Oa.set(r,i)}catch(r){let i=Vl(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function Mb(t,e){(t.Oa.get(e)||[]).forEach(n=>{n.resolve()}),t.Oa.delete(e)}function Pb(t,e,n){let r=$(t),i=r.xa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.xa[r.currentUser.toKey()]=i}}function Sl(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.Da.get(e))t.ba.delete(r),n&&t.Sa.ka(r,n);t.Da.delete(e),t.isPrimaryClient&&t.Ma.Rr(e).forEach(r=>{t.Ma.containsKey(r)||IO(t,r)})}function IO(t,e){t.Ca.delete(e.path.canonicalString());let n=t.va.get(e);n!==null&&(Tl(t.remoteStore,n),t.va=t.va.remove(e),t.Fa.delete(n),Rb(t))}function qC(t,e,n){for(let r of n)r instanceof pm?(t.Ma.addReference(r.key,e),Yz(t,r)):r instanceof gm?(R("SyncEngine","Document no longer in limbo: "+r.key),t.Ma.removeReference(r.key,e),t.Ma.containsKey(r.key)||IO(t,r.key)):G()}function Yz(t,e){let n=e.key,r=n.path.canonicalString();t.va.get(n)||t.Ca.has(r)||(R("SyncEngine","New document in limbo: "+n),t.Ca.add(r),Rb(t))}function Rb(t){for(;t.Ca.size>0&&t.va.size<t.maxConcurrentLimboResolutions;){let e=t.Ca.values().next().value;t.Ca.delete(e);let n=new U(xe.fromString(e)),r=t.Na.next();t.Fa.set(r,new $C(n)),t.va=t.va.insert(n,r),Sm(t.remoteStore,new Cl(an(Nl(n.path)),r,"TargetPurposeLimboResolution",bn.oe))}}function Ti(t,e,n){return C(this,null,function*(){let r=$(t),i=[],s=[],o=[];r.ba.isEmpty()||(r.ba.forEach((a,l)=>{o.push(r.Ba(l,e,n).then(c=>{if((c||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(l.targetId,c?.fromCache?"not-current":"current"),c){i.push(c);let u=CC.Qi(l.targetId,c);s.push(u)}}))}),yield Promise.all(o),r.Sa.l_(i),yield function(l,c){return C(this,null,function*(){let u=$(l);try{yield u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>b.forEach(c,h=>b.forEach(h.ki,g=>u.persistence.referenceDelegate.addReference(d,h.targetId,g)).next(()=>b.forEach(h.qi,g=>u.persistence.referenceDelegate.removeReference(d,h.targetId,g)))))}catch(d){if(!Cs(d))throw d;R("LocalStore","Failed to update sequence numbers: "+d)}for(let d of c){let h=d.targetId;if(!d.fromCache){let g=u.ts.get(h),y=g.snapshotVersion,w=g.withLastLimboFreeSnapshotVersion(y);u.ts=u.ts.insert(h,w)}}})}(r.localStore,s))})}function Jz(t,e){return C(this,null,function*(){let n=$(t);if(!n.currentUser.isEqual(e)){R("SyncEngine","User change. New user:",e.toKey());let r=yield cO(n.localStore,e);n.currentUser=e,function(s,o){s.Oa.forEach(a=>{a.forEach(l=>{l.reject(new M(I.CANCELLED,o))})}),s.Oa.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Ti(n,r._s)}})}function Zz(t,e){let n=$(t),r=n.Fa.get(e);if(r&&r.wa)return fe().add(r.key);{let i=fe(),s=n.Da.get(e);if(!s)return i;for(let o of s){let a=n.ba.get(o);i=i.unionWith(a.view.Ea)}return i}}function Xz(t,e){return C(this,null,function*(){let n=$(t),r=yield im(n.localStore,e.query,!0),i=e.view.pa(r);return n.isPrimaryClient&&qC(n,e.targetId,i.fa),i})}function e8(t,e){return C(this,null,function*(){let n=$(t);return fO(n.localStore,e).then(r=>Ti(n,r))})}function t8(t,e,n,r){return C(this,null,function*(){let i=$(t),s=yield function(a,l){let c=$(a),u=$(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",d=>u.Cn(d,l).next(h=>h?c.localDocuments.getDocuments(d,h):b.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?yield Ol(i.remoteStore):n==="acknowledged"||n==="rejected"?(Pb(i,e,r||null),Mb(i,e),function(a,l){$($(a).mutationQueue).Fn(l)}(i.localStore,e)):G(),yield Ti(i,s)):R("SyncEngine","Cannot apply mutation batch with id: "+e)})}function n8(t,e){return C(this,null,function*(){let n=$(t);if(Am(n),Nb(n),e===!0&&n.La!==!0){let r=n.sharedClientState.getAllActiveQueryTargets(),i=yield QN(n,r.toArray());n.La=!0,yield kC(n.remoteStore,!0);for(let s of i)Sm(n.remoteStore,s)}else if(e===!1&&n.La!==!1){let r=[],i=Promise.resolve();n.Da.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Sl(n,o),xl(n.localStore,o,!0))),Tl(n.remoteStore,o)}),yield i,yield QN(n,r),function(o){let a=$(o);a.Fa.forEach((l,c)=>{Tl(a.remoteStore,c)}),a.Ma.Vr(),a.Fa=new Map,a.va=new Ke(U.comparator)}(n),n.La=!1,yield kC(n.remoteStore,!1)}})}function QN(t,e,n){return C(this,null,function*(){let r=$(t),i=[],s=[];for(let o of e){let a,l=r.Da.get(o);if(l&&l.length!==0){a=yield Il(r.localStore,an(l[0]));for(let c of l){let u=r.ba.get(c),d=yield Xz(r,u);d.snapshot&&s.push(d.snapshot)}}else{let c=yield hO(r.localStore,o);a=yield Il(r.localStore,c),yield Ab(r,xO(c),o,!1,a.resumeToken)}i.push(a)}return r.Sa.l_(s),i})}function xO(t){return Ik(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function r8(t){return function(n){return $($(n).persistence).Li()}($(t).localStore)}function i8(t,e,n,r){return C(this,null,function*(){let i=$(t);if(i.La)return void R("SyncEngine","Ignoring unexpected query state notification.");let s=i.Da.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{let o=yield fO(i.localStore,Tk(s[0])),a=id.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Ft.EMPTY_BYTE_STRING);yield Ti(i,o,a);break}case"rejected":yield xl(i.localStore,e,!0),Sl(i,e,r);break;default:G()}})}function s8(t,e,n){return C(this,null,function*(){let r=Am(t);if(r.La){for(let i of e){if(r.Da.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){R("SyncEngine","Adding an already active target "+i);continue}let s=yield hO(r.localStore,i),o=yield Il(r.localStore,s);yield Ab(r,xO(s),o.targetId,!1,o.resumeToken),Sm(r.remoteStore,o)}for(let i of n)r.Da.has(i)&&(yield xl(r.localStore,i,!1).then(()=>{Tl(r.remoteStore,i),Sl(r,i)}).catch(Es))}})}function Am(t){let e=$(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=bO.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Zz.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Gz.bind(null,e),e.Sa.l_=jz.bind(null,e.eventManager),e.Sa.ka=Uz.bind(null,e.eventManager),e}function Nb(t){let e=$(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Wz.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Kz.bind(null,e),e}function o8(t,e,n){let r=$(t);(function(s,o,a){return C(this,null,function*(){try{let l=yield o.getMetadata();if(yield function(g,y){let w=$(g),v=ft(y.createTime);return w.persistence.runTransaction("hasNewerBundle","readonly",T=>w.Kr.getBundleMetadata(T,y.id)).then(T=>!!T&&T.createTime.compareTo(v)>=0)}(s.localStore,l))return yield o.close(),a._completeWith(function(g){return{taskState:"Success",documentsLoaded:g.totalDocuments,bytesLoaded:g.totalBytes,totalDocuments:g.totalDocuments,totalBytes:g.totalBytes}}(l)),Promise.resolve(new Set);a._updateProgress(EO(l));let c=new UC(l,s.localStore,o.serializer),u=yield o.qa();for(;u;){let h=yield c._a(u);h&&a._updateProgress(h),u=yield o.qa()}let d=yield c.complete();return yield Ti(s,d.ca,void 0),yield function(g,y){let w=$(g);return w.persistence.runTransaction("Save bundle","readwrite",v=>w.Kr.saveBundleMetadata(v,y))}(s.localStore,l),a._completeWith(d.progress),Promise.resolve(d.ua)}catch(l){return Hn("SyncEngine",`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}})})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var fd=class{constructor(){this.synchronizeTabs=!1}initialize(e){return C(this,null,function*(){this.serializer=Ed(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return lO(this.persistence,new rm,e.initialUser,this.serializer)}createPersistence(e){return new tm(nm.jr,this.serializer)}createSharedClientState(e){return new am}terminate(){return C(this,null,function*(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var _m=class t extends fd{constructor(e,n,r){super(),this.Qa=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return C(this,null,function*(){yield ey(t.prototype,this,"initialize").call(this,e),yield this.Qa.initialize(this,e),yield Nb(this.Qa.syncEngine),yield Ol(this.Qa.remoteStore),yield this.persistence.mi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return lO(this.persistence,new rm,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){let r=this.persistence.referenceDelegate.garbageCollector;return new aC(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){let r=new xE(n,this.persistence);return new IE(e.asyncQueue,r)}createPersistence(e){let n=Cb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?$n.withCacheSize(this.cacheSizeBytes):$n.DEFAULT;return new EC(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,gO(),Ag(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new am}},zC=class t extends _m{constructor(e,n){super(e,n,!1),this.Qa=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){return C(this,null,function*(){yield ey(t.prototype,this,"initialize").call(this,e);let n=this.Qa.syncEngine;this.sharedClientState instanceof Ku&&(this.sharedClientState.syncEngine={Ys:t8.bind(null,n),Zs:i8.bind(null,n),Xs:s8.bind(null,n),Li:r8.bind(null,n),Js:e8.bind(null,n)},yield this.sharedClientState.start()),yield this.persistence.mi(r=>C(this,null,function*(){yield n8(this.Qa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let n=gO();if(!Ku.D(n))throw new M(I.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=Cb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Ku(n,e.asyncQueue,r,e.clientId,e.initialUser)}},pd=class{initialize(e,n){return C(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>KN(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Jz.bind(null,this.syncEngine),yield kC(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new VC}()}createDatastore(e){let n=Ed(e.databaseInfo.databaseId),r=function(s){return new SC(s)}(e.databaseInfo);return function(s,o,a,l){return new PC(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new NC(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>KN(this.syncEngine,n,0),function(){return lm.D()?new lm:new TC}())}createSyncEngine(e,n){return function(i,s,o,a,l,c,u){let d=new HC(i,s,o,a,l,c);return u&&(d.La=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return C(this,null,function*(){var e;yield function(r){return C(this,null,function*(){let i=$(r);R("RemoteStore","RemoteStore shutting down."),i.M_.add(5),yield kl(i),i.O_.shutdown(),i.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function YN(t,e=10240){let n=0;return{read(){return C(this,null,function*(){if(n<t.byteLength){let i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}})},cancel(){return C(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Al=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):dt("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var GC=class{constructor(e,n){this.Ua=e,this.serializer=n,this.metadata=new Et,this.buffer=new Uint8Array,this.Wa=function(){return new TextDecoder("utf-8")}(),this.Ga().then(r=>{r&&r.sa()?this.metadata.resolve(r.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.ia)}`))},r=>this.metadata.reject(r))}close(){return this.Ua.cancel()}getMetadata(){return C(this,null,function*(){return this.metadata.promise})}qa(){return C(this,null,function*(){return yield this.getMetadata(),this.Ga()})}Ga(){return C(this,null,function*(){let e=yield this.za();if(e===null)return null;let n=this.Wa.decode(e),r=Number(n);isNaN(r)&&this.ja(`length string (${n}) is not valid number`);let i=yield this.Ha(r);return new jC(JSON.parse(i),e.length+r)})}Ja(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}za(){return C(this,null,function*(){for(;this.Ja()<0&&!(yield this.Ya()););if(this.buffer.length===0)return null;let e=this.Ja();e<0&&this.ja("Reached the end of bundle when a length string is expected.");let n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n})}Ha(e){return C(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ya())&&this.ja("Reached the end of bundle when more is expected.");let n=this.Wa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n})}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}Ya(){return C(this,null,function*(){let e=yield this.Ua.read();if(!e.done){let n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done})}};var WC=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return C(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new M(I.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let n=yield function(i,s){return C(this,null,function*(){let o=$(i),a={documents:s.map(d=>od(o.serializer,d))},l=yield o.Mo("BatchGetDocuments",o.serializer.databaseId,xe.emptyPath(),a,s.length),c=new Map;l.forEach(d=>{let h=dz(o.serializer,d);c.set(h.key.toString(),h)});let u=[];return s.forEach(d=>{let h=c.get(d.toString());J(!!h),u.push(h)}),u})}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n})}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new vs(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return C(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{let i=U.fromPath(r);this.mutations.push(new td(i,this.precondition(i)))}),yield function(r,i){return C(this,null,function*(){let s=$(r),o={writes:i.map(a=>ad(s.serializer,a))};yield s.Do("Commit",s.serializer.databaseId,xe.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw G();n=te.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new M(I.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){let n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(te.min())?ct.exists(!1):ct.updateTime(n):ct.none()}preconditionForUpdate(e){let n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(te.min()))throw new M(I.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ct.updateTime(n)}return ct.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var KC=class{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Za=r.maxAttempts,this.Jo=new dd(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){this.Jo.Ko(()=>C(this,null,function*(){let e=new WC(this.datastore),n=this.tu(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.nu(i)}))}).catch(r=>{this.nu(r)})}))}tu(e){try{let n=this.updateFunction(e);return!_d(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(()=>(this.eu(),Promise.resolve()))):this.deferred.reject(e)}ru(e){if(e.name==="FirebaseError"){let n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!Uk(n)}return!1}};var QC=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=wt.UNAUTHENTICATED,this.clientId=Rg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>C(this,null,function*(){R("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(R("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new M(I.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Et;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>C(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=Vl(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Mg(t,e){return C(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),R("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>C(this,null,function*(){r.isEqual(i)||(yield cO(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function YC(t,e){return C(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield kb(t);R("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>GN(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>GN(e.remoteStore,i)),t._onlineComponents=e})}function TO(t){return t.name==="FirebaseError"?t.code===I.FAILED_PRECONDITION||t.code===I.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function kb(t){return C(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){R("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Mg(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!TO(n))throw n;Hn("Error using user provided cache. Falling back to memory cache: "+n),yield Mg(t,new fd)}}else R("FirestoreClient","Using default OfflineComponentProvider"),yield Mg(t,new fd);return t._offlineComponents})}function Mm(t){return C(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(R("FirestoreClient","Using user provided OnlineComponentProvider"),yield YC(t,t._uninitializedComponentsProvider._online)):(R("FirestoreClient","Using default OnlineComponentProvider"),yield YC(t,new pd))),t._onlineComponents})}function DO(t){return kb(t).then(e=>e.persistence)}function Ob(t){return kb(t).then(e=>e.localStore)}function SO(t){return Mm(t).then(e=>e.remoteStore)}function Fb(t){return Mm(t).then(e=>e.syncEngine)}function a8(t){return Mm(t).then(e=>e.datastore)}function Ml(t){return C(this,null,function*(){let e=yield Mm(t),n=e.eventManager;return n.onListen=Bz.bind(null,e.syncEngine),n.onUnlisten=Hz.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=$z.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=qz.bind(null,e.syncEngine),n})}function l8(t){return t.asyncQueue.enqueue(()=>C(this,null,function*(){let e=yield DO(t),n=yield SO(t);return e.setNetworkEnabled(!0),function(i){let s=$(i);return s.M_.delete(0),Cd(s)}(n)}))}function c8(t){return t.asyncQueue.enqueue(()=>C(this,null,function*(){let e=yield DO(t),n=yield SO(t);return e.setNetworkEnabled(!1),function(i){return C(this,null,function*(){let s=$(i);s.M_.add(0),yield kl(s),s.N_.set("Offline")})}(n)}))}function u8(t,e){let n=new Et;return t.asyncQueue.enqueueAndForget(()=>C(this,null,function*(){return function(i,s,o){return C(this,null,function*(){try{let a=yield function(c,u){let d=$(c);return d.persistence.runTransaction("read document","readonly",h=>d.localDocuments.getDocument(h,u))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new M(I.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let l=Vl(a,`Failed to get document '${s} from cache`);o.reject(l)}})}(yield Ob(t),e,n)})),n.promise}function AO(t,e,n={}){let r=new Et;return t.asyncQueue.enqueueAndForget(()=>C(this,null,function*(){return function(s,o,a,l,c){let u=new Al({next:h=>{o.enqueueAndForget(()=>Db(s,d));let g=h.docs.has(a);!g&&h.fromCache?c.reject(new M(I.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&h.fromCache&&l&&l.source==="server"?c.reject(new M(I.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new hd(Nl(a.path),u,{includeMetadataChanges:!0,ra:!0});return Tb(s,d)}(yield Ml(t),t.asyncQueue,e,n,r)})),r.promise}function d8(t,e){let n=new Et;return t.asyncQueue.enqueueAndForget(()=>C(this,null,function*(){return function(i,s,o){return C(this,null,function*(){try{let a=yield im(i,s,!0),l=new mm(s,a.ls),c=l.da(a.documents),u=l.applyChanges(c,!1);o.resolve(u.snapshot)}catch(a){let l=Vl(a,`Failed to execute query '${s} against cache`);o.reject(l)}})}(yield Ob(t),e,n)})),n.promise}function MO(t,e,n={}){let r=new Et;return t.asyncQueue.enqueueAndForget(()=>C(this,null,function*(){return function(s,o,a,l,c){let u=new Al({next:h=>{o.enqueueAndForget(()=>Db(s,d)),h.fromCache&&l.source==="server"?c.reject(new M(I.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new hd(a,u,{includeMetadataChanges:!0,ra:!0});return Tb(s,d)}(yield Ml(t),t.asyncQueue,e,n,r)})),r.promise}function h8(t,e){let n=new Al(e);return t.asyncQueue.enqueueAndForget(()=>C(this,null,function*(){return function(i,s){$(i).z_.add(s),s.next()}(yield Ml(t),n)})),()=>{n.$a(),t.asyncQueue.enqueueAndForget(()=>C(this,null,function*(){return function(i,s){$(i).z_.delete(s)}(yield Ml(t),n)}))}}function f8(t,e,n,r){let i=function(o,a){let l;return l=typeof o=="string"?$k().encode(o):o,function(u,d){return new GC(u,d)}(function(u,d){if(u instanceof Uint8Array)return YN(u,d);if(u instanceof ArrayBuffer)return YN(new Uint8Array(u),d);if(u instanceof ReadableStream)return u.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),a)}(n,Ed(e));t.asyncQueue.enqueueAndForget(()=>C(this,null,function*(){o8(yield Fb(t),i,r)}))}function p8(t,e){return t.asyncQueue.enqueue(()=>C(this,null,function*(){return function(r,i){let s=$(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Kr.getNamedQuery(o,i))}(yield Ob(t),e)}))}function PO(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var JN=new Map;function Vb(t,e,n){if(!n)throw new M(I.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Lb(t,e,n,r){if(e===!0&&r===!0)throw new M(I.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function ZN(t){if(!U.isDocumentKey(t))throw new M(I.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function XN(t){if(U.isDocumentKey(t))throw new M(I.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Pm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":G()}function Te(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new M(I.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=Pm(t);throw new M(I.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function RO(t,e){if(e<=0)throw new M(I.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}var ym=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new M(I.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new M(I.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Lb("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=PO((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new M(I.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new M(I.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new M(I.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Ao=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ym({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new M(I.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new M(I.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ym(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new pE;switch(r.type){case"firstParty":return new yE(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new M(I.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=JN.get(n);r&&(R("ComponentProvider","Removing Datastore"),JN.delete(n),r.terminate())}(this),Promise.resolve()}};function NO(t,e,n,r={}){var i;let s=(t=Te(t,Ao))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Hn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=wt.MOCK_USER;else{a=Xo(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new M(I.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new wt(c)}t._authCredentials=new gE(new Pg(a,l))}}var Gt=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},ze=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new zr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},zr=class t extends Gt{constructor(e,n,r){super(e,n,Nl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new ze(this.firestore,null,new U(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function jb(t,e,...n){if(t=se(t),Vb("collection","path",e),t instanceof Ao){let r=xe.fromString(e,...n);return XN(r),new zr(t,null,r)}{if(!(t instanceof ze||t instanceof zr))throw new M(I.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(xe.fromString(e,...n));return XN(r),new zr(t.firestore,null,r)}}function kO(t,e){if(t=Te(t,Ao),Vb("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new M(I.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Gt(t,null,function(r){return new pr(xe.emptyPath(),r)}(e))}function bd(t,e,...n){if(t=se(t),arguments.length===1&&(e=Rg.newId()),Vb("doc","path",e),t instanceof Ao){let r=xe.fromString(e,...n);return ZN(r),new ze(t,null,new U(r))}{if(!(t instanceof ze||t instanceof zr))throw new M(I.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(xe.fromString(e,...n));return ZN(r),new ze(t.firestore,t instanceof zr?t.converter:null,new U(r))}}function Ub(t,e){return t=se(t),e=se(e),(t instanceof ze||t instanceof zr)&&(e instanceof ze||e instanceof zr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function Bb(t,e){return t=se(t),e=se(e),t instanceof Gt&&e instanceof Gt&&t.firestore===e.firestore&&vd(t._query,e._query)&&t.converter===e.converter}var JC=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Jo=new dd(this,"async_queue_retry"),this.hu=()=>{let n=Ag();n&&R("AsyncQueue","Visibility state changed to "+n.visibilityState),this.Jo.Uo()};let e=Ag();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let n=Ag();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let n=new Et;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return C(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Jo.reset()}catch(e){if(!Cs(e))throw e;R("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Jo.Ko(()=>this.Tu())}})}Iu(e){let n=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw dt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.uu=!1,r))));return this.iu=n,n}enqueueAfterDelay(e,n,r){this.Pu(),this.lu.indexOf(e)>-1&&(n=0);let i=OC.createAndSchedule(this,e,n,r,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&G()}verifyOperationInProgress(){}du(){return C(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let n of this._u)if(n.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this._u)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let n=this._u.indexOf(e);this._u.splice(n,1)}};function ZC(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var XC=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Et,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var OO=-1,Ze=class extends Ao{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new JC}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||FO(this),this._firestoreClient.terminate()}};function At(t){return t._firestoreClient||FO(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function FO(t){var e,n,r;let i=t._freezeSettings(),s=function(a,l,c,u){return new TE(a,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,PO(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new QC(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function VO(t,e){GO(t=Te(t,Ze));let n=At(t);if(n._uninitializedComponentsProvider)throw new M(I.FAILED_PRECONDITION,"SDK cache is already specified.");Hn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=t._freezeSettings(),i=new pd;return jO(n,i,new _m(i,r.cacheSizeBytes,e?.forceOwnership))}function LO(t){GO(t=Te(t,Ze));let e=At(t);if(e._uninitializedComponentsProvider)throw new M(I.FAILED_PRECONDITION,"SDK cache is already specified.");Hn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=t._freezeSettings(),r=new pd;return jO(e,r,new zC(r,n.cacheSizeBytes))}function jO(t,e,n){let r=new Et;return t.asyncQueue.enqueue(()=>C(this,null,function*(){try{yield Mg(t,n),yield YC(t,e),r.resolve()}catch(i){let s=i;if(!TO(s))throw s;Hn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function UO(t){if(t._initialized&&!t._terminated)throw new M(I.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Et;return t._queue.enqueueAndForgetEvenWhileRestricted(()=>C(this,null,function*(){try{yield function(r){return C(this,null,function*(){if(!hs.D())return Promise.resolve();let i=r+"main";yield hs.delete(i)})}(Cb(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}})),e.promise}function BO(t){return function(n){let r=new Et;return n.asyncQueue.enqueueAndForget(()=>C(this,null,function*(){return Qz(yield Fb(n),r)})),r.promise}(At(t=Te(t,Ze)))}function $O(t){return l8(At(t=Te(t,Ze)))}function HO(t){return c8(At(t=Te(t,Ze)))}function qO(t,e){let n=At(t=Te(t,Ze)),r=new XC;return f8(n,t._databaseId,e,r),r}function zO(t,e){return p8(At(t=Te(t,Ze)),e).then(n=>n?new Gt(t,null,n.query):null)}function GO(t){if(t._initialized||t._terminated)throw new M(I.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Qr=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(Ft.fromBase64String(e))}catch(n){throw new M(I.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(Ft.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var mr=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new M(I.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ht(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Ii=class{constructor(e){this._methodName=e}};var Mo=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new M(I.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new M(I.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return de(this._lat,e._lat)||de(this._long,e._long)}};var g8=/^__.*__$/,eb=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new gr(e,this.data,this.fieldMask,n,this.fieldTransforms):new ys(e,this.data,n,this.fieldTransforms)}},vm=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new gr(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function WO(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw G()}}var wm=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.gu({path:r,yu:!1});return i.wu(e),i}Su(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.gu({path:r,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return Em(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(WO(this.fu)&&g8.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},tb=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Ed(e)}Fu(e,n,r,i=!1){return new wm({fu:e,methodName:n,vu:r,path:ht.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function ko(t){let e=t._freezeSettings(),n=Ed(t._databaseId);return new tb(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Rm(t,e,n,r,i,s={}){let o=t.Fu(s.merge||s.mergeFields?2:0,e,n,i);qb("Data must be an object, but it was:",o,r);let a=YO(r,o),l,c;if(s.merge)l=new In(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){let u=[];for(let d of s.mergeFields){let h=ob(e,d,n);if(!o.contains(h))throw new M(I.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);ZO(u,h)||u.push(h)}l=new In(u),c=o.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,c=o.fieldTransforms;return new eb(new Zt(a),l,c)}var gd=class t extends Ii{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};function KO(t,e,n){return new wm({fu:3,vu:e.settings.vu,methodName:t._methodName,yu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var nb=class t extends Ii{_toFieldTransform(e){return new To(e.path,new ms)}isEqual(e){return e instanceof t}},rb=class t extends Ii{constructor(e,n){super(e),this.Mu=n}_toFieldTransform(e){let n=KO(this,e,!0),r=this.Mu.map(s=>Oo(s,n)),i=new Ci(r);return new To(e.path,i)}isEqual(e){return e instanceof t&&ry(this.Mu,e.Mu)}},ib=class t extends Ii{constructor(e,n){super(e),this.Mu=n}_toFieldTransform(e){let n=KO(this,e,!0),r=this.Mu.map(s=>Oo(s,n)),i=new bi(r);return new To(e.path,i)}isEqual(e){return e instanceof t&&ry(this.Mu,e.Mu)}},sb=class t extends Ii{constructor(e,n){super(e),this.xu=n}_toFieldTransform(e){let n=new _s(e.serializer,Nk(e.serializer,this.xu));return new To(e.path,n)}isEqual(e){return e instanceof t&&this.xu===e.xu}};function $b(t,e,n,r){let i=t.Fu(1,e,n);qb("Data must be an object, but it was:",i,r);let s=[],o=Zt.empty();No(r,(l,c)=>{let u=zb(e,l,n);c=se(c);let d=i.Su(u);if(c instanceof gd)s.push(u);else{let h=Oo(c,d);h!=null&&(s.push(u),o.set(u,h))}});let a=new In(s);return new vm(o,a,i.fieldTransforms)}function Hb(t,e,n,r,i,s){let o=t.Fu(1,e,n),a=[ob(e,r,n)],l=[i];if(s.length%2!=0)throw new M(I.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(ob(e,s[h])),l.push(s[h+1]);let c=[],u=Zt.empty();for(let h=a.length-1;h>=0;--h)if(!ZO(c,a[h])){let g=a[h],y=l[h];y=se(y);let w=o.Su(g);if(y instanceof gd)c.push(g);else{let v=Oo(y,w);v!=null&&(c.push(g),u.set(g,v))}}let d=new In(c);return new vm(u,d,o.fieldTransforms)}function QO(t,e,n,r=!1){return Oo(n,t.Fu(r?4:3,e))}function Oo(t,e){if(JO(t=se(t)))return qb("Unsupported field value:",e,t),YO(t,e);if(t instanceof Ii)return function(r,i){if(!WO(i.fu))throw i.Du(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let l=Oo(a,i.bu(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=se(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Nk(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=nt.fromDate(r);return{timestampValue:El(i.serializer,s)}}if(r instanceof nt){let s=new nt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:El(i.serializer,s)}}if(r instanceof Mo)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Qr)return{bytesValue:Hk(i.serializer,r._byteString)};if(r instanceof ze){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:vb(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Du(`Unsupported field value: ${Pm(r)}`)}(t,e)}function YO(t,e){let n={};return gk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):No(t,(r,i)=>{let s=Oo(i,e.pu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function JO(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof nt||t instanceof Mo||t instanceof Qr||t instanceof ze||t instanceof Ii)}function qb(t,e,n){if(!JO(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=Pm(n);throw r==="an object"?e.Du(t+" a custom object"):e.Du(t+" "+r)}}function ob(t,e,n){if((e=se(e))instanceof mr)return e._internalPath;if(typeof e=="string")return zb(t,e);throw Em("Field path arguments must be of type string or ",t,!1,void 0,n)}var m8=new RegExp("[~\\*/\\[\\]]");function zb(t,e,n){if(e.search(m8)>=0)throw Em(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new mr(...e.split("."))._internalPath}catch{throw Em(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Em(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new M(I.INVALID_ARGUMENT,a+t+l)}function ZO(t,e){return t.some(n=>n.isEqual(e))}var Po=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ze(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new ab(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(Nm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},ab=class extends Po{data(){return super.data()}};function Nm(t,e){return typeof e=="string"?zb(t,e):e instanceof mr?e._internalPath:e._delegate._internalPath}function XO(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new M(I.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var md=class{},Ro=class extends md{};function Di(t,e,...n){let r=[];e instanceof md&&r.push(e),r=r.concat(n),function(s){let o=s.filter(l=>l instanceof lb).length,a=s.filter(l=>l instanceof Cm).length;if(o>1||o>0&&a>0)throw new M(I.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var Cm=class t extends Ro{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return cF(e._query,n),new Gt(e.firestore,e.converter,jE(e._query,n))}_parse(e){let n=ko(e.firestore);return function(s,o,a,l,c,u,d){let h;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new M(I.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){tk(d,u);let g=[];for(let y of d)g.push(ek(l,s,y));h={arrayValue:{values:g}}}else h=ek(l,s,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||tk(d,u),h=QO(a,o,d,u==="in"||u==="not-in");return be.create(c,u,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function eF(t,e,n){let r=e,i=Nm("where",t);return Cm._create(i,r,n)}var lb=class t extends md{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Oe.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let l of a)cF(o,l),o=jE(o,l)}(e._query,n),new Gt(e.firestore,e.converter,jE(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var cb=class t extends Ro{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t(e,n)}_apply(e){let n=function(i,s,o){if(i.startAt!==null)throw new M(I.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new M(I.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Io(s,o)}(e._query,this._field,this._direction);return new Gt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new pr(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}};function tF(t,e="asc"){let n=e,r=Nm("orderBy",t);return cb._create(r,n)}var bm=class t extends Ro{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){return new Gt(e.firestore,e.converter,$g(e._query,this._limit,this._limitType))}};function nF(t){return RO("limit",t),bm._create("limit",t,"F")}function rF(t){return RO("limitToLast",t),bm._create("limitToLast",t,"L")}var Im=class t extends Ro{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=lF(e,this.type,this._docOrFields,this._inclusive);return new Gt(e.firestore,e.converter,function(i,s){return new pr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function iF(...t){return Im._create("startAt",t,!0)}function sF(...t){return Im._create("startAfter",t,!1)}var xm=class t extends Ro{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=lF(e,this.type,this._docOrFields,this._inclusive);return new Gt(e.firestore,e.converter,function(i,s){return new pr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function oF(...t){return xm._create("endBefore",t,!1)}function aF(...t){return xm._create("endAt",t,!0)}function lF(t,e,n,r){if(n[0]=se(n[0]),n[0]instanceof Po)return function(s,o,a,l,c){if(!l)throw new M(I.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let u=[];for(let d of fl(s))if(d.field.isKeyField())u.push(bo(o,l.key));else{let h=l.data.field(d.field);if(Dm(h))throw new M(I.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){let g=d.field.canonicalString();throw new M(I.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${g}' (used as the orderBy) does not exist.`)}u.push(h)}return new Wr(u,c)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{let i=ko(t.firestore);return function(o,a,l,c,u,d){let h=o.explicitOrderBy;if(u.length>h.length)throw new M(I.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let g=[];for(let y=0;y<u.length;y++){let w=u[y];if(h[y].field.isKeyField()){if(typeof w!="string")throw new M(I.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof w}`);if(!_b(o)&&w.indexOf("/")!==-1)throw new M(I.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${w}' contains a slash.`);let v=o.path.child(xe.fromString(w));if(!U.isDocumentKey(v))throw new M(I.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${v}' is not because it contains an odd number of segments.`);let T=new U(v);g.push(bo(a,T))}else{let v=QO(l,c,w);g.push(v)}}return new Wr(g,d)}(t._query,t.firestore._databaseId,i,e,n,r)}}function ek(t,e,n){if(typeof(n=se(n))=="string"){if(n==="")throw new M(I.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!_b(e)&&n.indexOf("/")!==-1)throw new M(I.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(xe.fromString(n));if(!U.isDocumentKey(r))throw new M(I.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return bo(t,new U(r))}if(n instanceof ze)return bo(t,n._key);throw new M(I.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Pm(n)}.`)}function tk(t,e){if(!Array.isArray(t)||t.length===0)throw new M(I.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function cF(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new M(I.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new M(I.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var Pl=class{convertValue(e,n="none"){switch(Co(e)){case 0:return null;case 1:return e.booleanValue;case 2:return lt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(fs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw G()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return No(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new Mo(lt(e.latitude),lt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=gb(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Zu(e));default:return null}}convertTimestamp(e){let n=Ei(e);return new nt(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=xe.fromString(e);J(eO(r));let i=new ps(r.get(1),r.get(3)),s=new U(r.popFirst(5));return i.isEqual(n)||dt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function km(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var ub=class extends Pl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Qr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new ze(this.firestore,null,n)}};var wi=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},zn=class extends Po{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new us(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(Nm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},us=class extends zn{data(e={}){return super.data(e)}},_r=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new wi(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new us(this._firestore,this._userDataWriter,r.key,r,new wi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new M(I.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let l=new us(i._firestore,i._userDataWriter,a.doc.key,a.doc,new wi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let l=new us(i._firestore,i._userDataWriter,a.doc.key,a.doc,new wi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),c=-1,u=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:_8(a.type),doc:l,oldIndex:c,newIndex:u}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function _8(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return G()}}function Gb(t,e){return t instanceof zn&&e instanceof zn?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof _r&&e instanceof _r&&t._firestore===e._firestore&&Bb(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function uF(t){t=Te(t,ze);let e=Te(t.firestore,Ze);return AO(At(e),t._key).then(n=>Yb(e,t,n))}var xi=class extends Pl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Qr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new ze(this.firestore,null,n)}};function dF(t){t=Te(t,ze);let e=Te(t.firestore,Ze),n=At(e),r=new xi(e);return u8(n,t._key).then(i=>new zn(e,r,t._key,i,new wi(i!==null&&i.hasLocalMutations,!0),t.converter))}function hF(t){t=Te(t,ze);let e=Te(t.firestore,Ze);return AO(At(e),t._key,{source:"server"}).then(n=>Yb(e,t,n))}function fF(t){t=Te(t,Gt);let e=Te(t.firestore,Ze),n=At(e),r=new xi(e);return XO(t._query),MO(n,t._query).then(i=>new _r(e,r,t,i))}function pF(t){t=Te(t,Gt);let e=Te(t.firestore,Ze),n=At(e),r=new xi(e);return d8(n,t._query).then(i=>new _r(e,r,t,i))}function gF(t){t=Te(t,Gt);let e=Te(t.firestore,Ze),n=At(e),r=new xi(e);return MO(n,t._query,{source:"server"}).then(i=>new _r(e,r,t,i))}function Wb(t,e,n){t=Te(t,ze);let r=Te(t.firestore,Ze),i=km(t.converter,e,n);return Ll(r,[Rm(ko(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,ct.none())])}function Kb(t,e,n,...r){t=Te(t,ze);let i=Te(t.firestore,Ze),s=ko(i),o;return o=typeof(e=se(e))=="string"||e instanceof mr?Hb(s,"updateDoc",t._key,e,n,r):$b(s,"updateDoc",t._key,e),Ll(i,[o.toMutation(t._key,ct.exists(!0))])}function mF(t){return Ll(Te(t.firestore,Ze),[new vs(t._key,ct.none())])}function _F(t,e){let n=Te(t.firestore,Ze),r=bd(t),i=km(t.converter,e);return Ll(n,[Rm(ko(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,ct.exists(!1))]).then(()=>r)}function Qb(t,...e){var n,r,i;t=se(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||ZC(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(ZC(e[o])){let d=e[o];e[o]=(n=d.next)===null||n===void 0?void 0:n.bind(d),e[o+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let l,c,u;if(t instanceof ze)c=Te(t.firestore,Ze),u=Nl(t._key.path),l={next:d=>{e[o]&&e[o](Yb(c,t,d))},error:e[o+1],complete:e[o+2]};else{let d=Te(t,Gt);c=Te(d.firestore,Ze),u=d._query;let h=new xi(c);l={next:g=>{e[o]&&e[o](new _r(c,h,d,g))},error:e[o+1],complete:e[o+2]},XO(t._query)}return function(h,g,y,w){let v=new Al(w),T=new hd(g,v,y);return h.asyncQueue.enqueueAndForget(()=>C(this,null,function*(){return Tb(yield Ml(h),T)})),()=>{v.$a(),h.asyncQueue.enqueueAndForget(()=>C(this,null,function*(){return Db(yield Ml(h),T)}))}}(At(c),u,a,l)}function yF(t,e){return h8(At(t=Te(t,Ze)),ZC(e)?e:{next:e})}function Ll(t,e){return function(r,i){let s=new Et;return r.asyncQueue.enqueueAndForget(()=>C(this,null,function*(){return zz(yield Fb(r),i,s)})),s.promise}(At(t),e)}function Yb(t,e,n){let r=n.docs.get(e._key),i=new xi(t);return new zn(t,i,e._key,r,new wi(n.hasPendingWrites,n.fromCache),e.converter)}var y8={maxAttempts:5};var Tm=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=ko(e)}set(e,n,r){this._verifyNotCommitted();let i=ls(e,this._firestore),s=km(i.converter,n,r),o=Rm(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,ct.none())),this}update(e,n,r,...i){this._verifyNotCommitted();let s=ls(e,this._firestore),o;return o=typeof(n=se(n))=="string"||n instanceof mr?Hb(this._dataReader,"WriteBatch.update",s._key,n,r,i):$b(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,ct.exists(!0))),this}delete(e){this._verifyNotCommitted();let n=ls(e,this._firestore);return this._mutations=this._mutations.concat(new vs(n._key,ct.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new M(I.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function ls(t,e){if((t=se(t)).firestore!==e)throw new M(I.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var db=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=ko(n)}get(n){let r=ls(n,this._firestore),i=new ub(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return G();let o=s[0];if(o.isFoundDocument())return new Po(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Po(this._firestore,i,r._key,null,r.converter);throw G()})}set(n,r,i){let s=ls(n,this._firestore),o=km(s.converter,r,i),a=Rm(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){let o=ls(n,this._firestore),a;return a=typeof(r=se(r))=="string"||r instanceof mr?Hb(this._dataReader,"Transaction.update",o._key,r,i,s):$b(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){let r=ls(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){let n=ls(e,this._firestore),r=new xi(this._firestore);return super.get(e).then(i=>new zn(this._firestore,r,n._key,i._document,new wi(!1,!1),n.converter))}};function vF(t,e,n){t=Te(t,Ze);let r=Object.assign(Object.assign({},y8),n);return function(s){if(s.maxAttempts<1)throw new M(I.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let l=new Et;return s.asyncQueue.enqueueAndForget(()=>C(this,null,function*(){let c=yield a8(s);new KC(s.asyncQueue,c,a,o,l).Xa()})),l.promise}(At(t),i=>e(new db(t,i)),r)}function wF(){return new gd("deleteField")}function EF(){return new nb("serverTimestamp")}function CF(...t){return new rb("arrayUnion",t)}function bF(...t){return new ib("arrayRemove",t)}function IF(t){return new sb("increment",t)}(function(e,n=!0){(function(i){Rl=i})(ea),si(new Ut("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Ze(new mE(r.getProvider("auth-internal")),new wE(r.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new M(I.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ps(c.options.projectId,u)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),fn(nN,"4.6.1",e),fn(nN,"4.6.1","esm2017")})();var v8="@firebase/firestore-compat",w8="0.3.30";function nI(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new M("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function xF(){if(typeof Uint8Array>"u")throw new M("unimplemented","Uint8Arrays are not available in this environment.")}function TF(){if(!mk())throw new M("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Om=class t{constructor(e){this._delegate=e}static fromBase64String(e){return TF(),new t(Qr.fromBase64String(e))}static fromUint8Array(e){return xF(),new t(Qr.fromUint8Array(e))}toBase64(){return TF(),this._delegate.toBase64()}toUint8Array(){return xF(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function Jb(t){return E8(t,["next","error","complete"])}function E8(t,e){if(typeof t!="object"||t===null)return!1;let n=t;for(let r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}var Zb=class{enableIndexedDbPersistence(e,n){return VO(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return LO(e._delegate)}clearIndexedDbPersistence(e){return UO(e._delegate)}},Fm=class{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof ps||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Hn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){NO(this._delegate,e,n,r)}enableNetwork(){return $O(this._delegate)}disableNetwork(){return HO(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,Lb("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return BO(this._delegate)}onSnapshotsInSync(e){return yF(this._delegate,e)}get app(){if(!this._appCompat)throw new M("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Bl(this,jb(this._delegate,e))}catch(n){throw ln(n,"collection()","Firestore.collection()")}}doc(e){try{return new Yr(this,bd(this._delegate,e))}catch(n){throw ln(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new jo(this,kO(this._delegate,e))}catch(n){throw ln(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return vF(this._delegate,n=>e(new Vm(this,n)))}batch(){return At(this._delegate),new Lm(new Tm(this._delegate,e=>Ll(this._delegate,e)))}loadBundle(e){return qO(this._delegate,e)}namedQuery(e){return zO(this._delegate,e).then(n=>n?new jo(this,n):null)}},jl=class extends Pl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Om(new Qr(e))}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return Yr.forKey(n,this.firestore,null)}};function C8(t){nk(t)}var Vm=class{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new jl(e)}get(e){let n=Fo(e);return this._delegate.get(n).then(r=>new Vo(this._firestore,new zn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){let i=Fo(e);return r?(nI("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=Fo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=Fo(e);return this._delegate.delete(n),this}},Lm=class{constructor(e){this._delegate=e}set(e,n,r){let i=Fo(e);return r?(nI("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=Fo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=Fo(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}},Ul=class t{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){let r=new us(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Lo(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){let r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new t(e,new jl(e),n),i.set(n,s)),s}};Ul.INSTANCES=new WeakMap;var Yr=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new jl(e)}static forPath(e,n,r){if(e.length%2!==0)throw new M("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new t(n,new ze(n._delegate,r,new U(e)))}static forKey(e,n,r){return new t(n,new ze(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Bl(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Bl(this.firestore,jb(this._delegate,e))}catch(n){throw ln(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=se(e),e instanceof ze?Ub(this._delegate,e):!1}set(e,n){n=nI("DocumentReference.set",n);try{return n?Wb(this._delegate,e,n):Wb(this._delegate,e)}catch(r){throw ln(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?Kb(this._delegate,e):Kb(this._delegate,e,n,...r)}catch(i){throw ln(i,"updateDoc()","DocumentReference.update()")}}delete(){return mF(this._delegate)}onSnapshot(...e){let n=DF(e),r=SF(e,i=>new Vo(this.firestore,new zn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Qb(this._delegate,n,r)}get(e){let n;return e?.source==="cache"?n=dF(this._delegate):e?.source==="server"?n=hF(this._delegate):n=uF(this._delegate),n.then(r=>new Vo(this.firestore,new zn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(Ul.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function ln(t,e,n){return t.message=t.message.replace(e,n),t}function DF(t){for(let e of t)if(typeof e=="object"&&!Jb(e))return e;return{}}function SF(t,e){var n,r;let i;return Jb(t[0])?i=t[0]:Jb(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Vo=class{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new Yr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return Gb(this._delegate,e._delegate)}},Lo=class extends Vo{data(e){let n=this._delegate.data(e);return this._delegate._converter||rk(n!==void 0,"Document in a QueryDocumentSnapshot should exist"),n}},jo=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new jl(e)}where(e,n,r){try{return new t(this.firestore,Di(this._delegate,eF(e,n,r)))}catch(i){throw ln(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new t(this.firestore,Di(this._delegate,tF(e,n)))}catch(r){throw ln(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new t(this.firestore,Di(this._delegate,nF(e)))}catch(n){throw ln(n,"limit()","Query.limit()")}}limitToLast(e){try{return new t(this.firestore,Di(this._delegate,rF(e)))}catch(n){throw ln(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new t(this.firestore,Di(this._delegate,iF(...e)))}catch(n){throw ln(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new t(this.firestore,Di(this._delegate,sF(...e)))}catch(n){throw ln(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new t(this.firestore,Di(this._delegate,oF(...e)))}catch(n){throw ln(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new t(this.firestore,Di(this._delegate,aF(...e)))}catch(n){throw ln(n,"endAt()","Query.endAt()")}}isEqual(e){return Bb(this._delegate,e._delegate)}get(e){let n;return e?.source==="cache"?n=pF(this._delegate):e?.source==="server"?n=gF(this._delegate):n=fF(this._delegate),n.then(r=>new Id(this.firestore,new _r(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let n=DF(e),r=SF(e,i=>new Id(this.firestore,new _r(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Qb(this._delegate,n,r)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(Ul.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},Xb=class{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new Lo(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Id=class{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new jo(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Lo(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new Xb(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new Lo(this._firestore,r))})}isEqual(e){return Gb(this._delegate,e._delegate)}},Bl=class t extends jo{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Yr(this.firestore,e):null}doc(e){try{return e===void 0?new Yr(this.firestore,bd(this._delegate)):new Yr(this.firestore,bd(this._delegate,e))}catch(n){throw ln(n,"doc()","CollectionReference.doc()")}}add(e){return _F(this._delegate,e).then(n=>new Yr(this.firestore,n))}isEqual(e){return Ub(this._delegate,e._delegate)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(Ul.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Fo(t){return Te(t,ze)}var eI=class t{constructor(...e){this._delegate=new mr(...e)}static documentId(){return new t(ht.keyField().canonicalString())}isEqual(e){return e=se(e),e instanceof mr?this._delegate._internalPath.isEqual(e._internalPath):!1}};var tI=class t{constructor(e){this._delegate=e}static serverTimestamp(){let e=EF();return e._methodName="FieldValue.serverTimestamp",new t(e)}static delete(){let e=wF();return e._methodName="FieldValue.delete",new t(e)}static arrayUnion(...e){let n=CF(...e);return n._methodName="FieldValue.arrayUnion",new t(n)}static arrayRemove(...e){let n=bF(...e);return n._methodName="FieldValue.arrayRemove",new t(n)}static increment(e){let n=IF(e);return n._methodName="FieldValue.increment",new t(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var b8={Firestore:Fm,GeoPoint:Mo,Timestamp:nt,Blob:Om,Transaction:Vm,WriteBatch:Lm,DocumentReference:Yr,DocumentSnapshot:Vo,Query:jo,QueryDocumentSnapshot:Lo,QuerySnapshot:Id,CollectionReference:Bl,FieldPath:eI,FieldValue:tI,setLogLevel:C8,CACHE_SIZE_UNLIMITED:OO};function I8(t,e){t.INTERNAL.registerComponent(new Ut("firestore-compat",n=>{let r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},b8)))}function x8(t){I8(t,(e,n)=>new Fm(e,n,new Zb)),t.registerVersion(v8,w8)}x8(et);function T8(t,e=ai){return new oe(n=>{let r;return e!=null?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}function AF(t,e){return T8(t,e)}function D8(t,e){return AF(t,e).pipe(qs(void 0),bc(),B(n=>{let[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function sI(t,e){return AF(t,e).pipe(B(n=>({payload:n,type:"query"})))}var jm=class{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){let r=this.ref.collection(e),{ref:i,query:s}=kF(r,n);return new Bm(i,s,this.afs)}snapshotChanges(){return D8(this.ref,this.afs.schedulers.outsideAngular).pipe(Ye)}valueChanges(e={}){return this.snapshotChanges().pipe(B(({payload:n})=>e.idField?Pe(j({},n.data()),{[e.idField]:n.id}):n.data()))}get(e){return ge(this.ref.get(e)).pipe(Ye)}};function Um(t,e){return sI(t,e).pipe(qs(void 0),bc(),B(n=>{let[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,l)=>{let c=s.find(d=>d.doc.ref.isEqual(a.ref)),u=r?.payload.docs.find(d=>d.ref.isEqual(a.ref));c&&JSON.stringify(c.doc.metadata)===JSON.stringify(a.metadata)||!c&&u&&JSON.stringify(u.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:l,newIndex:l,type:"modified",doc:a}})}),o}))}function MF(t,e,n){return Um(t,n).pipe(Cr((r,i)=>S8(r,i.map(s=>s.payload),e),[]),$s(),B(r=>r.map(i=>({type:i.type,payload:i}))))}function S8(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=A8(t,r))}),t}function rI(t,e,n,...r){let i=t.slice();return i.splice(e,n,...r),i}function A8(t,e){switch(e.type){case"added":if(!(t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)))return rI(t,e.newIndex,0,e);break;case"modified":if(t[e.oldIndex]==null||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}else return rI(t,e.newIndex,1,e);break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return rI(t,e.oldIndex,1);break}return t}function PF(t){return(!t||t.length===0)&&(t=["added","removed","modified"]),t}var Bm=class{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=Um(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(B(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(qs(void 0),bc(),xt(([r,i])=>i.length>0||!r),B(([,r])=>r),Ye)}auditTrail(e){return this.stateChanges(e).pipe(Cr((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=PF(e);return MF(this.query,n,this.afs.schedulers.outsideAngular).pipe(Ye)}valueChanges(e={}){return sI(this.query,this.afs.schedulers.outsideAngular).pipe(B(n=>n.payload.docs.map(r=>e.idField?Pe(j({},r.data()),{[e.idField]:r.id}):r.data())),Ye)}get(e){return ge(this.query.get(e)).pipe(Ye)}add(e){return this.ref.add(e)}doc(e){return new jm(this.ref.doc(e),this.afs)}},iI=class{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return!e||e.length===0?Um(this.query,this.afs.schedulers.outsideAngular).pipe(Ye):Um(this.query,this.afs.schedulers.outsideAngular).pipe(B(n=>n.filter(r=>e.indexOf(r.type)>-1)),xt(n=>n.length>0),Ye)}auditTrail(e){return this.stateChanges(e).pipe(Cr((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=PF(e);return MF(this.query,n,this.afs.schedulers.outsideAngular).pipe(Ye)}valueChanges(e={}){return sI(this.query,this.afs.schedulers.outsideAngular).pipe(B(r=>r.payload.docs.map(i=>e.idField?j({[e.idField]:i.id},i.data()):i.data())),Ye)}get(e){return ge(this.query.get(e)).pipe(Ye)}},RF=new L("angularfire2.enableFirestorePersistence"),NF=new L("angularfire2.firestore.persistenceSettings"),M8=new L("angularfire2.firestore.settings"),P8=new L("angularfire2.firestore.use-emulator");function kF(t,e=n=>n){return{query:e(t),ref:t}}var R8=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,l,c,u,d,h,g,y,w,v,T,V){this.schedulers=l;let P=mi(n,a,r),F=u;d&&lu(P,a,h,y,w,v,g,T),[this.firestore,this.persistenceEnabled$]=es(`${P.name}.firestore`,"AngularFirestore",P.name,()=>{let X=a.runOutsideAngular(()=>P.firestore());if(s&&X.settings(s),F&&X.useEmulator(...F),i&&!io(o)){let ne=()=>{try{return ge(X.enablePersistence(c||void 0).then(()=>!0,()=>!1))}catch(De){return typeof console<"u"&&console.warn(De),K(!1)}};return[X,a.runOutsideAngular(ne)]}else return[X,K(!1)]},[s,F,i])}collection(n,r){let i;typeof n=="string"?i=this.firestore.collection(n):i=n;let{ref:s,query:o}=kF(i,r),a=this.schedulers.ngZone.run(()=>s);return new Bm(a,o,this)}collectionGroup(n,r){let i=r||(o=>o),s=this.firestore.collectionGroup(n);return new iI(i(s),this)}doc(n){let r;typeof n=="string"?r=this.firestore.doc(n):r=n;let i=this.schedulers.ngZone.run(()=>r);return new jm(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(x(kr),x(Or,8),x(RF,8),x(M8,8),x(St),x(me),x(Xi),x(NF,8),x(P8,8),x(cu,8),x(nu,8),x(ru,8),x(iu,8),x(su,8),x(ou,8),x(au,8),x(lr,8))};static \u0275prov=z({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),OF=(()=>{class t{constructor(){et.registerVersion("angularfire",cr.full,"fst-compat")}static enablePersistence(n){return{ngModule:t,providers:[{provide:RF,useValue:!0},{provide:NF,useValue:n}]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ve({type:t});static \u0275inj=Fe({providers:[R8]})}return t})();var FF="@firebase/database",VF="1.0.4";var _x="";function yx(t){_x=t}var fI=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),gt(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Ph(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var pI=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Mn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var p2=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new fI(e)}}catch{}return new pI},Bo=p2("localStorage"),gI=p2("sessionStorage");var zl=new Ni("@firebase/database"),g2=function(){let t=1;return function(){return t++}}(),m2=function(t){let e=ZT(t),n=new JT;n.update(e);let r=n.digest();return Sh.encodeByteArray(r)},Kd=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Kd.apply(null,r):typeof r=="object"?e+=gt(r):e+=r,e+=" "}return e},$o=null,LF=!0,_2=function(t,e){O(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(zl.logLevel=Pn.VERBOSE,$o=zl.log.bind(zl),e&&gI.set("logging_enabled",!0)):typeof t=="function"?$o=t:($o=null,gI.remove("logging_enabled"))},Lt=function(...t){if(LF===!0&&(LF=!1,$o===null&&gI.get("logging_enabled")===!0&&_2(!0)),$o){let e=Kd.apply(null,t);$o(e)}},Qd=function(t){return function(...e){Lt(t,...e)}},mI=function(...t){let e="FIREBASE INTERNAL ERROR: "+Kd(...t);zl.error(e)},Xr=function(...t){let e=`FIREBASE FATAL ERROR: ${Kd(...t)}`;throw zl.error(e),new Error(e)},Xt=function(...t){let e="FIREBASE WARNING: "+Kd(...t);zl.warn(e)},N8=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Xt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},g_=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},k8=function(t){if(wr()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Ds="[MIN_NAME]",Si="[MAX_NAME]",qo=function(t,e){if(t===e)return 0;if(t===Ds||e===Si)return-1;if(e===Ds||t===Si)return 1;{let n=jF(t),r=jF(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},O8=function(t,e){return t===e?0:t<e?-1:1},xd=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+gt(e))},vx=function(t){if(typeof t!="object"||t===null)return gt(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=gt(e[r]),n+=":",n+=vx(t[e[r]]);return n+="}",n},y2=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function jt(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var v2=function(t){O(!g_(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,l;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let c=[];for(l=n;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(i?1:0),c.reverse();let u=c.join(""),d="";for(l=0;l<64;l+=8){let h=parseInt(u.substr(l,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},F8=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},V8=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function L8(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var j8=new RegExp("^-?(0*)\\d{1,10}$"),U8=-2147483648,B8=2147483647,jF=function(t){if(j8.test(t)){let e=Number(t);if(e>=U8&&e<=B8)return e}return null},ec=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw Xt("Exception was thrown by user callback.",n),e},Math.floor(0))}},$8=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Ad=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var _I=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Xt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var yI=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Lt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Xt(e)}},Md=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),Hm="5",w2="v",E2="s",C2="r",b2="f",I2=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,x2="ls",T2="p",vI="ac",D2="websocket",S2="long_polling";var qm=class{constructor(e,n,r,i,s=!1,o="",a=!1,l=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Bo.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Bo.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function H8(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function A2(t,e,n){O(typeof e=="string","typeof type must == string"),O(typeof n=="object","typeof params must == object");let r;if(e===D2)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===S2)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);H8(t)&&(n.ns=t.namespace);let i=[];return jt(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var wI=class{constructor(){this.counters_={}}incrementCounter(e,n=1){Mn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return zT(this.counters_)}};var oI={},aI={};function wx(t){let e=t.toString();return oI[e]||(oI[e]=new wI),oI[e]}function q8(t,e){let n=t.toString();return aI[n]||(aI[n]=e()),aI[n]}var EI=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&ec(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var UF="start",z8="close",G8="pLPCommand",W8="pRTLPCB",M2="id",P2="pw",R2="ser",K8="cb",Q8="seg",Y8="ts",J8="d",Z8="dframe",N2=1870,k2=30,X8=N2-k2,eG=25e3,tG=3e4,kd=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Qd(e),this.stats_=wx(n),this.urlFn=l=>(this.appCheckToken&&(l[vI]=this.appCheckToken),A2(n,S2,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new EI(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(tG)),k8(()=>{if(this.isClosed_)return;this.scriptTagHolder=new CI((...s)=>{let[o,a,l,c,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===UF)this.id=a,this.password=l;else if(o===z8)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[UF]="t",r[R2]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[K8]=this.scriptTagHolder.uniqueCallbackIdentifier),r[w2]=Hm,this.transportSessionId&&(r[E2]=this.transportSessionId),this.lastSessionId&&(r[x2]=this.lastSessionId),this.applicationId&&(r[T2]=this.applicationId),this.appCheckToken&&(r[vI]=this.appCheckToken),typeof location<"u"&&location.hostname&&I2.test(location.hostname)&&(r[C2]=b2);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return wr()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!F8()&&!V8()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=gt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=qT(n),i=y2(r,X8);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(wr())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[Z8]="t",r[M2]=e,r[P2]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=gt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},CI=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,wr())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=g2(),window[G8+this.uniqueCallbackIdentifier]=e,window[W8+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Lt("frame writing exception"),a.stack&&Lt(a.stack),Lt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Lt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[M2]=this.myID,e[P2]=this.myPW,e[R2]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+k2+r.length<=N2;){let o=this.pendingSegs.shift();r=r+"&"+Q8+i+"="+o.seg+"&"+Y8+i+"="+o.ts+"&"+J8+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(eG)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){wr()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Lt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var nG=16384,rG=45e3,zm=null;typeof MozWebSocket<"u"?zm=MozWebSocket:typeof WebSocket<"u"&&(zm=WebSocket);var Hl=(()=>{class t{constructor(n,r,i,s,o,a,l){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Qd(this.connId),this.stats_=wx(r),this.connURL=t.connectionURL_(r,a,l,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[w2]=Hm,!wr()&&typeof location<"u"&&location.hostname&&I2.test(location.hostname)&&(a[C2]=b2),r&&(a[E2]=r),i&&(a[x2]=i),s&&(a[vI]=s),o&&(a[T2]=o),A2(n,D2,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Bo.set("previous_websocket_failure",!0);try{let i;if(wr()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Hm}/${_x}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new zm(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&zm!==null&&!t.forceDisallow_}static previouslyFailed(){return Bo.isInMemoryStorage||Bo.get("previous_websocket_failure")===!0}markConnectionHealthy(){Bo.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=Ph(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(O(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=gt(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=y2(r,nG);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(rG))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),O2=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[kd,Hl]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=Hl&&Hl.isAvailable(),i=r&&!Hl.previouslyFailed();if(n.webSocketOnly&&(r||Xt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Hl];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),iG=6e4,sG=5e3,oG=10*1024,aG=100*1024,lI="t",BF="d",lG="s",$F="r",cG="e",HF="o",qF="a",zF="n",GF="p",uG="h",bI=class{constructor(e,n,r,i,s,o,a,l,c,u){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Qd("c:"+this.id+":"),this.transportManager_=new O2(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Ad(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>aG?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>oG?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(lI in e){let n=e[lI];n===qF?this.upgradeIfSecondaryHealthy_():n===$F?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===HF&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=xd("t",e),r=xd("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:GF,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:qF,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:zF,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=xd("t",e),r=xd("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=xd(lI,e);if(BF in e){let r=e[BF];if(n===uG){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===zF){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===lG?this.onConnectionShutdown_(r):n===$F?this.onReset_(r):n===cG?mI("Server Error: "+r):n===HF?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):mI("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Hm!==r&&Xt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Ad(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(iG))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Ad(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(sG))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:GF,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Bo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Gm=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var Wm=class{constructor(e){this.allowedEvents_=e,this.listeners_={},O(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){O(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var Km=class t extends Wm{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!ty()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return O(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var WF=32,KF=768,Me=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function Ae(){return new Me("")}function _e(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Ss(t){return t.pieces_.length-t.pieceNum_}function qe(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Me(t.pieces_,e)}function Ex(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function dG(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Od(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function F2(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Me(e,0)}function Xe(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Me)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new Me(n,0)}function ye(t){return t.pieceNum_>=t.pieces_.length}function cn(t,e){let n=_e(t),r=_e(e);if(n===null)return e;if(n===r)return cn(qe(t),qe(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function hG(t,e){let n=Od(t,0),r=Od(e,0);for(let i=0;i<n.length&&i<r.length;i++){let s=qo(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function Cx(t,e){if(Ss(t)!==Ss(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Gn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Ss(t)>Ss(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var II=class{constructor(e,n){this.errorPrefix_=n,this.parts_=Od(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=vc(this.parts_[r]);V2(this)}};function fG(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=vc(e),V2(t)}function pG(t){let e=t.parts_.pop();t.byteLength_-=vc(e),t.parts_.length>0&&(t.byteLength_-=1)}function V2(t){if(t.byteLength_>KF)throw new Error(t.errorPrefix_+"has a key path longer than "+KF+" bytes ("+t.byteLength_+").");if(t.parts_.length>WF)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+WF+") or object contains a cycle "+Uo(t))}function Uo(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var xI=class t extends Wm{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return O(e==="visible","Unknown event type: "+e),[this.visible_]}};var Td=1e3,gG=60*5*1e3,QF=30*1e3,mG=1.3,_G=3e4,yG="server_kill",YF=3,bx=(()=>{class t extends Gm{constructor(n,r,i,s,o,a,l,c){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=t.nextPersistentConnectionId_++,this.log_=Qd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Td,this.maxReconnectDelay_=gG,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!wr())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");xI.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&Km.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(gt(o)),O(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new Pt,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let l=a.d;a.s==="ok"?r.resolve(l):r.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),O(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),O(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let l={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,l=>{let c=l.d,u=l.s;t.warnOnListenWarnings_(c,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",l),u!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(u,c))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&Mn(n,"w")){let i=Ri(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Xt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||QT(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=QF)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=KT(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),O(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+gt(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):mI("Unrecognized action received from server: "+gt(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){O(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Td,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Td,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>_G&&(this.reconnectDelay_=Td),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*mG)}this.onConnectStatus_(!1)}establishConnection_(){return C(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,l=null,c=function(){l?l.close():(a=!0,i())},u=function(h){O(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(h)};this.realtime_={close:c,sendRequest:u};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,g]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?Lt("getToken() completed but was canceled"):(Lt("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=g&&g.token,l=new bI(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,y=>{Xt(y+" ("+this.repoInfo_.toString()+")"),this.interrupt(yG)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&Xt(h),c())}}})}interrupt(n){Lt("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){Lt("Resuming connection for reason: "+n),delete this.interruptReasons_[n],Rh(this.interruptReasons_)&&(this.reconnectDelay_=Td,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>vx(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new Me(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){Lt("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=YF&&(this.reconnectDelay_=QF,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){Lt("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=YF&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";wr()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+_x.replace(/\./g,"-")]=1,ty()?n["framework.cordova"]=1:GT()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=Km.getInstance().currentlyOnline();return Rh(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),Ee=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var Gl=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new Ee(Ds,e),i=new Ee(Ds,n);return this.compare(r,i)!==0}minPost(){return Ee.MIN}};var $m,Qm=class extends Gl{static get __EMPTY_NODE(){return $m}static set __EMPTY_NODE(e){$m=e}compare(e,n){return qo(e.name,n.name)}isDefinedOn(e){throw Zo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return Ee.MIN}maxPost(){return new Ee(Si,$m)}makePost(e,n){return O(typeof e=="string","KeyIndex indexValue must always be a string."),new Ee(e,$m)}toString(){return".key"}},Zr=new Qm;var ql=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},yr=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??Wn.EMPTY_NODE,this.right=o??Wn.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Wn.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return Wn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),TI=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new yr(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Wn=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,yr.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,yr.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ql(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new ql(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new ql(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new ql(this.root_,null,this.comparator_,!0,e)}};Wn.EMPTY_NODE=new TI;function vG(t,e){return qo(t.name,e.name)}function Ix(t,e){return qo(t,e)}var DI;function wG(t){DI=t}var L2=function(t){return typeof t=="number"?"number:"+v2(t):"string:"+t},j2=function(t){if(t.isLeafNode()){let e=t.val();O(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Mn(e,".sv"),"Priority must be a string or number.")}else O(t===DI||t.isEmpty(),"priority of unexpected type.");O(t===DI||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var JF,Wl=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,O(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),j2(this.priorityNode_)}static set __childrenNodeConstructor(n){JF=n}static get __childrenNodeConstructor(){return JF}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return ye(n)?this:_e(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=_e(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(O(i!==".priority"||Ss(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(qe(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+L2(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=v2(this.value_):n+=this.value_,this.lazyHash_=m2(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(O(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return O(s>=0,"Unknown leaf type: "+r),O(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),U2,B2;function EG(t){U2=t}function CG(t){B2=t}var SI=class extends Gl{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?qo(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return Ee.MIN}maxPost(){return new Ee(Si,new Wl("[PRIORITY-POST]",B2))}makePost(e,n){let r=U2(e);return new Ee(n,new Wl("[PRIORITY-POST]",r))}toString(){return".priority"}},Ge=new SI;var bG=Math.log(2),AI=class{constructor(e){let n=s=>parseInt(Math.log(s)/bG,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Ym=function(t,e,n,r){t.sort(e);let i=function(l,c){let u=c-l,d,h;if(u===0)return null;if(u===1)return d=t[l],h=n?n(d):d,new yr(h,d.node,yr.BLACK,null,null);{let g=parseInt(u/2,10)+l,y=i(l,g),w=i(g+1,c);return d=t[g],h=n?n(d):d,new yr(h,d.node,yr.BLACK,y,w)}},s=function(l){let c=null,u=null,d=t.length,h=function(y,w){let v=d-y,T=d;d-=y;let V=i(v+1,T),P=t[v],F=n?n(P):P;g(new yr(F,P.node,w,null,V))},g=function(y){c?(c.left=y,c=y):(u=y,c=y)};for(let y=0;y<l.count;++y){let w=l.nextBitIsOne(),v=Math.pow(2,l.count-(y+1));w?h(v,yr.BLACK):(h(v,yr.BLACK),h(v,yr.RED))}return u},o=new AI(t.length),a=s(o);return new Wn(r||e,a)};var cI,$l={},Kl=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return O($l&&Ge,"ChildrenNode.ts has not been loaded"),cI=cI||new t({".priority":$l},{".priority":Ge}),cI}get(e){let n=Ri(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Wn?n:null}hasIndex(e){return Mn(this.indexSet_,e.toString())}addIndex(e,n){O(e!==Zr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(Ee.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=Ym(r,e.getCompare()):a=$l;let l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;let u=Object.assign({},this.indexes_);return u[l]=a,new t(u,c)}addToIndexes(e,n){let r=yc(this.indexes_,(i,s)=>{let o=Ri(this.indexSet_,s);if(O(o,"Missing index implementation for "+s),i===$l)if(o.isDefinedOn(e.node)){let a=[],l=n.getIterator(Ee.Wrap),c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),Ym(a,o.getCompare())}else return $l;else{let a=n.get(e.name),l=i;return a&&(l=l.remove(new Ee(e.name,a))),l.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=yc(this.indexes_,i=>{if(i===$l)return i;{let s=n.get(e.name);return s?i.remove(new Ee(e.name,s)):i}});return new t(r,this.indexSet_)}};var Dd,he=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&j2(this.priorityNode_),this.children_.isEmpty()&&O(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Dd||(Dd=new t(new Wn(Ix),null,Kl.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Dd}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?Dd:r}}getChild(n){let r=_e(n);return r===null?this:this.getImmediateChild(r).getChild(qe(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(O(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new Ee(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Dd:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=_e(n);if(i===null)return r;{O(_e(n)!==".priority"||Ss(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(qe(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Ge,(a,l)=>{r[a]=l.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let l in r)a[l]=r[l];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+L2(this.getPriority().val())+":"),this.forEachChild(Ge,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":m2(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new Ee(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new Ee(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new Ee(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,Ee.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,Ee.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===Yd?-1:0}withIndex(n){if(n===Zr||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===Zr||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Ge),s=r.getIterator(Ge),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===Zr?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),MI=class extends he{constructor(){super(new Wn(Ix),he.EMPTY_NODE,Kl.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return he.EMPTY_NODE}isEmpty(){return!1}},Yd=new MI;Object.defineProperties(Ee,{MIN:{value:new Ee(Ds,he.EMPTY_NODE)},MAX:{value:new Ee(Si,Yd)}});Qm.__EMPTY_NODE=he.EMPTY_NODE;Wl.__childrenNodeConstructor=he;wG(Yd);CG(Yd);var IG=!0;function rt(t,e=null){if(t===null)return he.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),O(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new Wl(n,rt(e))}if(!(t instanceof Array)&&IG){let n=[],r=!1;if(jt(t,(o,a)=>{if(o.substring(0,1)!=="."){let l=rt(a);l.isEmpty()||(r=r||!l.getPriority().isEmpty(),n.push(new Ee(o,l)))}}),n.length===0)return he.EMPTY_NODE;let s=Ym(n,vG,o=>o.name,Ix);if(r){let o=Ym(n,Ge.getCompare());return new he(s,rt(e),new Kl({".priority":o},{".priority":Ge}))}else return new he(s,rt(e),Kl.Default)}else{let n=he.EMPTY_NODE;return jt(t,(r,i)=>{if(Mn(t,r)&&r.substring(0,1)!=="."){let s=rt(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(rt(e))}}EG(rt);var Fd=class extends Gl{constructor(e){super(),this.indexPath_=e,O(!ye(e)&&_e(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?qo(e.name,n.name):s}makePost(e,n){let r=rt(e),i=he.EMPTY_NODE.updateChild(this.indexPath_,r);return new Ee(n,i)}maxPost(){let e=he.EMPTY_NODE.updateChild(this.indexPath_,Yd);return new Ee(Si,e)}toString(){return Od(this.indexPath_,0).join("/")}};var PI=class extends Gl{compare(e,n){let r=e.node.compareTo(n.node);return r===0?qo(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return Ee.MIN}maxPost(){return Ee.MAX}makePost(e,n){let r=rt(e);return new Ee(n,r)}toString(){return".value"}},xx=new PI;function $2(t){return{type:"value",snapshotNode:t}}function Ql(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Vd(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Ld(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function xG(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var jd=class{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){O(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(Vd(n,a)):O(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Ql(n,r)):o.trackChildChange(Ld(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Ge,(i,s)=>{n.hasChild(i)||r.trackChildChange(Vd(i,s))}),n.isLeafNode()||n.forEachChild(Ge,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Ld(i,s,o))}else r.trackChildChange(Ql(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?he.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var Jm=class t{constructor(e){this.indexedFilter_=new jd(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new Ee(n,r))||(r=he.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=he.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(he.EMPTY_NODE);let s=this;return n.forEachChild(Ge,(o,a)=>{s.matches(new Ee(o,a))||(i=i.updateImmediateChild(o,he.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var RI=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{let r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Jm(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new Ee(n,r))||(r=he.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=he.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=he.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(he.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,he.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(h,g)=>d(g,h)}else o=this.index_.getCompare();let a=e;O(a.numChildren()===this.limit_,"");let l=new Ee(n,r),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=i.getChildAfterChild(this.index_,c,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);let g=h==null?1:o(h,l);if(u&&!r.isEmpty()&&g>=0)return s?.trackChildChange(Ld(n,r,d)),a.updateImmediateChild(n,r);{s?.trackChildChange(Vd(n,d));let w=a.updateImmediateChild(n,he.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(Ql(h.name,h.node)),w.updateImmediateChild(h.name,h.node)):w}}else return r.isEmpty()?e:u&&o(c,l)>=0?(s!=null&&(s.trackChildChange(Vd(c.name,c.node)),s.trackChildChange(Ql(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(c.name,he.EMPTY_NODE)):e}};var Ud=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ge}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return O(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return O(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ds}hasEnd(){return this.endSet_}getIndexEndValue(){return O(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return O(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Si}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return O(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ge}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function TG(t){return t.loadsAllData()?new jd(t.getIndex()):t.hasLimit()?new RI(t):new Jm(t)}function DG(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function SG(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function NI(t,e,n){let r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function AG(t,e,n){let r;return t.index_===Zr||n?r=NI(t,e,n):r=NI(t,e,Si),r.startAfterSet_=!0,r}function kI(t,e,n){let r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function MG(t,e,n){let r;return t.index_===Zr||n?r=kI(t,e,n):r=kI(t,e,Ds),r.endBeforeSet_=!0,r}function m_(t,e){let n=t.copy();return n.index_=e,n}function ZF(t){let e={};if(t.isDefault())return e;let n;if(t.index_===Ge?n="$priority":t.index_===xx?n="$value":t.index_===Zr?n="$key":(O(t.index_ instanceof Fd,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=gt(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=gt(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+gt(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=gt(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+gt(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function XF(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Ge&&(e.i=t.index_.toString()),e}var OI=class t extends Gm{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Qd("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(O(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let l=ZF(e._queryParams);this.restRequest_(s+".json",l,(c,u)=>{let d=u;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(s,d,!1,r),Ri(this.listens_,o)===a){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",i(h,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=ZF(e._queryParams),r=e._path.toString(),i=new Pt;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+YT(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=Ph(a.responseText)}catch{Xt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,l)}else a.status!==401&&a.status!==404&&Xt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var FI=class{constructor(){this.rootNode_=he.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function Zm(){return{value:null,children:new Map}}function tc(t,e,n){if(ye(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=_e(e);t.children.has(r)||t.children.set(r,Zm());let i=t.children.get(r);e=qe(e),tc(i,e,n)}}function VI(t,e){if(ye(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(Ge,(r,i)=>{tc(t,new Me(r),i)}),VI(t,e)}}else if(t.children.size>0){let n=_e(e);return e=qe(e),t.children.has(n)&&VI(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function LI(t,e,n){t.value!==null?n(e,t.value):PG(t,(r,i)=>{let s=new Me(e.toString()+"/"+r);LI(i,s,n)})}function PG(t,e){t.children.forEach((n,r)=>{e(r,n)})}var jI=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&jt(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var e2=10*1e3,RG=30*1e3,NG=5*60*1e3,UI=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new jI(e);let r=e2+(RG-e2)*Math.random();Ad(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;jt(e,(i,s)=>{s>0&&Mn(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),Ad(this.reportStats_.bind(this),Math.floor(Math.random()*2*NG))}};var Jr=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(Jr||{});function Tx(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Dx(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Sx(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var BI=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Jr.ACK_USER_WRITE,this.source=Tx()}operationForChild(e){if(ye(this.path)){if(this.affectedTree.value!=null)return O(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new Me(e));return new t(Ae(),n,this.revert)}}else return O(_e(this.path)===e,"operationForChild called for unrelated child."),new t(qe(this.path),this.affectedTree,this.revert)}};var Xm=class t{constructor(e,n){this.source=e,this.path=n,this.type=Jr.LISTEN_COMPLETE}operationForChild(e){return ye(this.path)?new t(this.source,Ae()):new t(this.source,qe(this.path))}};var Yl=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Jr.OVERWRITE}operationForChild(e){return ye(this.path)?new t(this.source,Ae(),this.snap.getImmediateChild(e)):new t(this.source,qe(this.path),this.snap)}};var Bd=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Jr.MERGE}operationForChild(e){if(ye(this.path)){let n=this.children.subtree(new Me(e));return n.isEmpty()?null:n.value?new Yl(this.source,Ae(),n.value):new t(this.source,Ae(),n)}else return O(_e(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,qe(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var ei=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ye(e))return this.isFullyInitialized()&&!this.filtered_;let n=_e(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var $I=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function kG(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(xG(o.childName,o.snapshotNode))}),Sd(t,i,"child_removed",e,r,n),Sd(t,i,"child_added",e,r,n),Sd(t,i,"child_moved",s,r,n),Sd(t,i,"child_changed",e,r,n),Sd(t,i,"value",e,r,n),i}function Sd(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,l)=>FG(t,a,l)),o.forEach(a=>{let l=OG(t,a,s);i.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,t.query_))})})}function OG(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function FG(t,e,n){if(e.childName==null||n.childName==null)throw Zo("Should only compare child_ events.");let r=new Ee(e.childName,e.snapshotNode),i=new Ee(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function __(t,e){return{eventCache:t,serverCache:e}}function Pd(t,e,n,r){return __(new ei(e,n,r),t.serverCache)}function H2(t,e,n,r){return __(t.eventCache,new ei(e,n,r))}function e_(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Ho(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var uI,VG=()=>(uI||(uI=new Wn(O8)),uI),un=class t{constructor(e,n=VG()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return jt(e,(r,i)=>{n=n.set(new Me(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Ae(),value:this.value};if(ye(e))return null;{let r=_e(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(qe(e),n);return s!=null?{path:Xe(new Me(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ye(e))return this;{let n=_e(e),r=this.children.get(n);return r!==null?r.subtree(qe(e)):new t(null)}}set(e,n){if(ye(e))return new t(n,this.children);{let r=_e(e),s=(this.children.get(r)||new t(null)).set(qe(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(ye(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=_e(e),r=this.children.get(n);if(r){let i=r.remove(qe(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(ye(e))return this.value;{let n=_e(e),r=this.children.get(n);return r?r.get(qe(e)):null}}setTree(e,n){if(ye(e))return n;{let r=_e(e),s=(this.children.get(r)||new t(null)).setTree(qe(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(Ae(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Xe(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,Ae(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(ye(e))return null;{let s=_e(e),o=this.children.get(s);return o?o.findOnPath_(qe(e),Xe(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Ae(),n)}foreachOnPath_(e,n,r){if(ye(e))return this;{this.value&&r(n,this.value);let i=_e(e),s=this.children.get(i);return s?s.foreachOnPath_(qe(e),Xe(n,i),r):new t(null)}}foreach(e){this.foreach_(Ae(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(Xe(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var vr=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new un(null))}};function Rd(t,e,n){if(ye(e))return new vr(new un(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=cn(i,e);return s=s.updateChild(o,n),new vr(t.writeTree_.set(i,s))}else{let i=new un(n),s=t.writeTree_.setTree(e,i);return new vr(s)}}}function HI(t,e,n){let r=t;return jt(n,(i,s)=>{r=Rd(r,Xe(e,i),s)}),r}function t2(t,e){if(ye(e))return vr.empty();{let n=t.writeTree_.setTree(e,new un(null));return new vr(n)}}function qI(t,e){return zo(t,e)!=null}function zo(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(cn(n.path,e)):null}function n2(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Ge,(r,i)=>{e.push(new Ee(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new Ee(r,i.value))}),e}function xs(t,e){if(ye(e))return t;{let n=zo(t,e);return n!=null?new vr(new un(n)):new vr(t.writeTree_.subtree(e))}}function zI(t){return t.writeTree_.isEmpty()}function Jl(t,e){return q2(Ae(),t.writeTree_,e)}function q2(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(O(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=q2(Xe(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Xe(t,".priority"),r)),n}}function y_(t,e){return K2(e,t)}function LG(t,e,n,r,i){O(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Rd(t.visibleWrites,e,n)),t.lastWriteId=r}function jG(t,e,n,r){O(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=HI(t.visibleWrites,e,n),t.lastWriteId=r}function UG(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function BG(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);O(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&$G(a,r.path)?i=!1:Gn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return HG(t),!0;if(r.snap)t.visibleWrites=t2(t.visibleWrites,r.path);else{let a=r.children;jt(a,l=>{t.visibleWrites=t2(t.visibleWrites,Xe(r.path,l))})}return!0}else return!1}function $G(t,e){if(t.snap)return Gn(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&Gn(Xe(t.path,n),e))return!0;return!1}function HG(t){t.visibleWrites=z2(t.allWrites,qG,Ae()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function qG(t){return t.visible}function z2(t,e,n){let r=vr.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)Gn(n,o)?(a=cn(n,o),r=Rd(r,a,s.snap)):Gn(o,n)&&(a=cn(o,n),r=Rd(r,Ae(),s.snap.getChild(a)));else if(s.children){if(Gn(n,o))a=cn(n,o),r=HI(r,a,s.children);else if(Gn(o,n))if(a=cn(o,n),ye(a))r=HI(r,Ae(),s.children);else{let l=Ri(s.children,_e(a));if(l){let c=l.getChild(qe(a));r=Rd(r,Ae(),c)}}}else throw Zo("WriteRecord should have .snap or .children")}}return r}function G2(t,e,n,r,i){if(!r&&!i){let s=zo(t.visibleWrites,e);if(s!=null)return s;{let o=xs(t.visibleWrites,e);if(zI(o))return n;if(n==null&&!qI(o,Ae()))return null;{let a=n||he.EMPTY_NODE;return Jl(o,a)}}}else{let s=xs(t.visibleWrites,e);if(!i&&zI(s))return n;if(!i&&n==null&&!qI(s,Ae()))return null;{let o=function(c){return(c.visible||i)&&(!r||!~r.indexOf(c.writeId))&&(Gn(c.path,e)||Gn(e,c.path))},a=z2(t.allWrites,o,e),l=n||he.EMPTY_NODE;return Jl(a,l)}}}function zG(t,e,n){let r=he.EMPTY_NODE,i=zo(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ge,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=xs(t.visibleWrites,e);return n.forEachChild(Ge,(o,a)=>{let l=Jl(xs(s,new Me(o)),a);r=r.updateImmediateChild(o,l)}),n2(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=xs(t.visibleWrites,e);return n2(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function GG(t,e,n,r,i){O(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=Xe(e,n);if(qI(t.visibleWrites,s))return null;{let o=xs(t.visibleWrites,s);return zI(o)?i.getChild(n):Jl(o,i.getChild(n))}}function WG(t,e,n,r){let i=Xe(e,n),s=zo(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=xs(t.visibleWrites,i);return Jl(o,r.getNode().getImmediateChild(n))}else return null}function KG(t,e){return zo(t.visibleWrites,e)}function QG(t,e,n,r,i,s,o){let a,l=xs(t.visibleWrites,e),c=zo(l,Ae());if(c!=null)a=c;else if(n!=null)a=Jl(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let u=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),g=h.getNext();for(;g&&u.length<i;)d(g,r)!==0&&u.push(g),g=h.getNext();return u}else return[]}function YG(){return{visibleWrites:vr.empty(),allWrites:[],lastWriteId:-1}}function t_(t,e,n,r){return G2(t.writeTree,t.treePath,e,n,r)}function Ax(t,e){return zG(t.writeTree,t.treePath,e)}function r2(t,e,n,r){return GG(t.writeTree,t.treePath,e,n,r)}function n_(t,e){return KG(t.writeTree,Xe(t.treePath,e))}function JG(t,e,n,r,i,s){return QG(t.writeTree,t.treePath,e,n,r,i,s)}function Mx(t,e,n){return WG(t.writeTree,t.treePath,e,n)}function W2(t,e){return K2(Xe(t.treePath,e),t.writeTree)}function K2(t,e){return{treePath:t,writeTree:e}}var GI=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;O(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),O(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,Ld(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,Vd(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,Ql(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,Ld(r,e.snapshotNode,i.oldSnap));else throw Zo("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var WI=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},Q2=new WI,$d=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new ei(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Mx(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Ho(this.viewCache_),s=JG(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function ZG(t){return{filter:t}}function XG(t,e){O(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),O(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function eW(t,e,n,r,i){let s=new GI,o,a;if(n.type===Jr.OVERWRITE){let c=n;c.source.fromUser?o=KI(t,e,c.path,c.snap,r,i,s):(O(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!ye(c.path),o=r_(t,e,c.path,c.snap,r,i,a,s))}else if(n.type===Jr.MERGE){let c=n;c.source.fromUser?o=nW(t,e,c.path,c.children,r,i,s):(O(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=QI(t,e,c.path,c.children,r,i,a,s))}else if(n.type===Jr.ACK_USER_WRITE){let c=n;c.revert?o=sW(t,e,c.path,r,i,s):o=rW(t,e,c.path,c.affectedTree,r,i,s)}else if(n.type===Jr.LISTEN_COMPLETE)o=iW(t,e,n.path,r,s);else throw Zo("Unknown operation type: "+n.type);let l=s.getChanges();return tW(e,o,l),{viewCache:o,changes:l}}function tW(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=e_(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push($2(e_(e)))}}function Y2(t,e,n,r,i,s){let o=e.eventCache;if(n_(r,n)!=null)return e;{let a,l;if(ye(n))if(O(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=Ho(e),u=c instanceof he?c:he.EMPTY_NODE,d=Ax(r,u);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let c=t_(r,Ho(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{let c=_e(n);if(c===".priority"){O(Ss(n)===1,"Can't have a priority with additional path components");let u=o.getNode();l=e.serverCache.getNode();let d=r2(r,n,u,l);d!=null?a=t.filter.updatePriority(u,d):a=o.getNode()}else{let u=qe(n),d;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();let h=r2(r,n,o.getNode(),l);h!=null?d=o.getNode().getImmediateChild(c).updateChild(u,h):d=o.getNode().getImmediateChild(c)}else d=Mx(r,c,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),c,d,u,i,s):a=o.getNode()}}return Pd(e,a,o.isFullyInitialized()||ye(n),t.filter.filtersNodes())}}function r_(t,e,n,r,i,s,o,a){let l=e.serverCache,c,u=o?t.filter:t.filter.getIndexedFilter();if(ye(n))c=u.updateFullNode(l.getNode(),r,null);else if(u.filtersNodes()&&!l.isFiltered()){let g=l.getNode().updateChild(n,r);c=u.updateFullNode(l.getNode(),g,null)}else{let g=_e(n);if(!l.isCompleteForPath(n)&&Ss(n)>1)return e;let y=qe(n),v=l.getNode().getImmediateChild(g).updateChild(y,r);g===".priority"?c=u.updatePriority(l.getNode(),v):c=u.updateChild(l.getNode(),g,v,y,Q2,null)}let d=H2(e,c,l.isFullyInitialized()||ye(n),u.filtersNodes()),h=new $d(i,d,s);return Y2(t,d,n,i,h,a)}function KI(t,e,n,r,i,s,o){let a=e.eventCache,l,c,u=new $d(i,e,s);if(ye(n))c=t.filter.updateFullNode(e.eventCache.getNode(),r,o),l=Pd(e,c,!0,t.filter.filtersNodes());else{let d=_e(n);if(d===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),r),l=Pd(e,c,a.isFullyInitialized(),a.isFiltered());else{let h=qe(n),g=a.getNode().getImmediateChild(d),y;if(ye(h))y=r;else{let w=u.getCompleteChild(d);w!=null?Ex(h)===".priority"&&w.getChild(F2(h)).isEmpty()?y=w:y=w.updateChild(h,r):y=he.EMPTY_NODE}if(g.equals(y))l=e;else{let w=t.filter.updateChild(a.getNode(),d,y,h,u,o);l=Pd(e,w,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function i2(t,e){return t.eventCache.isCompleteForChild(e)}function nW(t,e,n,r,i,s,o){let a=e;return r.foreach((l,c)=>{let u=Xe(n,l);i2(e,_e(u))&&(a=KI(t,a,u,c,i,s,o))}),r.foreach((l,c)=>{let u=Xe(n,l);i2(e,_e(u))||(a=KI(t,a,u,c,i,s,o))}),a}function s2(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function QI(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;ye(n)?c=r:c=new un(null).setTree(n,r);let u=e.serverCache.getNode();return c.children.inorderTraversal((d,h)=>{if(u.hasChild(d)){let g=e.serverCache.getNode().getImmediateChild(d),y=s2(t,g,h);l=r_(t,l,new Me(d),y,i,s,o,a)}}),c.children.inorderTraversal((d,h)=>{let g=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!u.hasChild(d)&&!g){let y=e.serverCache.getNode().getImmediateChild(d),w=s2(t,y,h);l=r_(t,l,new Me(d),w,i,s,o,a)}}),l}function rW(t,e,n,r,i,s,o){if(n_(i,n)!=null)return e;let a=e.serverCache.isFiltered(),l=e.serverCache;if(r.value!=null){if(ye(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return r_(t,e,n,l.getNode().getChild(n),i,s,a,o);if(ye(n)){let c=new un(null);return l.getNode().forEachChild(Zr,(u,d)=>{c=c.set(new Me(u),d)}),QI(t,e,n,c,i,s,a,o)}else return e}else{let c=new un(null);return r.foreach((u,d)=>{let h=Xe(n,u);l.isCompleteForPath(h)&&(c=c.set(u,l.getNode().getChild(h)))}),QI(t,e,n,c,i,s,a,o)}}function iW(t,e,n,r,i){let s=e.serverCache,o=H2(e,s.getNode(),s.isFullyInitialized()||ye(n),s.isFiltered());return Y2(t,o,n,r,Q2,i)}function sW(t,e,n,r,i,s){let o;if(n_(r,n)!=null)return e;{let a=new $d(r,e,i),l=e.eventCache.getNode(),c;if(ye(n)||_e(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=t_(r,Ho(e));else{let d=e.serverCache.getNode();O(d instanceof he,"serverChildren would be complete if leaf node"),u=Ax(r,d)}u=u,c=t.filter.updateFullNode(l,u,s)}else{let u=_e(n),d=Mx(r,u,e.serverCache);d==null&&e.serverCache.isCompleteForChild(u)&&(d=l.getImmediateChild(u)),d!=null?c=t.filter.updateChild(l,u,d,qe(n),a,s):e.eventCache.getNode().hasChild(u)?c=t.filter.updateChild(l,u,he.EMPTY_NODE,qe(n),a,s):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=t_(r,Ho(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||n_(r,Ae())!=null,Pd(e,c,o,t.filter.filtersNodes())}}var YI=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new jd(r.getIndex()),s=TG(r);this.processor_=ZG(s);let o=n.serverCache,a=n.eventCache,l=i.updateFullNode(he.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(he.EMPTY_NODE,a.getNode(),null),u=new ei(l,o.isFullyInitialized(),i.filtersNodes()),d=new ei(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=__(d,u),this.eventGenerator_=new $I(this.query_)}get query(){return this.query_}};function oW(t){return t.viewCache_.serverCache.getNode()}function aW(t){return e_(t.viewCache_)}function lW(t,e){let n=Ho(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ye(e)&&!n.getImmediateChild(_e(e)).isEmpty())?n.getChild(e):null}function o2(t){return t.eventRegistrations_.length===0}function cW(t,e){t.eventRegistrations_.push(e)}function a2(t,e,n){let r=[];if(n){O(e==null,"A cancel should cancel all event registrations.");let i=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function l2(t,e,n,r){e.type===Jr.MERGE&&e.source.queryId!==null&&(O(Ho(t.viewCache_),"We should always have a full cache before handling merges"),O(e_(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=eW(t.processor_,i,e,n,r);return XG(t.processor_,s.viewCache),O(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,J2(t,s.changes,s.viewCache.eventCache.getNode(),null)}function uW(t,e){let n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ge,(s,o)=>{r.push(Ql(s,o))}),n.isFullyInitialized()&&r.push($2(n.getNode())),J2(t,r,n.getNode(),e)}function J2(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return kG(t.eventGenerator_,e,n,i)}var i_,s_=class{constructor(){this.views=new Map}};function dW(t){O(!i_,"__referenceConstructor has already been defined"),i_=t}function hW(){return O(i_,"Reference.ts has not been loaded"),i_}function fW(t){return t.views.size===0}function Px(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return O(s!=null,"SyncTree gave us an op for an invalid query."),l2(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat(l2(o,e,n,r));return s}}function Z2(t,e,n,r,i){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=t_(n,i?r:null),l=!1;a?l=!0:r instanceof he?(a=Ax(n,r),l=!1):(a=he.EMPTY_NODE,l=!1);let c=__(new ei(a,l,!1),new ei(r,i,!1));return new YI(e,c)}return o}function pW(t,e,n,r,i,s){let o=Z2(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),cW(o,n),uW(o,n)}function gW(t,e,n,r){let i=e._queryIdentifier,s=[],o=[],a=As(t);if(i==="default")for(let[l,c]of t.views.entries())o=o.concat(a2(c,n,r)),o2(c)&&(t.views.delete(l),c.query._queryParams.loadsAllData()||s.push(c.query));else{let l=t.views.get(i);l&&(o=o.concat(a2(l,n,r)),o2(l)&&(t.views.delete(i),l.query._queryParams.loadsAllData()||s.push(l.query)))}return a&&!As(t)&&s.push(new(hW())(e._repo,e._path)),{removed:s,events:o}}function X2(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Ts(t,e){let n=null;for(let r of t.views.values())n=n||lW(r,e);return n}function eV(t,e){if(e._queryParams.loadsAllData())return v_(t);{let r=e._queryIdentifier;return t.views.get(r)}}function tV(t,e){return eV(t,e)!=null}function As(t){return v_(t)!=null}function v_(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var o_;function mW(t){O(!o_,"__referenceConstructor has already been defined"),o_=t}function _W(){return O(o_,"Reference.ts has not been loaded"),o_}var yW=1,a_=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new un(null),this.pendingWriteTree_=YG(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function Rx(t,e,n,r,i){return LG(t.pendingWriteTree_,e,n,r,i),i?nc(t,new Yl(Tx(),e,n)):[]}function vW(t,e,n,r){jG(t.pendingWriteTree_,e,n,r);let i=un.fromObject(n);return nc(t,new Bd(Tx(),e,i))}function Is(t,e,n=!1){let r=UG(t.pendingWriteTree_,e);if(BG(t.pendingWriteTree_,e)){let s=new un(null);return r.snap!=null?s=s.set(Ae(),!0):jt(r.children,o=>{s=s.set(new Me(o),!0)}),nc(t,new BI(r.path,s,n))}else return[]}function Jd(t,e,n){return nc(t,new Yl(Dx(),e,n))}function wW(t,e,n){let r=un.fromObject(n);return nc(t,new Bd(Dx(),e,r))}function EW(t,e){return nc(t,new Xm(Dx(),e))}function CW(t,e,n){let r=Nx(t,n);if(r){let i=kx(r),s=i.path,o=i.queryId,a=cn(s,e),l=new Xm(Sx(o),a);return Ox(t,s,l)}else return[]}function l_(t,e,n,r,i=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||tV(o,e))){let l=gW(o,e,n,r);fW(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let c=l.removed;if(a=l.events,!i){let u=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,g)=>As(g));if(u&&!d){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let g=xW(h);for(let y=0;y<g.length;++y){let w=g[y],v=w.query,T=sV(t,w);t.listenProvider_.startListening(Nd(v),Hd(t,v),T.hashFn,T.onComplete)}}}!d&&c.length>0&&!r&&(u?t.listenProvider_.stopListening(Nd(e),null):c.forEach(h=>{let g=t.queryToTagMap.get(E_(h));t.listenProvider_.stopListening(Nd(h),g)}))}TW(t,c)}return a}function nV(t,e,n,r){let i=Nx(t,r);if(i!=null){let s=kx(i),o=s.path,a=s.queryId,l=cn(o,e),c=new Yl(Sx(a),l,n);return Ox(t,o,c)}else return[]}function bW(t,e,n,r){let i=Nx(t,r);if(i){let s=kx(i),o=s.path,a=s.queryId,l=cn(o,e),c=un.fromObject(n),u=new Bd(Sx(a),l,c);return Ox(t,o,u)}else return[]}function JI(t,e,n,r=!1){let i=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(h,g)=>{let y=cn(h,i);s=s||Ts(g,y),o=o||As(g)});let a=t.syncPointTree_.get(i);a?(o=o||As(a),s=s||Ts(a,Ae())):(a=new s_,t.syncPointTree_=t.syncPointTree_.set(i,a));let l;s!=null?l=!0:(l=!1,s=he.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((g,y)=>{let w=Ts(y,Ae());w&&(s=s.updateImmediateChild(g,w))}));let c=tV(a,e);if(!c&&!e._queryParams.loadsAllData()){let h=E_(e);O(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let g=DW();t.queryToTagMap.set(h,g),t.tagToQueryMap.set(g,h)}let u=y_(t.pendingWriteTree_,i),d=pW(a,e,n,u,s,l);if(!c&&!o&&!r){let h=eV(a,e);d=d.concat(SW(t,e,h))}return d}function w_(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let l=cn(o,e),c=Ts(a,l);if(c)return c});return G2(i,e,s,n,!0)}function IW(t,e){let n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(c,u)=>{let d=cn(c,n);r=r||Ts(u,d)});let i=t.syncPointTree_.get(n);i?r=r||Ts(i,Ae()):(i=new s_,t.syncPointTree_=t.syncPointTree_.set(n,i));let s=r!=null,o=s?new ei(r,!0,!1):null,a=y_(t.pendingWriteTree_,e._path),l=Z2(i,e,a,s?o.getNode():he.EMPTY_NODE,s);return aW(l)}function nc(t,e){return rV(e,t.syncPointTree_,null,y_(t.pendingWriteTree_,Ae()))}function rV(t,e,n,r){if(ye(t.path))return iV(t,e,n,r);{let i=e.get(Ae());n==null&&i!=null&&(n=Ts(i,Ae()));let s=[],o=_e(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){let c=n?n.getImmediateChild(o):null,u=W2(r,o);s=s.concat(rV(a,l,c,u))}return i&&(s=s.concat(Px(i,t,r,n))),s}}function iV(t,e,n,r){let i=e.get(Ae());n==null&&i!=null&&(n=Ts(i,Ae()));let s=[];return e.children.inorderTraversal((o,a)=>{let l=n?n.getImmediateChild(o):null,c=W2(r,o),u=t.operationForChild(o);u&&(s=s.concat(iV(u,a,l,c)))}),i&&(s=s.concat(Px(i,t,r,n))),s}function sV(t,e){let n=e.query,r=Hd(t,n);return{hashFn:()=>(oW(e)||he.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?CW(t,n._path,r):EW(t,n._path);{let s=L8(i,n);return l_(t,n,null,s)}}}}function Hd(t,e){let n=E_(e);return t.queryToTagMap.get(n)}function E_(t){return t._path.toString()+"$"+t._queryIdentifier}function Nx(t,e){return t.tagToQueryMap.get(e)}function kx(t){let e=t.indexOf("$");return O(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Me(t.substr(0,e))}}function Ox(t,e,n){let r=t.syncPointTree_.get(e);O(r,"Missing sync point for query tag that we're tracking");let i=y_(t.pendingWriteTree_,e);return Px(r,n,i,null)}function xW(t){return t.fold((e,n,r)=>{if(n&&As(n))return[v_(n)];{let i=[];return n&&(i=X2(n)),jt(r,(s,o)=>{i=i.concat(o)}),i}})}function Nd(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(_W())(t._repo,t._path):t}function TW(t,e){for(let n=0;n<e.length;++n){let r=e[n];if(!r._queryParams.loadsAllData()){let i=E_(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function DW(){return yW++}function SW(t,e,n){let r=e._path,i=Hd(t,e),s=sV(t,n),o=t.listenProvider_.startListening(Nd(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)O(!As(a.value),"If we're adding a query, it shouldn't be shadowed");else{let l=a.fold((c,u,d)=>{if(!ye(c)&&u&&As(u))return[v_(u).query];{let h=[];return u&&(h=h.concat(X2(u).map(g=>g.query))),jt(d,(g,y)=>{h=h.concat(y)}),h}});for(let c=0;c<l.length;++c){let u=l[c];t.listenProvider_.stopListening(Nd(u),Hd(t,u))}}return o}var ZI=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},XI=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=Xe(this.path_,e);return new t(this.syncTree_,n)}node(){return w_(this.syncTree_,this.path_)}},AW=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},c2=function(t,e,n){if(!t||typeof t!="object")return t;if(O(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return MW(t[".sv"],e,n);if(typeof t[".sv"]=="object")return PW(t[".sv"],e);O(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},MW=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:O(!1,"Unexpected server value: "+t)}},PW=function(t,e,n){t.hasOwnProperty("increment")||O(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&O(!1,"Unexpected increment value: "+r);let i=e.node();if(O(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},oV=function(t,e,n,r){return Vx(e,new XI(n,t),r)},Fx=function(t,e,n){return Vx(t,new ZI(e),n)};function Vx(t,e,n){let r=t.getPriority().val(),i=c2(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=c2(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new Wl(a,rt(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Wl(i))),o.forEachChild(Ge,(a,l)=>{let c=Vx(l,e.getImmediateChild(a),n);c!==l&&(s=s.updateImmediateChild(a,c))}),s}}var qd=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function C_(t,e){let n=e instanceof Me?e:new Me(e),r=t,i=_e(n);for(;i!==null;){let s=Ri(r.node.children,i)||{children:{},childCount:0};r=new qd(i,r,s),n=qe(n),i=_e(n)}return r}function Go(t){return t.node.value}function Lx(t,e){t.node.value=e,ex(t)}function aV(t){return t.node.childCount>0}function RW(t){return Go(t)===void 0&&!aV(t)}function b_(t,e){jt(t.node.children,(n,r)=>{e(new qd(n,t,r))})}function lV(t,e,n,r){n&&!r&&e(t),b_(t,i=>{lV(i,e,!0,r)}),n&&r&&e(t)}function NW(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Zd(t){return new Me(t.parent===null?t.name:Zd(t.parent)+"/"+t.name)}function ex(t){t.parent!==null&&kW(t.parent,t.name,t)}function kW(t,e,n){let r=RW(n),i=Mn(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,ex(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,ex(t))}var OW=/[\[\].#$\/\u0000-\u001F\u007F]/,FW=/[\[\].#$\u0000-\u001F\u007F]/,dI=10*1024*1024,I_=function(t){return typeof t=="string"&&t.length!==0&&!OW.test(t)},cV=function(t){return typeof t=="string"&&t.length!==0&&!FW.test(t)},VW=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),cV(t)},zd=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!g_(t)||t&&typeof t=="object"&&Mn(t,".sv")},ti=function(t,e,n,r){r&&e===void 0||Xd(hn(t,"value"),e,n)},Xd=function(t,e,n){let r=n instanceof Me?new II(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Uo(r));if(typeof e=="function")throw new Error(t+"contains a function "+Uo(r)+" with contents = "+e.toString());if(g_(e))throw new Error(t+"contains "+e.toString()+" "+Uo(r));if(typeof e=="string"&&e.length>dI/3&&vc(e)>dI)throw new Error(t+"contains a string greater than "+dI+" utf8 bytes "+Uo(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(jt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!I_(o)))throw new Error(t+" contains an invalid key ("+o+") "+Uo(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);fG(r,o),Xd(t,a,r),pG(r)}),i&&s)throw new Error(t+' contains ".value" child '+Uo(r)+" in addition to actual children.")}},LW=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];let s=Od(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!I_(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(hG);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&Gn(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},uV=function(t,e,n,r){if(r&&e===void 0)return;let i=hn(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];jt(e,(o,a)=>{let l=new Me(o);if(Xd(i,a,Xe(n,l)),Ex(l)===".priority"&&!zd(a))throw new Error(i+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(l)}),LW(i,s)},jx=function(t,e,n){if(!(n&&e===void 0)){if(g_(e))throw new Error(hn(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!zd(e))throw new Error(hn(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},eh=function(t,e,n,r){if(!(r&&n===void 0)&&!I_(n))throw new Error(hn(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},rc=function(t,e,n,r){if(!(r&&n===void 0)&&!cV(n))throw new Error(hn(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},jW=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),rc(t,e,n,r)},xn=function(t,e){if(_e(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},dV=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!I_(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!VW(n))throw new Error(hn(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var tx=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function x_(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!Cx(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function hV(t,e,n){x_(t,n),fV(t,r=>Cx(r,e))}function Tn(t,e,n){x_(t,n),fV(t,r=>Gn(r,e)||Gn(e,r))}function fV(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?(UW(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function UW(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();$o&&Lt("event: "+n.toString()),ec(r)}}}var pV="repo_interrupt",BW=25,nx=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new tx,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Zm(),this.transactionQueueTree_=new qd,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function $W(t,e,n){if(t.stats_=wx(t.repoInfo_),t.forceRestClient_||$8())t.server_=new OI(t.repoInfo_,(r,i,s,o)=>{u2(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>d2(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{gt(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new bx(t.repoInfo_,e,(r,i,s,o)=>{u2(t,r,i,s,o)},r=>{d2(t,r)},r=>{HW(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=q8(t.repoInfo_,()=>new UI(t.stats_,t.server_)),t.infoData_=new FI,t.infoSyncTree_=new a_({startListening:(r,i,s,o)=>{let a=[],l=t.infoData_.getNode(r._path);return l.isEmpty()||(a=Jd(t.infoSyncTree_,r._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Ux(t,"connected",!1),t.serverSyncTree_=new a_({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,l)=>{let c=o(a,l);Tn(t.eventQueue_,r._path,c)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function gV(t){let n=t.infoData_.getNode(new Me(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function th(t){return AW({timestamp:gV(t)})}function u2(t,e,n,r,i){t.dataUpdateCount++;let s=new Me(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let l=yc(n,c=>rt(c));o=bW(t.serverSyncTree_,s,l,i)}else{let l=rt(n);o=nV(t.serverSyncTree_,s,l,i)}else if(r){let l=yc(n,c=>rt(c));o=wW(t.serverSyncTree_,s,l)}else{let l=rt(n);o=Jd(t.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=Zl(t,s)),Tn(t.eventQueue_,a,o)}function d2(t,e){Ux(t,"connected",e),e===!1&&GW(t)}function HW(t,e){jt(e,(n,r)=>{Ux(t,n,r)})}function Ux(t,e,n){let r=new Me("/.info/"+e),i=rt(n);t.infoData_.updateSnapshot(r,i);let s=Jd(t.infoSyncTree_,r,i);Tn(t.eventQueue_,r,s)}function T_(t){return t.nextWriteId_++}function qW(t,e,n){let r=IW(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{let s=rt(i).withIndex(e._queryParams.getIndex());JI(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Jd(t.serverSyncTree_,e._path,s);else{let a=Hd(t.serverSyncTree_,e);o=nV(t.serverSyncTree_,e._path,s,a)}return Tn(t.eventQueue_,e._path,o),l_(t.serverSyncTree_,e,n,null,!0),s},i=>(ic(t,"get for query "+gt(e)+" failed: "+i),Promise.reject(new Error(i))))}function Bx(t,e,n,r,i){ic(t,"set",{path:e.toString(),value:n,priority:r});let s=th(t),o=rt(n,r),a=w_(t.serverSyncTree_,e),l=Fx(o,a,s),c=T_(t),u=Rx(t.serverSyncTree_,e,l,c,!0);x_(t.eventQueue_,u),t.server_.put(e.toString(),o.val(!0),(h,g)=>{let y=h==="ok";y||Xt("set at "+e+" failed: "+h);let w=Is(t.serverSyncTree_,c,!y);Tn(t.eventQueue_,e,w),Ms(t,i,h,g)});let d=Hx(t,e);Zl(t,d),Tn(t.eventQueue_,d,[])}function zW(t,e,n,r){ic(t,"update",{path:e.toString(),value:n});let i=!0,s=th(t),o={};if(jt(n,(a,l)=>{i=!1,o[a]=oV(Xe(e,a),rt(l),t.serverSyncTree_,s)}),i)Lt("update() called with empty data.  Don't do anything."),Ms(t,r,"ok",void 0);else{let a=T_(t),l=vW(t.serverSyncTree_,e,o,a);x_(t.eventQueue_,l),t.server_.merge(e.toString(),n,(c,u)=>{let d=c==="ok";d||Xt("update at "+e+" failed: "+c);let h=Is(t.serverSyncTree_,a,!d),g=h.length>0?Zl(t,e):e;Tn(t.eventQueue_,g,h),Ms(t,r,c,u)}),jt(n,c=>{let u=Hx(t,Xe(e,c));Zl(t,u)}),Tn(t.eventQueue_,e,[])}}function GW(t){ic(t,"onDisconnectEvents");let e=th(t),n=Zm();LI(t.onDisconnect_,Ae(),(i,s)=>{let o=oV(i,s,t.serverSyncTree_,e);tc(n,i,o)});let r=[];LI(n,Ae(),(i,s)=>{r=r.concat(Jd(t.serverSyncTree_,i,s));let o=Hx(t,i);Zl(t,o)}),t.onDisconnect_=Zm(),Tn(t.eventQueue_,Ae(),r)}function WW(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&VI(t.onDisconnect_,e),Ms(t,n,r,i)})}function h2(t,e,n,r){let i=rt(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&tc(t.onDisconnect_,e,i),Ms(t,r,s,o)})}function KW(t,e,n,r,i){let s=rt(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&tc(t.onDisconnect_,e,s),Ms(t,i,o,a)})}function QW(t,e,n,r){if(Rh(n)){Lt("onDisconnect().update() called with empty data.  Don't do anything."),Ms(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&jt(n,(o,a)=>{let l=rt(a);tc(t.onDisconnect_,Xe(e,o),l)}),Ms(t,r,i,s)})}function YW(t,e,n){let r;_e(e._path)===".info"?r=JI(t.infoSyncTree_,e,n):r=JI(t.serverSyncTree_,e,n),hV(t.eventQueue_,e._path,r)}function rx(t,e,n){let r;_e(e._path)===".info"?r=l_(t.infoSyncTree_,e,n):r=l_(t.serverSyncTree_,e,n),hV(t.eventQueue_,e._path,r)}function mV(t){t.persistentConnection_&&t.persistentConnection_.interrupt(pV)}function JW(t){t.persistentConnection_&&t.persistentConnection_.resume(pV)}function ic(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Lt(n,...e)}function Ms(t,e,n,r){e&&ec(()=>{if(n==="ok")e(null);else{let i=(n||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function ZW(t,e,n,r,i,s){ic(t,"transaction on "+e);let o={path:e,update:n,onComplete:r,status:null,order:g2(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=$x(t,e,void 0);o.currentInputSnapshot=a;let l=o.update(a.val());if(l===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Xd("transaction failed: Data returned ",l,o.path),o.status=0;let c=C_(t.transactionQueueTree_,e),u=Go(c)||[];u.push(o),Lx(c,u);let d;typeof l=="object"&&l!==null&&Mn(l,".priority")?(d=Ri(l,".priority"),O(zd(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(w_(t.serverSyncTree_,e)||he.EMPTY_NODE).getPriority().val();let h=th(t),g=rt(l,d),y=Fx(g,a,h);o.currentOutputSnapshotRaw=g,o.currentOutputSnapshotResolved=y,o.currentWriteId=T_(t);let w=Rx(t.serverSyncTree_,e,y,o.currentWriteId,o.applyLocally);Tn(t.eventQueue_,e,w),D_(t,t.transactionQueueTree_)}}function $x(t,e,n){return w_(t.serverSyncTree_,e,n)||he.EMPTY_NODE}function D_(t,e=t.transactionQueueTree_){if(e||S_(t,e),Go(e)){let n=yV(t,e);O(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&XW(t,Zd(e),n)}else aV(e)&&b_(e,n=>{D_(t,n)})}function XW(t,e,n){let r=n.map(c=>c.currentWriteId),i=$x(t,e,r),s=i,o=i.hash();for(let c=0;c<n.length;c++){let u=n[c];O(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;let d=cn(e,u.path);s=s.updateChild(d,u.currentOutputSnapshotRaw)}let a=s.val(!0),l=e;t.server_.put(l.toString(),a,c=>{ic(t,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,u=u.concat(Is(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();S_(t,C_(t.transactionQueueTree_,e)),D_(t,t.transactionQueueTree_),Tn(t.eventQueue_,e,u);for(let h=0;h<d.length;h++)ec(d[h])}else{if(c==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{Xt("transaction at "+l.toString()+" failed: "+c);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=c}Zl(t,e)}},o)}function Zl(t,e){let n=_V(t,e),r=Zd(n),i=yV(t,n);return e7(t,i,r),r}function e7(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let l=e[a],c=cn(n,l.path),u=!1,d;if(O(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,d=l.abortReason,i=i.concat(Is(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=BW)u=!0,d="maxretry",i=i.concat(Is(t.serverSyncTree_,l.currentWriteId,!0));else{let h=$x(t,l.path,o);l.currentInputSnapshot=h;let g=e[a].update(h.val());if(g!==void 0){Xd("transaction failed: Data returned ",g,l.path);let y=rt(g);typeof g=="object"&&g!=null&&Mn(g,".priority")||(y=y.updatePriority(h.getPriority()));let v=l.currentWriteId,T=th(t),V=Fx(y,h,T);l.currentOutputSnapshotRaw=y,l.currentOutputSnapshotResolved=V,l.currentWriteId=T_(t),o.splice(o.indexOf(v),1),i=i.concat(Rx(t.serverSyncTree_,l.path,V,l.currentWriteId,l.applyLocally)),i=i.concat(Is(t.serverSyncTree_,v,!0))}else u=!0,d="nodata",i=i.concat(Is(t.serverSyncTree_,l.currentWriteId,!0))}Tn(t.eventQueue_,n,i),i=[],u&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}S_(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)ec(r[a]);D_(t,t.transactionQueueTree_)}function _V(t,e){let n,r=t.transactionQueueTree_;for(n=_e(e);n!==null&&Go(r)===void 0;)r=C_(r,n),e=qe(e),n=_e(e);return r}function yV(t,e){let n=[];return vV(t,e,n),n.sort((r,i)=>r.order-i.order),n}function vV(t,e,n){let r=Go(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);b_(e,i=>{vV(t,i,n)})}function S_(t,e){let n=Go(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,Lx(e,n.length>0?n:void 0)}b_(e,r=>{S_(t,r)})}function Hx(t,e){let n=Zd(_V(t,e)),r=C_(t.transactionQueueTree_,e);return NW(r,i=>{hI(t,i)}),hI(t,r),lV(r,i=>{hI(t,i)}),n}function hI(t,e){let n=Go(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(O(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(O(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(Is(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?Lx(e,void 0):n.length=s+1,Tn(t.eventQueue_,Zd(e),i);for(let o=0;o<r.length;o++)ec(r[o])}}function t7(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function n7(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Xt(`Invalid query segment '${n}' in query '${t}'`)}return e}var ix=function(t,e){let n=r7(t),r=n.namespace;n.domain==="firebase.com"&&Xr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Xr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||N8();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new qm(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new Me(n.pathString)}},r7=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",l=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let u=t.indexOf("/");u===-1&&(u=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(u,d)),u<d&&(i=t7(t.substring(u,d)));let h=n7(t.substring(Math.min(t.length,d)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;let g=e.slice(0,c);if(g.toLowerCase()==="localhost")n="localhost";else if(g.split(".").length<=2)n=g;else{let y=e.indexOf(".");r=e.substring(0,y).toLowerCase(),n=e.substring(y+1),s=r}"ns"in h&&(s=h.ns)}return{host:e,port:l,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var f2="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",i7=function(){let t=0,e=[];return function(n){let r=n===t;t=n;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=f2.charAt(n%64),n=Math.floor(n/64);O(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=f2.charAt(e[i]);return O(o.length===20,"nextPushId: Length should be 20."),o}}();var c_=class{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+gt(this.snapshot.exportVal())}},u_=class{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Gd=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return O(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var d_=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new Pt;return WW(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){xn("OnDisconnect.remove",this._path);let e=new Pt;return h2(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){xn("OnDisconnect.set",this._path),ti("OnDisconnect.set",e,this._path,!1);let n=new Pt;return h2(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){xn("OnDisconnect.setWithPriority",this._path),ti("OnDisconnect.setWithPriority",e,this._path,!1),jx("OnDisconnect.setWithPriority",n,!1);let r=new Pt;return KW(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){xn("OnDisconnect.update",this._path),uV("OnDisconnect.update",e,this._path,!1);let n=new Pt;return QW(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var dn=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return ye(this._path)?null:Ex(this._path)}get ref(){return new Dn(this._repo,this._path)}get _queryIdentifier(){let e=XF(this._queryParams),n=vx(e);return n==="{}"?"default":n}get _queryObject(){return XF(this._queryParams)}isEqual(e){if(e=se(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=Cx(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+dG(this._path)}};function A_(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Rs(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Zr){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==Ds)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==Si)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Ge){if(e!=null&&!zd(e)||n!=null&&!zd(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(O(t.getIndex()instanceof Fd||t.getIndex()===xx,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function M_(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Dn=class t extends dn{constructor(e,n){super(e,n,new Ud,!1)}get parent(){let e=F2(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Xl=class t{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new Me(e),r=Ps(this.ref,e);return new t(this._node.getChild(n),r,Ge)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new t(i,Ps(this.ref,r),Ge)))}hasChild(e){let n=new Me(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function qx(t,e){return t=se(t),t._checkNotDeleted("ref"),e!==void 0?Ps(t._root,e):t._root}function zx(t,e){t=se(t),t._checkNotDeleted("refFromURL");let n=ix(e,t._repo.repoInfo_.nodeAdmin);dV("refFromURL",n);let r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&Xr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),qx(t,n.path.toString())}function Ps(t,e){return t=se(t),_e(t._path)===null?jW("child","path",e,!1):rc("child","path",e,!1),new Dn(t._repo,Xe(t._path,e))}function wV(t,e){t=se(t),xn("push",t._path),ti("push",e,t._path,!0);let n=gV(t._repo),r=i7(n),i=Ps(t,r),s=Ps(t,r),o;return e!=null?o=P_(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function EV(t){return xn("remove",t._path),P_(t,null)}function P_(t,e){t=se(t),xn("set",t._path),ti("set",e,t._path,!1);let n=new Pt;return Bx(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function CV(t,e){t=se(t),xn("setPriority",t._path),jx("setPriority",e,!1);let n=new Pt;return Bx(t._repo,Xe(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function bV(t,e,n){if(xn("setWithPriority",t._path),ti("setWithPriority",e,t._path,!1),jx("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let r=new Pt;return Bx(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function IV(t,e){uV("update",e,t._path,!1);let n=new Pt;return zW(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function xV(t){t=se(t);let e=new Gd(()=>{}),n=new Wd(e);return qW(t._repo,t,n).then(r=>new Xl(r,new Dn(t._repo,t._path),t._queryParams.getIndex()))}var Wd=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let r=n._queryParams.getIndex();return new c_("value",this,new Xl(e.snapshotNode,new Dn(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new u_(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},h_=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new u_(this,e,n):null}createEvent(e,n){O(e.childName!=null,"Child events should have a childName.");let r=Ps(new Dn(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new c_(e.type,this,new Xl(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function nh(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let l=n,c=(u,d)=>{rx(t._repo,t,a),l(u,d)};c.userCallback=n.userCallback,c.context=n.context,n=c}let o=new Gd(n,s||void 0),a=e==="value"?new Wd(o):new h_(e,o);return YW(t._repo,t,a),()=>rx(t._repo,t,a)}function R_(t,e,n,r){return nh(t,"value",e,n,r)}function Gx(t,e,n,r){return nh(t,"child_added",e,n,r)}function Wx(t,e,n,r){return nh(t,"child_changed",e,n,r)}function Kx(t,e,n,r){return nh(t,"child_moved",e,n,r)}function Qx(t,e,n,r){return nh(t,"child_removed",e,n,r)}function Yx(t,e,n){let r=null,i=n?new Gd(n):null;e==="value"?r=new Wd(i):e&&(r=new h_(e,i)),rx(t._repo,t,r)}var Sn=class{},f_=class extends Sn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){ti("endAt",this._value,e._path,!0);let n=kI(e._queryParams,this._value,this._key);if(M_(n),Rs(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new dn(e._repo,e._path,n,e._orderByCalled)}};function TV(t,e){return eh("endAt","key",e,!0),new f_(t,e)}var sx=class extends Sn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){ti("endBefore",this._value,e._path,!1);let n=MG(e._queryParams,this._value,this._key);if(M_(n),Rs(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new dn(e._repo,e._path,n,e._orderByCalled)}};function DV(t,e){return eh("endBefore","key",e,!0),new sx(t,e)}var p_=class extends Sn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){ti("startAt",this._value,e._path,!0);let n=NI(e._queryParams,this._value,this._key);if(M_(n),Rs(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new dn(e._repo,e._path,n,e._orderByCalled)}};function SV(t=null,e){return eh("startAt","key",e,!0),new p_(t,e)}var ox=class extends Sn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){ti("startAfter",this._value,e._path,!1);let n=AG(e._queryParams,this._value,this._key);if(M_(n),Rs(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new dn(e._repo,e._path,n,e._orderByCalled)}};function AV(t,e){return eh("startAfter","key",e,!0),new ox(t,e)}var ax=class extends Sn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new dn(e._repo,e._path,DG(e._queryParams,this._limit),e._orderByCalled)}};function MV(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new ax(t)}var lx=class extends Sn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new dn(e._repo,e._path,SG(e._queryParams,this._limit),e._orderByCalled)}};function PV(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new lx(t)}var cx=class extends Sn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){A_(e,"orderByChild");let n=new Me(this._path);if(ye(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new Fd(n),i=m_(e._queryParams,r);return Rs(i),new dn(e._repo,e._path,i,!0)}};function RV(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return rc("orderByChild","path",t,!1),new cx(t)}var ux=class extends Sn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){A_(e,"orderByKey");let n=m_(e._queryParams,Zr);return Rs(n),new dn(e._repo,e._path,n,!0)}};function NV(){return new ux}var dx=class extends Sn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){A_(e,"orderByPriority");let n=m_(e._queryParams,Ge);return Rs(n),new dn(e._repo,e._path,n,!0)}};function kV(){return new dx}var hx=class extends Sn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){A_(e,"orderByValue");let n=m_(e._queryParams,xx);return Rs(n),new dn(e._repo,e._path,n,!0)}};function OV(){return new hx}var fx=class extends Sn{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(ti("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new f_(this._value,this._key)._apply(new p_(this._value,this._key)._apply(e))}};function FV(t,e){return eh("equalTo","key",e,!0),new fx(t,e)}function Kn(t,...e){let n=se(t);for(let r of e)n=r._apply(n);return n}dW(Dn);mW(Dn);var s7="FIREBASE_DATABASE_EMULATOR_HOST",px={},o7=!1;function a7(t,e,n,r){t.repoInfo_=new qm(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function Jx(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||Xr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Lt("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=ix(s,i),a=o.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[s7]),c?(l=!0,s=`http://${c}?ns=${a.namespace}`,o=ix(s,i),a=o.repoInfo):l=!o.repoInfo.secure;let u=i&&l?new Md(Md.OWNER):new yI(t.name,t.options,e);dV("Invalid Firebase Database URL",o),ye(o.path)||Xr("Database URL must point to the root of a Firebase Database (not including a child path).");let d=c7(a,t,u,new _I(t.name,n));return new gx(d,t)}function l7(t,e){let n=px[e];(!n||n[t.key]!==t)&&Xr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),mV(t),delete n[t.key]}function c7(t,e,n,r){let i=px[e.name];i||(i={},px[e.name]=i);let s=i[t.toURLString()];return s&&Xr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new nx(t,o7,n,r),i[t.toURLString()]=s,s}var gx=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||($W(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Dn(this._repo,Ae())),this._rootInternal}_delete(){return this._rootInternal!==null&&(l7(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Xr("Cannot call "+e+" on a deleted database.")}};function VV(){O2.IS_TRANSPORT_INITIALIZED&&Xt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function LV(){VV(),kd.forceDisallow()}function jV(){VV(),Hl.forceDisallow(),kd.forceAllow()}function UV(t,e,n,r={}){t=se(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Xr("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Xr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Md(Md.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:Xo(r.mockUserToken,t.app.options.projectId);s=new Md(o)}a7(i,e,n,s)}function BV(t){t=se(t),t._checkNotDeleted("goOffline"),mV(t._repo)}function $V(t){t=se(t),t._checkNotDeleted("goOnline"),JW(t._repo)}function HV(t,e){_2(t,e)}function u7(t){yx(ea),si(new Ut("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return Jx(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),fn(FF,VF,t),fn(FF,VF,"esm2017")}var d7={".sv":"timestamp"};function qV(){return d7}function zV(t){return{".sv":{increment:t}}}var mx=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function GV(t,e,n){var r;if(t=se(t),xn("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let i=(r=n?.applyLocally)!==null&&r!==void 0?r:!0,s=new Pt,o=(l,c,u)=>{let d=null;l?s.reject(l):(d=new Xl(u,new Dn(t._repo,t._path),Ge),s.resolve(new mx(c,d)))},a=R_(t,()=>{});return ZW(t._repo,t._path,e,o,a,i),s.promise}bx.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};bx.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};u7();var h7="@firebase/database-compat",f7="1.0.4";var p7=new Ni("@firebase/database-compat"),WV=function(t){let e="FIREBASE WARNING: "+t;p7.warn(e)};var g7=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(hn(t,e)+"must be a boolean.")},m7=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(hn(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var Zx=class{constructor(e){this._delegate=e}cancel(e){re("OnDisconnect.cancel",0,1,arguments.length),bt("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){re("OnDisconnect.remove",0,1,arguments.length),bt("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){re("OnDisconnect.set",1,2,arguments.length),bt("OnDisconnect.set","onComplete",n,!0);let r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){re("OnDisconnect.setWithPriority",2,3,arguments.length),bt("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(re("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,WV("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}bt("OnDisconnect.update","onComplete",n,!0);let r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}};var Xx=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return re("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var Wo=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return re("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return re("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return re("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return re("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return re("DataSnapshot.child",0,1,arguments.length),e=String(e),rc("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return re("DataSnapshot.hasChild",1,1,arguments.length),rc("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return re("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return re("DataSnapshot.forEach",1,1,arguments.length),bt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return re("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return re("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return re("DataSnapshot.ref",0,0,arguments.length),new Ai(this._database,this._delegate.ref)}get ref(){return this.getRef()}},N_=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;re("Query.on",2,4,arguments.length),bt("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",r,i),a=(c,u)=>{n.call(o.context,new Wo(this.database,c),u)};a.userCallback=n,a.context=o.context;let l=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return R_(this._delegate,a,l),n;case"child_added":return Gx(this._delegate,a,l),n;case"child_removed":return Qx(this._delegate,a,l),n;case"child_changed":return Wx(this._delegate,a,l),n;case"child_moved":return Kx(this._delegate,a,l),n;default:throw new Error(hn("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(re("Query.off",0,3,arguments.length),m7("Query.off",e,!0),bt("Query.off","callback",n,!0),iy("Query.off","context",r,!0),n){let i=()=>{};i.userCallback=n,i.context=r,Yx(this._delegate,e,i)}else Yx(this._delegate,e)}get(){return xV(this._delegate).then(e=>new Wo(this.database,e))}once(e,n,r,i){re("Query.once",1,4,arguments.length),bt("Query.once","callback",n,!0);let s=t.getCancelAndContextArgs_("Query.once",r,i),o=new Pt,a=(c,u)=>{let d=new Wo(this.database,c);n&&n.call(s.context,d,u),o.resolve(d)};a.userCallback=n,a.context=s.context;let l=c=>{s.cancel&&s.cancel.call(s.context,c),o.reject(c)};switch(e){case"value":R_(this._delegate,a,l,{onlyOnce:!0});break;case"child_added":Gx(this._delegate,a,l,{onlyOnce:!0});break;case"child_removed":Qx(this._delegate,a,l,{onlyOnce:!0});break;case"child_changed":Wx(this._delegate,a,l,{onlyOnce:!0});break;case"child_moved":Kx(this._delegate,a,l,{onlyOnce:!0});break;default:throw new Error(hn("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return re("Query.limitToFirst",1,1,arguments.length),new t(this.database,Kn(this._delegate,MV(e)))}limitToLast(e){return re("Query.limitToLast",1,1,arguments.length),new t(this.database,Kn(this._delegate,PV(e)))}orderByChild(e){return re("Query.orderByChild",1,1,arguments.length),new t(this.database,Kn(this._delegate,RV(e)))}orderByKey(){return re("Query.orderByKey",0,0,arguments.length),new t(this.database,Kn(this._delegate,NV()))}orderByPriority(){return re("Query.orderByPriority",0,0,arguments.length),new t(this.database,Kn(this._delegate,kV()))}orderByValue(){return re("Query.orderByValue",0,0,arguments.length),new t(this.database,Kn(this._delegate,OV()))}startAt(e=null,n){return re("Query.startAt",0,2,arguments.length),new t(this.database,Kn(this._delegate,SV(e,n)))}startAfter(e=null,n){return re("Query.startAfter",0,2,arguments.length),new t(this.database,Kn(this._delegate,AV(e,n)))}endAt(e=null,n){return re("Query.endAt",0,2,arguments.length),new t(this.database,Kn(this._delegate,TV(e,n)))}endBefore(e=null,n){return re("Query.endBefore",0,2,arguments.length),new t(this.database,Kn(this._delegate,DV(e,n)))}equalTo(e,n){return re("Query.equalTo",1,2,arguments.length),new t(this.database,Kn(this._delegate,FV(e,n)))}toString(){return re("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return re("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(re("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){let i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,bt(e,"cancel",i.cancel,!0),i.context=r,iy(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(hn(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new Ai(this.database,new Dn(this._delegate._repo,this._delegate._path))}},Ai=class t extends N_{constructor(e,n){super(e,new dn(n._repo,n._path,new Ud,!1)),this.database=e,this._delegate=n}getKey(){return re("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return re("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,Ps(this._delegate,e))}getParent(){re("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return re("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){re("Reference.set",1,2,arguments.length),bt("Reference.set","onComplete",n,!0);let r=P_(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(re("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,WV("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}xn("Reference.update",this._delegate._path),bt("Reference.update","onComplete",n,!0);let r=IV(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){re("Reference.setWithPriority",2,3,arguments.length),bt("Reference.setWithPriority","onComplete",r,!0);let i=bV(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){re("Reference.remove",0,1,arguments.length),bt("Reference.remove","onComplete",e,!0);let n=EV(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){re("Reference.transaction",1,3,arguments.length),bt("Reference.transaction","transactionUpdate",e,!1),bt("Reference.transaction","onComplete",n,!0),g7("Reference.transaction","applyLocally",r,!0);let i=GV(this._delegate,e,{applyLocally:r}).then(s=>new Xx(s.committed,new Wo(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){re("Reference.setPriority",1,2,arguments.length),bt("Reference.setPriority","onComplete",n,!0);let r=CV(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){re("Reference.push",0,2,arguments.length),bt("Reference.push","onComplete",n,!0);let r=wV(this._delegate,e),i=r.then(o=>new t(this.database,o));n&&i.then(()=>n(null),o=>n(o));let s=new t(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return xn("Reference.onDisconnect",this._delegate._path),new Zx(new d_(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var Ko=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:LV,forceLongPolling:jV}}useEmulator(e,n,r={}){UV(this._delegate,e,n,r)}ref(e){if(re("database.ref",0,1,arguments.length),e instanceof Ai){let n=zx(this._delegate,e.toString());return new Ai(this,n)}else{let n=qx(this._delegate,e);return new Ai(this,n)}}refFromURL(e){re("database.refFromURL",1,1,arguments.length);let r=zx(this._delegate,e);return new Ai(this,r)}goOffline(){return re("database.goOffline",0,0,arguments.length),BV(this._delegate)}goOnline(){return re("database.goOnline",0,0,arguments.length),$V(this._delegate)}};Ko.ServerValue={TIMESTAMP:qV(),increment:t=>zV(t)};function _7({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){yx(n);let a=new sy("database-standalone"),l=new Nh("auth-internal",a);l.setComponent(new Ut("auth-internal",()=>r,"PRIVATE"));let c;return i&&(c=new Nh("app-check-internal",a),c.setComponent(new Ut("app-check-internal",()=>i,"PRIVATE"))),{instance:new Ko(Jx(t,l,c,e,o),t),namespace:s}}var y7=Object.freeze({__proto__:null,initStandalone:_7});var v7=Ko.ServerValue;function w7(t){t.INTERNAL.registerComponent(new Ut("database-compat",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new Ko(i,r)},"PUBLIC").setServiceProps({Reference:Ai,Query:N_,Database:Ko,DataSnapshot:Wo,enableLogging:HV,INTERNAL:y7,ServerValue:v7}).setMultipleInstances(!0)),t.registerVersion(h7,f7)}w7(et);function rh(t,e,n="on",r=ai){return new oe(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),n==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),n==="on"?{unsubscribe(){s!=null&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(B(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),Hs())}function E7(t){return typeof t=="string"}function C7(t){return typeof t.exportVal=="function"}function ZV(t){return t==null}function XV(t){return typeof t.set=="function"}function KV(t,e){return XV(e)?e:t.ref(e)}function eL(t,e){if(E7(t))return e.stringCase();if(XV(t))return e.firebaseCase();if(C7(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function tL(t){return(ZV(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function nL(t,e,n){e=tL(e);let r=e.map(i=>rh(t,i,"on",n));return Oi(...r)}function b7(t,e,n){let r=nL(t,e).pipe(Cr((i,s)=>[...i,s],[]));return x7(t,r,n)}function I7(t,e){return rh(t,"value","on",e).pipe(B(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}function x7(t,e,n){return I7(t,n).pipe(Ay(e),B(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(l=>l.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),Dy(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),B(i=>i.actions))}function QV(t,e){return function(r,i){return eL(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function T7(t){return function(n){return n?eL(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function D7(t,e,n){return rh(t,"value","once",n).pipe(Re(r=>{let i=[K(r)];return e.forEach(s=>i.push(rh(t,s,"on",n))),Oi(...i).pipe(Cr(A7,[]))}),$s())}function rL(t,e){let n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function S7(t,e){if(ZV(e))return 0;{let n=rL(t,e);return n===-1?t.length:n+1}}function A7(t,e){let{payload:n,prevKey:r,key:i}=e,s=rL(t,i),o=S7(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(l=>{let c={payload:l,type:"value",prevKey:a,key:l.key};return a=l.key,t=[...t,c],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(l=>l.payload.key!==n.key),t.splice(o,0,e));else{if(r==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=t.splice(s,1)[0];return t=t.slice(),t.splice(o,0,a),t}return t;default:return t}}function YV(t,e,n){return e=tL(e),D7(t,e,n)}function M7(t,e){let n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:QV(r,"update"),set:QV(r,"set"),push:i=>r.push(i),remove:T7(r),snapshotChanges(i){return YV(t,i,n).pipe(Ye)},stateChanges(i){return nL(t,i,n).pipe(Ye)},auditTrail(i){return b7(t,i,n).pipe(Ye)},valueChanges(i,s){return YV(t,i,n).pipe(B(a=>a.map(l=>s&&s.idField?Pe(j({},l.payload.val()),{[s.idField]:l.key}):l.payload.val())),Ye)}}}function JV(t,e){return function(){return rh(t,"value","on",e)}}function P7(t,e){return{query:t,snapshotChanges(){return JV(t,e.schedulers.outsideAngular)().pipe(Ye)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return JV(t,e.schedulers.outsideAngular)().pipe(Ye,B(r=>r.payload.exists()?r.payload.val():null))}}}var R7=new L("angularfire2.realtimeDatabaseURL"),N7=new L("angularfire2.database.use-emulator"),Mi=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,l,c,u,d,h,g,y,w,v){this.schedulers=a;let T=l,V=mi(n,o,r);c&&lu(V,o,u,h,g,y,d,w),this.database=es(`${V.name}.database.${i}`,"AngularFireDatabase",V.name,()=>{let P=o.runOutsideAngular(()=>V.database(i||void 0));return T&&P.useEmulator(...T),P},[T])}list(n,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>KV(this.database,n)),s=i;return r&&(s=r(i)),M7(s,this)}object(n){let r=this.schedulers.ngZone.runOutsideAngular(()=>KV(this.database,n));return P7(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(x(kr),x(Or,8),x(R7,8),x(St),x(me),x(Xi),x(N7,8),x(cu,8),x(nu,8),x(ru,8),x(iu,8),x(su,8),x(ou,8),x(au,8),x(lr,8))};static \u0275prov=z({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),iL=(()=>{class t{constructor(){et.registerVersion("angularfire",cr.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ve({type:t});static \u0275inj=Fe({providers:[Mi]})}return t})();var sL={production:!1,firebase:{apiKey:"AIzaSyBYTMHqsFXq-3lErQ5UHGndvMCECDjtCqE",authDomain:"supernova-1-22e7c.firebaseapp.com",databaseURL:"https://supernova-1-22e7c-default-rtdb.europe-west1.firebasedatabase.app",projectId:"supernova-1-22e7c",storageBucket:"supernova-1-22e7c.appspot.com",messagingSenderId:"806806701040",appId:"1:806806701040:web:13a720ad4c2d9926bb1335",measurementId:"G-1V5VXYFKLZ"}};var pe="primary",yh=Symbol("RouteTitle"),iT=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function cc(t){return new iT(t)}function k7(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function O7(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!ni(t[n],e[n]))return!1;return!0}function ni(t,e){let n=t?sT(t):void 0,r=e?sT(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!pL(t[i],e[i]))return!1;return!0}function sT(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function pL(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function gL(t){return t.length>0?t[t.length-1]:null}function Fs(t){return Ey(t)?t:no(t)?ge(Promise.resolve(t)):K(t)}var F7={exact:_L,subset:yL},mL={exact:V7,subset:L7,ignored:()=>!0};function oL(t,e,n){return F7[n.paths](t.root,e.root,n.matrixParams)&&mL[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function V7(t,e){return ni(t,e)}function _L(t,e,n){if(!Yo(t.segments,e.segments)||!V_(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!_L(t.children[r],e.children[r],n))return!1;return!0}function L7(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>pL(t[n],e[n]))}function yL(t,e,n){return vL(t,e,e.segments,n)}function vL(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!Yo(i,n)||e.hasChildren()||!V_(i,n,r))}else if(t.segments.length===n.length){if(!Yo(t.segments,n)||!V_(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!yL(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!Yo(t.segments,i)||!V_(t.segments,i,r)||!t.children[pe]?!1:vL(t.children[pe],e,s,r)}}function V_(t,e,n){return e.every((r,i)=>mL[n](t[i].parameters,r.parameters))}var Ns=class{constructor(e=new Ne([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=cc(this.queryParams)),this._queryParamMap}toString(){return B7.serialize(this)}},Ne=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return L_(this)}},Qo=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=cc(this.parameters)),this._parameterMap}toString(){return EL(this)}};function j7(t,e){return Yo(t,e)&&t.every((n,r)=>ni(n.parameters,e[r].parameters))}function Yo(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function U7(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===pe&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==pe&&(n=n.concat(e(i,r)))}),n}var vh=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:()=>(()=>new uh)(),providedIn:"root"});let t=e;return t})(),uh=class{parse(e){let n=new aT(e);return new Ns(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${ih(e.root,!0)}`,r=q7(e.queryParams),i=typeof e.fragment=="string"?`#${$7(e.fragment)}`:"";return`${n}${r}${i}`}},B7=new uh;function L_(t){return t.segments.map(e=>EL(e)).join("/")}function ih(t,e){if(!t.hasChildren())return L_(t);if(e){let n=t.children[pe]?ih(t.children[pe],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==pe&&r.push(`${i}:${ih(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=U7(t,(r,i)=>i===pe?[ih(t.children[pe],!1)]:[`${i}:${ih(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[pe]!=null?`${L_(t)}/${n[0]}`:`${L_(t)}/(${n.join("//")})`}}function wL(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function O_(t){return wL(t).replace(/%3B/gi,";")}function $7(t){return encodeURI(t)}function oT(t){return wL(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function j_(t){return decodeURIComponent(t)}function aL(t){return j_(t.replace(/\+/g,"%20"))}function EL(t){return`${oT(t.path)}${H7(t.parameters)}`}function H7(t){return Object.keys(t).map(e=>`;${oT(e)}=${oT(t[e])}`).join("")}function q7(t){let e=Object.keys(t).map(n=>{let r=t[n];return Array.isArray(r)?r.map(i=>`${O_(n)}=${O_(i)}`).join("&"):`${O_(n)}=${O_(r)}`}).filter(n=>!!n);return e.length?`?${e.join("&")}`:""}var z7=/^[^\/()?;#]+/;function eT(t){let e=t.match(z7);return e?e[0]:""}var G7=/^[^\/()?;=#]+/;function W7(t){let e=t.match(G7);return e?e[0]:""}var K7=/^[^=?&#]+/;function Q7(t){let e=t.match(K7);return e?e[0]:""}var Y7=/^[^&#]+/;function J7(t){let e=t.match(Y7);return e?e[0]:""}var aT=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ne([],{}):new Ne([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[pe]=new Ne(e,n)),r}parseSegment(){let e=eT(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new Q(4009,!1);return this.capture(e),new Qo(j_(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=W7(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=eT(this.remaining);i&&(r=i,this.capture(r))}e[j_(n)]=j_(r)}parseQueryParam(e){let n=Q7(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=J7(this.remaining);o&&(r=o,this.capture(r))}let i=aL(n),s=aL(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=eT(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new Q(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=pe);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[pe]:new Ne([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new Q(4011,!1)}};function CL(t){return t.segments.length>0?new Ne([],{[pe]:t}):t}function bL(t){let e={};for(let r of Object.keys(t.children)){let i=t.children[r],s=bL(i);if(r===pe&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new Ne(t.segments,e);return Z7(n)}function Z7(t){if(t.numberOfChildren===1&&t.children[pe]){let e=t.children[pe];return new Ne(t.segments.concat(e.segments),e.children)}return t}function uc(t){return t instanceof Ns}function X7(t,e,n=null,r=null){let i=IL(t);return xL(i,e,n,r)}function IL(t){let e;function n(s){let o={};for(let l of s.children){let c=n(l);o[l.outlet]=c}let a=new Ne(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=CL(r);return e??i}function xL(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return tT(i,i,i,n,r);let s=eK(e);if(s.toRoot())return tT(i,i,new Ne([],{}),n,r);let o=tK(s,i,t),a=o.processChildren?ah(o.segmentGroup,o.index,s.commands):DL(o.segmentGroup,o.index,s.commands);return tT(i,o.segmentGroup,a,n,r)}function U_(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function dh(t){return typeof t=="object"&&t!=null&&t.outlets}function tT(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([l,c])=>{s[l]=Array.isArray(c)?c.map(u=>`${u}`):`${c}`});let o;t===e?o=n:o=TL(t,e,n);let a=CL(bL(o));return new Ns(a,s,i)}function TL(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=TL(s,e,n)}),new Ne(t.segments,r)}var B_=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&U_(r[0]))throw new Q(4003,!1);let i=r.find(dh);if(i&&i!==gL(r))throw new Q(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function eK(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new B_(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([l,c])=>{a[l]=typeof c=="string"?c.split("/"):c}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,l)=>{l==0&&a==="."||(l==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new B_(n,e,r)}var ac=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function tK(t,e,n){if(t.isAbsolute)return new ac(e,!0,0);if(!n)return new ac(e,!1,NaN);if(n.parent===null)return new ac(n,!0,0);let r=U_(t.commands[0])?0:1,i=n.segments.length-1+r;return nK(n,i,t.numberOfDoubleDots)}function nK(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new Q(4005,!1);i=r.segments.length}return new ac(r,!1,i-s)}function rK(t){return dh(t[0])?t[0].outlets:{[pe]:t}}function DL(t,e,n){if(t||(t=new Ne([],{})),t.segments.length===0&&t.hasChildren())return ah(t,e,n);let r=iK(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new Ne(t.segments.slice(0,r.pathIndex),{});return s.children[pe]=new Ne(t.segments.slice(r.pathIndex),t.children),ah(s,0,i)}else return r.match&&i.length===0?new Ne(t.segments,{}):r.match&&!t.hasChildren()?lT(t,e,n):r.match?ah(t,0,i):lT(t,e,n)}function ah(t,e,n){if(n.length===0)return new Ne(t.segments,{});{let r=rK(n),i={};if(Object.keys(r).some(s=>s!==pe)&&t.children[pe]&&t.numberOfChildren===1&&t.children[pe].segments.length===0){let s=ah(t.children[pe],e,n);return new Ne(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=DL(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Ne(t.segments,i)}}function iK(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(dh(a))break;let l=`${a}`,c=r<n.length-1?n[r+1]:null;if(i>0&&l===void 0)break;if(l&&c&&typeof c=="object"&&c.outlets===void 0){if(!cL(l,c,o))return s;r+=2}else{if(!cL(l,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function lT(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(dh(s)){let l=sK(s.outlets);return new Ne(r,l)}if(i===0&&U_(n[0])){let l=t.segments[e];r.push(new Qo(l.path,lL(n[0]))),i++;continue}let o=dh(s)?s.outlets[pe]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&U_(a)?(r.push(new Qo(o,lL(a))),i+=2):(r.push(new Qo(o,{})),i++)}return new Ne(r,{})}function sK(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=lT(new Ne([],{}),0,r))}),e}function lL(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function cL(t,e,n){return t==n.path&&ni(e,n.parameters)}var lh="imperative",Qn=class{constructor(e,n){this.id=e,this.url=n}},dc=class extends Qn{constructor(e,n,r="imperative",i=null){super(e,n),this.type=0,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Pi=class extends Qn{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},ks=class extends Qn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Os=class extends Qn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=16}},hh=class extends Qn{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},$_=class extends Qn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},cT=class extends Qn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},uT=class extends Qn{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},dT=class extends Qn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},hT=class extends Qn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},fT=class{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},pT=class{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},gT=class{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},mT=class{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},_T=class{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},yT=class{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},H_=class{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=15}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},fh=class{},ph=class{constructor(e){this.url=e}};var vT=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new wh,this.attachRef=null}},wh=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new vT,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),q_=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=wT(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=wT(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=ET(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return ET(e,this._root).map(n=>n.value)}};function wT(t,e){if(t===e.value)return e;for(let n of e.children){let r=wT(t,n);if(r)return r}return null}function ET(t,e){if(t===e.value)return[e];for(let n of e.children){let r=ET(t,n);if(r.length)return r.unshift(e),r}return[]}var An=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function oc(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var z_=class extends q_{constructor(e,n){super(e),this.snapshot=n,PT(this,e)}toString(){return this.snapshot.toString()}};function SL(t,e){let n=oK(t,e),r=new It([new Qo("",{})]),i=new It({}),s=new It({}),o=new It({}),a=new It(""),l=new hc(r,i,o,a,s,pe,e,n.root);return l.snapshot=n.root,new z_(new An(l,[]),n)}function oK(t,e){let n={},r={},i={},s="",o=new gh([],n,i,s,r,pe,e,null,{});return new G_("",new An(o,[]))}var hc=class{constructor(e,n,r,i,s,o,a,l){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(B(c=>c[yh]))??K(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(B(e=>cc(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(B(e=>cc(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function MT(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:j(j({},e.params),t.params),data:j(j({},e.data),t.data),resolve:j(j(j(j({},t.data),e.data),i?.data),t._resolvedData)}:r={params:t.params,data:t.data,resolve:j(j({},t.data),t._resolvedData??{})},i&&ML(i)&&(r.resolve[yh]=i.title),r}var gh=class{get title(){return this.data?.[yh]}constructor(e,n,r,i,s,o,a,l,c){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=cc(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=cc(this.queryParams)),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},G_=class extends q_{constructor(e,n){super(n),this.url=e,PT(this,n)}toString(){return AL(this._root)}};function PT(t,e){e.value._routerState=t,e.children.forEach(n=>PT(t,n))}function AL(t){let e=t.children.length>0?` { ${t.children.map(AL).join(", ")} } `:"";return`${t.value}${e}`}function nT(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,ni(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),ni(e.params,n.params)||t.paramsSubject.next(n.params),O7(e.url,n.url)||t.urlSubject.next(n.url),ni(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function CT(t,e){let n=ni(t.params,e.params)&&j7(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||CT(t.parent,e.parent))}function ML(t){return typeof t.title=="string"||t.title===null}var RT=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=pe,this.activateEvents=new st,this.deactivateEvents=new st,this.attachEvents=new st,this.detachEvents=new st,this.parentContexts=q(wh),this.location=q(Pa),this.changeDetector=q(to),this.environmentInjector=q(nn),this.inputBinder=q(J_,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Q(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Q(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Q(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new Q(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,l=this.parentContexts.getOrCreateContext(this.name).children,c=new bT(r,l,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:c,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Rt({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Gi]});let t=e;return t})(),bT=class{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===hc?this.route:e===wh?this.childContexts:this.parent.get(e,n)}},J_=new L(""),uL=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=Cc([i.queryParams,i.params,i.data]).pipe(Re(([o,a,l],c)=>(l=j(j(j({},o),a),l),c===0?K(l):Promise.resolve(l)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=x1(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:l}of a.inputs)r.activatedComponentRef.setInput(l,o[l])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac});let t=e;return t})();function aK(t,e,n){let r=mh(t,e._root,n?n._root:void 0);return new z_(r,e)}function mh(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=lK(t,e,n);return new An(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>mh(t,a)),o}}let r=cK(e.value),i=e.children.map(s=>mh(t,s));return new An(r,i)}}function lK(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return mh(t,r,i);return mh(t,r)})}function cK(t){return new hc(new It(t.url),new It(t.params),new It(t.queryParams),new It(t.fragment),new It(t.data),t.outlet,t.component,t)}var PL="ngNavigationCancelingError";function RL(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=uc(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=NL(!1,0,e);return i.url=n,i.navigationBehaviorOptions=r,i}function NL(t,e,n){let r=new Error("NavigationCancelingError: "+(t||""));return r[PL]=!0,r.cancellationCode=e,n&&(r.url=n),r}function uK(t){return kL(t)&&uc(t.url)}function kL(t){return t&&t[PL]}var dK=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=ot({type:e,selectors:[["ng-component"]],standalone:!0,features:[g1],decls:1,vars:0,template:function(i,s){i&1&&D(0,"router-outlet")},dependencies:[RT],encapsulation:2});let t=e;return t})();function hK(t,e){return t.providers&&!t._injector&&(t._injector=rp(t.providers,e,`Route: ${t.path}`)),t._injector??e}function NT(t){let e=t.children&&t.children.map(NT),n=e?Pe(j({},t),{children:e}):j({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==pe&&(n.component=dK),n}function ri(t){return t.outlet||pe}function fK(t,e){let n=t.filter(r=>ri(r)===e);return n.push(...t.filter(r=>ri(r)!==e)),n}function Eh(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var pK=(t,e,n,r)=>B(i=>(new IT(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),IT=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),nT(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=oc(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=oc(e);for(let o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=oc(e);for(let o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=oc(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new yT(s.value.snapshot))}),e.children.length&&this.forwardEvent(new mT(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(nT(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),nT(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=Eh(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},W_=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},lc=class{constructor(e,n){this.component=e,this.route=n}};function gK(t,e,n){let r=t._root,i=e?e._root:null;return sh(r,i,n,[r.value])}function mK(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function pc(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!cS(t)?t:e.get(t):r}function sh(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=oc(e);return t.children.forEach(o=>{_K(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>ch(a,n.getContext(o),i)),i}function _K(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let l=yK(o,s,s.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new W_(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?sh(t,e,a?a.children:null,r,i):sh(t,e,n,r,i),l&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new lc(a.outlet.component,o))}else o&&ch(e,a,i),i.canActivateChecks.push(new W_(r)),s.component?sh(t,null,a?a.children:null,r,i):sh(t,null,n,r,i);return i}function yK(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!Yo(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Yo(t.url,e.url)||!ni(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!CT(t,e)||!ni(t.queryParams,e.queryParams);case"paramsChange":default:return!CT(t,e)}}function ch(t,e,n){let r=oc(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?ch(o,e.children.getContext(s),n):ch(o,null,n):ch(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new lc(e.outlet.component,i)):n.canDeactivateChecks.push(new lc(null,i)):n.canDeactivateChecks.push(new lc(null,i))}function Ch(t){return typeof t=="function"}function vK(t){return typeof t=="boolean"}function wK(t){return t&&Ch(t.canLoad)}function EK(t){return t&&Ch(t.canActivate)}function CK(t){return t&&Ch(t.canActivateChild)}function bK(t){return t&&Ch(t.canDeactivate)}function IK(t){return t&&Ch(t.canMatch)}function OL(t){return t instanceof li||t?.name==="EmptyError"}var F_=Symbol("INITIAL_VALUE");function fc(){return Re(t=>Cc(t.map(e=>e.pipe(Rn(1),qs(F_)))).pipe(B(e=>{for(let n of e)if(n!==!0){if(n===F_)return F_;if(n===!1||n instanceof Ns)return n}return!0}),xt(e=>e!==F_),Rn(1)))}function xK(t,e){return _t(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?K(Pe(j({},n),{guardsResult:!0})):TK(o,r,i,t).pipe(_t(a=>a&&vK(a)?DK(r,s,t,e):K(a)),B(a=>Pe(j({},n),{guardsResult:a})))})}function TK(t,e,n,r){return ge(t).pipe(_t(i=>RK(i.component,i.route,n,e,r)),Nn(i=>i!==!0,!0))}function DK(t,e,n,r){return ge(e).pipe(ci(i=>ha(AK(i.route.parent,r),SK(i.route,r),PK(t,i.path,n),MK(t,i.route,n))),Nn(i=>i!==!0,!0))}function SK(t,e){return t!==null&&e&&e(new _T(t)),K(!0)}function AK(t,e){return t!==null&&e&&e(new gT(t)),K(!0)}function MK(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return K(!0);let i=r.map(s=>rf(()=>{let o=Eh(e)??n,a=pc(s,o),l=EK(a)?a.canActivate(e,t):Ar(o,()=>a(e,t));return Fs(l).pipe(Nn())}));return K(i).pipe(fc())}function PK(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>mK(o)).filter(o=>o!==null).map(o=>rf(()=>{let a=o.guards.map(l=>{let c=Eh(o.node)??n,u=pc(l,c),d=CK(u)?u.canActivateChild(r,t):Ar(c,()=>u(r,t));return Fs(d).pipe(Nn())});return K(a).pipe(fc())}));return K(s).pipe(fc())}function RK(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return K(!0);let o=s.map(a=>{let l=Eh(e)??i,c=pc(a,l),u=bK(c)?c.canDeactivate(t,e,n,r):Ar(l,()=>c(t,e,n,r));return Fs(u).pipe(Nn())});return K(o).pipe(fc())}function NK(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return K(!0);let s=i.map(o=>{let a=pc(o,t),l=wK(a)?a.canLoad(e,n):Ar(t,()=>a(e,n));return Fs(l)});return K(s).pipe(fc(),FL(r))}function FL(t){return gy(it(e=>{if(uc(e))throw RL(t,e)}),B(e=>e===!0))}function kK(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return K(!0);let s=i.map(o=>{let a=pc(o,t),l=IK(a)?a.canMatch(e,n):Ar(t,()=>a(e,n));return Fs(l)});return K(s).pipe(fc(),FL(r))}var _h=class{constructor(e){this.segmentGroup=e||null}},K_=class extends Error{constructor(e){super(),this.urlTree=e}};function sc(t){return da(new _h(t))}function OK(t){return da(new Q(4e3,!1))}function FK(t){return da(NL(!1,3))}var xT=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return K(r);if(i.numberOfChildren>1||!i.children[pe])return OK(e.redirectTo);i=i.children[pe]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new K_(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new Ns(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,l])=>{o[a]=this.createSegmentGroup(e,l,r,i)}),new Ne(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new Q(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},TT={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function VK(t,e,n,r,i){let s=kT(t,e,n);return s.matched?(r=hK(e,r),kK(r,e,n,i).pipe(B(o=>o===!0?s:j({},TT)))):K(s)}function kT(t,e,n){if(e.path==="**")return LK(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?j({},TT):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||k7)(n,t,e);if(!i)return j({},TT);let s={};Object.entries(i.posParams??{}).forEach(([a,l])=>{s[a]=l.path});let o=i.consumed.length>0?j(j({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function LK(t){return{matched:!0,parameters:t.length>0?gL(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function dL(t,e,n,r){return n.length>0&&BK(t,n,r)?{segmentGroup:new Ne(e,UK(r,new Ne(n,t.children))),slicedSegments:[]}:n.length===0&&$K(t,n,r)?{segmentGroup:new Ne(t.segments,jK(t,e,n,r,t.children)),slicedSegments:n}:{segmentGroup:new Ne(t.segments,t.children),slicedSegments:n}}function jK(t,e,n,r,i){let s={};for(let o of r)if(Z_(t,n,o)&&!i[ri(o)]){let a=new Ne([],{});s[ri(o)]=a}return j(j({},i),s)}function UK(t,e){let n={};n[pe]=e;for(let r of t)if(r.path===""&&ri(r)!==pe){let i=new Ne([],{});n[ri(r)]=i}return n}function BK(t,e,n){return n.some(r=>Z_(t,e,r)&&ri(r)!==pe)}function $K(t,e,n){return n.some(r=>Z_(t,e,r))}function Z_(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function HK(t,e,n,r){return ri(t)!==r&&(r===pe||!Z_(e,n,t))?!1:kT(e,t,n).matched}function qK(t,e,n){return e.length===0&&!t.children[n]}var DT=class{};function zK(t,e,n,r,i,s,o="emptyOnly"){return new ST(t,e,n,r,i,o,s).recognize()}var GK=31,ST=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new xT(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new Q(4002,`'${e.segmentGroup}'`)}recognize(){let e=dL(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(B(n=>{let r=new gh([],Object.freeze({}),Object.freeze(j({},this.urlTree.queryParams)),this.urlTree.fragment,{},pe,this.rootComponentType,null,{}),i=new An(r,n),s=new G_("",i),o=X7(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,pe).pipe(Fi(r=>{if(r instanceof K_)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof _h?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=MT(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(B(s=>s instanceof An?[s]:[]))}processChildren(e,n,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return ge(i).pipe(ci(s=>{let o=r.children[s],a=fK(n,s);return this.processSegmentGroup(e,a,o,s)}),Cr((s,o)=>(s.push(...o),s)),Vi(null),xy(),_t(s=>{if(s===null)return sc(r);let o=VL(s);return WK(o),K(o)}))}processSegment(e,n,r,i,s,o){return ge(n).pipe(ci(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(Fi(l=>{if(l instanceof _h)return K(null);throw l}))),Nn(a=>!!a),Fi(a=>{if(OL(a))return qK(r,i,s)?K(new DT):sc(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return HK(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):sc(i):sc(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){let{matched:a,consumedSegments:l,positionalParamSegments:c,remainingSegments:u}=kT(n,i,s);if(!a)return sc(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>GK&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(l,i.redirectTo,c);return this.applyRedirects.lineralizeSegments(i,d).pipe(_t(h=>this.processSegment(e,r,n,h.concat(u),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){let o=VK(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),o.pipe(Re(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Re(({routes:l})=>{let c=r._loadedInjector??e,{consumedSegments:u,remainingSegments:d,parameters:h}=a,g=new gh(u,h,Object.freeze(j({},this.urlTree.queryParams)),this.urlTree.fragment,QK(r),ri(r),r.component??r._loadedComponent??null,r,YK(r)),{segmentGroup:y,slicedSegments:w}=dL(n,u,d,l);if(w.length===0&&y.hasChildren())return this.processChildren(c,l,y).pipe(B(T=>T===null?null:new An(g,T)));if(l.length===0&&w.length===0)return K(new An(g,[]));let v=ri(r)===s;return this.processSegment(c,l,y,w,v?pe:s,!0).pipe(B(T=>new An(g,T instanceof An?[T]:[])))}))):sc(n)))}getChildConfig(e,n,r){return n.children?K({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?K({routes:n._loadedRoutes,injector:n._loadedInjector}):NK(e,n,r,this.urlSerializer).pipe(_t(i=>i?this.configLoader.loadChildren(e,n).pipe(it(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):FK(n))):K({routes:[],injector:e})}};function WK(t){t.sort((e,n)=>e.value.outlet===pe?-1:n.value.outlet===pe?1:e.value.outlet.localeCompare(n.value.outlet))}function KK(t){let e=t.value.routeConfig;return e&&e.path===""}function VL(t){let e=[],n=new Set;for(let r of t){if(!KK(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=VL(r.children);e.push(new An(r.value,i))}return e.filter(r=>!n.has(r))}function QK(t){return t.data||{}}function YK(t){return t.resolve||{}}function JK(t,e,n,r,i,s){return _t(o=>zK(t,e,n,r,o.extractedUrl,i,s).pipe(B(({state:a,tree:l})=>Pe(j({},o),{targetSnapshot:a,urlAfterRedirects:l}))))}function ZK(t,e){return _t(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return K(n);let s=new Set(i.map(l=>l.route)),o=new Set;for(let l of s)if(!o.has(l))for(let c of LL(l))o.add(c);let a=0;return ge(o).pipe(ci(l=>s.has(l)?XK(l,r,t,e):(l.data=MT(l,l.parent,t).resolve,K(void 0))),it(()=>a++),fa(1),_t(l=>a===o.size?K(n):pn))})}function LL(t){let e=t.children.map(n=>LL(n)).flat();return[t,...e]}function XK(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!ML(i)&&(s[yh]=i.title),eQ(s,t,e,r).pipe(B(o=>(t._resolvedData=o,t.data=MT(t,t.parent,n).resolve,null)))}function eQ(t,e,n,r){let i=sT(t);if(i.length===0)return K({});let s={};return ge(i).pipe(_t(o=>tQ(t[o],e,n,r).pipe(Nn(),it(a=>{s[o]=a}))),fa(1),Iy(s),Fi(o=>OL(o)?pn:da(o)))}function tQ(t,e,n,r){let i=Eh(e)??r,s=pc(t,i),o=s.resolve?s.resolve(e,n):Ar(i,()=>s(e,n));return Fs(o)}function rT(t){return Re(e=>{let n=t(e);return n?ge(n).pipe(B(()=>e)):K(e)})}var jL=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===pe);return i}getResolvedTitleForRoute(r){return r.data[yh]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:()=>(()=>q(nQ))(),providedIn:"root"});let t=e;return t})(),nQ=(()=>{let e=class e extends jL{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(x(j0))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),bh=new L("",{providedIn:"root",factory:()=>({})}),Q_=new L("ROUTES"),OT=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=q(op)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return K(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Fs(r.loadComponent()).pipe(B(UL),it(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),Li(()=>{this.componentLoaders.delete(r)})),s=new oa(i,()=>new ut).pipe(sa());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return K({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=rQ(i,this.compiler,r,this.onLoadEndListener).pipe(Li(()=>{this.childrenLoaders.delete(i)})),a=new oa(o,()=>new ut).pipe(sa());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function rQ(t,e,n,r){return Fs(t.loadChildren()).pipe(B(UL),_t(i=>i instanceof Oc||Array.isArray(i)?K(i):ge(e.compileModuleAsync(i))),B(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(Q_,[],{optional:!0,self:!0}).flat()),{routes:o.map(NT),injector:s}}))}function iQ(t){return t&&typeof t=="object"&&"default"in t}function UL(t){return iQ(t)?t.default:t}var FT=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:()=>(()=>q(sQ))(),providedIn:"root"});let t=e;return t})(),sQ=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),BL=new L(""),$L=new L("");function oQ(t,e,n){let r=t.get($L),i=t.get($t);return t.get(me).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,Promise.resolve();let s,o=new Promise(c=>{s=c}),a=i.startViewTransition(()=>(s(),aQ(t))),{onViewTransitionCreated:l}=r;return l&&Ar(t,()=>l({transition:a,from:e,to:n})),o})}function aQ(t){return new Promise(e=>{d0(e,{injector:t})})}var VT=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new ut,this.transitionAbortSubject=new ut,this.configLoader=q(OT),this.environmentInjector=q(nn),this.urlSerializer=q(vh),this.rootContexts=q(wh),this.location=q(La),this.inputBindingEnabled=q(J_,{optional:!0})!==null,this.titleStrategy=q(jL),this.options=q(bh,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=q(FT),this.createViewTransition=q(BL,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>K(void 0),this.rootComponentType=null;let r=s=>this.events.next(new fT(s)),i=s=>this.events.next(new pT(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(Pe(j(j({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new It({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:lh,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(xt(o=>o.id!==0),B(o=>Pe(j({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Re(o=>{this.currentTransition=o;let a=!1,l=!1;return K(o).pipe(it(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?Pe(j({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Re(c=>{let u=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=c.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!u&&d!=="reload"){let h="";return this.events.next(new Os(c.id,this.urlSerializer.serialize(c.rawUrl),h,0)),c.resolve(null),pn}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return K(c).pipe(Re(h=>{let g=this.transitions?.getValue();return this.events.next(new dc(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),g!==this.transitions?.getValue()?pn:Promise.resolve(h)}),JK(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),it(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=Pe(j({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let g=new $_(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(g)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:h,extractedUrl:g,source:y,restoredState:w,extras:v}=c,T=new dc(h,this.urlSerializer.serialize(g),y,w);this.events.next(T);let V=SL(g,this.rootComponentType).snapshot;return this.currentTransition=o=Pe(j({},c),{targetSnapshot:V,urlAfterRedirects:g,extras:Pe(j({},v),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=g,K(o)}else{let h="";return this.events.next(new Os(c.id,this.urlSerializer.serialize(c.extractedUrl),h,1)),c.resolve(null),pn}}),it(c=>{let u=new cT(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}),B(c=>(this.currentTransition=o=Pe(j({},c),{guards:gK(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),o)),xK(this.environmentInjector,c=>this.events.next(c)),it(c=>{if(o.guardsResult=c.guardsResult,uc(c.guardsResult))throw RL(this.urlSerializer,c.guardsResult);let u=new uT(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(u)}),xt(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",3),!1)),rT(c=>{if(c.guards.canActivateChecks.length)return K(c).pipe(it(u=>{let d=new dT(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}),Re(u=>{let d=!1;return K(u).pipe(ZK(this.paramsInheritanceStrategy,this.environmentInjector),it({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(u,"",2)}}))}),it(u=>{let d=new hT(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}))}),rT(c=>{let u=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(it(g=>{d.component=g}),B(()=>{})));for(let g of d.children)h.push(...u(g));return h};return Cc(u(c.targetSnapshot.root)).pipe(Vi(),Rn(1))}),rT(()=>this.afterPreactivation()),Re(()=>{let{currentSnapshot:c,targetSnapshot:u}=o,d=this.createViewTransition?.(this.environmentInjector,c.root,u.root);return d?ge(d).pipe(B(()=>o)):K(o)}),B(c=>{let u=aK(r.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o=Pe(j({},c),{targetRouterState:u}),this.currentNavigation.targetRouterState=u,o}),it(()=>{this.events.next(new fh)}),pK(this.rootContexts,r.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Rn(1),it({next:c=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Pi(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{a=!0}}),Sy(this.transitionAbortSubject.pipe(it(c=>{throw c}))),Li(()=>{if(!a&&!l){let c="";this.cancelNavigationTransition(o,c,1)}this.currentNavigation?.id===o.id&&(this.currentNavigation=null)}),Fi(c=>{if(l=!0,kL(c))this.events.next(new ks(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),uK(c)?this.events.next(new ph(c.url)):o.resolve(!1);else{this.events.next(new hh(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(c))}catch(u){o.reject(u)}}return pn}))}))}cancelNavigationTransition(r,i,s){let o=new ks(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function lQ(t){return t!==lh}var cQ=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:()=>(()=>q(uQ))(),providedIn:"root"});let t=e;return t})(),AT=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},uQ=(()=>{let e=class e extends AT{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=eo(e)))(s||e)}})(),e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),HL=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:()=>(()=>q(dQ))(),providedIn:"root"});let t=e;return t})(),dQ=(()=>{let e=class e extends HL{constructor(){super(...arguments),this.location=q(La),this.urlSerializer=q(vh),this.options=q(bh,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=q(FT),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Ns,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=SL(this.currentUrlTree,null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof dc)this.stateMemento=this.createStateMemento();else if(r instanceof Os)this.rawUrlTree=i.initialUrl;else if(r instanceof $_){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof fh?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof ks&&(r.code===3||r.code===2)?this.restoreHistory(i):r instanceof hh?this.restoreHistory(i,!0):r instanceof Pi&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=j(j({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=j(j({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=eo(e)))(s||e)}})(),e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),oh=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(oh||{});function qL(t,e){t.events.pipe(xt(n=>n instanceof Pi||n instanceof ks||n instanceof hh||n instanceof Os),B(n=>n instanceof Pi||n instanceof Os?oh.COMPLETE:(n instanceof ks?n.code===0||n.code===1:!1)?oh.REDIRECTING:oh.FAILED),xt(n=>n!==oh.REDIRECTING),Rn(1)).subscribe(()=>{e()})}function hQ(t){throw t}var fQ={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},pQ={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Mt=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=q(sp),this.stateManager=q(HL),this.options=q(bh,{optional:!0})||{},this.pendingTasks=q(Fa),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=q(VT),this.urlSerializer=q(vh),this.location=q(La),this.urlHandlingStrategy=q(FT),this._events=new ut,this.errorHandler=this.options.errorHandler||hQ,this.navigated=!1,this.routeReuseStrategy=q(cQ),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=q(Q_,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!q(J_,{optional:!0}),this.eventsSubscription=new mt,this.isNgZoneEnabled=q(me)instanceof me&&me.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof ks&&i.code!==0&&i.code!==1)this.navigated=!0;else if(i instanceof Pi)this.navigated=!0;else if(i instanceof ph){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),l={skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||lQ(s.source)};this.scheduleNavigation(a,lh,null,l,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}mQ(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),lh,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription||(this.nonRouterCurrentEntryChangeSubscription=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)}))}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let c=j({},s);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let l=this.parseUrl(r);this.scheduleNavigation(l,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(NT),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:l,preserveFragment:c}=i,u=c?this.currentUrlTree.fragment:a,d=null;switch(l){case"merge":d=j(j({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let g=s?s.snapshot:this.routerState.snapshot.root;h=IL(g)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),h=this.currentUrlTree.root}return xL(h,r,d,u??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=uc(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,lh,null,i)}navigate(r,i={skipLocationChange:!1}){return gQ(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=j({},fQ):i===!1?s=j({},pQ):s=i,uc(r))return oL(this.currentUrlTree,r,s);let o=this.parseUrl(r);return oL(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.keys(r).reduce((i,s)=>{let o=r[s];return o!=null&&(i[s]=o),i},{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let l,c,u;a?(l=a.resolve,c=a.reject,u=a.promise):u=new Promise((h,g)=>{l=h,c=g});let d=this.pendingTasks.add();return qL(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:l,reject:c,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(h=>Promise.reject(h))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function gQ(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new Q(4008,!1)}function mQ(t){return!(t instanceof fh)&&!(t instanceof ph)}var Y_=class{};var _Q=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(xt(r=>r instanceof Pi),ci(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=rp(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,l=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(l,o.children??o._loadedRoutes))}return ge(s).pipe(ki())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=K(null);let o=s.pipe(_t(a=>a===null?K(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return ge([o,a]).pipe(ki())}else return o})}};e.\u0275fac=function(i){return new(i||e)(x(Mt),x(op),x(nn),x(Y_),x(OT))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),zL=new L(""),yQ=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration=a.scrollPositionRestoration||"disabled",a.anchorScrolling=a.anchorScrolling||"disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof dc?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof Pi?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof Os&&r.code===0&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof H_&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new H_(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){RA()},e.\u0275prov=z({token:e,factory:e.\u0275fac});let t=e;return t})();function vQ(t){return t.routerState.root}function Ih(t,e){return{\u0275kind:t,\u0275providers:e}}function wQ(){let t=q(Ln);return e=>{let n=t.get(ro);if(e!==n.components[0])return;let r=t.get(Mt),i=t.get(GL);t.get(LT)===1&&r.initialNavigation(),t.get(WL,null,ve.Optional)?.setUpPreloading(),t.get(zL,null,ve.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var GL=new L("",{factory:()=>new ut}),LT=new L("",{providedIn:"root",factory:()=>1});function EQ(){return Ih(2,[{provide:LT,useValue:0},{provide:cp,multi:!0,deps:[Ln],useFactory:e=>{let n=e.get(P1,Promise.resolve());return()=>n.then(()=>new Promise(r=>{let i=e.get(Mt),s=e.get(GL);qL(i,()=>{r(!0)}),e.get(VT).afterPreactivation=()=>(r(!0),s.closed?K(void 0):s),i.initialNavigation()}))}}])}function CQ(){return Ih(3,[{provide:cp,multi:!0,useFactory:()=>{let e=q(Mt);return()=>{e.setUpLocationChangeListener()}}},{provide:LT,useValue:2}])}var WL=new L("");function bQ(t){return Ih(0,[{provide:WL,useExisting:_Q},{provide:Y_,useExisting:t}])}function IQ(){return Ih(8,[uL,{provide:J_,useExisting:uL}])}function xQ(t){let e=[{provide:BL,useValue:oQ},{provide:$L,useValue:j({skipNextTransition:!!t?.skipInitialTransition},t)}];return Ih(9,e)}var hL=new L("ROUTER_FORROOT_GUARD"),TQ=[La,{provide:vh,useClass:uh},Mt,wh,{provide:hc,useFactory:vQ,deps:[Mt]},OT,[]],jT=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[TQ,[],{provide:Q_,multi:!0,useValue:r},{provide:hL,useFactory:MQ,deps:[[Mt,new Ma,new Gv]]},{provide:bh,useValue:i||{}},i?.useHash?SQ():AQ(),DQ(),i?.preloadingStrategy?bQ(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?PQ(i):[],i?.bindToComponentInputs?IQ().\u0275providers:[],i?.enableViewTransitions?xQ().\u0275providers:[],RQ()]}}static forChild(r){return{ngModule:e,providers:[{provide:Q_,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(x(hL,8))},e.\u0275mod=Ve({type:e}),e.\u0275inj=Fe({});let t=e;return t})();function DQ(){return{provide:zL,useFactory:()=>{let t=q(O1),e=q(me),n=q(bh),r=q(VT),i=q(vh);return n.scrollOffset&&t.setOffset(n.scrollOffset),new yQ(i,r,t,e,n)}}}function SQ(){return{provide:gi,useClass:fp}}function AQ(){return{provide:gi,useClass:x0}}function MQ(t){return"guarded"}function PQ(t){return[t.initialNavigation==="disabled"?CQ().\u0275providers:[],t.initialNavigation==="enabledBlocking"?EQ().\u0275providers:[]]}var fL=new L("");function RQ(){return[{provide:fL,useFactory:wQ},{provide:up,multi:!0,useExisting:fL}]}var ii=(()=>{let e=class e{constructor(r){this.db=r,this.dbPath="/produit",this.productsRef=r.list(this.dbPath)}addProduct(r){this.productsRef.push(r)}getAll(){return this.productsRef}getProductByCas(r){return this.db.list("/produit",i=>i.orderByChild("Cas").equalTo(r)).valueChanges()}};e.\u0275fac=function(i){return new(i||e)(x(Mi))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function NQ(t,e){if(t&1&&(f(0,"div",1)(1,"div",2),D(2,"img",3),p(),f(3,"div",4)(4,"form")(5,"div",5)(6,"label",6)(7,"strong"),m(8,"Marque:"),p()(),f(9,"span"),m(10),p()(),f(11,"div",5)(12,"label",7)(13,"strong"),m(14,"Mod\xE8le :"),p()(),f(15,"span"),m(16),p()(),f(17,"div",5)(18,"label",8)(19,"strong"),m(20,"Puissance :"),p()(),f(21,"span"),m(22),p()(),f(23,"div",5)(24,"label",9)(25,"strong"),m(26,"Finition :"),p()(),f(27,"span"),m(28),p()(),f(29,"div",5)(30,"label",10)(31,"strong"),m(32,"Forme:"),p()(),f(33,"span"),m(34),p()(),f(35,"div",5)(36,"label",11)(37,"strong"),m(38,"Temp\xE9rature de couleur:"),p()(),f(39,"span"),m(40),p()(),f(41,"div",5)(42,"label",12)(43,"strong"),m(44,"Faisceau:"),p()(),f(45,"span"),m(46),p()(),f(47,"div",5)(48,"label",13)(49,"strong"),m(50,"Description:"),p()(),f(51,"span"),m(52),p()()()()()),t&2){let n=E();_(2),Nt("src",n.currentProduct.Photo_luminaire,Qe),_(8),ee(n.currentProduct.Marque),_(6),ee(n.currentProduct.Modele),_(6),ee(n.currentProduct.Puissance),_(6),ee(n.currentProduct.Finition),_(6),ee(n.currentProduct.Forme),_(6),ee(n.currentProduct.Temperature_de_couleur),_(6),ee(n.currentProduct.Faisceau),_(6),ee(n.currentProduct.Description)}}function kQ(t,e){t&1&&(f(0,"div"),D(1,"br"),f(2,"p"),m(3,"Cannot access this Product..."),p()())}var KL=(()=>{let e=class e{constructor(r){this.productService=r,this.refreshList=new st,this.currentProduct={Identifiant:"",Marque:"",Modele:"",Type:"",Finition:"",Puissance:"",Temperature_de_couleur:"",Forme:"",Faisceau:"",Photo_luminaire:"",Photo_projet:"",Description:""},this.message=""}ngOnInit(){this.message=""}ngOnChanges(){this.message="",this.currentProduct=j({},this.product)}};e.\u0275fac=function(i){return new(i||e)(W(ii))},e.\u0275cmp=ot({type:e,selectors:[["app-product-details"]],inputs:{product:"product"},outputs:{refreshList:"refreshList"},features:[Gi],decls:2,vars:1,consts:[["class","product-details"],[1,"product-details"],[1,"image-container"],["alt","Product Image",3,"src"],[1,"details-container"],[1,"form-group"],["for","title"],["for","description"],["for","effLumineuse"],["for","fluxLumi"],["for","puiss"],["for","TempCoul"],["for","Faisc"],["for","Descr"]],template:function(i,s){i&1&&Z(0,NQ,53,9,"div",0)(1,kQ,4,0),i&2&&h1(0,s.currentProduct?0:1)},dependencies:[Nr,Rr,ar],styles:[".product-details[_ngcontent-%COMP%]{display:flex;width:800px;margin:auto;background-color:#f2f2f2;padding:20px;border-radius:5px;box-shadow:0 2px 5px #0000001a}.product-details[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{flex:1;padding-right:20px;display:flex;justify-content:center;align-items:center}.product-details[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:250px;height:250px;margin:20px}.product-details[_ngcontent-%COMP%]   .details-container[_ngcontent-%COMP%]{flex:2}.product-details[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:10px;margin-top:0}.product-details[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{margin-top:10px}.product-details[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:10px}.product-details[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700}.product-details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;margin-left:10px;line-height:1.4}"]});let t=e;return t})();function FQ(t,e){if(t&1&&(f(0,"div"),D(1,"app-product-details",4)(2,"hr"),p()),t&2){let n=e.$implicit;_(1),S("product",n)}}function VQ(t,e){t&1&&(f(0,"div"),D(1,"br"),f(2,"p"),m(3,"No products found..."),p()())}var QL=(()=>{let e=class e{constructor(r){this.productService=r,this.currentIndex=-1,this.filteredProducts=[],this.checkboxes={}}ngOnInit(){this.filteredProducts=this.products,this.retrieveProducts();for(let r=1;r<=4;r++)this.checkboxes[r]=!1}applyFilter(r){let i=Object.keys(this.checkboxes).filter(s=>this.checkboxes[s]);i.length===0?this.filteredProducts=this.products:this.filteredProducts=this.products.filter(s=>i.includes(s.Identifiant.toString()))}refreshList(){this.currentProduct=void 0,this.currentIndex=-1,this.retrieveProducts()}retrieveProducts(){this.productService.getAll().snapshotChanges().pipe(B(r=>r.map(i=>j({key:i.payload.key},i.payload.val())))).subscribe(r=>{this.products=r})}setActiveProduct(r,i){this.currentProduct=r,this.currentIndex=i}};e.\u0275fac=function(i){return new(i||e)(W(ii))},e.\u0275cmp=ot({type:e,selectors:[["app-product-list"]],inputs:{selectedProducts:"selectedProducts"},decls:5,vars:1,consts:[[1,"list","row"],[1,"col-md-6"],[4,"ngFor","ngForOf"],["noProducts",""],[3,"product"]],template:function(i,s){i&1&&(f(0,"div",0)(1,"div",1),Z(2,FQ,3,1,"div",2)(3,VQ,4,0,"ng-template",null,3,Yi),p()()),i&2&&(_(2),S("ngForOf",s.selectedProducts))},dependencies:[jn,KL],styles:['.list[_ngcontent-%COMP%]{text-align:left;max-width:750px;margin:auto}.checkbox-label[_ngcontent-%COMP%]{display:inline-block;position:relative;padding-left:25px;margin-right:10px;cursor:pointer}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{position:absolute;opacity:0;cursor:pointer}.checkbox-label[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:20px;width:20px;background-color:#eee;border-radius:3px}.checkbox-label[_ngcontent-%COMP%]:hover   .checkmark[_ngcontent-%COMP%]{background-color:#ccc}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]{background-color:#2196f3}.checkbox-label[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]:after{content:"";position:absolute;display:none}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]:after{display:block}.checkbox-label[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]:after{left:7px;top:3px;width:5px;height:10px;border:solid white;border-width:0 2px 2px 0;transform:rotate(45deg)}']});let t=e;return t})();var Yn=(()=>{let e=class e{constructor(r){this.db=r,this.userDataSubject=new It(null),this.userData$=this.userDataSubject.asObservable(),this.dbPath="/user",this.usersRef=r.list(this.dbPath)}setUserData(r){this.userDataSubject.next(r)}addUser(r){this.usersRef.push(r)}getAllC(){return this.usersRef.snapshotChanges().pipe(B(r=>r.map(i=>({key:i.payload.key,data:i.payload.val()})).filter(i=>i.data.Confirmed===!0)))}checkIfUserExists(r,i){return this.user=this.usersRef.snapshotChanges().pipe(B(s=>s.map(o=>({key:o.payload.key,data:o.payload.val()})).find(o=>o.data.Email===r&&o.data.Mdp===i)?.data)),this.user}getAllU(){return this.usersRef.snapshotChanges().pipe(B(r=>r.map(i=>({key:i.payload.key,data:i.payload.val()})).filter(i=>i.data.Confirmed===!1)))}removeUser(r){return this.usersRef.remove(r)}confirmUser(r){return this.usersRef.update(r,{Confirmed:!0})}unconfirmUser(r){return this.usersRef.update(r,{Confirmed:!1})}};e.\u0275fac=function(i){return new(i||e)(x(Mi))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var YL=(()=>{let e=class e{constructor(r,i){this.router=r,this.userService=i,this.user=null,this.fullName=""}ngOnInit(){this.user=this.userService.user,this.user!=null&&this.user.subscribe(r=>{this.fullName=r.Prenom+" "+r.Nom;let i=document.getElementById("name");i&&(i.textContent=this.fullName),console.log(r)})}goToForm(){this.router.navigate(["/form"])}goToFiltre(){this.router.navigate(["/filtre"])}};e.\u0275fac=function(i){return new(i||e)(W(Mt),W(Yn))},e.\u0275cmp=ot({type:e,selectors:[["app-accueil"]],decls:75,vars:0,consts:[["lang","fr"],["rel","preconnect","href","https://fonts.googleapis.com"],["rel","preconnect","href","https://fonts.gstatic.com","crossorigin",""],["href","https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap","rel","stylesheet"],["charset","UTF-8"],["name","viewport","content","width=device-width, initial-scale=1.0"],[1,"container"],[1,"sidebar"],["src","assets/images/logo.jpg","alt","Supernova",1,"logo"],[1,"profile"],["src","assets/images/profile.png","alt","Profile Picture"],["id","name",1,"name"],[1,"active"],["href","#"],["src","assets/images/home.png","alt","home",1,"padding-right"],["href","wishlist"],["src","assets/images/heart.png","alt","Favorie",1,"padding-right"],["href","projects"],["src","assets/images/folder.png","alt","Projet",1,"padding-right"],[1,"settings"],["src","assets/images/logout.png","alt","Logout",1,"padding-right"],["href","login"],[1,"main-content"],[1,"welcome"],[1,"bold"],[1,"widgets"],[1,"widget"],["src","assets/images/logo.png","alt","Assistant"],["src","assets/images/loupe.png","alt","Filter"],[1,"buttons"],[3,"click"],[1,"concepts"],[1,"concepts-grid"],[1,"concept"]],template:function(i,s){i&1&&(f(0,"html",0)(1,"head"),D(2,"link",1)(3,"link",2)(4,"link",3)(5,"meta",4)(6,"meta",5),f(7,"title"),m(8,"Supernova"),p()(),f(9,"body")(10,"div",6)(11,"aside",7),D(12,"img",8)(13,"br"),f(14,"div",9),D(15,"img",10),f(16,"h2",11),m(17,"Majeri Amine"),p(),f(18,"p"),m(19,"Voir et modifier le profile"),p()(),f(20,"nav")(21,"ul")(22,"li",12)(23,"a",13),D(24,"img",14),m(25," Accueil "),p()(),f(26,"li")(27,"a",15),D(28,"img",16),m(29," Favoris "),p()(),f(30,"li")(31,"a",17),D(32,"img",18),m(33," Projet"),p()()()(),f(34,"div",19)(35,"ul")(36,"li"),D(37,"img",20),f(38,"a",21),m(39," Logout"),p()()()()(),f(40,"main",22)(41,"section",23)(42,"h1"),m(43,"Bienvenue !"),p(),f(44,"p"),m(45,"Pour trouver les solutions d'\xE9clairage les plus pertinentes pour vos projets, c'est par ici !"),p(),f(46,"p",24),m(47,"Trouvez le moyen le plus simple pour vous !"),p(),f(48,"div",25)(49,"div",26),D(50,"img",27),f(51,"p"),m(52,"Laissez-vous aider par l\u2019assistant Supernova"),p()(),f(53,"div",26),D(54,"img",28),f(55,"p"),m(56,"Recherchez parmis des milliers de produits"),p()()(),f(57,"div",29)(58,"button",30),A("click",function(){return s.goToForm()}),m(59,"Par l'assistant"),p(),f(60,"button",30),A("click",function(){return s.goToFiltre()}),m(61,"Par le filtre"),p()()(),f(62,"section",31)(63,"h2",24),m(64,"Mes concepts \xE9clairage"),p(),f(65,"div",32)(66,"div",33)(67,"h3"),m(68,"Maison Annecy"),p()(),f(69,"div",33)(70,"h3"),m(71,"Chalet"),p()(),f(72,"div",33)(73,"h3"),m(74,"Restaurant"),p()()()()()()()())},styles:['*[_ngcontent-%COMP%]{box-sizing:border-box;margin:0;padding:0;font-family:Montserrat,sans-serif}body[_ngcontent-%COMP%]{display:flex;height:100vh;background-color:#f0f4f8}.container[_ngcontent-%COMP%]{display:flex;width:100%}.padding-right[_ngcontent-%COMP%]{padding-right:10px}.sidebar[_ngcontent-%COMP%]{width:20%;background-color:#fff;padding:20px;box-shadow:2px 0 5px #0000001a}.profile[_ngcontent-%COMP%]{text-align:center;margin-bottom:40px}.profile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;margin-bottom:10px}.profile[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;margin-bottom:5px}.profile[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#888}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:20px 0}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;font-size:16px;color:#333;display:flex;align-items:center}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#4a90e2}.settings[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;margin-top:40px}.settings[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:20px 0}.settings[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;font-size:16px;color:#333}.settings[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#4a90e2}.main-content[_ngcontent-%COMP%]{flex:1;padding:40px}.welcome[_ngcontent-%COMP%]{background:url("./media/background-QQ5WNRMO.png") no-repeat center center;background-size:cover;padding:40px;border-radius:10px;color:#fff;text-align:center;margin-bottom:40px}.welcome[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{width:60%;font-weight:700;text-align:left;font-size:36px;margin-bottom:20px}.bold[_ngcontent-%COMP%]{font-weight:700}.welcome[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{width:60%;text-align:left;font-size:18px;margin-bottom:20px}.welcome[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;gap:38px;padding-left:20px}.logo[_ngcontent-%COMP%]{padding-top:50px;padding-bottom:30px}.welcome[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#333;border:none;color:#fff;padding:10px 20px;border-radius:30px;cursor:pointer;font-size:16px;width:250px}.widgets[_ngcontent-%COMP%]{display:flex;gap:70px;color:#000;padding:30px;border-radius:30px}.widget[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:220px;padding:20px;background-color:#fff;border-radius:10px;box-shadow:0 2px 5px #0000001a;text-align:center}.widget[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;text-align:center;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;width:100%}.widget[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60px;height:60px;margin-top:40px;margin-bottom:40px}.welcome[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#4a90e2}.concepts[_ngcontent-%COMP%]{text-align:center}.concepts[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;margin-bottom:20px}.concepts-grid[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:20px}.concept[_ngcontent-%COMP%]{background-color:#fff;border-radius:10px;padding:20px;width:200px;box-shadow:0 2px 5px #0000001a;text-align:center}.concept[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;margin-bottom:10px}']});let t=e;return t})();var mc=(()=>{let e=class e{constructor(r){this.db=r,this.dbPath="/RepQuest",this.responsesRef=r.list(this.dbPath)}getAll(){return this.responsesRef}create(r){return this.responsesRef.push(r)}update(r,i){return this.responsesRef.update(r,i)}delete(r){return this.responsesRef.remove(r)}deleteAll(){return this.responsesRef.remove()}saveResponsesToFirebase(r){let i=[];return r.forEach(s=>{i.push(this.create(s).then(()=>console.log("Response saved:",s)))}),Promise.all(i)}getResponsesByStyle(r,i,s,o,a){return this.db.list(this.dbPath,l=>l.orderByChild("style").equalTo(r).orderByChild("Espace_a_traiter").equalTo(i).orderByChild("Finition").equalTo(s).orderByChild("Forme").equalTo(o).orderByChild("Materiaux_de_surface_de_pose").equalTo(a))}clearDatabase(){return C(this,null,function*(){console.log("removing responses");let r=yield this.responsesRef.snapshotChanges().pipe(Rn(1)).toPromise(),i=[];return r.forEach(s=>{i.push(this.responsesRef.remove(s.key))}),Promise.all(i)})}};e.\u0275fac=function(i){return new(i||e)(x(Mi))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var X_=(()=>{let e=class e{constructor(r){this.db=r,this.dbPath="/project",this.projectsRef=r.list(this.dbPath)}addProject(r){this.projectsRef.push(r)}getAll(){return this.projectsRef}removeProject(r){return this.projectsRef.remove(r)}updateProject(r,i){return this.projectsRef.update(r,i)}};e.\u0275fac=function(i){return new(i||e)(x(Mi))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function LQ(t,e){if(t&1){let n=Y();f(0,"div")(1,"h4",6),m(2,"La cr\xE9ation du projet va d\xE9marrer"),p(),f(3,"div",7)(4,"div",8),D(5,"img",9),f(6,"h5",6),m(7,"C\u2019est Rapide !"),p(),f(8,"p"),m(9,"Le questionnaire prend moins de 5 minutes, aucun document n\u2019est n\xE9cessaire."),p()(),f(10,"div",8),D(11,"img",10),f(12,"h5",6),m(13,"On vous accompagne"),p(),f(14,"p"),m(15,"Nos experts r\xE9pondent \xE0 toutes vos questions par chat ou par t\xE9l\xE9phone dans 24H maximum"),p()(),f(16,"div",8),D(17,"img",11),f(18,"h5",6),m(19,"On s\u2019occupe de tout !"),p(),f(20,"p"),m(21,"Vos produits trouv\xE9s et votre projet finalis\xE9 en un temps record !"),p()()(),f(22,"div",12)(23,"button",13),A("click",function(){N(n);let i=E();return k(i.goToHome())}),m(24,"Pr\xE9c\xE9dent"),p(),f(25,"button",13),A("click",function(){N(n);let i=E();return k(i.onNextButtonClick())}),m(26,"Suivant"),p()()()}}function jQ(t,e){if(t&1){let n=Y();f(0,"div"),D(1,"img",14),f(2,"h4",15),m(3,"Comment s'appelle votre projet ?"),p(),f(4,"div",16)(5,"input",17),A("ngModelChange",function(i){N(n);let s=E();return k(s.projectName=i)}),p()(),D(6,"br"),f(7,"div",12)(8,"button",13),A("click",function(){N(n);let i=E();return k(i.onBackButtonClick())}),m(9,"Pr\xE9c\xE9dent"),p(),f(10,"button",13),A("click",function(){N(n);let i=E();return k(i.onNextStepButtonClick())}),m(11,"Suivant"),p()()()}if(t&2){let n=E();_(5),S("ngModel",n.projectName)}}function UQ(t,e){if(t&1){let n=Y();f(0,"div")(1,"p"),m(2," Quel est"),p(),f(3,"h4",6),m(4,"Le standing de votre projet ?"),p(),f(5,"div",18)(6,"div",19),A("click",function(){N(n);let i=E();return k(i.selectWidget("Petit budget"))}),D(7,"img",20),p(),f(8,"p",21),m(9,"Entr\xE9e de gamme"),p()(),f(10,"div",18)(11,"div",19),A("click",function(){N(n);let i=E();return k(i.selectWidget("Moyen standing"))}),D(12,"img",22),p(),f(13,"p",21),m(14,"Moyen standing"),p()(),f(15,"div",18)(16,"div",19),A("click",function(){N(n);let i=E();return k(i.selectWidget("Luxe / Haut de gamme"))}),D(17,"img",23),p(),f(18,"p",21),m(19,"Luxe / Haut de gamme"),p()(),D(20,"br"),f(21,"div",12)(22,"button",13),A("click",function(){N(n);let i=E();return k(i.onStandingToStyle())}),m(23,"Pr\xE9c\xE9dent"),p(),f(24,"button",13),A("click",function(){N(n);let i=E();return k(i.onEspaceButtonClick())}),m(25,"Suivant"),p()()()}if(t&2){let n=E();_(6),Se("selected",n.selectedWidget==="Petit budget"),_(5),Se("selected",n.selectedWidget==="Moyen standing"),_(5),Se("selected",n.selectedWidget==="Luxe / Haut de gamme")}}function BQ(t,e){if(t&1){let n=Y();f(0,"div")(1,"p"),m(2," Quel est"),p(),f(3,"h4",6),m(4,"Le style architectural du projet ?"),p(),f(5,"div",18)(6,"div",24),A("click",function(){N(n);let i=E();return k(i.selectStyle("Sobre & minimaliste"))}),D(7,"img",25),p(),f(8,"p",21),m(9,"Sobre & Minimaliste"),p()(),f(10,"div",18)(11,"div",24),A("click",function(){N(n);let i=E();return k(i.selectStyle("Moderne"))}),D(12,"img",26),p(),f(13,"p",21),m(14,"Moderne"),p()(),f(15,"div",18)(16,"div",24),A("click",function(){N(n);let i=E();return k(i.selectStyle("Couleurs vives"))}),D(17,"img",27),p(),f(18,"p",21),m(19,"Couleurs vives"),p()(),f(20,"div",18)(21,"div",24),A("click",function(){N(n);let i=E();return k(i.selectStyle("industriel"))}),D(22,"img",28),p(),f(23,"p",21),m(24,"Industrial"),p()(),f(25,"div",18)(26,"div",24),A("click",function(){N(n);let i=E();return k(i.selectStyle("Ecologiste"))}),D(27,"img",29),p(),f(28,"p",21),m(29,"Ecologiste"),p()(),f(30,"div",18)(31,"div",24),A("click",function(){N(n);let i=E();return k(i.selectStyle("Style ancien"))}),D(32,"img",30),p(),f(33,"p",21),m(34,"Styles anciens"),p()(),D(35,"br"),f(36,"div",12)(37,"button",13),A("click",function(){N(n);let i=E();return k(i.onStyleToType())}),m(38,"Pr\xE9c\xE9dent"),p(),f(39,"button",13),A("click",function(){N(n);let i=E();return k(i.onStandingButtonClick())}),m(40,"Suivant"),p()()()}if(t&2){let n=E();_(6),Se("selected",n.selectedStyle==="Sobre & minimaliste"),_(5),Se("selected",n.selectedStyle==="Moderne"),_(5),Se("selected",n.selectedStyle==="Couleurs vives"),_(5),Se("selected",n.selectedStyle==="industriel"),_(5),Se("selected",n.selectedStyle==="Ecologiste"),_(5),Se("selected",n.selectedStyle==="Style ancien")}}function $Q(t,e){if(t&1){let n=Y();f(0,"div",18)(1,"div",32),A("click",function(){let s=N(n).$implicit,o=E(2);return k(o.selectSegment(s.value))}),D(2,"img",33),p(),f(3,"p",21),m(4),p()()}if(t&2){let n=e.$implicit,r=E(2);_(1),Se("selected",r.selectedSegment===n.value),_(1),S("src",n.image,Qe)("alt",n.alt),_(2),ee(n.label)}}function HQ(t,e){if(t&1){let n=Y();f(0,"div")(1,"p"),m(2," Quel est"),p(),f(3,"h4",6),m(4,"Le segment du projet ?"),p(),Z(5,$Q,5,5,"div",31),f(6,"div",12)(7,"button",13),A("click",function(){N(n);let i=E();return k(i.ongoBack())}),m(8,"Pr\xE9c\xE9dent"),p(),f(9,"button",13),A("click",function(){N(n);let i=E();return k(i.onStandingButtonClick())}),m(10,"Suivant"),p()(),D(11,"br"),p()}if(t&2){let n=E();_(5),S("ngForOf",n.currentSegments)}}function qQ(t,e){if(t&1){let n=Y();f(0,"div",18)(1,"div",24),A("click",function(){let s=N(n).$implicit,o=E(2);return k(o.selectType(s.value))}),D(2,"img",33),p(),f(3,"p",21),m(4),p()()}if(t&2){let n=e.$implicit,r=E(2);_(1),Se("selected",r.selectedType===n.value),_(1),S("src",n.image,Qe)("alt",n.alt),_(2),ee(n.label)}}function zQ(t,e){if(t&1){let n=Y();f(0,"div")(1,"p"),m(2," Quel est"),p(),f(3,"h4",6),m(4,"Le type du projet ?"),p(),Z(5,qQ,5,5,"div",31),D(6,"br"),f(7,"div",12)(8,"button",13),A("click",function(){N(n);let i=E();return k(i.onSegmentButtonClick())}),m(9,"Pr\xE9c\xE9dent"),p(),f(10,"button",13),A("click",function(){N(n);let i=E();return k(i.onStyleButtonClick())}),m(11,"Suivant"),p()()()}if(t&2){let n=E();_(5),S("ngForOf",n.types[n.selectedSegment])}}function GQ(t,e){if(t&1){let n=Y();f(0,"div",18)(1,"div",24),A("click",function(){let s=N(n).$implicit,o=E(2);return k(o.selectEspace(s.value))}),D(2,"img",33),p(),f(3,"p",21),m(4),p()()}if(t&2){let n=e.$implicit,r=E(2);_(1),Se("selected",r.selectedEspaces.includes(n.value)),_(1),S("src",n.image,Qe)("alt",n.alt),_(2),ee(n.label)}}function WQ(t,e){if(t&1){let n=Y();f(0,"div")(1,"p"),m(2," Pourriez vous"),p(),f(3,"h4",6),m(4,"indiquer l'espace \xE0 \xE9tudier dans votre projet ?"),p(),Z(5,GQ,5,5,"div",31),D(6,"br"),f(7,"div",12)(8,"button",13),A("click",function(){N(n);let i=E();return k(i.onEspaceToNext())}),m(9,"Pr\xE9c\xE9dent"),p(),f(10,"button",13),A("click",function(){N(n);let i=E();return k(i.onSurfaceButtonClick())}),m(11,"Suivant"),p()()()}if(t&2){let n=E();_(5),S("ngForOf",n.espaces)}}function KQ(t,e){if(t&1){let n=Y();f(0,"div",18)(1,"div",24),A("click",function(){let s=N(n).$implicit,o=E().$implicit,a=E(2);return k(a.selectSurface(o,s.value))}),D(2,"img",33),p(),f(3,"p",21),m(4),p()()}if(t&2){let n=e.$implicit,r=E().$implicit,i=E(2);_(1),Se("selected",i.selectedSurface[r]===n.value),_(1),S("src",n.image,Qe)("alt",n.alt),_(2),ee(n.label)}}function QQ(t,e){if(t&1&&(f(0,"div")(1,"h4",6),m(2),p(),Z(3,KQ,5,5,"div",31),p()),t&2){let n=e.$implicit,r=E(2);_(2),Le("la surface de pose pour ",n," ?"),_(1),S("ngForOf",r.surfaces)}}function YQ(t,e){if(t&1){let n=Y();f(0,"div")(1,"p"),m(2,"Quel est"),p(),Z(3,QQ,4,2,"div",34),D(4,"br"),f(5,"div",12)(6,"button",13),A("click",function(){N(n);let i=E();return k(i.onSurfaceToEspace())}),m(7,"Pr\xE9c\xE9dent"),p(),f(8,"button",13),A("click",function(){N(n);let i=E();return k(i.onPoseButtonClick())}),m(9,"Suivant"),p()()()}if(t&2){let n=E();_(3),S("ngForOf",n.selectedEspaces)}}function JQ(t,e){if(t&1){let n=Y();f(0,"div",18)(1,"div",24),A("click",function(){let s=N(n).$implicit,o=E().$implicit,a=E(2);return k(a.selectPose(o,s.value))}),D(2,"img",33),p(),f(3,"p",21),m(4),p()()}if(t&2){let n=e.$implicit,r=E().$implicit,i=E(2);_(1),Se("selected",i.selectedPose[r]===n.value),_(1),S("src",n.image,Qe)("alt",n.alt),_(2),ee(n.label)}}function ZQ(t,e){if(t&1&&(f(0,"div")(1,"h4",6),m(2),p(),Z(3,JQ,5,5,"div",31),p()),t&2){let n=e.$implicit,r=E(2);_(2),ka("le mode de pose possible pour les luminaires au ",r.selectedSurface[n]," de ",n," ?"),_(1),S("ngForOf",r.poses[r.selectedSurface[n]])}}function XQ(t,e){if(t&1){let n=Y();f(0,"div")(1,"p"),m(2,"Quel est"),p(),Z(3,ZQ,4,3,"div",34),D(4,"br"),f(5,"div",12)(6,"button",13),A("click",function(){N(n);let i=E();return k(i.onModeToSurface())}),m(7,"Pr\xE9c\xE9dent"),p(),f(8,"button",13),A("click",function(){N(n);let i=E();return k(i.onMaterialClickButton())}),m(9,"Suivant"),p()()()}if(t&2){let n=E();_(3),S("ngForOf",n.selectedEspaces)}}function eY(t,e){if(t&1){let n=Y();f(0,"div",18)(1,"div",35),A("click",function(){let s=N(n).$implicit,o=E().$implicit,a=E(2);return k(a.selectMaterial(o,s.value))}),D(2,"img",33),p(),f(3,"p",21),m(4),p()()}if(t&2){let n=e.$implicit,r=E().$implicit,i=E(2);_(1),Se("selected",i.selectedMaterial[r]===n.value),_(1),S("src",n.image,Qe)("alt",n.alt),_(2),ee(n.label)}}function tY(t,e){if(t&1&&(f(0,"div")(1,"h4",6),m(2),p(),Z(3,eY,5,5,"div",31),p()),t&2){let n=e.$implicit,r=E(2);_(2),Le("Le mat\xE9riau de la surface de pose pour ",n," ?"),_(1),S("ngForOf",r.materials)}}function nY(t,e){if(t&1){let n=Y();f(0,"div")(1,"p"),m(2,"Quel est"),p(),Z(3,tY,4,2,"div",34),D(4,"br"),f(5,"div",12)(6,"button",13),A("click",function(){N(n);let i=E();return k(i.onMaterialToMode())}),m(7,"Pr\xE9c\xE9dent"),p(),f(8,"button",13),A("click",function(){N(n);let i=E();return k(i.onHauteurClickButton())}),m(9,"Suivant"),p()()()}if(t&2){let n=E();_(3),S("ngForOf",n.selectedEspaces)}}function rY(t,e){if(t&1){let n=Y();f(0,"div")(1,"h4",6),m(2),p(),D(3,"br"),f(4,"input",36),A("ngModelChange",function(i){let o=N(n).$implicit,a=E(2);return k(a.selectedHauteur[o]=i)}),p()()}if(t&2){let n=e.$implicit,r=E(2);_(2),Le("La hauteur sous plafond de ",n," ?"),_(2),Ra("id","input-h-",n,""),S("ngModel",r.selectedHauteur[n])}}function iY(t,e){if(t&1){let n=Y();f(0,"div")(1,"p"),m(2,"Quel est"),p(),Z(3,rY,5,3,"div",34),D(4,"br"),f(5,"div",12)(6,"button",13),A("click",function(){N(n);let i=E();return k(i.onHauteurToMaterial())}),m(7,"Pr\xE9c\xE9dent"),p(),f(8,"button",13),A("click",function(){N(n);let i=E();return k(i.onFormeButtonClick())}),m(9,"Suivant"),p()()()}if(t&2){let n=E();_(3),S("ngForOf",n.selectedEspaces)}}function sY(t,e){if(t&1){let n=Y();f(0,"div",18)(1,"div",24),A("click",function(){let s=N(n).$implicit,o=E().$implicit,a=E(2);return k(a.selectForme(s.value,o))}),D(2,"img",33),p(),f(3,"p",21),m(4),p()()}if(t&2){let n=e.$implicit,r=E().$implicit,i=E(2);_(1),Se("selected",i.selectedForme[r]===n.value),_(1),S("src",n.image,Qe)("alt",n.alt),_(2),ee(n.label)}}function oY(t,e){if(t&1&&(f(0,"div")(1,"h4",6),m(2),p(),Z(3,sY,5,5,"div",31),p()),t&2){let n=e.$implicit,r=E(2);_(2),Le("De luminaires pr\xE9f\xE9rez-vous pour ",n,"?"),_(1),S("ngForOf",r.formes)}}function aY(t,e){if(t&1){let n=Y();f(0,"div")(1,"p"),m(2,"Quelle forme"),p(),Z(3,oY,4,2,"div",34),D(4,"br"),f(5,"div",12)(6,"button",13),A("click",function(){N(n);let i=E();return k(i.onFormeToHauteur())}),m(7,"Pr\xE9c\xE9dent"),p(),f(8,"button",13),A("click",function(){N(n);let i=E();return k(i.onFinitionClickButton())}),m(9,"Suivant"),p()()()}if(t&2){let n=E();_(3),S("ngForOf",n.selectedEspaces)}}function lY(t,e){if(t&1){let n=Y();f(0,"div")(1,"h4",6),m(2),p(),f(3,"div",37)(4,"div",38)(5,"div",39),A("click",function(){let s=N(n).$implicit,o=E(2);return k(o.selectFinition("Gris",s))}),p(),f(6,"p",21),m(7,"Gris"),p()(),f(8,"div",38)(9,"div",40),A("click",function(){let s=N(n).$implicit,o=E(2);return k(o.selectFinition("Noir",s))}),p(),f(10,"p",21),m(11,"Noir"),p()(),f(12,"div",38)(13,"div",24),A("click",function(){let s=N(n).$implicit,o=E(2);return k(o.selectFinition("Blanc",s))}),p(),f(14,"p",21),m(15,"Blanc"),p()(),f(16,"div",38)(17,"div",24),A("click",function(){let s=N(n).$implicit,o=E(2);return k(o.selectFinition("auchoix",s))}),D(18,"img",41),p(),f(19,"p",21),m(20,"Au choix"),p()(),f(21,"div",38)(22,"div",24),A("click",function(){let s=N(n).$implicit,o=E(2);return k(o.selectFinition("autre",s))}),D(23,"img",41),p(),f(24,"p",21),m(25,"Autre"),p()()()()}if(t&2){let n=e.$implicit,r=E(2);_(2),Le("Finition pr\xE9f\xE9rez-vous pour ",n,"?"),_(3),Se("selected",r.selectedFinition[n]==="Gris"),_(4),Se("selected",r.selectedFinition[n]==="Noir"),_(4),Se("selected",r.selectedFinition[n]==="Blanc"),_(4),Se("selected",r.selectedFinition[n]==="auchoix"),_(5),Se("selected",r.selectedFinition[n]==="autre")}}function cY(t,e){if(t&1){let n=Y();f(0,"div")(1,"p"),m(2,"Quelle"),p(),Z(3,lY,26,11,"div",34),D(4,"br"),f(5,"div",12)(6,"button",13),A("click",function(){N(n);let i=E();return k(i.onFinitionToForme())}),m(7,"Pr\xE9c\xE9dent"),p(),f(8,"button",13),A("click",function(){N(n);let i=E();return k(i.getResults())}),m(9,"Suivant"),p()()()}if(t&2){let n=E();_(3),S("ngForOf",n.selectedEspaces)}}function uY(t,e){if(t&1){let n=Y();f(0,"div",52),A("click",function(){let s=N(n).$implicit,o=E(2);return k(o.selectCurrentEspace(s))}),D(1,"img",33),f(2,"p"),m(3),p()()}if(t&2){let n=e.$implicit,r=E(2);Se("selected",n===r.selectedEspace),_(1),S("src",n.image,Qe)("alt",n.alt),_(2),ee(n.label)}}function dY(t,e){if(t&1){let n=Y();f(0,"div",53),D(1,"img",54),f(2,"p",55),m(3),p(),f(4,"p"),m(5),p(),f(6,"div",56)(7,"button",57),m(8,"\u2764\uFE0F"),p(),f(9,"button",58),A("click",function(){let s=N(n).$implicit,o=E(2);return k(o.showDetailsP(s))}),m(10,"\u27A1\uFE0F"),p()()()}if(t&2){let n=e.$implicit,r=E(2);Se("selected",r.projectProducts[r.selectedEspace.label]===n||r.firstShow),_(1),S("src","assets/images/"+n.Photo_luminaire||"assets/images/l1.png",Qe),_(2),ee(n.Marque),_(2),Le(" ",n.Modele,"")}}function hY(t,e){if(t&1){let n=Y();f(0,"div",42)(1,"div",43)(2,"div",44),m(3,"\u2190"),p(),f(4,"p",45),m(5," R\xE9sultat de "),p(),f(6,"div",46),Z(7,uY,4,5,"div",47),p()(),f(8,"div",48)(9,"h2"),m(10,"On a trouv\xE9 \xE7a pour Vous !"),p(),f(11,"p"),m(12),p(),f(13,"div",49),Z(14,dY,11,5,"div",50),p(),f(15,"button",51),A("click",function(){N(n);let i=E();return k(i.nextSpace())}),m(16,"Espace suivant"),p()()()}if(t&2){let n=E();_(7),S("ngForOf",n.filteredEspaces),_(5),Le("",n.selectedProducts.length," R\xE9sultats"),_(2),S("ngForOf",n.selectedProducts)}}function fY(t,e){if(t&1){let n=Y();f(0,"div",59)(1,"div",60)(2,"div",61),D(3,"img",62),f(4,"button",63),A("click",function(){N(n);let i=E();return k(i.goBack())}),m(5,"\u2190"),p(),f(6,"button",64),m(7),p()(),D(8,"br"),f(9,"div",65),D(10,"img",66),f(11,"h2"),m(12),p(),f(13,"p"),m(14),p(),f(15,"div",67)(16,"p")(17,"strong"),m(18,"Description"),p()(),f(19,"p"),m(20),p(),f(21,"p")(22,"b"),m(23,"Type: "),p(),m(24),p(),f(25,"p")(26,"b"),m(27,"Puissance: "),p(),m(28),p(),f(29,"p")(30,"b"),m(31,"Forme: "),p(),m(32),p(),f(33,"p")(34,"b"),m(35,"Temp\xE9rature de couleur : "),p(),m(36),p(),f(37,"p")(38,"b"),m(39,"Faisceau : "),p(),m(40),p(),f(41,"div",68)(42,"p")(43,"strong"),m(44,"Couleur"),p()(),f(45,"div",69),D(46,"div",70)(47,"div",71)(48,"div",72),p()(),f(49,"button",73),A("click",function(){N(n);let i=E();return k(i.send(i.selectedProduct))}),m(50," \u{1F6D2} Ajouter au projet"),p()()()()()}if(t&2){let n=E();_(3),S("src",n.selectedProduct!=null&&n.selectedProduct.Photo_projet?"assets/images/"+n.selectedProduct.Photo_projet:"assets/images/chambre.jpg",Qe),_(3),Se("added",n.selectedProduct.inWishlist),_(1),Le(" ",n.selectedProduct.inWishlist?"\u2764\uFE0F":"\u2661"," "),_(3),S("src","assets/images/"+n.selectedProduct.Photo_luminaire,Qe),_(2),ee(n.selectedProduct.Marque),_(2),ee(n.selectedProduct.Modele),_(6),ee(n.selectedProduct.Description),_(4),ee(n.selectedProduct.Type),_(4),ee(n.selectedProduct.Puissance),_(4),ee(n.selectedProduct.Forme),_(4),ee(n.selectedProduct.Temperature_de_couleur),_(4),ee(n.selectedProduct.Faisceau)}}function pY(t,e){if(t&1&&(f(0,"div",82),D(1,"img",33),f(2,"div",65)(3,"h2"),m(4),p(),f(5,"p"),m(6),p(),f(7,"p"),m(8,"Couleur - Noir"),p(),f(9,"a",83),m(10),p()()()),t&2){let n=e.$implicit;_(1),S("src",n.image||"https://tekled.co.uk/cdn/shop/articles/What_is_a_Conventional_Light-775007.jpg?v=1680528977",Qe)("alt",n.Marque),_(3),ee(n.Marque),_(2),ee(n.label),_(4),ee(n.Espace)}}function gY(t,e){if(t&1){let n=Y();f(0,"div",42)(1,"header")(2,"button",74),m(3,"\u2190"),p(),f(4,"h1"),m(5,"Mon panier"),p(),f(6,"button",75),m(7,"\xD7"),p()(),f(8,"main")(9,"div",76),Z(10,pY,11,5,"div",77),p(),f(11,"form",78)(12,"label"),D(13,"input",79),m(14," T\xE9l\xE9charger le concept \xE9clairage "),p(),f(15,"label"),D(16,"input",80),m(17," obtenir une estimation financi\xE8re "),p(),f(18,"label"),D(19,"input",80),m(20," Essayer les produits en demo "),p()(),f(21,"button",81),A("click",function(){N(n);let i=E();return k(i.showManu())}),m(22,"Envoyer"),p()()()}if(t&2){let n=E();_(10),S("ngForOf",n.projectProducts)}}function mY(t,e){if(t&1){let n=Y();f(0,"div",84)(1,"button",63),A("click",function(){N(n);let i=E();return k(i.goBackToD())}),m(2,"\u2190"),p(),f(3,"div",85)(4,"h1"),m(5,"C'est tout bon pour nous !"),p(),f(6,"p"),m(7,"Je m'appelle Alban, je suis votre interlocuteur fabricant, et je reviendrai vers vous le plus t\xF4t possible"),p(),f(8,"div",86),D(9,"img",87),f(10,"div",88)(11,"p")(12,"strong"),m(13,"Alban Grison"),p()(),f(14,"p"),m(15,"CEO K-Design House"),p(),f(16,"p"),m(17,"a.grisonk-designhouse.com"),p(),f(18,"p"),m(19,"+33 6 43 17 29 79"),p()()(),f(20,"button",89),A("click",function(){N(n);let i=E();return k(i.returnToMenu())}),m(21,"Revenir au menu"),p()()()}}var ZL=(()=>{let e=class e{constructor(r,i,s,o){this.productService=r,this.responseService=i,this.router=s,this.projectService=o,this.correspondingProducts=[],this.showProjectNameQuestion=!1,this.projectName="",this.showPreviousQuestion=!0,this.showNextPage=!1,this.selectedWidget="",this.showProjectProducts=!1,this.showStyle=!1,this.showManufacture=!1,this.showSegment=!1,this.showType=!1,this.showEspace=!1,this.showSurface=!1,this.showPose=!1,this.showFinition=!1,this.showMaterial=!1,this.showHauteur=!1,this.showForme=!1,this.showResponse=!1,this.showDetails=!1,this.firstShow=!0,this.selectedSegment="",this.selectedStyle="",this.selectedType="",this.selectedEspaces=[],this.projectProducts=[],this.selectedEspace={value:"",label:"",image:"",alt:""},this.selectedSurface={},this.selectedPose={},this.selectedMaterial={},this.selectedHauteur={},this.selectedForme={},this.selectedFinition={},this.filteredEspaces=[],this.unsubscribe$=new ut,this.formes=[{value:"Rond",label:"Rond",image:"assets/images/rond.png",alt:"Image 1"},{value:"Carr\xE9",label:"Carr\xE9",image:"assets/images/carre.png",alt:"Image 2"},{value:"Rectangulaire",label:"Rectangulaire",image:"assets/images/rectangulaire.svg",alt:"Image 3"},{value:"Lin\xE9aire",label:"Lin\xE9aire",image:"assets/images/ligne.png",alt:"Image 4"},{value:" ",label:"Je ne sais pas",image:"assets/images/jesaispas.jpg",alt:"Image 4"}],this.materials=[{value:"Bois",label:"Bois",image:"assets/images/bois.webp",alt:"Image 1"},{value:"Brique",label:"Brique",image:"assets/images/brique.jpg",alt:"Image 2"},{value:"Placo",label:"Pl\xE2tre",image:"assets/images/platre.jpg",alt:"Image 4"},{value:"Gravier",label:"Gravier",image:"assets/images/gravier.jpg",alt:"Image 5"},{value:"Beton",label:"B\xE9ton",image:"assets/images/beton.jpg",alt:"Image 6"},{value:"Terre v\xE9g\xE9tale",label:"Terre v\xE9g\xE9tale",image:"assets/images/terre.jpg",alt:"Image 7"}],this.poses={Plafond:[{value:"Suspendu",label:"Suspendu",image:"assets/images/suspendu.jpg",alt:"Pose 2"},{value:"Encastr\xE9",label:"Encastr\xE9",image:"assets/images/encastr\xE9.jpg",alt:"Pose 1"},{value:"En saillie",label:"En saillie",image:"assets/images/en_saillie.jpg",alt:"Pose 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Pose 5"}],Mur:[{value:"En saillie",label:"En saillie",image:"assets/images/saillie2.jpg",alt:"Pose 2"},{value:"Encastr\xE9",label:"Encastr\xE9",image:"assets/images/encastr\xE92.jpg",alt:"Pose 1"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Pose 5"}],Sol:[{value:"Encastr\xE9",label:"Encastr\xE9",image:"assets/images/encastr\xE93.jpg",alt:"Pose 1"},{value:"En saillie",label:"En saillie",image:"assets/images/en_saillie3.jpg",alt:"Pose 2"},{value:"Sur mat",label:"Sur m\xE2t",image:"assets/images/sur_mat.jpg",alt:"Pose 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Pose 5"}]},this.surfaces=[{value:"Mur",label:"Mur",image:"assets/images/mur.jpg",alt:"Image 1"},{value:"Plafond",label:"Plafond",image:"assets/images/plafond.jpg",alt:"Image 2"},{value:"Sol",label:"Sol",image:"assets/images/sol.jpg",alt:"Image 3"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Image 4"}],this.espaces=[{value:"Chambre",label:"Chambre",image:"assets/images/chambre.jpg",alt:"Image 1"},{value:"Salon / s\xE9jour",label:"Salon / s\xE9jour",image:"assets/images/salon.jpg",alt:"Image 2"},{value:"Cuisine",label:"Cuisine",image:"assets/images/cuisine.jpg",alt:"Image 3"},{value:"Salle de bain",label:"Salle de bain",image:"assets/images/salle_de_bain.jpg",alt:"Image 4"},{value:"Abords exterieur",label:"Abords exterieur",image:"assets/images/bandelerie.jpg",alt:"Image 6"},{value:"Couloir",label:"Couloir",image:"assets/images/couloir.jpg",alt:"Image 6"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Image 3"}],this.types={R\u00E9sidentiel:[{value:"Chateau",label:"Chateau",image:"assets/images/chateau.jpeg",alt:"Type 1 Alt 1"},{value:"Appartement",label:"Appartement",image:"assets/images/appartement.jpg",alt:"Type 1 Alt 2"},{value:"Chalet",label:"Ch\xE2let en montagne",image:"assets/images/chalet.jpg",alt:"Type 1 Alt 2"},{value:"Villa",label:"Villa",image:"assets/images/villa.jpg",alt:"Type 1 Alt 2"},{value:"Maison",label:"Maison individuelle",image:"assets/images/maison.jpg",alt:"Type 1 Alt 3"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}],tertaire:[{value:"tour",label:"Tour",image:"assets/images/tour.jpg",alt:"Type 1 Alt 1"},{value:"siege",label:"Si\xE8ge social",image:"assets/images/siege.jpg",alt:"Type 1 Alt 2"},{value:"agence",label:"Agence",image:"assets/images/agence.jpeg",alt:"Type 1 Alt 2"},{value:"administration",label:"Administration",image:"assets/images/administration.png",alt:"Type 1 Alt 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}],shop:[{value:"centreC",label:"Centre commercial",image:"assets/images/centre.jpg",alt:"Type 1 Alt 1"},{value:"distribution",label:"Grandes distribution",image:"assets/images/distribution.jpg",alt:"Type 1 Alt 2"},{value:"boutique",label:"Boutique et petit commerce",image:"assets/images/boutique.jpg",alt:"Type 1 Alt 2"},{value:"grand",label:"Grand magasin",image:"assets/images/magasin.jpg",alt:"Type 1 Alt 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}],education:[{value:"ecole",label:"Ecole/coll\xE8ge/lyc\xE9e",image:"assets/images/ecole.jpg",alt:"Type 1 Alt 1"},{value:"campus",label:"Campus universitaire",image:"assets/images/campus.jpg",alt:"Type 1 Alt 2"},{value:"bibliotheque",label:"Biblioth\xE8que",image:"assets/images/biblio.jpg",alt:"Type 1 Alt 2"},{value:"centreR",label:"Centre de recherche",image:"assets/images/centreR.jpg",alt:"Type 1 Alt 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}],hotellerie:[{value:"hotel",label:"H\xF4tel",image:"assets/images/hotel.jpg",alt:"Type 1 Alt 1"},{value:"restaurant",label:"Restaurant / Bar / Caf\xE9",image:"assets/images/restaurant.jpg",alt:"Type 1 Alt 2"},{value:"soin",label:"Etablissement de soin",image:"assets/images/soin.jpg",alt:"Type 1 Alt 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}],art:[{value:"musee",label:"Mus\xE9e / Exposition",image:"assets/images/mus\xE9e.jpg",alt:"Type 1 Alt 1"},{value:"cinema",label:"Cin\xE9ma / Th\xE9\xE2tre",image:"assets/images/cinema.jpg",alt:"Type 1 Alt 2"},{value:"monument",label:"Monuments historiques",image:"assets/images/monument.jpg",alt:"Type 1 Alt 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}],medical:[{value:"hopital",label:"H\xF4pital / clinique",image:"assets/images/hopital.jpg",alt:"Type 1 Alt 1"},{value:"cabinet",label:"Cabinet m\xE9dical",image:"assets/images/cabinet.jpg",alt:"Type 1 Alt 2"},{value:"pharmacie",label:"Pharmacie",image:"assets/images/pharmacie.jpeg",alt:"Type 1 Alt 2"},{value:"laboratoire",label:"Laboratoire d'analyse",image:"assets/images/labo.jpg",alt:"Type 1 Alt 2"},{value:"centreSante",label:"Centres de sant\xE9 / EHPAD",image:"assets/images/ehpad.jpg",alt:"Type 1 Alt 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}],industriel:[{value:"usine",label:"Usine",image:"assets/images/usine.jpg",alt:"Type 1 Alt 1"},{value:"entrepots",label:"Entrepots logistiques",image:"assets/images/entrepot.jpg",alt:"Type 1 Alt 2"},{value:"atelier",label:"Ateliers",image:"assets/images/atelier.jpg",alt:"Type 1 Alt 2"},{value:"locaux",label:"Locaux techniques",image:"assets/images/locaux.jpg",alt:"Type 1 Alt 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}],parc:[{value:"ecPublic",label:"Eclairage public",image:"assets/images/ec_public.jpg",alt:"Type 1 Alt 1"},{value:"parc",label:"Parc & Jardin",image:"assets/images/parcc.jpg",alt:"Type 1 Alt 2"},{value:"plPublic",label:"Place publique",image:"assets/images/publicc.jpg",alt:"Type 1 Alt 2"},{value:"parking",label:"Parking",image:"assets/images/parking.jpg",alt:"Type 1 Alt 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}],infrastructure:[{value:"aeroport",label:"A\xE9roport",image:"assets/images/a\xE9ro.jpg",alt:"Type 1 Alt 1"},{value:"tunnel",label:"Tunnel",image:"assets/images/tunnel.jpg",alt:"Type 1 Alt 2"},{value:"gare",label:"Gare de train",image:"assets/images/gare.jpg",alt:"Type 1 Alt 2"},{value:"port",label:"Port",image:"assets/images/port.jpg",alt:"Type 1 Alt 2"},{value:"metro",label:"Metro",image:"assets/images/metro.jpg",alt:"Type 1 Alt 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}],sportif:[{value:"terrain",label:"Terrain/Stade",image:"assets/images/stade.jpg",alt:"Type 1 Alt 1"},{value:"piscine",label:"Piscine",image:"assets/images/piscine.jpg",alt:"Type 1 Alt 2"},{value:"gymnase",label:"Gymnase",image:"assets/images/gymnase.jpg",alt:"Type 1 Alt 2"},{value:"salle",label:"Salle de sport",image:"assets/images/salle_sport.jpg",alt:"Type 1 Alt 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}]},this.currentSegments=[{value:"R\xE9sidentiel",label:"R\xE9sidentiel",image:"assets/images/r\xE9sidentielle.jpg",alt:"Image 1"},{value:"education",label:"Education",image:"assets/images/education.jpg",alt:"Image 2"},{value:"tertaire",label:"Tertiaire",image:"assets/images/tertaire.jpg",alt:"Image 3"},{value:"hotellerie",label:"H\xF4tellerie & bien \xEAtre",image:"assets/images/hotelerie.jpg",alt:"Image 4"},{value:"shop",label:"Shop & retail",image:"assets/images/shop&retail.jpg",alt:"Image 5"},{value:"art",label:"Art & culture",image:"assets/images/art.jpg",alt:"Image 6"},{value:"medical",label:"M\xE9dical & centre de soins",image:"assets/images/hopital.jpg",alt:"Image 6"},{value:"infrastructure",label:"Infrastructures",image:"assets/images/infrastructure.jpg",alt:"Image 6"},{value:"industriel",label:"Locaux techniques et industriels",image:"assets/images/industriel.jpg",alt:"Image 6"},{value:"sportif",label:"Sportif",image:"assets/images/sportif.jpg",alt:"Image 6"},{value:"parc",label:"Parcs & milieux urbains",image:"assets/images/parc.jpg",alt:"Image 6"}],this.lastEspac=""}selectWidget(r){this.selectedWidget=r}selectPose(r,i){this.selectedPose[r]=i}selectStyle(r){this.selectedStyle=r}selectType(r){this.selectedType=r}showDetailsP(r){this.showResponse=!1,this.showDetails=!0,this.selectedProduct=r}selectEspace(r){let i=this.selectedEspaces.indexOf(r);i>-1?(this.selectedEspaces.splice(i,1),delete this.selectedSurface[r],delete this.selectedPose[r],delete this.selectedMaterial[r],delete this.selectedHauteur[r],delete this.selectedForme[r],delete this.selectedFinition[r]):this.selectedEspaces.push(r)}selectHauteur(r,i){this.selectedHauteur[i]=r}selectForme(r,i){this.selectedForme[i]=r}selectFinition(r,i){this.selectedFinition[i]=r}selectSurface(r,i){this.selectedSurface[r]=i}selectMaterial(r,i){this.selectedMaterial[r]=i}onFinitionClickButton(){this.showForme=!1,this.showFinition=!0}onMaterialClickButton(){this.showPose=!1,this.showMaterial=!0}onHauteurClickButton(){this.showMaterial=!1,this.showHauteur=!0}onPoseButtonClick(){this.showSurface=!1,this.selectedSurface!=null&&this.selectedSurface!=null?this.showPose=!0:this.showMaterial=!0}selectSegment(r){this.selectedSegment=r,this.showType=!0,this.showSegment=!1}onNextButtonClick(){this.showNextPage=!1,this.showProjectNameQuestion=!0,this.showPreviousQuestion=!1}onNextButtonClick2(){this.selectedStyle!=null&&(this.showNextPage=!1,this.showProjectNameQuestion=!1,this.showPreviousQuestion=!1,this.showStyle=!0)}goToHome(){this.router.navigate(["/accueil"])}onNextButtonClick1(){this.selectedWidget!=null&&(this.showNextPage=!1,this.showProjectNameQuestion=!1,this.showPreviousQuestion=!1,this.showType=!0)}ongoBack(){this.showSegment=!1,this.showType=!1,this.showProjectNameQuestion=!0}onStandingButtonClick(){this.showStyle=!1,this.showNextPage=!0}onSegmentButtonClick(){this.showSegment=!0,this.showType=!1}onFormeButtonClick(){this.showForme=!0,this.showHauteur=!1;let r=document.getElementById("input-h");r!=null&&r.value.trim()!=""&&(this.selectedHauteur=parseInt(r.value.trim()))}onFinitionToForme(){this.showFinition=!1,this.showForme=!0}onFormeToHauteur(){this.showForme=!1,this.showHauteur=!0}onModeToSurface(){this.showPose=!1,this.showSurface=!0}onMaterialToMode(){this.showMaterial=!1,this.showPose=!0}onHauteurToMaterial(){this.showHauteur=!1,this.showMaterial=!0}onSurfaceToEspace(){this.showSurface=!1,this.selectedSegment==="R\xE9sidentiel"?this.showEspace=!0:this.showNextPage=!0}onEspaceToNext(){this.showEspace=!1,this.showNextPage=!0}onStandingToStyle(){this.showNextPage=!1,this.showStyle=!0}onStyleToType(){this.showStyle=!1,this.showType=!0}onNextStepButtonClick(){let r=document.getElementById("input");r.value.trim()!=""&&(this.showProjectNameQuestion=!1,this.showSegment=!1,this.showSegment=!0,this.showPreviousQuestion=!1,this.projectName=r.value.trim())}onStyleButtonClick(){this.showStyle=!0,this.showType=!1}onBackButtonClick(){this.showProjectNameQuestion=!1,this.showPreviousQuestion=!1,this.showNextPage=!1,this.showPreviousQuestion=!0}onSurfaceButtonClick(){this.selectedEspaces.length>0&&(this.showEspace=!1,this.showSurface=!0)}filterEspaces(){this.filteredEspaces=this.espaces.filter(r=>this.selectedEspaces.includes(r.value))}onEspaceButtonClick(){this.showNextPage=!1,this.showHauteur=!1,this.selectedSegment==="R\xE9sidentiel"?this.showEspace=!0:this.showSurface=!0}onWidgetHover(r){let i=r.currentTarget;i.style.backgroundColor="blue"}onWidgetLeave(r){let i=r.currentTarget;i.style.backgroundColor="transparent"}ngOnInit(){this.retrieveProducts(),this.retrieveResponses()}nextSpace(){let r=this.selectedEspaces[this.selectedEspaces.indexOf(this.selectedEspace.value)+1];if(this.lastEspac===r||r==null){console.log(this.projectProducts),this.projectProducts=Object.keys(this.projectProducts).map(s=>{let o=this.projectProducts[s];return console.log(o),o.Espace_a_traiter=s,o}),this.showResponse=!1,this.showProjectProducts=!0;let i={Nom:this.projectName,Products:this.projectProducts};this.projectService.addProject(i),console.log(this.projectProducts)}else this.lastEspac=r,console.log(r),this.selectCurrentEspace(this.espaces.find(i=>i.value===r))}returnToMenu(){this.router.navigate(["/accueil"])}generateId(){return Math.floor(Math.random()*1e6)}showManu(){this.showProjectProducts=!1,this.showManufacture=!0}send(r){this.firstShow=!1,this.showResponse=!0,this.showDetails=!1,this.projectProducts[this.selectedEspace.label]=r}selectCurrentEspace(r){this.firstShow=!0,this.showResponse=!1,this.retrieveProducts(),this.selectedEspace=r;let i=this.responses.filter(o=>this.selectedEspace.value===""||o.Espace_a_traiter===this.selectedEspace.value),s=Array.from(new Set(i.flatMap(o=>[o.Choix1,o.Choix2,o.Choix3])));this.selectedProducts=this.products.filter(o=>s.includes(o.Identifiant)),this.showResponse=!0}getResults(){this.filterEspaces(),this.selectedEspace=this.filteredEspaces[0],this.firstShow=!0,this.showFinition=!1,this.showResponse=!0;let r=this.responses.filter(s=>this.selectedEspace.value===""||s.Espace_a_traiter===this.selectedEspace.value),i=Array.from(new Set(r.flatMap(s=>[s.Choix1,s.Choix2,s.Choix3])));this.selectedProducts=this.products.filter(s=>i.includes(s.Identifiant))}retrieveProducts(){this.productService.getAll().snapshotChanges().pipe(B(r=>r.map(i=>j({key:i.payload.key},i.payload.val())))).subscribe(r=>{this.products=r})}retrieveResponses(){this.responseService.getAll().snapshotChanges().pipe(B(r=>r.map(i=>j({key:i.payload.key},i.payload.val())))).subscribe(r=>{this.responses=r})}goBack(){this.showDetails=!1,this.showResponse=!0}};e.\u0275fac=function(i){return new(i||e)(W(ii),W(mc),W(Mt),W(X_))},e.\u0275cmp=ot({type:e,selectors:[["app-form"]],decls:21,vars:17,consts:[[1,"parent-widget","rounded"],[1,"principal"],[4,"ngIf"],["class","container",4,"ngIf"],["class","product-detail-container",4,"ngIf"],["class","contact-container",4,"ngIf"],[1,"title"],[1,"widgets-container"],[1,"widget"],["src","assets/images/message.png","alt","Image 1"],["src","assets/images/outil.png","alt","Image 2"],["src","assets/images/papier.png","alt","Image 3"],[1,"buttons"],[1,"button",3,"click"],["src","assets/images/name.png","alt","Image",1,"image-right"],[1,"title","left","margin-top"],[1,"input-container","left"],["type","text","id","input","placeholder","\xE9crire ici ...",1,"input",3,"ngModel","ngModelChange"],[1,"widget-container1"],[1,"widget1",3,"click"],["src","assets/images/1.png","alt","Image 1"],[1,"widget-text"],["src","assets/images/2.png","alt","Image 2"],["src","assets/images/3.png","alt","Image 3"],[1,"widget2",3,"click"],["src","assets/images/sobre.png","alt","Image 1"],["src","assets/images/moderne.png","alt","Image 2"],["src","assets/images/couleur.png","alt","Image 3"],["src","assets/images/industriel.png","alt","Image 4"],["src","assets/images/ecologiste.png","alt","Image 4"],["src","assets/images/ancien.png","alt","Image 4"],["class","widget-container1",4,"ngFor","ngForOf"],[1,"widget3",3,"click"],[3,"src","alt"],[4,"ngFor","ngForOf"],[1,"widget4",3,"click"],["type","text","placeholder","\xE9crire ici ...",1,"input1",3,"ngModel","id","ngModelChange"],[1,"finition"],[1,"widget-wrapper"],[1,"widget2","gris",3,"click"],[1,"widget2","noir",3,"click"],["src","assets/images/jesaispas.jpg","alt","Image"],[1,"container"],[1,"header"],[1,"back-arrow"],[1,"left"],[1,"categories"],["class","category-item",3,"selected","click",4,"ngFor","ngForOf"],[1,"results"],[1,"products"],["class","product-card",3,"selected",4,"ngFor","ngForOf"],[1,"next-space",3,"click"],[1,"category-item",3,"click"],[1,"product-card"],["alt","Product",3,"src"],[1,"product-name"],[1,"product-actions"],[1,"favorite"],[1,"details",3,"click"],[1,"product-detail-container"],[1,"product-detail"],[1,"product-image"],["alt","Product Image","onerror","this.src='assets/images/chambre.jpg'",1,"image-top",3,"src"],[1,"back-button",3,"click"],[1,"wishlist-button"],[1,"product-info"],["alt","Product Image",1,"image-desc",3,"src"],[1,"product-description"],[1,"product-color"],[1,"color-options"],[1,"color-option",2,"background-color","#000"],[1,"color-option",2,"background-color","#ccc"],[1,"color-option",2,"background-color","#fff"],[1,"add-to-project-button",3,"click"],[1,"back-button1"],[1,"close-button"],[1,"products1"],["class","product",4,"ngFor","ngForOf"],[1,"options"],["type","checkbox","checked",""],["type","checkbox"],[1,"submit-button",3,"click"],[1,"product"],["href","#"],[1,"contact-container"],[1,"contact-content"],[1,"contact-info"],["src","assets/images/man.png","alt","Alban Grison"],[1,"contact-details"],[1,"return-button",3,"click"]],template:function(i,s){i&1&&(f(0,"div",0)(1,"p",1),m(2,"Assistance Supernova"),p(),Z(3,LQ,27,0,"div",2)(4,jQ,12,1,"div",2)(5,UQ,26,6,"div",2)(6,BQ,41,12,"div",2)(7,HQ,12,1,"div",2)(8,zQ,12,1,"div",2)(9,WQ,12,1,"div",2)(10,YQ,10,1,"div",2)(11,XQ,10,1,"div",2),D(12,"br"),Z(13,nY,10,1,"div",2)(14,iY,10,1,"div",2)(15,aY,10,1,"div",2)(16,cY,10,1,"div",2)(17,hY,17,3,"div",3)(18,fY,51,13,"div",4)(19,gY,23,1,"div",3)(20,mY,22,0,"div",5),p()),i&2&&(_(3),S("ngIf",s.showPreviousQuestion),_(1),S("ngIf",s.showProjectNameQuestion),_(1),S("ngIf",s.showNextPage),_(1),S("ngIf",s.showStyle),_(1),S("ngIf",s.showSegment),_(1),S("ngIf",s.showType),_(1),S("ngIf",s.showEspace),_(1),S("ngIf",s.showSurface),_(1),S("ngIf",s.showPose),_(2),S("ngIf",s.showMaterial),_(1),S("ngIf",s.showHauteur),_(1),S("ngIf",s.showForme),_(1),S("ngIf",s.showFinition),_(1),S("ngIf",s.showResponse),_(1),S("ngIf",s.showDetails),_(1),S("ngIf",s.showProjectProducts),_(1),S("ngIf",s.showManufacture))},dependencies:[jn,Un,Nr,Ap,vM,Rr,G0,ar],styles:['@import"https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap";.parent-widget[_ngcontent-%COMP%]{font-family:Montserrat,sans-serif;padding:20px;border-radius:50px;background-color:#fff;border:2px solid #ddd;text-align:center}.widgets-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap}.widget[_ngcontent-%COMP%]{box-shadow:0 4px 8px #0000001a;width:30%;height:fit-content;min-height:250px;text-align:center;position:relative;overflow:hidden;margin-right:20px;margin-bottom:20px;background-color:#fff;border-radius:40px;border:2px solid #ddd}.widget[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:10px;width:50px;height:auto;transition:transform .3s ease}.widget[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{position:absolute;bottom:10px;left:20px;right:20px;color:#000;padding:5px;transition:background-color .3s ease}.widget[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{transform:scale(1.1)}.margin-top[_ngcontent-%COMP%]{margin-top:100px}.widget1.selected[_ngcontent-%COMP%], .widget3.selected[_ngcontent-%COMP%]{border:2px solid #FFF9BF}.widget2.selected[_ngcontent-%COMP%]{border:2px solid purple}.left[_ngcontent-%COMP%]{margin-left:100px;text-align:left}.widget[_ngcontent-%COMP%]:hover{background-color:#fff9bf}.button[_ngcontent-%COMP%]:hover{background-color:#fff;color:#000;transition:background-color .5s ease,color .5s ease}.button[_ngcontent-%COMP%]:not(:hover){background-color:#000;color:#fff;transition:background-color .5s ease,color .5s ease}.principal[_ngcontent-%COMP%]{margin-bottom:40px}.title[_ngcontent-%COMP%]{margin-bottom:30px;font-weight:700}.image-right[_ngcontent-%COMP%]{margin-top:0;float:right;margin-left:10px}.input[_ngcontent-%COMP%]{margin-bottom:20px;width:400px;height:40px;border-radius:40px;border:2px solid #ddd;padding-left:20px;margin-left:0;box-shadow:-4px 4px 8px #0000001a}.image-center[_ngcontent-%COMP%]{display:block;margin:0 auto;width:200px;height:300px}.input1[_ngcontent-%COMP%]{margin:0 auto;width:400px;height:40px;border-radius:40px;border:2px solid #ddd;box-shadow:-4px 4px 8px #0000001a}.input-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start;margin-bottom:20px}.button[_ngcontent-%COMP%]{margin-top:50px;margin-bottom:20px;margin-right:20px;background-color:#000;border-color:#000;border-radius:40px;color:#fff;font-weight:700;height:50px;width:200px}.widget-container1[_ngcontent-%COMP%]{display:inline-block;text-align:center;margin:10px}.arrow[_ngcontent-%COMP%]{position:absolute;top:70%;transform:translateY(-50%);width:40px;height:40px;cursor:pointer}.left[_ngcontent-%COMP%]{left:150px}.right[_ngcontent-%COMP%]{right:250px}.widget1[_ngcontent-%COMP%]{width:150px;height:180px;padding:10px;border-radius:8px;box-shadow:0 2px 4px #0000001a;transition:box-shadow .3s ease}.widget1[_ngcontent-%COMP%]:hover{box-shadow:0 4px 8px #0003}.widget1[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:auto;display:block;margin:50% auto 0;text-align:center;transform:translateY(-50%)}.widget2[_ngcontent-%COMP%]{width:150px;height:180px;padding:10px;margin:10px;border-radius:8px;box-shadow:0 2px 4px #0000001a;transition:box-shadow .3s ease}.widget2[_ngcontent-%COMP%]:hover{box-shadow:0 4px 8px #0003}.widget2[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.widget3[_ngcontent-%COMP%]:hover{box-shadow:0 4px 8px #0003}.widget-text[_ngcontent-%COMP%]{text-align:center;margin-top:5px;font-size:14px}.widget3[_ngcontent-%COMP%]{width:300px;height:180px;padding:10px;border-radius:8px;box-shadow:0 2px 4px #0000001a;transition:box-shadow .3s ease}.widget3[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.noir[_ngcontent-%COMP%]{background-color:#000}.gris[_ngcontent-%COMP%]{background-color:#949494}.widget4[_ngcontent-%COMP%]{width:120px;height:120px;border-radius:50%;padding:10px;box-shadow:0 2px 4px #0000001a;transition:box-shadow .3s ease}.widget4[_ngcontent-%COMP%]:hover{box-shadow:0 4px 8px #0003}.widget4[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:50%}.widget4.selected[_ngcontent-%COMP%]{border:2px solid black}.finition[_ngcontent-%COMP%]{flex-wrap:wrap;display:flex;justify-content:center}.widget-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.back-arrow[_ngcontent-%COMP%]{justify-content:left;width:30px;cursor:pointer;padding-left:10px}.categories[_ngcontent-%COMP%]{display:flex;justify-content:space-around;width:70%;margin-right:20%}.category-item[_ngcontent-%COMP%]{text-align:center}.category-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-top:20px;width:200px;height:200px;border-radius:10%;margin-bottom:5px}.left[_ngcontent-%COMP%]{justify-content:left}.category-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px}.category-item.selected[_ngcontent-%COMP%]{border-bottom:2px solid #000}.category-item[_ngcontent-%COMP%]:not(.selected){filter:grayscale(100%);opacity:.5}.back-button[_ngcontent-%COMP%]{position:absolute;top:250px;left:150px;background:none;border:none;cursor:pointer;font-size:1.5em;color:#fff;text-shadow:1px 1px 2px rgba(0,0,0,.5)}.wishlist-button[_ngcontent-%COMP%]{position:absolute;top:250px;right:150px;background:none;border:none;cursor:pointer;font-size:1.5em;color:#d3d3d3;transition:color .3s}.results[_ngcontent-%COMP%]{text-align:center}.results[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:10px 0;font-size:24px}.results[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:10px 0;font-size:16px;color:#666}.products[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-around}.product-card[_ngcontent-%COMP%]{width:200px;background-color:#f9f9f9;border-radius:10px;box-shadow:0 0 5px #0000001a;margin:10px;padding:10px;text-align:center}.product-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;border-radius:10px}.product-card[_ngcontent-%COMP%]:not(.selected){filter:grayscale(100%);opacity:.5}.product-name[_ngcontent-%COMP%]{font-size:14px;margin:10px 0}.product-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-around}.product-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer}.product-actions[_ngcontent-%COMP%]   .favorite[_ngcontent-%COMP%]{color:red}.product-actions[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{color:#00f}.load-more[_ngcontent-%COMP%], .next-space[_ngcontent-%COMP%]{display:block;width:150px;margin:20px auto;padding:10px;background-color:#000;color:#fff;border:none;border-radius:5px;cursor:pointer}.load-more[_ngcontent-%COMP%]:hover, .next-space[_ngcontent-%COMP%]:hover{background-color:#333}.product-info[_ngcontent-%COMP%]{padding:20px}.product-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5em}.product-description[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0}.product-color[_ngcontent-%COMP%]{margin:20px 0}.color-options[_ngcontent-%COMP%]{justify-content:center;display:flex;gap:10px}.color-option[_ngcontent-%COMP%]{width:25px;height:25px;border-radius:50%;border:1px solid #ccc}.add-to-project-button[_ngcontent-%COMP%]{display:inline-block;padding:10px 20px;background-color:#000;color:#fff;border:none;border-radius:5px;cursor:pointer;font-size:1em}.add-to-project-button[_ngcontent-%COMP%]:hover{background-color:#444}.image-top[_ngcontent-%COMP%]{width:100%;max-height:400px;object-fit:cover}.image-desc[_ngcontent-%COMP%]{width:70px;height:70px;margin:10px}.product-options[_ngcontent-%COMP%]{margin-top:20px}.checkbox-container[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:10px}.checkbox[_ngcontent-%COMP%]{margin-right:10px}.checkbox-label[_ngcontent-%COMP%]{font-size:16px;color:#333;cursor:pointer}.container[_ngcontent-%COMP%]{width:90%;max-width:1200px;margin:auto}header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px 0}.back-button1[_ngcontent-%COMP%], .close-button[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;cursor:pointer}h1[_ngcontent-%COMP%]{margin:0;font-size:24px}.products1[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin:20px 0}.product[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:20px;display:flex;align-items:center}.product[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60px;height:60px;margin-right:20px}.product-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 10px;font-size:18px}.product-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0;color:#666}.product-info[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#6200ee;text-decoration:none}.options[_ngcontent-%COMP%]{margin:20px 0}.options[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:10px}.submit-button[_ngcontent-%COMP%]{display:block;width:100%;padding:15px;background-color:#333;color:#fff;border:none;border-radius:8px;font-size:16px;cursor:pointer}.contact-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px;height:100vh;background-color:#fff;font-family:Arial,sans-serif}.return-button[_ngcontent-%COMP%]{padding:10px 20px;background-color:#000;color:#fff;border:none;border-radius:5px;cursor:pointer;font-size:1em}.return-button[_ngcontent-%COMP%]:hover{background-color:#444}.contact-content[_ngcontent-%COMP%]{text-align:center;max-width:600px}.contact-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2em;margin-bottom:10px}.contact-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.2em;margin-bottom:20px}.contact-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-bottom:20px}.contact-info[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:150px;height:150px;border-radius:50%;margin-bottom:10px}.contact-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0}']});let t=e;return t})();function _Y(t,e){if(t&1){let n=Y();f(0,"div",32)(1,"input",44),A("change",function(i){let o=N(n).$implicit,a=E(2);return k(a.onSegmentChange(o.value,i))}),p(),f(2,"label",45),m(3),p()()}if(t&2){let n=e.$implicit;_(1),Nt("id",n.value),S("value",n.value),_(1),Nt("for",n.value),_(1),ee(n.label)}}function yY(t,e){if(t&1&&(f(0,"option",50),m(1),p()),t&2){let n=e.$implicit;S("value",n.value),_(1),ee(n.label)}}function vY(t,e){if(t&1){let n=Y();f(0,"div",39)(1,"h2"),m(2),p(),f(3,"div",46)(4,"select",47)(5,"option",48),A("change",function(){N(n);let i=E(2);return k(i.selectedType=i.type.label)}),m(6,"S\xE9lectionner un type"),p(),Z(7,yY,2,2,"option",49),p()()()}if(t&2){let n=E(2);_(2),Le("Types de projets pour ",n.selectedSegment,""),_(5),S("ngForOf",n.types[n.selectedSegment])}}function wY(t,e){if(t&1&&(f(0,"option",50),m(1),p()),t&2){let n=e.$implicit;S("value",n.value),_(1),ee(n.label)}}function EY(t,e){if(t&1){let n=Y();f(0,"div",39)(1,"h2"),m(2,"Espace \xE0 traiter"),p(),f(3,"div",46)(4,"select",51),A("change",function(i){N(n);let s=E(2);return k(s.onSelectChange(i))}),f(5,"option",52),m(6,"S\xE9lectionner un espace \xE0 traiter"),p(),Z(7,wY,2,2,"option",49),p()()()}if(t&2){let n=E(2);_(7),S("ngForOf",n.espaces)}}function CY(t,e){if(t&1){let n=Y();f(0,"div",32)(1,"input",53),A("change",function(){let s=N(n).$implicit,o=E(2);return k(o.selectedSurface=s.label)})("change",function(i){let o=N(n).$implicit,a=E(2);return k(a.onSurfaceChange(o.value,i))}),p(),f(2,"label",45),m(3),p()()}if(t&2){let n=e.$implicit;_(1),Nt("id",n.value),S("value",n.value),_(1),Nt("for",n.value),_(1),ee(n.label)}}function bY(t,e){if(t&1&&(f(0,"option",50),m(1),p()),t&2){let n=e.$implicit;S("value",n.value),_(1),Le("",n.label," ")}}function IY(t,e){if(t&1){let n=Y();f(0,"div",39)(1,"h2"),m(2),p(),f(3,"div",46)(4,"select",54)(5,"option",48),A("change",function(){N(n);let i=E(2);return k(i.selectedPose=i.pose.label)}),m(6,"S\xE9lectionner une mode de pose"),p(),Z(7,bY,2,2,"option",49),p()()()}if(t&2){let n=E(2);_(2),Le("Mode de pose pour ",n.selectedSurface,""),_(5),S("ngForOf",n.poses[n.selectedSurface])}}function xY(t,e){if(t&1){let n=Y();f(0,"div",32)(1,"input",55),A("change",function(){let s=N(n).$implicit,o=E(2);return k(o.selectedMaterial=s.label)}),p(),f(2,"label",45),m(3),p()()}if(t&2){let n=e.$implicit;_(1),Nt("id",n.value),S("value",n.value),_(1),Nt("for",n.value),_(1),ee(n.label)}}function TY(t,e){if(t&1){let n=Y();f(0,"div",32)(1,"input",56),A("change",function(){N(n);let i=E(2);return k(i.selectedForme)}),p(),f(2,"label",45),m(3),p()()}if(t&2){let n=e.$implicit;_(1),Nt("id",n.value),S("value",n.value),_(1),Nt("for",n.value),_(1),ee(n.label)}}function DY(t,e){if(t&1){let n=Y();f(0,"div",32)(1,"input",57),A("change",function(){N(n);let i=E(2);return k(i.selectedStyle)}),p(),f(2,"label",45),m(3),p()()}if(t&2){let n=e.$implicit;_(1),Nt("id",n.label),S("value",n.label),_(1),Nt("for",n.label),_(1),ee(n.label)}}function SY(t,e){if(t&1){let n=Y();f(0,"div",32)(1,"input",58),A("change",function(){N(n);let i=E(2);return k(i.selectedFinition)}),p(),f(2,"label",45),m(3),p()()}if(t&2){let n=e.$implicit;_(1),Nt("id",n.label),S("value",n.label),_(1),Nt("for",n.label),_(1),ee(n.label)}}function AY(t,e){if(t&1){let n=Y();f(0,"main",25)(1,"h1",5),m(2,"Filtre supernova"),p(),f(3,"header")(4,"div",26),D(5,"img",27)(6,"input",28),p()(),f(7,"form",29)(8,"div")(9,"h2",30),m(10,"Standing"),p(),f(11,"div",31)(12,"div",32)(13,"input",33),A("change",function(){N(n);let i=E();return k(i.selectedSegment="Entr\xE9e de gamme")}),p(),f(14,"label",34),m(15,"Entr\xE9e de gamme"),p()(),f(16,"div",32)(17,"input",35),A("change",function(){N(n);let i=E();return k(i.selectedSegment="Moyen standing")}),p(),f(18,"label",36),m(19,"Moyen standing"),p()(),f(20,"div",32)(21,"input",37),A("change",function(){N(n);let i=E();return k(i.selectedSegment="Luxe / Haut de gamme")}),p(),f(22,"label",38),m(23,"Luxe / Haut de gamme"),p()()()(),D(24,"br"),f(25,"div")(26,"h2",30),m(27,"Segment"),p(),f(28,"div",39),Z(29,_Y,4,4,"div",40),p()(),Z(30,vY,8,2,"div",41)(31,EY,8,1,"div",41),f(32,"div")(33,"h2",30),m(34," Surface de pose "),p(),f(35,"div",42),Z(36,CY,4,4,"div",40),p()(),Z(37,IY,8,2,"div",41),f(38,"div")(39,"h2",30),m(40,"Materiaux de surface de pose "),p(),f(41,"div",39),Z(42,xY,4,4,"div",40),p()(),f(43,"div")(44,"h2",30),m(45,"Forme "),p(),f(46,"div",39),Z(47,TY,4,4,"div",40),p()(),f(48,"div")(49,"h2",30),m(50,"Style "),p(),f(51,"div",39),Z(52,DY,4,4,"div",40),p()(),f(53,"div")(54,"h2",30),m(55,"Finition "),p(),f(56,"div",39),Z(57,SY,4,4,"div",40),p()(),D(58,"br"),p(),f(59,"button",43),A("click",function(){N(n);let i=E();return k(i.showR())}),m(60,"Chercher"),p()()}if(t&2){let n=E();_(29),S("ngForOf",n.Segments),_(1),S("ngIf",n.selectedSegment),_(1),S("ngIf",n.selectedSegment==="R\xE9sidentiel"),_(5),S("ngForOf",n.surfaces),_(1),S("ngIf",n.selectedSurface),_(5),S("ngForOf",n.materials),_(5),S("ngForOf",n.formes),_(5),S("ngForOf",n.styles),_(5),S("ngForOf",n.finitions)}}function MY(t,e){if(t&1){let n=Y();f(0,"div",64)(1,"div",65),D(2,"img",66),f(3,"button",67),A("click",function(){let s=N(n).$implicit,o=E(3);return k(o.toggleWishlist(s))}),m(4),p()(),f(5,"div",68)(6,"h3"),m(7),p(),f(8,"p"),m(9),p()(),f(10,"div",69)(11,"button",70),A("click",function(){let s=N(n).$implicit,o=E(3);return k(o.displayDetails(s))}),m(12,"\u2795"),p()()()}if(t&2){let n=e.$implicit;_(2),S("src","assets/images/"+n.Photo_luminaire,Qe)("alt",n.name),_(1),Se("added",n.inWishlist),Ra("id","wish",n.Identifiant,""),_(1),Le(" ",n.inWishlist?"\u2764\uFE0F":"\u2661"," "),_(3),ee(n.Marque),_(2),ee(n.Modele)}}function PY(t,e){if(t&1&&(f(0,"div")(1,"div",62),Z(2,MY,13,8,"div",63),p()()),t&2){let n=E(2);_(2),S("ngForOf",n.produits)}}function RY(t,e){t&1&&(f(0,"p"),m(1,"No products found..."),p())}function NY(t,e){if(t&1&&(f(0,"div",59),Z(1,PY,3,1,"div",60)(2,RY,2,0,"ng-template",null,61,Yi),p()),t&2){let n=Na(3),r=E();_(1),S("ngIf",r.produits&&r.produits.length>0)("ngIfElse",n)}}function kY(t,e){if(t&1){let n=Y();f(0,"div",32)(1,"input",92),A("change",function(){N(n);let i=E(2);return k(i.selectedFinitionP)}),p(),f(2,"label",45),m(3),p()()}if(t&2){let n=e.$implicit,r=E(2);np("background-color",r.finitionColors[n]),_(1),l1("radio ",r.finitionColors[n],""),Nt("id",n),S("value",n),_(1),Nt("for",n),_(1),Le("",n," ")}}function OY(t,e){if(t&1){let n=Y();f(0,"div",93)(1,"button",75),A("click",function(){N(n);let i=E(2);return k(i.goBackToD())}),m(2,"\u2190"),p(),f(3,"div",94)(4,"h1"),m(5,"C'est tout bon pour nous !"),p(),f(6,"p"),m(7,"Je m'appelle Alban, je suis votre interlocuteur fabricant, et je reviendrai vers vous le plus t\xF4t possible"),p(),f(8,"div",95),D(9,"img",96),f(10,"div",97)(11,"p")(12,"strong"),m(13,"Alban Grison"),p()(),f(14,"p"),m(15,"CEO K-Design House"),p(),f(16,"p"),m(17,"a.grisonk-designhouse.com"),p(),f(18,"p"),m(19,"+33 6 43 17 29 79"),p()()(),f(20,"button",98),A("click",function(){N(n);let i=E(2);return k(i.returnToMenu())}),m(21,"Revenir au menu"),p()()()}}function FY(t,e){if(t&1){let n=Y();f(0,"div",71)(1,"div",72)(2,"div",73)(3,"img",74),A("error",function(i){N(n);let s=E();return k(s.handleImageError(i))}),p(),f(4,"button",75),A("click",function(){N(n);let i=E();return k(i.goBack())}),m(5,"\u2190"),p(),f(6,"button",76),A("click",function(){N(n);let i=E();return k(i.toggleWishlist(i.selectedProduct))}),m(7),p()(),D(8,"br"),f(9,"div",77),D(10,"img",78),f(11,"h2"),m(12),p(),f(13,"p"),m(14),p(),f(15,"div",79)(16,"p")(17,"strong"),m(18,"Description"),p()(),f(19,"p"),m(20),p(),f(21,"p")(22,"b"),m(23,"Type: "),p(),m(24),p(),f(25,"p")(26,"b"),m(27,"Puissance: "),p(),m(28),p(),f(29,"p")(30,"b"),m(31,"Forme: "),p(),m(32),p(),f(33,"p")(34,"b"),m(35,"Temp\xE9rature de couleur : "),p(),m(36),p(),f(37,"p")(38,"b"),m(39,"Faisceau : "),p(),m(40),p(),f(41,"div",80)(42,"p")(43,"b"),m(44,"Finition: "),p()(),Z(45,kY,4,9,"div",81),p(),f(46,"div",82)(47,"div",83),D(48,"input",84),f(49,"label",85),m(50,"T\xE9l\xE9charger la fiche technique"),p()(),f(51,"div",83),D(52,"input",86),f(53,"label",87),m(54,"Obtenir une estimation financi\xE8re"),p()(),f(55,"div",83),D(56,"input",88),f(57,"label",89),m(58,"Essayer le produit en d\xE9mo"),p()()(),f(59,"button",90),A("click",function(){N(n);let i=E();return k(i.send())}),m(60,"Envoyer"),p()()(),Z(61,OY,22,0,"div",91),p()()}if(t&2){let n=E();_(3),S("src",n.selectedProduct!=null&&n.selectedProduct.Photo_projet?"assets/images/"+n.selectedProduct.Photo_projet:"assets/images/chambre.jpg",Qe),_(3),Se("added",n.selectedProduct.inWishlist),_(1),Le(" ",n.selectedProduct.inWishlist?"\u2764\uFE0F":"\u2661"," "),_(3),S("src","assets/images/"+n.selectedProduct.Photo_luminaire,Qe),_(2),ee(n.selectedProduct.Marque),_(2),ee(n.selectedProduct.Modele),_(6),ee(n.selectedProduct.Description),_(4),ee(n.selectedProduct.Type),_(4),ee(n.selectedProduct.Puissance),_(4),ee(n.selectedProduct.Forme),_(4),ee(n.selectedProduct.Temperature_de_couleur),_(4),ee(n.selectedProduct.Faisceau),_(5),S("ngForOf",n.finition),_(16),S("ngIf",n.showManufacture)}}var XL=(()=>{let e=class e{constructor(r,i,s,o){this.productService=r,this.responseService=i,this.userService=s,this.router=o,this.user=null,this.fullName="",this.Segments=[{value:"R\xE9sidentiel",label:"R\xE9sidentiel",image:"assets/images/r\xE9sidentielle.jpg",alt:"Image 1"},{value:"education",label:"Education",image:"assets/images/education.jpg",alt:"Image 2"},{value:"tertaire",label:"Tertiaire",image:"assets/images/tertaire.jpg",alt:"Image 3"},{value:"hotellerie",label:"H\xF4tellerie & bien \xEAtre",image:"assets/images/hotelerie.jpg",alt:"Image 4"},{value:"shop",label:"Shop & retail",image:"assets/images/shop&retail.jpg",alt:"Image 5"},{value:"art",label:"Art & culture",image:"assets/images/art.jpg",alt:"Image 6"},{value:"medical",label:"M\xE9dical & centre de soins",image:"assets/images/hopital.jpg",alt:"Image 6"},{value:"infrastructure",label:"Infrastructures",image:"assets/images/infrastructure.jpg",alt:"Image 6"},{value:"industriel",label:"Locaux techniques et industriels",image:"assets/images/industriel.jpg",alt:"Image 6"},{value:"sportif",label:"Sportif",image:"assets/images/sportif.jpg",alt:"Image 6"},{value:"parc",label:"Parcs & milieux urbains",image:"assets/images/parc.jpg",alt:"Image 6"}],this.types={R\u00E9sidentiel:[{value:"Chateau",label:"Chateau",image:"assets/images/chateau.jpeg",alt:"Type 1 Alt 1"},{value:"Appartement",label:"Appartement",image:"assets/images/appartement.jpg",alt:"Type 1 Alt 2"},{value:"Chalet",label:"Ch\xE2let en montagne",image:"assets/images/chalet.jpg",alt:"Type 1 Alt 2"},{value:"Villa",label:"Villa",image:"assets/images/villa.jpg",alt:"Type 1 Alt 2"},{value:"Maison",label:"Maison individuelle",image:"assets/images/maison.jpg",alt:"Type 1 Alt 3"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}],tertaire:[{value:"tour",label:"Tour",image:"assets/images/tour.jpg",alt:"Type 1 Alt 1"},{value:"siege",label:"Si\xE8ge social",image:"assets/images/siege.jpg",alt:"Type 1 Alt 2"},{value:"agence",label:"Agence",image:"assets/images/agence.jpeg",alt:"Type 1 Alt 2"},{value:"administration",label:"Administration",image:"assets/images/administration.png",alt:"Type 1 Alt 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}],shop:[{value:"centreC",label:"Centre commercial",image:"assets/images/centre.jpg",alt:"Type 1 Alt 1"},{value:"distribution",label:"Grandes distribution",image:"assets/images/distribution.jpg",alt:"Type 1 Alt 2"},{value:"boutique",label:"Boutique et petit commerce",image:"assets/images/boutique.jpg",alt:"Type 1 Alt 2"},{value:"grand",label:"Grand magasin",image:"assets/images/magasin.jpg",alt:"Type 1 Alt 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}],education:[{value:"ecole",label:"Ecole/coll\xE8ge/lyc\xE9e",image:"assets/images/ecole.jpg",alt:"Type 1 Alt 1"},{value:"campus",label:"Campus universitaire",image:"assets/images/campus.jpg",alt:"Type 1 Alt 2"},{value:"bibliotheque",label:"Biblioth\xE8que",image:"assets/images/biblio.jpg",alt:"Type 1 Alt 2"},{value:"centreR",label:"Centre de recherche",image:"assets/images/centreR.jpg",alt:"Type 1 Alt 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}],hotellerie:[{value:"hotel",label:"H\xF4tel",image:"assets/images/hotel.jpg",alt:"Type 1 Alt 1"},{value:"restaurant",label:"Restaurant / Bar / Caf\xE9",image:"assets/images/restaurant.jpg",alt:"Type 1 Alt 2"},{value:"soin",label:"Etablissement de soin",image:"assets/images/soin.jpg",alt:"Type 1 Alt 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}],art:[{value:"musee",label:"Mus\xE9e / Exposition",image:"assets/images/mus\xE9e.jpg",alt:"Type 1 Alt 1"},{value:"cinema",label:"Cin\xE9ma / Th\xE9\xE2tre",image:"assets/images/cinema.jpg",alt:"Type 1 Alt 2"},{value:"monument",label:"Monuments historiques",image:"assets/images/monument.jpg",alt:"Type 1 Alt 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}],medical:[{value:"hopital",label:"H\xF4pital / clinique",image:"assets/images/hopital.jpg",alt:"Type 1 Alt 1"},{value:"cabinet",label:"Cabinet m\xE9dical",image:"assets/images/cabinet.jpg",alt:"Type 1 Alt 2"},{value:"pharmacie",label:"Pharmacie",image:"assets/images/pharmacie.jpeg",alt:"Type 1 Alt 2"},{value:"laboratoire",label:"Laboratoire d'analyse",image:"assets/images/labo.jpg",alt:"Type 1 Alt 2"},{value:"centreSante",label:"Centres de sant\xE9 / EHPAD",image:"assets/images/ehpad.jpg",alt:"Type 1 Alt 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}],industriel:[{value:"usine",label:"Usine",image:"assets/images/usine.jpg",alt:"Type 1 Alt 1"},{value:"entrepots",label:"Entrepots logistiques",image:"assets/images/entrepot.jpg",alt:"Type 1 Alt 2"},{value:"atelier",label:"Ateliers",image:"assets/images/atelier.jpg",alt:"Type 1 Alt 2"},{value:"locaux",label:"Locaux techniques",image:"assets/images/locaux.jpg",alt:"Type 1 Alt 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}],parc:[{value:"ecPublic",label:"Eclairage public",image:"assets/images/ec_public.jpg",alt:"Type 1 Alt 1"},{value:"parc",label:"Parc & Jardin",image:"assets/images/parcc.jpg",alt:"Type 1 Alt 2"},{value:"plPublic",label:"Place publique",image:"assets/images/publicc.jpg",alt:"Type 1 Alt 2"},{value:"parking",label:"Parking",image:"assets/images/parking.jpg",alt:"Type 1 Alt 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}],infrastructure:[{value:"aeroport",label:"A\xE9roport",image:"assets/images/a\xE9ro.jpg",alt:"Type 1 Alt 1"},{value:"tunnel",label:"Tunnel",image:"assets/images/tunnel.jpg",alt:"Type 1 Alt 2"},{value:"gare",label:"Gare de train",image:"assets/images/gare.jpg",alt:"Type 1 Alt 2"},{value:"port",label:"Port",image:"assets/images/port.jpg",alt:"Type 1 Alt 2"},{value:"metro",label:"Metro",image:"assets/images/metro.jpg",alt:"Type 1 Alt 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}],sportif:[{value:"terrain",label:"Terrain/Stade",image:"assets/images/stade.jpg",alt:"Type 1 Alt 1"},{value:"piscine",label:"Piscine",image:"assets/images/piscine.jpg",alt:"Type 1 Alt 2"},{value:"gymnase",label:"Gymnase",image:"assets/images/gymnase.jpg",alt:"Type 1 Alt 2"},{value:"salle",label:"Salle de sport",image:"assets/images/salle_sport.jpg",alt:"Type 1 Alt 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Type 1 Alt 2"}]},this.espaces=[{value:"Chambre",label:"Chambre",image:"assets/images/chambre.jpg",alt:"Image 1"},{value:"Salon / s\xE9jour",label:"Salon / s\xE9jour",image:"assets/images/salon.jpg",alt:"Image 2"},{value:"Cuisine",label:"Cuisine",image:"assets/images/cuisine.jpg",alt:"Image 3"},{value:"Salle de bain",label:"Salle de bain",image:"assets/images/salle_de_bain.jpg",alt:"Image 4"},{value:"Abords exterieur",label:"Abords exterieur",image:"assets/images/bandelerie.jpg",alt:"Image 6"},{value:"Couloir",label:"Couloir",image:"assets/images/couloir.jpg",alt:"Image 6"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Image 3"}],this.surfaces=[{value:"Mur",label:"Mur",image:"assets/images/mur.jpg",alt:"Image 1"},{value:"Plafond",label:"Plafond",image:"assets/images/plafond.jpg",alt:"Image 2"},{value:"Sol",label:"Sol",image:"assets/images/sol.jpg",alt:"Image 3"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Image 4"}],this.poses={Plafond:[{value:"Suspendu",label:"Suspendu",image:"assets/images/suspendu.jpg",alt:"Pose 2"},{value:"Encastr\xE9",label:"Encastr\xE9",image:"assets/images/encastr\xE9.jpg",alt:"Pose 1"},{value:"En saillie",label:"En saillie",image:"assets/images/en_saillie.jpg",alt:"Pose 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Pose 5"}],Mur:[{value:"En saillie",label:"En saillie",image:"assets/images/saillie2.jpg",alt:"Pose 2"},{value:"Encastr\xE9",label:"Encastr\xE9",image:"assets/images/encastr\xE92.jpg",alt:"Pose 1"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Pose 5"}],Sol:[{value:"Encastr\xE9",label:"Encastr\xE9",image:"assets/images/encastr\xE93.jpg",alt:"Pose 1"},{value:"En saillie",label:"En saillie",image:"assets/images/en_saillie3.jpg",alt:"Pose 2"},{value:"Sur mat",label:"Sur m\xE2t",image:"assets/images/sur_mat.jpg",alt:"Pose 2"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Pose 5"}]},this.materials=[{value:"Bois",label:"Bois",image:"assets/images/bois.webp",alt:"Image 1"},{value:"Brique",label:"Brique",image:"assets/images/brique.jpg",alt:"Image 2"},{value:"Placo",label:"Pl\xE2tre",image:"assets/images/platre.jpg",alt:"Image 4"},{value:"Gravier",label:"Gravier",image:"assets/images/gravier.jpg",alt:"Image 5"},{value:"Beton",label:"B\xE9ton",image:"assets/images/beton.jpg",alt:"Image 6"},{value:"Terre v\xE9g\xE9tale",label:"Terre v\xE9g\xE9tale",image:"assets/images/terre.jpg",alt:"Image 7"}],this.formes=[{value:"Rond",label:"Rond",image:"assets/images/rond.png",alt:"Image 1"},{value:"Carr\xE9",label:"Carr\xE9",image:"assets/images/carre.png",alt:"Image 2"},{value:"Rectangulaire",label:"Rectangulaire",image:"assets/images/rectangulaire.svg",alt:"Image 3"},{value:"Lin\xE9aire",label:"Lin\xE9aire",image:"assets/images/ligne.png",alt:"Image 4"},{value:" ",label:"Je ne sais pas",image:"assets/images/jesaispas.jpg",alt:"Image 4"}],this.styles=[{label:"Sobre & minimaliste"},{label:"Industriel"},{label:"Moderne"},{label:"Couleurs vives"},{label:"Ecologiste"},{label:"Style ancien"}],this.finitions=[{label:"Blanc"},{label:"Noir"},{label:"Gris"},{label:"Au choix"}],this.selectedFinitionP="",this.selectedProduct=null,this.showProduit=!1,this.showDetails=!1,this.showManufacture=!1,this.selectedSegment=null,this.selectedSurface=null,this.selectedType=null,this.selectedEspace=null,this.selectedPose=null,this.selectedMaterial=null,this.selectedForme=null,this.selectedStyle=null,this.selectedFinition=null,this.selectedStanding=null,this.responses=[],this.produits=[],this.finitionColors=[],this.finition=[],this.firstTime=!0}goToFavorite(){this.router.navigate(["/wishlist"],{state:{user:this.user}})}onSegmentChange(r,i){i.target.checked?this.selectedSegment=r:this.selectedSegment=null}onSurfaceChange(r,i){i.target.checked&&r!=="Je ne sais pas"?this.selectedSurface=r:this.selectedSurface=null}onSelectChange(r){let i=r.target,s=i.options[i.selectedIndex].text;this.selectedEspace=s,console.log("Selected espace:",this.selectedEspace)}returnToMenu(){this.router.navigate(["/accueil"])}showR(){return C(this,null,function*(){let r=this.responses.filter(s=>this.selectedEspace===""||s.Espace_a_traiter===this.selectedEspace);console.log(this.selectedSegment+" "+this.selectedSurface+" "+this.selectedEspace),console.log("selected responses :"),console.log(r),console.log("selected products :"),console.log(this.produits);let i=Array.from(new Set(r.flatMap(s=>[s.Choix1,s.Choix2,s.Choix3])));console.log("Cas values :"),console.log(i),this.produits=this.produits.filter(s=>i.includes(s.Identifiant)),console.log("filtered products :"),console.log(this.produits),this.showProduit=!0})}ngOnInit(){console.log("user :"),console.log(this.user),this.retrieveProducts(),this.retrieveResponses(),this.refreshWishlist()}toggleWishlist(r){this.user?(r.inWishlist=!r.inWishlist,r.inWishlist?(this.user.wishList||(this.user.wishList=[]),this.user.wishList.push(r)):this.user.wishList=this.user.wishList.filter(i=>i.Cas!==r.Identifiant),this.updateWishlistIcon(r)):console.error("User is not defined.")}updateWishlistIcon(r){let i=document.querySelector(`#wish${r.Identifiant}`);i&&(i.textContent=r.inWishlist?"\u2764\uFE0F":"\u2661")}refreshWishlist(){if(this.produits.length>0&&this.user!=null&&this.user.wishList!=null)for(let r of this.produits)r.inWishlist=this.user.wishList.some(i=>i.Cas===r.Identifiant),this.updateWishlistIcon(r)}handleImageError(r){r.target.src="assets/images/chambre.jpg"}retrieveProducts(){this.productService.getAll().snapshotChanges().pipe(B(r=>r.map(i=>j({key:i.payload.key},i.payload.val())))).subscribe(r=>{this.produits=r,this.refreshWishlist()})}retrieveResponses(){this.responseService.getAll().snapshotChanges().pipe(B(r=>r.map(i=>j({key:i.payload.key},i.payload.val())))).subscribe(r=>{this.responses=r})}displayDetails(r){console.log("Selected product:",r),this.selectedProduct=r,this.displayColors(),this.showDetails=!0,this.showProduit=!1}displayColors(){this.firstTime&&(this.finition=this.selectedProduct?.Finition?.split(","),this.finition.forEach(r=>{r=r.trim(),r.includes("Noir")&&(this.finitionColors[r]="black"),r.includes("Blanc")&&(this.finitionColors[r]="white"),r.includes("Gris")&&(this.finitionColors[r]="grey"),r.includes("Dor\xE9")&&(this.finitionColors[r]="gold")}),console.log(this.finition),console.log(this.finitionColors),this.finitionColors=[...new Set(this.finitionColors)],this.firstTime=!1)}goBack(){this.showDetails=!1,this.showProduit=!0,this.firstTime=!0,this.refreshWishlist()}send(){let r=document.getElementById("option1"),i=document.getElementById("option2"),s=document.getElementById("option3");r.checked&&console.log("Option 1 is checked"),i.checked&&console.log("Option 2 is checked"),s.checked&&console.log("Option 3 is checked"),this.showDetails=!1,this.showManufacture=!0}};e.\u0275fac=function(i){return new(i||e)(W(ii),W(mc),W(Yn),W(Mt))},e.\u0275cmp=ot({type:e,selectors:[["app-filtre"]],decls:42,vars:3,consts:[["lang","en"],["charset","UTF-8"],["name","viewport","content","width=device-width, initial-scale=1.0"],["rel","preconnect","href","https://fonts.gstatic.com","crossorigin",""],["href","https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap","rel","stylesheet"],[1,"headT"],[1,"container"],[1,"sidebar"],["src","assets/images/logo.jpg","alt","Supernova",1,"logo"],[1,"profile"],["src","assets/images/profile.png","alt","Profile Picture"],["id","name",1,"name"],[1,"active"],["href","#"],["src","assets/images/home.png","alt","home",1,"padding-right"],["href","wishlist"],["src","assets/images/heart.png","alt","Favorie",1,"padding-right"],["href","projects"],["src","assets/images/folder.png","alt","Projet",1,"padding-right"],[1,"settings"],["src","assets/images/logout.png","alt","Logout",1,"padding-right"],["href","login"],["class","main-content",4,"ngIf"],["class","product-list",4,"ngIf"],["class","product-detail-container",4,"ngIf"],[1,"main-content"],[1,"search-bar"],["src","assets/images/search.png","alt","Search"],["type","text","placeholder","Search"],[1,"filter-form"],[1,"so"],[1,"form-section","gap"],[1,"radio-container"],["type","radio","id","entree","name","standing","value","entree",1,"radio",3,"change"],["for","entree",1,"radio-label"],["type","radio","id","moyen","name","standing","value","moyen",1,"radio",3,"change"],["for","moyen",1,"radio-label"],["type","radio","id","luxe","name","standing","value","luxe",1,"radio",3,"change"],["for","luxe",1,"radio-label"],[1,"form-section"],["class","radio-container",4,"ngFor","ngForOf"],["class","form-section",4,"ngIf"],[1,"form-section1"],["type","submit",1,"search",3,"click"],["type","radio","name","segment",1,"radio",3,"id","value","change"],[1,"radio-label",3,"for"],[1,"select-container"],["id","typeSelect"],["value","","disabled","","selected","",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["id","espaceSelect",3,"change"],["value","","disabled","","selected",""],["type","radio","name","surface",1,"radio",3,"id","value","change"],["id","modeSelect"],["type","radio","name","material",1,"radio",3,"id","value","change"],["type","radio","name","forme",1,"radio",3,"id","value","change"],["type","radio","name","style",1,"radio",3,"id","value","change"],["type","radio","name","finition",1,"radio",3,"id","value","change"],[1,"product-list"],[4,"ngIf","ngIfElse"],["noProducts",""],[1,"product-grid"],["class","product-card",4,"ngFor","ngForOf"],[1,"product-card"],[1,"card-image"],[3,"src","alt"],[1,"wishlist-button",3,"id","click"],[1,"card-content"],[1,"card-actions"],[1,"cart-button",3,"click"],[1,"product-detail-container"],[1,"product-detail"],[1,"product-image"],["alt","Product Image","onerror","this.src='assets/images/chambre.jpg'",1,"image-top",3,"src","error"],[1,"back-button",3,"click"],[1,"wishlist-button",3,"click"],[1,"product-info"],["alt","Product Image",1,"image-desc",3,"src"],[1,"product-description"],["id","color-selector"],["class","radio-container",3,"background-color",4,"ngFor","ngForOf"],[1,"product-options"],[1,"checkbox-container"],["type","checkbox","id","option1",1,"checkbox"],["for","option1",1,"checkbox-label"],["type","checkbox","id","option2",1,"checkbox"],["for","option2",1,"checkbox-label"],["type","checkbox","id","option3",1,"checkbox"],["for","option3",1,"checkbox-label"],[1,"add-to-project-button",3,"click"],["class","contact-container",4,"ngIf"],["type","radio","name","finition",3,"id","value","change"],[1,"contact-container"],[1,"contact-content"],[1,"contact-info"],["src","assets/images/man.png","alt","Alban Grison"],[1,"contact-details"],[1,"return-button",3,"click"]],template:function(i,s){i&1&&(f(0,"html",0)(1,"head"),D(2,"meta",1)(3,"meta",2)(4,"link",3)(5,"link",4),f(6,"title",5),m(7,"Supernova Filter"),p()(),f(8,"body")(9,"div",6)(10,"aside",7),D(11,"img",8)(12,"br"),f(13,"div",9),D(14,"img",10),f(15,"h2",11),m(16,"Majeri Amine"),p(),f(17,"p"),m(18,"Voir et modifier le profile"),p()(),f(19,"nav")(20,"ul")(21,"li",12)(22,"a",13),D(23,"img",14),m(24," Accueil"),p()(),f(25,"li")(26,"a",15),D(27,"img",16),m(28," Favorie"),p()(),f(29,"li")(30,"a",17),D(31,"img",18),m(32," Projet"),p()()()(),f(33,"div",19)(34,"ul")(35,"li"),D(36,"img",20),f(37,"a",21),m(38," Logout"),p()()()()(),Z(39,AY,61,9,"main",22)(40,NY,4,2,"div",23)(41,FY,62,15,"div",24),p()()()),i&2&&(_(39),S("ngIf",!s.showProduit&&!s.showDetails&&!s.showManufacture),_(1),S("ngIf",s.showProduit),_(1),S("ngIf",s.showDetails))},dependencies:[jn,Un,Nr,DM,AM,Rr,ar],styles:['*[_ngcontent-%COMP%]{box-sizing:border-box;margin:0;padding:0;font-family:Montserrat,sans-serif}body[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;height:100vh;background-color:#f0f4f8}.list[_ngcontent-%COMP%]{text-align:left;max-width:750px;margin:auto}.checkbox-label[_ngcontent-%COMP%]{display:inline-block;position:relative;padding-left:25px;margin-right:10px;cursor:pointer}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{position:absolute;opacity:0;cursor:pointer}.checkbox-label[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:20px;width:20px;background-color:#eee;border-radius:3px}.checkbox-label[_ngcontent-%COMP%]:hover   .checkmark[_ngcontent-%COMP%]{background-color:#ccc}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]{background-color:#2196f3}.checkbox-label[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]:after{content:"";position:absolute;display:none}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]:after{display:block}.checkbox-label[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]:after{left:7px;top:3px;width:5px;height:10px;border:solid white;border-width:0 2px 2px 0;transform:rotate(45deg)}.radio-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin-bottom:10px}.padding-right[_ngcontent-%COMP%]{padding-right:10px}.radio[_ngcontent-%COMP%]{display:none}.radio-label[_ngcontent-%COMP%]{display:flex;align-items:center;padding:5px 10px;border:2px solid #ddd;border-radius:40px;cursor:pointer;font-size:1em;margin-right:10px;transition:background-color .2s,border-color .2s}.select-container[_ngcontent-%COMP%]{margin-top:5px;position:relative;display:inline-block;width:100%}.select-container[_ngcontent-%COMP%]:after{content:"\\25bc";font-size:16px;color:#555;position:absolute;top:50%;right:10px;pointer-events:none;transform:translateY(-50%)}select[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;width:100%;padding:10px 40px 10px 10px;font-size:16px;border:1px solid #ccc;border-radius:5px;background-color:#fff;color:#333;box-shadow:0 2px 5px #0000001a;transition:border-color .3s,box-shadow .3s}select[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none;box-shadow:0 0 5px #007bff80}option[_ngcontent-%COMP%]{padding:10px}.radio-label[_ngcontent-%COMP%]:before{content:"";display:inline-block;width:25px;height:25px;border:2px solid #ddd;border-radius:50%;margin-right:10px;transition:background-color .2s,border-color .2s}.radio[_ngcontent-%COMP%]:checked + .radio-label[_ngcontent-%COMP%]:before{background-color:#000;border-color:#000}.radio[_ngcontent-%COMP%]:checked + .radio-label[_ngcontent-%COMP%]{border-color:#000;color:#000}.container[_ngcontent-%COMP%]{display:flex;width:100%}.sidebar[_ngcontent-%COMP%]{width:20%;background-color:#fff;padding:20px;box-shadow:2px 0 5px #0000001a}.profile[_ngcontent-%COMP%]{text-align:center;margin-bottom:40px}.profile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;margin-bottom:10px}.profile[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;margin-bottom:5px}.profile[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#888}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:20px 0}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;font-size:16px;color:#333;display:flex;align-items:center}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#4a90e2}.settings[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;margin-top:40px}.settings[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:20px 0}.settings[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;font-size:16px;color:#333}.settings[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#4a90e2}.main-content[_ngcontent-%COMP%]{flex-grow:1;padding:40px}header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px}h1[_ngcontent-%COMP%]{font-size:1.5em;margin:0}.search-bar[_ngcontent-%COMP%]{margin:30px auto;width:600px;position:relative}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px 50px 10px 40px;border-radius:20px;border:1px solid #ccc;box-shadow:4px 4px 10px #0003}.search-bar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;right:20px;top:50%;transform:translateY(-50%);width:20px;height:20px}.filter-form[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:20px;margin-top:30px}.form-section[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.gap[_ngcontent-%COMP%]{gap:20px}.form-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1em;margin-bottom:10px}.form-section1[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.form-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .so[_ngcontent-%COMP%]{font-size:1em;margin-bottom:10px}.search[_ngcontent-%COMP%]{margin:20px 20px 20px 100px;background-color:#000;border-color:#000;border-radius:40px;color:#fff;font-weight:700;height:50px;width:600px;justify-content:center}.product-list[_ngcontent-%COMP%]{text-align:center}.product-grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;gap:20px;padding:20px}.product-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:10px;box-shadow:0 2px 5px #0000001a;width:200px;overflow:hidden;text-align:center;transition:transform .3s;position:relative}.product-card[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.card-image[_ngcontent-%COMP%]{position:relative}.card-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.card-content[_ngcontent-%COMP%]{padding:10px}.card-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:10px 0 5px;font-size:1.2em}.card-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#555}.card-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:10px;border-top:1px solid #eee}.card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;font-size:1.2em}.card-actions[_ngcontent-%COMP%]   .cart-button[_ngcontent-%COMP%]{color:green}.bold[_ngcontent-%COMP%]{font-weight:700;padding:20px;margin:20px}.product-detail-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:20px;background-color:#f8f8f8}.product-detail[_ngcontent-%COMP%]{display:flex;flex-direction:column;background-color:#fff;border-radius:10px;box-shadow:0 2px 5px #0000001a;overflow:hidden;max-width:800px;width:100%}.product-image[_ngcontent-%COMP%]{position:relative;width:100%;height:50%}.product-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.back-button[_ngcontent-%COMP%]{position:absolute;top:10px;left:10px;background:none;border:none;cursor:pointer;font-size:1.5em;color:#fff;text-shadow:1px 1px 2px rgba(0,0,0,.5)}.wishlist-button[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;background:none;border:none;cursor:pointer;font-size:1.5em;color:#d3d3d3;transition:color .3s}.wishlist-button.added[_ngcontent-%COMP%]{color:red}.product-info[_ngcontent-%COMP%]{padding:20px}.product-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5em}.product-description[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0}.product-color[_ngcontent-%COMP%]{margin:20px 0}.color-options[_ngcontent-%COMP%]{display:flex;gap:10px}.color-option[_ngcontent-%COMP%]{width:25px;height:25px;border-radius:50%;border:1px solid #ccc}.add-to-project-button[_ngcontent-%COMP%]{display:inline-block;padding:10px 20px;background-color:#000;color:#fff;border:none;border-radius:5px;cursor:pointer;font-size:1em}.add-to-project-button[_ngcontent-%COMP%]:hover{background-color:#444}.image-top[_ngcontent-%COMP%]{width:100%;max-height:100%}.image-desc[_ngcontent-%COMP%]{width:70px;height:70px;margin:10px}.product-options[_ngcontent-%COMP%]{margin-top:20px}.checkbox-container[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:10px}.checkbox[_ngcontent-%COMP%]{margin-right:10px}.checkbox-label[_ngcontent-%COMP%]{font-size:16px;color:#333;cursor:pointer}.contact-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;background-color:#fff;font-family:Arial,sans-serif;padding:20px 20px 20px 200px}.back-button[_ngcontent-%COMP%]{position:absolute;top:20px;left:20px;background:none;border:none;cursor:pointer;font-size:1.5em;color:#000}.contact-content[_ngcontent-%COMP%]{text-align:center;max-width:600px}.contact-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2em;margin-bottom:10px}.contact-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.2em;margin-bottom:20px}.contact-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-bottom:20px}.contact-info[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:150px;height:150px;border-radius:50%;margin-bottom:10px}.contact-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0}.return-button[_ngcontent-%COMP%]{padding:10px 20px;background-color:#000;color:#fff;border:none;border-radius:5px;cursor:pointer;font-size:1em}.return-button[_ngcontent-%COMP%]:hover{background-color:#444}#color-selector[_ngcontent-%COMP%]{display:flex;align-items:center}#color-selector[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{margin-right:10px;font-weight:700}#color-selector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;margin-right:10px}#color-selector[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.color-circle[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:50%;display:inline-block;margin-right:5px;border:1px solid #ccc}.black[_ngcontent-%COMP%]{background-color:#000}.white[_ngcontent-%COMP%]{background-color:#fff}.grey[_ngcontent-%COMP%]{background-color:gray}.gold[_ngcontent-%COMP%]{background-color:gold}']});let t=e;return t})();function VY(t,e){t&1&&(f(0,"div",8)(1,"div",9)(2,"p"),m(3,"Configurez votre projet et recevez :"),p(),f(4,"h1"),m(5,"Votre planche concept personnalis\xE9e pour votre projet"),p()(),f(6,"div",10),D(7,"img",11),p()())}function LY(t,e){if(t&1){let n=Y();f(0,"div",12)(1,"div",13),D(2,"span",14)(3,"span",15)(4,"span",15),p(),f(5,"button",16),A("click",function(){N(n);let i=E();return k(i.next1())}),m(6,"Suivant"),p()()}}function jY(t,e){t&1&&(f(0,"div",8)(1,"div",9)(2,"p"),m(3,"Configurez votre projet et recevez :"),p(),f(4,"h1"),m(5,"Une s\xE9lection des luminaires les plus adapt\xE9s au concept"),p()(),f(6,"div",10),D(7,"img",17),p()())}function UY(t,e){if(t&1){let n=Y();f(0,"div",12)(1,"div",13),D(2,"span",15)(3,"span",14)(4,"span",15),p(),f(5,"button",16),A("click",function(){N(n);let i=E();return k(i.next2())}),m(6,"Suivant"),p()()}}function BY(t,e){t&1&&(f(0,"div",8)(1,"div",9)(2,"p"),m(3,"Configurez votre projet et recevez :"),p(),f(4,"h1"),m(5,"L'estimation financi\xE8re du projet"),p(),f(6,"p"),m(7,"(Aucune CB n\xE9cessaire)"),p()(),f(8,"div",10),D(9,"img",18),p()())}function $Y(t,e){if(t&1){let n=Y();f(0,"div",12)(1,"div",13),D(2,"span",15)(3,"span",15)(4,"span",14),p(),f(5,"button",16),A("click",function(){N(n);let i=E();return k(i.next3())}),m(6,"Suivant"),p()()}}function HY(t,e){if(t&1){let n=Y();f(0,"div")(1,"h1",19),m(2,"Se connecter"),p(),f(3,"div",20)(4,"button",21),m(5," Google "),p(),f(6,"button",22),m(7," Facebook "),p()(),f(8,"p"),m(9,"Ou inscrivez-vous en utilisant"),p(),f(10,"form")(11,"div",23),D(12,"input",24),p(),f(13,"div",23),D(14,"input",25),f(15,"a",26),m(16,"Mot de passe oubli\xE9?"),p()(),f(17,"button",27),A("click",function(){N(n);let i=E();return k(i.login())}),m(18,"Se connecter"),p()(),f(19,"p"),m(20,"Vous n'avez pas encore de compte "),f(21,"button",28),A("click",function(){N(n);let i=E();return k(i.signin())}),m(22,"Inscrivez-vous"),p()()()}}function qY(t,e){if(t&1){let n=Y();f(0,"div")(1,"h1",19),m(2,"S'inscrire"),p(),f(3,"div",20)(4,"button",21),m(5," Google "),p(),f(6,"button",22),m(7," Facebook "),p()(),f(8,"p"),m(9,"Ou inscrivez-vous en utilisant"),p(),f(10,"form")(11,"div",23),D(12,"input",29),p(),f(13,"div",23),D(14,"input",30),p(),f(15,"div",23),D(16,"input",24),p(),f(17,"div",23),D(18,"input",31),p(),f(19,"div",23),D(20,"input",32),p(),f(21,"div",23),D(22,"input",25),p(),f(23,"button",27),A("click",function(){N(n);let i=E();return k(i.signup())}),m(24,"S'inscrire"),p()()()}}function zY(t,e){t&1&&(f(0,"div",8)(1,"div",9)(2,"h1",33),m(3,"Connectez-vous"),p(),f(4,"p",34),m(5,"Et commencez votre projet"),p()()())}function GY(t,e){if(t&1){let n=Y();f(0,"div",12)(1,"button",35),A("click",function(){N(n);let i=E();return k(i.next4())}),m(2,"Architecte"),p(),f(3,"button",35),A("click",function(){N(n);let i=E();return k(i.next6())}),m(4,"Admin"),p()()}}function WY(t,e){if(t&1){let n=Y();f(0,"div")(1,"form")(2,"div",23),D(3,"input",29),p(),f(4,"div",23),D(5,"input",25),p(),f(6,"button",27),A("click",function(){N(n);let i=E();return k(i.loginA())}),m(7,"Se connecter"),p()()()}}var ej=(()=>{let e=class e{constructor(r,i){this.userService=r,this.router=i,this.show1=!0,this.show2=!1,this.show3=!1,this.show4=!1,this.show5=!1,this.show6=!1,this.show7=!1,this.nom="",this.prenom="",this.email="",this.numtel="",this.nomAg="",this.mdp=""}next1(){this.show1=!this.show1,this.show2=!this.show2}next2(){this.show2=!this.show2,this.show3=!this.show3}next3(){this.show3=!this.show3,this.show6=!this.show4}next4(){this.show4=!this.show4,this.show6=!this.show6}next6(){this.show6=!this.show6,this.show7=!this.show7}login(){this.email=document.querySelector('input[type="email"]').value,this.mdp=document.querySelector('input[type="password"]').value,this.userService.checkIfUserExists(this.email,this.mdp).subscribe(r=>{r?r.Confirmed?(alert("Your account is confirmed, welcome!"),this.router.navigate(["/accueil"])):alert("Your account is not confirmed yet, please check your email"):alert("Invalid email or password")},r=>{console.error("Error:",r),alert("An error occurred during login")})}loginA(){this.email=document.querySelector('input[type="nom"]').value,this.mdp=document.querySelector('input[type="password"]').value,this.email=="haitam"&&this.mdp=="supernova123"?this.router.navigate(["/users"]):alert("Invalid email or password")}signin(){this.show4=!this.show4,this.show5=!this.show5}signup(){return C(this,null,function*(){this.show5=!this.show5,this.nom=document.querySelector('input[type="nom"]').value,this.prenom=document.querySelector('input[type="prenom"]').value,this.email=document.querySelector('input[type="email"]').value,this.numtel=document.querySelector('input[type="numtel"]').value,this.nomAg=document.querySelector('input[type="nomAg"]').value,this.mdp=document.querySelector('input[type="password"]').value;let r={Nom:this.nom,Prenom:this.prenom,Email:this.email,NumTel:this.numtel,NomAg:this.nomAg,Mdp:this.mdp,Confirmed:!1};this.userService.addUser(r);try{let i=yield fetch("http://localhost:3000/api/send-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:this.email,nom:this.nom,prenom:this.prenom})}),s=yield i.json();i.ok?alert(s.message):alert(s.error)}catch(i){console.error("Error:",i),alert("An error occurred while sending the email")}})}};e.\u0275fac=function(i){return new(i||e)(W(Yn),W(Mt))},e.\u0275cmp=ot({type:e,selectors:[["app-login"]],decls:20,vars:11,consts:[["lang","fr"],["charset","UTF-8"],["name","viewport","content","width=device-width, initial-scale=1.0"],[1,"container"],[1,"card"],["class","content",4,"ngIf"],["class","controls",4,"ngIf"],[4,"ngIf"],[1,"content"],[1,"text-content"],[1,"image-content"],["src","assets/images/l1.png","alt","Illustration"],[1,"controls"],[1,"dots"],[1,"dot","active"],[1,"dot"],[1,"next-button",3,"click"],["src","assets/images/l2.png","alt","Illustration"],["src","assets/images/l3.png","alt","Illustration"],[1,"padding-bottom"],[1,"social-login"],[1,"google-btn"],[1,"facebook-btn"],[1,"input-group"],["type","email","placeholder","Email","required",""],["type","password","placeholder","Mot de passe","required",""],["href","#",1,"forgot-password"],["type","submit",1,"login-btn",3,"click"],[1,"invisible-b",3,"click"],["type","nom","placeholder","Nom","required",""],["type","prenom","placeholder","Pr\xE9nom","required",""],["type","numtel","placeholder","Num tel","required",""],["type","nomAg","placeholder","Nom de l'agence","required",""],[1,"center","big"],[1,"center"],[1,"next-button","centerb",3,"click"]],template:function(i,s){i&1&&(f(0,"html",0)(1,"head"),D(2,"meta",1)(3,"meta",2),f(4,"title"),m(5,"Votre planche concept"),p()(),f(6,"body")(7,"div",3)(8,"div",4),Z(9,VY,8,0,"div",5)(10,LY,7,0,"div",6)(11,jY,8,0,"div",5)(12,UY,7,0,"div",6)(13,BY,10,0,"div",5)(14,$Y,7,0,"div",6)(15,HY,23,0,"div",7)(16,qY,25,0,"div",7)(17,zY,6,0,"div",5)(18,GY,5,0,"div",6)(19,WY,8,0,"div",7),p()()()()),i&2&&(_(9),S("ngIf",s.show1),_(1),S("ngIf",s.show1),_(1),S("ngIf",s.show2),_(1),S("ngIf",s.show2),_(1),S("ngIf",s.show3),_(1),S("ngIf",s.show3),_(1),S("ngIf",s.show4),_(1),S("ngIf",s.show5),_(1),S("ngIf",s.show6),_(1),S("ngIf",s.show6),_(1),S("ngIf",s.show7))},dependencies:[Un,Nr,Rr,ar],styles:["*[_ngcontent-%COMP%]{box-sizing:border-box;margin:0;padding:0;font-family:Montserrat,sans-serif}body[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;background-color:#f0f8ff;font-family:Arial,sans-serif}.container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%;height:100%}.card[_ngcontent-%COMP%]{background-color:#fff;border-radius:15px;box-shadow:0 4px 8px #0000001a;width:70%;max-width:800px;text-align:center;padding:20px}.content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px}.text-content[_ngcontent-%COMP%]{flex:1;text-align:left}.text-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#666}.text-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;color:#000;margin-top:10px}.image-content[_ngcontent-%COMP%]{flex:1}.image-content[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;height:auto}.controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px}.dots[_ngcontent-%COMP%]{display:flex;gap:5px}.dot[_ngcontent-%COMP%]{height:10px;width:10px;background-color:#bbb;border-radius:50%;display:inline-block}.dot.active[_ngcontent-%COMP%]{background-color:#353535}h1[_ngcontent-%COMP%]{font-weight:bolder}.next-button[_ngcontent-%COMP%]{background-color:#000;color:#fff;border:none;padding:10px 20px;border-radius:20px;cursor:pointer;font-size:16px;margin-right:35%;width:30%}.social-login[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:20px}.social-login[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:48%;padding:10px;border:none;border-radius:25px;cursor:pointer;font-size:16px;display:flex;align-items:center;justify-content:center}.invisible-b[_ngcontent-%COMP%]{border:none;background-color:#fff;color:#00bcd4}.google-btn[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #ddd;color:#444}.google-btn[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;margin-right:10px}.facebook-btn[_ngcontent-%COMP%]{background-color:#3b5998;color:#fff}.facebook-btn[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;margin-right:10px}p[_ngcontent-%COMP%]{font-size:14px;color:#666;margin:10px 0}.padding-bottom[_ngcontent-%COMP%]{padding-bottom:20px}form[_ngcontent-%COMP%]{width:100%}.input-group[_ngcontent-%COMP%]{position:relative;margin-bottom:20px}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ddd;border-radius:25px;font-size:16px;box-shadow:0 0 5px #0003}.text-content[_ngcontent-%COMP%]   .big[_ngcontent-%COMP%]{font-size:36px}.center[_ngcontent-%COMP%]{text-align:center}.controls[_ngcontent-%COMP%]   .centerb[_ngcontent-%COMP%]{gap:5px;background-color:#000;display:flex;justify-content:center;align-items:center;text-align:center;color:#fff;border:none;border-radius:25px;cursor:pointer;font-size:16px;margin-bottom:20px;margin-left:auto;margin-right:auto}.forgot-password[_ngcontent-%COMP%]{position:absolute;right:15px;top:50%;transform:translateY(-50%);font-size:12px;color:#666}.login-btn[_ngcontent-%COMP%]{width:100%;padding:10px;background-color:#000;color:#fff;border:none;border-radius:25px;cursor:pointer;font-size:16px;margin-bottom:20px}.login-btn[_ngcontent-%COMP%]:hover{background-color:#444}a[_ngcontent-%COMP%]{color:#00bcd4;text-decoration:none}a[_ngcontent-%COMP%]:hover{text-decoration:underline}.next-button[_ngcontent-%COMP%]:hover{background-color:#444}"]});let t=e;return t})();function KY(t,e){t&1&&(f(0,"div"),m(1,"Loading users..."),p())}function QY(t,e){if(t&1&&(f(0,"p")(1,"strong"),m(2,"Nom agence:"),p(),m(3),p()),t&2){let n=E().$implicit;_(3),Le(" ",n.data.NomAg,"")}}function YY(t,e){if(t&1&&(f(0,"p")(1,"strong"),m(2,"Num tel:"),p(),m(3),p()),t&2){let n=E().$implicit;_(3),Le(" ",n.data.NumTel,"")}}function JY(t,e){if(t&1&&(f(0,"p")(1,"strong"),m(2,"Confirmation:"),p(),m(3),p()),t&2){let n=E().$implicit;_(3),Le(" ",n.data.Confirmed,"")}}function ZY(t,e){if(t&1){let n=Y();f(0,"div",8)(1,"button",9),A("click",function(i){return N(n),E(3).removeUser(),k(i.stopPropagation())}),m(2,"Remove"),p(),f(3,"button",9),A("click",function(i){return N(n),E(3).confirmUser(),k(i.stopPropagation())}),m(4,"Confirm"),p()()}}function XY(t,e){if(t&1){let n=Y();f(0,"div",6),A("click",function(){let s=N(n).$implicit,o=E(2);return k(o.selectUser(s))}),f(1,"h2"),m(2),p(),f(3,"p")(4,"strong"),m(5,"Email:"),p(),m(6),p(),Z(7,QY,4,1,"p",2)(8,YY,4,1,"p",2)(9,JY,4,1,"p",2)(10,ZY,5,0,"div",7),p()}if(t&2){let n=e.$implicit,r=E(2);_(2),ka("",n.data.Nom," ",n.data.Prenom,""),_(4),Le(" ",n.data.Email,""),_(1),S("ngIf",n.data.NomAg),_(1),S("ngIf",n.data.NumTel),_(1),S("ngIf",n.data.Confirmed),_(1),S("ngIf",r.selectedUser===n)}}function eJ(t,e){if(t&1&&(f(0,"div",4),Z(1,XY,11,7,"div",5),p()),t&2){let n=E();_(1),S("ngForOf",n.users)}}function tJ(t,e){t&1&&(f(0,"div"),m(1,"Loading confirmed users..."),p())}function nJ(t,e){if(t&1&&(f(0,"p")(1,"strong"),m(2,"Nom agence:"),p(),m(3),p()),t&2){let n=E().$implicit;_(3),Le(" ",n.data.NomAg,"")}}function rJ(t,e){if(t&1&&(f(0,"p")(1,"strong"),m(2,"Num tel:"),p(),m(3),p()),t&2){let n=E().$implicit;_(3),Le(" ",n.data.NumTel,"")}}function iJ(t,e){if(t&1){let n=Y();f(0,"div",6),A("click",function(){let s=N(n).$implicit,o=E(2);return k(o.selectUser(s))}),f(1,"h2"),m(2),p(),f(3,"p")(4,"strong"),m(5,"Email:"),p(),m(6),p(),Z(7,nJ,4,1,"p",2)(8,rJ,4,1,"p",2),p()}if(t&2){let n=e.$implicit;_(2),ka("",n.data.Nom," ",n.data.Prenom,""),_(4),Le(" ",n.data.Email,""),_(1),S("ngIf",n.data.NomAg),_(1),S("ngIf",n.data.NumTel)}}function sJ(t,e){if(t&1&&(f(0,"div",4),Z(1,iJ,9,5,"div",5),p()),t&2){let n=E();_(1),S("ngForOf",n.confirmedUsers)}}var tj=(()=>{let e=class e{constructor(r,i){this.userService=r,this.router=i,this.users=[],this.confirmedUsers=[],this.selectedUser=null}ngOnInit(){return C(this,null,function*(){this.updateConfirmedUsers()})}goBack(){this.router.navigate(["/login"])}selectUser(r){this.selectedUser=r}updateConfirmedUsers(){this.userService.getAllU().subscribe(r=>this.users=r,r=>console.error(r)),this.userService.getAllC().subscribe(r=>this.confirmedUsers=r,r=>console.error(r))}removeUser(){return C(this,null,function*(){if(this.selectedUser)try{yield this.userService.removeUser(this.selectedUser.key),this.users=this.users.filter(r=>r.key!==this.selectedUser?.key),this.selectedUser=null}catch(r){console.error("Error removing user:",r)}this.updateConfirmedUsers()})}confirmUser(){return C(this,null,function*(){if(this.selectedUser)try{yield this.userService.confirmUser(this.selectedUser.key);let r=this.users.findIndex(i=>i.key===this.selectedUser?.key);r>-1&&(this.users[r].data.Confirmed=!0),this.selectedUser=null}catch(r){console.error("Error confirming user:",r)}this.updateConfirmedUsers()})}unConfirmUser(){return C(this,null,function*(){if(this.selectedUser)try{yield this.userService.unconfirmUser(this.selectedUser.key);let r=this.users.findIndex(i=>i.key===this.selectedUser?.key);r>-1&&(this.users[r].data.Confirmed=!1),this.selectedUser=null}catch(r){console.error("Error confirming user:",r)}this.updateConfirmedUsers()})}};e.\u0275fac=function(i){return new(i||e)(W(Yn),W(Mt))},e.\u0275cmp=ot({type:e,selectors:[["app-user-list"]],decls:12,vars:4,consts:[[1,"user-list-container"],[1,"back-button1",3,"click"],[4,"ngIf"],["class","users",4,"ngIf"],[1,"users"],["class","user-card",3,"click",4,"ngFor","ngForOf"],[1,"user-card",3,"click"],["class","actions",4,"ngIf"],[1,"actions"],[3,"click"]],template:function(i,s){i&1&&(f(0,"div",0)(1,"button",1),A("click",function(){return s.goBack()}),m(2,"\u2190"),p(),f(3,"h1"),m(4,"List of Users"),p(),Z(5,KY,2,0,"div",2)(6,eJ,2,1,"div",3),D(7,"br"),f(8,"h1"),m(9,"List of Confirmed Users"),p(),Z(10,tJ,2,0,"div",2)(11,sJ,2,1,"div",3),p()),i&2&&(_(5),S("ngIf",s.users.length===0),_(1),S("ngIf",s.users.length>0),_(4),S("ngIf",s.users.length===0),_(1),S("ngIf",s.users.length>0))},dependencies:[jn,Un],styles:[".user-list-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:20px;text-align:center}h1[_ngcontent-%COMP%]{font-size:2.5em;margin-bottom:20px;color:#333}.users[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:20px;justify-content:center}.user-card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 4px 8px #0000001a;padding:20px;width:500px;text-align:left}.user-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5em;margin-bottom:10px;color:#444}.user-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1em;color:#666}"]});let t=e;return t})();function oJ(t,e){if(t&1&&(f(0,"div",5)(1,"div",6),D(2,"img",7),p(),f(3,"div",8)(4,"h3"),m(5),p(),f(6,"p"),m(7),p()()()),t&2){let n=e.$implicit;_(2),S("src",n.image||"default-image-url",Qe)("alt",n.name),_(3),ee(n.Marque),_(2),ee(n.brand)}}function aJ(t,e){if(t&1&&(f(0,"div")(1,"div",3),Z(2,oJ,8,4,"div",4),p()()),t&2){let n=E();_(2),S("ngForOf",n.wishlist)}}function lJ(t,e){t&1&&(f(0,"p"),m(1,"No items in wishlist..."),p())}var nj=(()=>{let e=class e{constructor(r,i){this.router=r,this.userService=i,this.wishlist=[]}ngOnInit(){this.userService.userData$.subscribe(r=>{this.user=r,console.log(this.user)})}};e.\u0275fac=function(i){return new(i||e)(W(Mt),W(Yn))},e.\u0275cmp=ot({type:e,selectors:[["app-wishlist"]],decls:6,vars:2,consts:[[1,"wishlist-container"],[4,"ngIf","ngIfElse"],["noWishlist",""],[1,"wishlist-grid"],["class","wishlist-card",4,"ngFor","ngForOf"],[1,"wishlist-card"],[1,"card-image"],[3,"src","alt"],[1,"card-content"]],template:function(i,s){if(i&1&&(f(0,"div",0)(1,"h2"),m(2,"Your Wishlist"),p(),Z(3,aJ,3,1,"div",1)(4,lJ,2,0,"ng-template",null,2,Yi),p()),i&2){let o=Na(5);_(3),S("ngIf",s.wishlist&&s.wishlist.length>0)("ngIfElse",o)}},dependencies:[jn,Un]});let t=e;return t})();function cJ(t,e){if(t&1){let n=Y();f(0,"div",30)(1,"div",31)(2,"img",32),A("click",function(){let s=N(n).$implicit,o=E(3);return k(o.showProject(s))}),p()(),f(3,"div",33)(4,"h3"),m(5),p()()()}if(t&2){let n=e.$implicit;_(2),S("src",n.image||"https://tekled.co.uk/cdn/shop/articles/What_is_a_Conventional_Light-775007.jpg?v=1680528977",Qe)("alt",n.Nom),_(3),ee(n.Nom)}}function uJ(t,e){if(t&1&&(f(0,"div")(1,"div",28),Z(2,cJ,6,3,"div",29),p()()),t&2){let n=E(2);_(2),S("ngForOf",n.projects)}}function dJ(t,e){t&1&&(f(0,"p"),m(1,"No projects found..."),p())}function hJ(t,e){if(t&1&&(f(0,"main",23)(1,"h1",24),m(2," Mes projets "),p(),f(3,"div",25),Z(4,uJ,3,1,"div",26)(5,dJ,2,0,"ng-template",null,27,Yi),p()()),t&2){let n=Na(6),r=E();_(4),S("ngIf",r.projects&&r.projects.length>0)("ngIfElse",n)}}function fJ(t,e){if(t&1&&(f(0,"div",50),D(1,"img",51),f(2,"p"),m(3),p()()),t&2){let n=e.$implicit;_(1),S("src",n.image,Qe)("alt",n.label),_(2),ee(n.label)}}function pJ(t,e){if(t&1){let n=Y();f(0,"div",34)(1,"header")(2,"button",35),m(3,"\u2190"),p(),f(4,"h1"),m(5),p(),f(6,"button",36),m(7,"\u2661"),p()(),f(8,"main")(9,"div",37)(10,"section",38)(11,"h2"),m(12,"Les espaces trait\xE9s"),p(),f(13,"div",39),Z(14,fJ,4,3,"div",40),p(),f(15,"form",41)(16,"label"),D(17,"input",42),m(18," T\xE9l\xE9charger le concept \xE9clairage "),p(),f(19,"label"),D(20,"input",43),m(21," obtenir une estimation financi\xE8re "),p(),f(22,"label"),D(23,"input",43),m(24," Essayer les produits en demo "),p()(),f(25,"div",44)(26,"button",45),m(27,"Modifier"),p(),f(28,"button",46),A("click",function(){N(n);let i=E();return k(i.delete())}),m(29,"Supprimer"),p()()(),f(30,"section",47)(31,"h2"),m(32,"Les produit"),p(),f(33,"div",25)(34,"div",48)(35,"div",49)(36,"h3"),m(37,"Light shaper"),p(),f(38,"p"),m(39,"GL lighting"),p(),f(40,"p"),m(41,"Couleur - Noir"),p(),f(42,"a",13),m(43,"Salon"),p()()(),f(44,"div",48)(45,"div",49)(46,"h3"),m(47,"Light shaper SQ"),p(),f(48,"p"),m(49,"GL lighting"),p(),f(50,"p"),m(51,"Couleur - Gris"),p(),f(52,"a",13),m(53,"Chambre"),p()()(),f(54,"div",48)(55,"div",49)(56,"h3"),m(57,"Light shaper W"),p(),f(58,"p"),m(59,"GL lighting"),p(),f(60,"p"),m(61,"Couleur - Noir"),p(),f(62,"a",13),m(63,"Circulations"),p()()()()()()()()}if(t&2){let n=E();_(5),Le("Projet ",n.selectedProject.Nom,""),_(9),S("ngForOf",n.espaceOptions)}}var rj=(()=>{let e=class e{constructor(r,i){this.projectService=r,this.userService=i,this.fullName="",this.showList=!0,this.showProjectD=!1,this.espace=[],this.espaceOptions=[],this.espaces=[{value:"chambres",label:"chambres",image:"assets/images/chambre.jpg",alt:"Image 1"},{value:"S\xE9jour",label:"S\xE9jour",image:"assets/images/salon.jpg",alt:"Image 2"},{value:"cuisine",label:"cuisine",image:"assets/images/cuisine.jpg",alt:"Image 3"},{value:"Bureau",label:"Bureau",image:"assets/images/bureau.jpg",alt:"Image 5"},{value:"sanitaires",label:"sanitaires",image:"assets/images/salle_de_bain.jpg",alt:"Image 4"},{value:"Buanderie",label:"Buanderie",image:"assets/images/bandelerie.jpg",alt:"Image 6"},{value:"Couloir",label:"Couloir",image:"assets/images/couloir.jpg",alt:"Image 6"},{value:" ",label:"Je ne sais pas",image:"assets/images/autre.jpg",alt:"Image 3"}]}ngOnInit(){this.projectService.getAll().valueChanges().subscribe(r=>{this.projects=Object.values(r)})}delete(){console.log(this.selectedProject.key),this.projectService.removeProject(this.selectedProject.key.toString()).then(()=>{this.projectService.getAll().valueChanges().subscribe(r=>{this.projects=Object.values(r)}),this.showList=!0,this.showProjectD=!1}).catch(r=>{console.error("Error deleting project: ",r)})}showProject(r){this.showList=!1,this.showProjectD=!0,this.selectedProject=r,console.log(this.selectedProject),console.log(this.espace)}extractEspaces(){for(let r=0;r<this.selectedProject.Products.length;r++)this.espace.push(this.selectedProject.Products[r].data.Espace_a_traiter);console.log(this.espace)}};e.\u0275fac=function(i){return new(i||e)(W(X_),W(Yn))},e.\u0275cmp=ot({type:e,selectors:[["app-project-list"]],decls:50,vars:2,consts:[["lang","fr"],["rel","preconnect","href","https://fonts.googleapis.com"],["rel","preconnect","href","https://fonts.gstatic.com","crossorigin",""],["href","https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap","rel","stylesheet"],["charset","UTF-8"],["name","viewport","content","width=device-width, initial-scale=1.0"],[1,"container"],[1,"sidebar"],["src","assets/images/logo.jpg","alt","Supernova",1,"logo"],[1,"profile"],["src","assets/images/profile.png","alt","Profile Picture"],["id","name",1,"name"],[1,"active"],["href","#"],["src","assets/images/home.png","alt","home",1,"padding-right"],["src","assets/images/heart.png","alt","Favorie",1,"padding-right"],["src","assets/images/cart.png","alt","Panier",1,"padding-right"],["src","assets/images/folder.png","alt","Projet",1,"padding-right"],[1,"settings"],["src","assets/images/settings.png","alt","Param\xE8tre",1,"padding-right"],["src","assets/images/logout.png","alt","Logout",1,"padding-right"],["class","main-content",4,"ngIf"],["class","container1",4,"ngIf"],[1,"main-content"],[1,"center"],[1,"product-list"],[4,"ngIf","ngIfElse"],["noProducts",""],[1,"product-grid"],["class","product-card",4,"ngFor","ngForOf"],[1,"product-card"],[1,"card-image"],[3,"src","alt","click"],[1,"card-content"],[1,"container1"],[1,"back-button"],[1,"favorite-button"],[1,"content"],[1,"spaces"],[1,"space-list"],["class","space",4,"ngFor","ngForOf"],[1,"options"],["type","checkbox","checked",""],["type","checkbox"],[1,"buttons"],[1,"modify-button"],[1,"delete-button",3,"click"],[1,"products"],[1,"product"],[1,"product-info"],[1,"space"],[3,"src","alt"]],template:function(i,s){i&1&&(f(0,"html",0)(1,"head"),D(2,"link",1)(3,"link",2)(4,"link",3)(5,"meta",4)(6,"meta",5),f(7,"title"),m(8,"Supernova"),p()(),f(9,"body")(10,"div",6)(11,"aside",7),D(12,"img",8)(13,"br"),f(14,"div",9),D(15,"img",10),f(16,"h2",11),m(17,"Majeri Amine"),p(),f(18,"p"),m(19,"Voir et modifier le profile"),p()(),f(20,"nav")(21,"ul")(22,"li",12)(23,"a",13),D(24,"img",14),m(25," Accueil"),p()(),f(26,"li")(27,"a",13),D(28,"img",15),m(29," Favorie"),p()(),f(30,"li")(31,"a",13),D(32,"img",16),m(33," Panier"),p()(),f(34,"li")(35,"a",13),D(36,"img",17),m(37," Projet"),p()()()(),f(38,"div",18)(39,"ul")(40,"li"),D(41,"img",19),f(42,"a",13),m(43," Param\xE8tre"),p()(),f(44,"li"),D(45,"img",20),f(46,"a",13),m(47," Logout"),p()()()()(),Z(48,hJ,7,2,"main",21)(49,pJ,64,2,"div",22),p()()()),i&2&&(_(48),S("ngIf",s.showList),_(1),S("ngIf",s.showProjectD))},dependencies:[jn,Un,Nr,Rr,ar],styles:["*[_ngcontent-%COMP%]{box-sizing:border-box;margin:0;padding:0;font-family:Montserrat,sans-serif}body[_ngcontent-%COMP%]{display:flex;height:100vh;background-color:#f0f4f8}.container[_ngcontent-%COMP%]{display:flex;width:100%}header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px 0}.back-button[_ngcontent-%COMP%], .favorite-button[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;cursor:pointer}h1[_ngcontent-%COMP%]{margin:0;font-size:24px}.content[_ngcontent-%COMP%]{display:flex;gap:20px}.spaces[_ngcontent-%COMP%], .products[_ngcontent-%COMP%]{flex:1}.spaces[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .products[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:20px;margin-bottom:20px}.space-list[_ngcontent-%COMP%], .product-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.space[_ngcontent-%COMP%], .product[_ngcontent-%COMP%]{display:flex;align-items:center;background:#f1f1f1;border-radius:8px;overflow:hidden;padding:10px}.space[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .product[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60px;height:60px;margin-right:20px;border-radius:8px}.space[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .product-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0;color:#666}.product-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px}.product-info[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#6200ee;text-decoration:none}.options[_ngcontent-%COMP%]{margin:20px 0}.options[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:10px}.buttons[_ngcontent-%COMP%]{display:flex;gap:10px}.modify-button[_ngcontent-%COMP%], .delete-button[_ngcontent-%COMP%]{flex:1;padding:10px;font-size:16px;border:none;border-radius:8px;cursor:pointer}.modify-button[_ngcontent-%COMP%]{background-color:#333;color:#fff}.delete-button[_ngcontent-%COMP%]{background-color:#ff3b30;color:#fff}.padding-right[_ngcontent-%COMP%]{padding-right:10px}.product-list[_ngcontent-%COMP%]{text-align:center}.product-grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;gap:20px;padding:20px}.product-card[_ngcontent-%COMP%]{border-radius:10px;overflow:hidden;text-align:center;transition:transform .3s;position:relative}.center[_ngcontent-%COMP%]{display:flex;justify-content:center;padding-bottom:40px}.product-card[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.card-image[_ngcontent-%COMP%]{position:relative}.card-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:350px;height:200px;border-radius:5%}.sidebar[_ngcontent-%COMP%]{width:20%;background-color:#fff;padding:20px;box-shadow:2px 0 5px #0000001a}.container1[_ngcontent-%COMP%]{padding-left:15%}.profile[_ngcontent-%COMP%]{text-align:center;margin-bottom:40px}.profile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;margin-bottom:10px}.profile[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;margin-bottom:5px}.profile[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#888}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:20px 0}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;font-size:16px;color:#333;display:flex;align-items:center}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#4a90e2}.settings[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;margin-top:40px}.settings[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:20px 0}.settings[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;font-size:16px;color:#333}.settings[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#4a90e2}.main-content[_ngcontent-%COMP%]{flex:1;padding:40px}"]});let t=e;return t})();var gJ=[{path:"form",component:ZL},{path:"accueil",component:YL},{path:"",redirectTo:"login",pathMatch:"full"},{path:"products",component:QL},{path:"filtre",component:XL},{path:"login",component:ej},{path:"users",component:tj},{path:"wishlist",component:nj},{path:"projects",component:rj}],ij=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ve({type:e}),e.\u0275inj=Fe({imports:[jT.forRoot(gJ),jT]});let t=e;return t})();var sj=(()=>{let e=class e{constructor(r,i){this.productService=r,this.responseService=i,this.title="Supernova"}sendEmail(){document.getElementById("emailForm").addEventListener("submit",r=>C(this,null,function*(){r.preventDefault();let i=document.getElementById("email").value,s=document.getElementById("subject").value,o=document.getElementById("body").value;console.log("trying to send email");try{let a=yield fetch("http://localhost:3000/api/send-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:i,subject:s,body:o})}),l=yield a.json();a.ok?alert(l.message):alert(l.error)}catch(a){console.error("Error:",a),alert("An error occurred while sending the email")}}))}ngOnInit(){return C(this,null,function*(){})}};e.\u0275fac=function(i){return new(i||e)(W(ii),W(mc))},e.\u0275cmp=ot({type:e,selectors:[["app-root"]],decls:6,vars:0,consts:[[1,"navbar","navbar-expand","navbar-dark","bg-dark"],["href","#",1,"navbar-brand"],[1,"container","mt-3"]],template:function(i,s){i&1&&(f(0,"div")(1,"nav",0)(2,"a",1),m(3,"Supernova"),p()(),f(4,"div",2),D(5,"router-outlet"),p()())},dependencies:[RT],styles:[".container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;margin:25px auto}.navbar[_ngcontent-%COMP%]{margin-bottom:50px}"]});let t=e;return t})();var oj=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ve({type:e,bootstrap:[sj]}),e.\u0275inj=Fe({providers:[{provide:gi,useClass:fp}],imports:[G1,tM,ij,MM,kM.initializeApp(sL.firebase),GM,OF,NP,iL]});let t=e;return t})();eM().bootstrapModule(oj).catch(t=>console.error(t));
